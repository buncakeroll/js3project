"use strict";(self.webpackChunkrecipes=self.webpackChunkrecipes||[]).push([[179],{6304:(lt,Ee,k)=>{k.d(Ee,{Dh:()=>Ce,GT:()=>he,cc:()=>Se,hO:()=>Fe,on:()=>U,pX:()=>te,xv:()=>ae});var f=k(5879),Q=k(7142),F=k(2994);lt=k.hmd(lt);const ee=["ngOnDestroy"],te=(xe,tt,ut,J={})=>new Proxy(xe,{get:(_e,re)=>ut.runOutsideAngular(()=>{var ye;if(xe[re])return!(null===(ye=J?.spy)||void 0===ye)&&ye.get&&J.spy.get(re,xe[re]),xe[re];if(ee.indexOf(re)>-1)return()=>{};const Le=tt.toPromise().then($=>{const be=$&&$[re];return"function"==typeof be?be.bind($):be&&be.then?be.then(Ue=>ut.run(()=>Ue)):ut.run(()=>be)});return new Proxy(()=>{},{get:($,be)=>Le[be],apply:($,be,Ue)=>Le.then(At=>{var Kt;const On=At&&At(...Ue);return!(null===(Kt=J?.spy)||void 0===Kt)&&Kt.apply&&J.spy.apply(re,Ue,On),On})})})}),he=(xe,tt)=>{tt.forEach(ut=>{Object.getOwnPropertyNames(ut.prototype||ut).forEach(J=>{Object.defineProperty(xe.prototype,J,Object.getOwnPropertyDescriptor(ut.prototype||ut,J))})})};class fe{constructor(tt){return tt}}const Ce=new f.OlP("angularfire2.app.options"),ae=new f.OlP("angularfire2.app.name");function U(xe,tt,ut){const _e="object"==typeof ut&&ut||{};_e.name=_e.name||"string"==typeof ut&&ut||"[DEFAULT]";const ye=Q.Z.apps.filter(Le=>Le&&Le.name===_e.name)[0]||tt.runOutsideAngular(()=>Q.Z.initializeApp(xe,_e));try{JSON.stringify(xe)!==JSON.stringify(ye.options)&&G("error",`${ye.name} Firebase App already initialized with different options${lt.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new fe(ye)}const G=(xe,...tt)=>{(0,f.X6Q)()&&typeof console<"u"&&console[xe](...tt)},X={provide:fe,useFactory:U,deps:[Ce,f.R0b,[new f.FiY,ae]]};let Fe=(()=>{class xe{constructor(ut){Q.Z.registerVersion("angularfire",F.q4.full,"core"),Q.Z.registerVersion("angularfire",F.q4.full,"app-compat"),Q.Z.registerVersion("angular",f.q4F.full,ut.toString())}static initializeApp(ut,J){return{ngModule:xe,providers:[{provide:Ce,useValue:ut},{provide:ae,useValue:J}]}}}return xe.\u0275fac=function(ut){return new(ut||xe)(f.LFG(f.Lbi))},xe.\u0275mod=f.oAB({type:xe}),xe.\u0275inj=f.cJS({providers:[X]}),xe})();function Se(xe,tt,ut,J,_e){const[,re,ye]=globalThis.\u0275AngularfireInstanceCache.find(Le=>Le[0]===xe)||[];if(re)return function $e(xe,tt){try{return xe.toString()===tt.toString()}catch{return xe===tt}}(_e,ye)||(He("error",`${tt} was already initialized on the ${ut} Firebase App with different settings.${Ne?" You may need to reload as Firebase is not HMR aware.":""}`),He("warn",{is:_e,was:ye})),re;{const Le=J();return globalThis.\u0275AngularfireInstanceCache.push([xe,Le,_e]),Le}}const Ne=!!lt.hot,He=(xe,...tt)=>{(0,f.X6Q)()&&typeof console<"u"&&console[xe](...tt)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},2994:(lt,Ee,k)=>{k.d(Ee,{q4:()=>tc,iC:()=>Gu,fc:()=>qa,HU:()=>$u,vb:()=>Hu,JM:()=>nc});var f=k(5879),Q=k(3182),F=k(5861),ee=k(4303),te=k(9058),he=k(4537),fe=k(7879),Ce=k(1878);const ae="@firebase/installations",U="0.6.1",G=1e4,X=`w:${U}`,Fe="FIS_v2",Se="https://firebaseinstallations.googleapis.com/v1",$e=36e5,tt=new te.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ut(b){return b instanceof te.ZR&&b.code.includes("request-failed")}function J({projectId:b}){return`${Se}/projects/${b}/installations`}function _e(b){return{token:b.token,requestStatus:2,expiresIn:At(b.expiresIn),creationTime:Date.now()}}function re(b,T){return ye.apply(this,arguments)}function ye(){return(ye=(0,F.Z)(function*(b,T){const V=(yield T.json()).error;return tt.create("request-failed",{requestName:b,serverCode:V.code,serverMessage:V.message,serverStatus:V.status})})).apply(this,arguments)}function Le({apiKey:b}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":b})}function be(b){return Ue.apply(this,arguments)}function Ue(){return(Ue=(0,F.Z)(function*(b){const T=yield b();return T.status>=500&&T.status<600?b():T})).apply(this,arguments)}function At(b){return Number(b.replace("s","000"))}function Mn(){return(Mn=(0,F.Z)(function*({appConfig:b,heartbeatServiceProvider:T},{fid:x}){const V=J(b),K=Le(b),ne=T.getImmediate({optional:!0});if(ne){const ot=yield ne.getHeartbeatsHeader();ot&&K.append("x-firebase-client",ot)}const et={method:"POST",headers:K,body:JSON.stringify({fid:x,authVersion:Fe,appId:b.appId,sdkVersion:X})},st=yield be(()=>fetch(V,et));if(st.ok){const ot=yield st.json();return{fid:ot.fid||x,registrationStatus:2,refreshToken:ot.refreshToken,authToken:_e(ot.authToken)}}throw yield re("Create Installation",st)})).apply(this,arguments)}function In(b){return new Promise(T=>{setTimeout(T,b)})}const zs=/^[cdef][\w-]{21}$/,ie="";function le(){try{const b=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(b),b[0]=112+b[0]%16;const x=function pe(b){return function fr(b){return btoa(String.fromCharCode(...b)).replace(/\+/g,"-").replace(/\//g,"_")}(b).substr(0,22)}(b);return zs.test(x)?x:ie}catch{return ie}}function de(b){return`${b.appName}!${b.appId}`}const Oe=new Map;function Ve(b,T){const x=de(b);Xt(x,T),function wt(b,T){const x=function Ct(){return!on&&"BroadcastChannel"in self&&(on=new BroadcastChannel("[Firebase] FID Change"),on.onmessage=b=>{Xt(b.data.key,b.data.fid)}),on}();x&&x.postMessage({key:b,fid:T}),function Jt(){0===Oe.size&&on&&(on.close(),on=null)}()}(x,T)}function Xt(b,T){const x=Oe.get(b);if(x)for(const V of x)V(T)}let on=null;const Bn="firebase-installations-database",pr=1,ln="firebase-installations-store";let Pn=null;function si(){return Pn||(Pn=(0,Ce.X3)(Bn,pr,{upgrade:(b,T)=>{0===T&&b.createObjectStore(ln)}})),Pn}function Yr(b,T){return Qr.apply(this,arguments)}function Qr(){return(Qr=(0,F.Z)(function*(b,T){const x=de(b),K=(yield si()).transaction(ln,"readwrite"),ne=K.objectStore(ln),Me=yield ne.get(x);return yield ne.put(T,x),yield K.done,(!Me||Me.fid!==T.fid)&&Ve(b,T.fid),T})).apply(this,arguments)}function ns(b){return wi.apply(this,arguments)}function wi(){return(wi=(0,F.Z)(function*(b){const T=de(b),V=(yield si()).transaction(ln,"readwrite");yield V.objectStore(ln).delete(T),yield V.done})).apply(this,arguments)}function Vi(b,T){return _t.apply(this,arguments)}function _t(){return(_t=(0,F.Z)(function*(b,T){const x=de(b),K=(yield si()).transaction(ln,"readwrite"),ne=K.objectStore(ln),Me=yield ne.get(x),et=T(Me);return void 0===et?yield ne.delete(x):yield ne.put(et,x),yield K.done,et&&(!Me||Me.fid!==et.fid)&&Ve(b,et.fid),et})).apply(this,arguments)}function Pt(b){return Vt.apply(this,arguments)}function Vt(){return Vt=(0,F.Z)(function*(b){let T;const x=yield Vi(b.appConfig,V=>{const K=function jn(b){return is(b||{fid:le(),registrationStatus:0})}(V),ne=function rs(b,T){if(0===T.registrationStatus){if(!navigator.onLine)return{installationEntry:T,registrationPromise:Promise.reject(tt.create("app-offline"))};const x={fid:T.fid,registrationStatus:1,registrationTime:Date.now()},V=function Er(b,T){return en.apply(this,arguments)}(b,x);return{installationEntry:x,registrationPromise:V}}return 1===T.registrationStatus?{installationEntry:T,registrationPromise:Cn(b)}:{installationEntry:T}}(b,K);return T=ne.registrationPromise,ne.installationEntry});return x.fid===ie?{installationEntry:yield T}:{installationEntry:x,registrationPromise:T}}),Vt.apply(this,arguments)}function en(){return en=(0,F.Z)(function*(b,T){try{const x=yield function On(b,T){return Mn.apply(this,arguments)}(b,T);return Yr(b.appConfig,x)}catch(x){throw ut(x)&&409===x.customData.serverCode?yield ns(b.appConfig):yield Yr(b.appConfig,{fid:T.fid,registrationStatus:0}),x}}),en.apply(this,arguments)}function Cn(b){return Ei.apply(this,arguments)}function Ei(){return(Ei=(0,F.Z)(function*(b){let T=yield xn(b.appConfig);for(;1===T.registrationStatus;)yield In(100),T=yield xn(b.appConfig);if(0===T.registrationStatus){const{installationEntry:x,registrationPromise:V}=yield Pt(b);return V||x}return T})).apply(this,arguments)}function xn(b){return Vi(b,T=>{if(!T)throw tt.create("installation-not-found");return is(T)})}function is(b){return function tn(b){return 1===b.registrationStatus&&b.registrationTime+G<Date.now()}(b)?{fid:b.fid,registrationStatus:0}:b}function Ii(){return(Ii=(0,F.Z)(function*({appConfig:b,heartbeatServiceProvider:T},x){const V=function yu(b,{fid:T}){return`${J(b)}/${T}/authTokens:generate`}(b,x),K=function $(b,{refreshToken:T}){const x=Le(b);return x.append("Authorization",function Kt(b){return`${Fe} ${b}`}(T)),x}(b,x),ne=T.getImmediate({optional:!0});if(ne){const ot=yield ne.getHeartbeatsHeader();ot&&K.append("x-firebase-client",ot)}const et={method:"POST",headers:K,body:JSON.stringify({installation:{sdkVersion:X,appId:b.appId}})},st=yield be(()=>fetch(V,et));if(st.ok)return _e(yield st.json());throw yield re("Generate Auth Token",st)})).apply(this,arguments)}function ai(b){return qs.apply(this,arguments)}function qs(){return qs=(0,F.Z)(function*(b,T=!1){let x;const V=yield Vi(b.appConfig,ne=>{if(!Zt(ne))throw tt.create("not-registered");const Me=ne.authToken;if(!T&&function j(b){return 2===b.requestStatus&&!function B(b){const T=Date.now();return T<b.creationTime||b.creationTime+b.expiresIn<T+$e}(b)}(Me))return ne;if(1===Me.requestStatus)return x=function Ye(b,T){return Ae.apply(this,arguments)}(b,T),ne;{if(!navigator.onLine)throw tt.create("app-offline");const et=function Z(b){const T={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},b),{authToken:T})}(ne);return x=function St(b,T){return mt.apply(this,arguments)}(b,et),et}});return x?yield x:V.authToken}),qs.apply(this,arguments)}function Ae(){return(Ae=(0,F.Z)(function*(b,T){let x=yield ze(b.appConfig);for(;1===x.authToken.requestStatus;)yield In(100),x=yield ze(b.appConfig);const V=x.authToken;return 0===V.requestStatus?ai(b,T):V})).apply(this,arguments)}function ze(b){return Vi(b,T=>{if(!Zt(T))throw tt.create("not-registered");return function ve(b){return 1===b.requestStatus&&b.requestTime+G<Date.now()}(T.authToken)?Object.assign(Object.assign({},T),{authToken:{requestStatus:0}}):T})}function mt(){return mt=(0,F.Z)(function*(b,T){try{const x=yield function oi(b,T){return Ii.apply(this,arguments)}(b,T),V=Object.assign(Object.assign({},T),{authToken:x});return yield Yr(b.appConfig,V),x}catch(x){if(!ut(x)||401!==x.customData.serverCode&&404!==x.customData.serverCode){const V=Object.assign(Object.assign({},T),{authToken:{requestStatus:0}});yield Yr(b.appConfig,V)}else yield ns(b.appConfig);throw x}}),mt.apply(this,arguments)}function Zt(b){return void 0!==b&&2===b.registrationStatus}function it(){return(it=(0,F.Z)(function*(b){const T=b,{installationEntry:x,registrationPromise:V}=yield Pt(T);return V?V.catch(console.error):ai(T).catch(console.error),x.fid})).apply(this,arguments)}function Gt(){return Gt=(0,F.Z)(function*(b,T=!1){const x=b;return yield function Hn(b){return pn.apply(this,arguments)}(x),(yield ai(x,T)).token}),Gt.apply(this,arguments)}function pn(){return(pn=(0,F.Z)(function*(b){const{registrationPromise:T}=yield Pt(b);T&&(yield T)})).apply(this,arguments)}function po(b){return tt.create("missing-app-config-values",{valueName:b})}const Ol="installations",tr=b=>{const T=b.getProvider("app").getImmediate(),x=function ba(b){if(!b||!b.options)throw po("App Configuration");if(!b.name)throw po("App Name");const T=["projectId","apiKey","appId"];for(const x of T)if(!b.options[x])throw po(x);return{appName:b.name,projectId:b.options.projectId,apiKey:b.options.apiKey,appId:b.options.appId}}(T);return{app:T,appConfig:x,heartbeatServiceProvider:(0,ee._getProvider)(T,"heartbeat"),_delete:()=>Promise.resolve()}},Da=b=>{const T=b.getProvider("app").getImmediate(),x=(0,ee._getProvider)(T,Ol).getImmediate();return{getId:()=>function se(b){return it.apply(this,arguments)}(x),getToken:K=>function Rt(b){return Gt.apply(this,arguments)}(x,K)}};(function Ws(){(0,ee._registerComponent)(new he.wA(Ol,tr,"PUBLIC")),(0,ee._registerComponent)(new he.wA("installations-internal",Da,"PRIVATE"))})(),(0,ee.registerVersion)(ae,U),(0,ee.registerVersion)(ae,U,"esm2017");const $o="@firebase/remote-config",Nr=new te.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Df{constructor(T,x,V,K){this.client=T,this.storage=x,this.storageCache=V,this.logger=K}isCachedDataFresh(T,x){if(!x)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const V=Date.now()-x,K=V<=T;return this.logger.debug(`Config fetch cache check. Cache age millis: ${V}. Cache max age millis (minimumFetchIntervalMillis setting): ${T}. Is cache hit: ${K}.`),K}fetch(T){var x=this;return(0,F.Z)(function*(){const[V,K]=yield Promise.all([x.storage.getLastSuccessfulFetchTimestampMillis(),x.storage.getLastSuccessfulFetchResponse()]);if(K&&x.isCachedDataFresh(T.cacheMaxAgeMillis,V))return K;T.eTag=K&&K.eTag;const ne=yield x.client.fetch(T),Me=[x.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===ne.status&&Me.push(x.storage.setLastSuccessfulFetchResponse(ne)),yield Promise.all(Me),ne})()}}function Nt(b=navigator){return b.languages&&b.languages[0]||b.language}class Wn{constructor(T,x,V,K,ne,Me){this.firebaseInstallations=T,this.sdkVersion=x,this.namespace=V,this.projectId=K,this.apiKey=ne,this.appId=Me}fetch(T){var x=this;return(0,F.Z)(function*(){const[V,K]=yield Promise.all([x.firebaseInstallations.getId(),x.firebaseInstallations.getToken()]),Me=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${x.projectId}/namespaces/${x.namespace}:fetch?key=${x.apiKey}`,et={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":T.eTag||"*"},st={sdk_version:x.sdkVersion,app_instance_id:V,app_instance_id_token:K,app_id:x.appId,language_code:Nt()},ot={method:"POST",headers:et,body:JSON.stringify(st)},Bt=fetch(Me,ot),dt=new Promise((or,ar)=>{T.signal.addEventListener(()=>{const ur=new Error("The operation was aborted.");ur.name="AbortError",ar(ur)})});let sr;try{yield Promise.race([Bt,dt]),sr=yield Bt}catch(or){let ar="fetch-client-network";throw"AbortError"===or?.name&&(ar="fetch-timeout"),Nr.create(ar,{originalErrorMessage:or?.message})}let Dn=sr.status;const qi=sr.headers.get("ETag")||void 0;let Tn,Ti;if(200===sr.status){let or;try{or=yield sr.json()}catch(ar){throw Nr.create("fetch-client-parse",{originalErrorMessage:ar?.message})}Tn=or.entries,Ti=or.state}if("INSTANCE_STATE_UNSPECIFIED"===Ti?Dn=500:"NO_CHANGE"===Ti?Dn=304:("NO_TEMPLATE"===Ti||"EMPTY_CONFIG"===Ti)&&(Tn={}),304!==Dn&&200!==Dn)throw Nr.create("fetch-status",{httpStatus:Dn});return{status:Dn,eTag:qi,config:Tn}})()}}class li{constructor(T,x){this.client=T,this.storage=x}fetch(T){var x=this;return(0,F.Z)(function*(){const V=(yield x.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return x.attemptFetch(T,V)})()}attemptFetch(T,{throttleEndTimeMillis:x,backoffCount:V}){var K=this;return(0,F.Z)(function*(){yield function kn(b,T){return new Promise((x,V)=>{const K=Math.max(T-Date.now(),0),ne=setTimeout(x,K);b.addEventListener(()=>{clearTimeout(ne),V(Nr.create("fetch-throttle",{throttleEndTimeMillis:T}))})})}(T.signal,x);try{const ne=yield K.client.fetch(T);return yield K.storage.deleteThrottleMetadata(),ne}catch(ne){if(!function Ks(b){if(!(b instanceof te.ZR&&b.customData))return!1;const T=Number(b.customData.httpStatus);return 429===T||500===T||503===T||504===T}(ne))throw ne;const Me={throttleEndTimeMillis:Date.now()+(0,te.$s)(V),backoffCount:V+1};return yield K.storage.setThrottleMetadata(Me),K.attemptFetch(T,Me)}})()}}class Wo{constructor(T,x,V,K,ne){this.app=T,this._client=x,this._storageCache=V,this._storage=K,this._logger=ne,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function wu(b,T){const x=b.target.error||void 0;return Nr.create(T,{originalErrorMessage:x&&x?.message})}const bs="app_namespace_store";class Rn{constructor(T,x,V,K=function Mt(){return new Promise((b,T)=>{try{const x=indexedDB.open("firebase_remote_config",1);x.onerror=V=>{T(wu(V,"storage-open"))},x.onsuccess=V=>{b(V.target.result)},x.onupgradeneeded=V=>{0===V.oldVersion&&V.target.result.createObjectStore(bs,{keyPath:"compositeKey"})}}catch(x){T(Nr.create("storage-open",{originalErrorMessage:x?.message}))}})}()){this.appId=T,this.appName=x,this.namespace=V,this.openDbPromise=K}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(T){return this.set("last_fetch_status",T)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(T){return this.set("last_successful_fetch_timestamp_millis",T)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(T){return this.set("last_successful_fetch_response",T)}getActiveConfig(){return this.get("active_config")}setActiveConfig(T){return this.set("active_config",T)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(T){return this.set("active_config_etag",T)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(T){return this.set("throttle_metadata",T)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(T){var x=this;return(0,F.Z)(function*(){const V=yield x.openDbPromise;return new Promise((K,ne)=>{const et=V.transaction([bs],"readonly").objectStore(bs),st=x.createCompositeKey(T);try{const ot=et.get(st);ot.onerror=Bt=>{ne(wu(Bt,"storage-get"))},ot.onsuccess=Bt=>{const dt=Bt.target.result;K(dt?dt.value:void 0)}}catch(ot){ne(Nr.create("storage-get",{originalErrorMessage:ot?.message}))}})})()}set(T,x){var V=this;return(0,F.Z)(function*(){const K=yield V.openDbPromise;return new Promise((ne,Me)=>{const st=K.transaction([bs],"readwrite").objectStore(bs),ot=V.createCompositeKey(T);try{const Bt=st.put({compositeKey:ot,value:x});Bt.onerror=dt=>{Me(wu(dt,"storage-set"))},Bt.onsuccess=()=>{ne()}}catch(Bt){Me(Nr.create("storage-set",{originalErrorMessage:Bt?.message}))}})})()}delete(T){var x=this;return(0,F.Z)(function*(){const V=yield x.openDbPromise;return new Promise((K,ne)=>{const et=V.transaction([bs],"readwrite").objectStore(bs),st=x.createCompositeKey(T);try{const ot=et.delete(st);ot.onerror=Bt=>{ne(wu(Bt,"storage-delete"))},ot.onsuccess=()=>{K()}}catch(ot){ne(Nr.create("storage-delete",{originalErrorMessage:ot?.message}))}})})()}createCompositeKey(T){return[this.appId,this.appName,this.namespace,T].join()}}class di{constructor(T){this.storage=T}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var T=this;return(0,F.Z)(function*(){const x=T.storage.getLastFetchStatus(),V=T.storage.getLastSuccessfulFetchTimestampMillis(),K=T.storage.getActiveConfig(),ne=yield x;ne&&(T.lastFetchStatus=ne);const Me=yield V;Me&&(T.lastSuccessfulFetchTimestampMillis=Me);const et=yield K;et&&(T.activeConfig=et)})()}setLastFetchStatus(T){return this.lastFetchStatus=T,this.storage.setLastFetchStatus(T)}setLastSuccessfulFetchTimestampMillis(T){return this.lastSuccessfulFetchTimestampMillis=T,this.storage.setLastSuccessfulFetchTimestampMillis(T)}setActiveConfig(T){return this.activeConfig=T,this.storage.setActiveConfig(T)}}function vn(){return go.apply(this,arguments)}function go(){return(go=(0,F.Z)(function*(){if(!(0,te.hl)())return!1;try{return yield(0,te.eu)()}catch{return!1}})).apply(this,arguments)}!function Ui(){(0,ee._registerComponent)(new he.wA("remote-config",function b(T,{instanceIdentifier:x}){const V=T.getProvider("app").getImmediate(),K=T.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Nr.create("registration-window");if(!(0,te.hl)())throw Nr.create("indexed-db-unavailable");const{projectId:ne,apiKey:Me,appId:et}=V.options;if(!ne)throw Nr.create("registration-project-id");if(!Me)throw Nr.create("registration-api-key");if(!et)throw Nr.create("registration-app-id");const st=new Rn(et,V.name,x=x||"firebase"),ot=new di(st),Bt=new fe.Yd($o);Bt.logLevel=fe.in.ERROR;const dt=new Wn(K,ee.SDK_VERSION,x,ne,Me,et),sr=new li(dt,st),Dn=new Df(sr,st,ot,Bt),qi=new Wo(V,Dn,ot,st,Bt);return function fd(b){const T=(0,te.m9)(b);T._initializePromise||(T._initializePromise=T._storageCache.loadFromStorage().then(()=>{T._isInitializationComplete=!0}))}(qi),qi},"PUBLIC").setMultipleInstances(!0)),(0,ee.registerVersion)($o,"0.4.1"),(0,ee.registerVersion)($o,"0.4.1","esm2017")}();const ss="/firebase-messaging-sw.js",Et="/firebase-cloud-messaging-push-scope",Bi="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",mo="https://fcmregistrations.googleapis.com/v1",os="google.c.a.c_id",bn="google.c.a.c_l",xa="google.c.a.ts";var Ds=function(b){return b.PUSH_RECEIVED="push-received",b.NOTIFICATION_CLICKED="notification-clicked",b}(Ds||{});function hi(b){const T=new Uint8Array(b);return btoa(String.fromCharCode(...T)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Ts(b){const x=(b+"=".repeat((4-b.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),V=atob(x),K=new Uint8Array(V.length);for(let ne=0;ne<V.length;++ne)K[ne]=V.charCodeAt(ne);return K}const Ci="fcm_token_details_db",Na=5,rr="fcm_token_object_Store";function Tf(){return Tf=(0,F.Z)(function*(b){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(ne=>ne.name).includes(Ci))return null;let T=null;return(yield(0,Ce.X3)(Ci,Na,{upgrade:(V=(0,F.Z)(function*(K,ne,Me,et){var st;if(ne<2||!K.objectStoreNames.contains(rr))return;const ot=et.objectStore(rr),Bt=yield ot.index("fcmSenderId").get(b);if(yield ot.clear(),Bt)if(2===ne){const dt=Bt;if(!dt.auth||!dt.p256dh||!dt.endpoint)return;T={token:dt.fcmToken,createTime:null!==(st=dt.createTime)&&void 0!==st?st:Date.now(),subscriptionOptions:{auth:dt.auth,p256dh:dt.p256dh,endpoint:dt.endpoint,swScope:dt.swScope,vapidKey:"string"==typeof dt.vapidKey?dt.vapidKey:hi(dt.vapidKey)}}}else if(3===ne){const dt=Bt;T={token:dt.fcmToken,createTime:dt.createTime,subscriptionOptions:{auth:hi(dt.auth),p256dh:hi(dt.p256dh),endpoint:dt.endpoint,swScope:dt.swScope,vapidKey:hi(dt.vapidKey)}}}else if(4===ne){const dt=Bt;T={token:dt.fcmToken,createTime:dt.createTime,subscriptionOptions:{auth:hi(dt.auth),p256dh:hi(dt.p256dh),endpoint:dt.endpoint,swScope:dt.swScope,vapidKey:hi(dt.vapidKey)}}}}),function(ne,Me,et,st){return V.apply(this,arguments)})})).close(),yield(0,Ce.Lj)(Ci),yield(0,Ce.Lj)("fcm_vapid_details_db"),yield(0,Ce.Lj)("undefined"),function Eu(b){if(!b||!b.subscriptionOptions)return!1;const{subscriptionOptions:T}=b;return"number"==typeof b.createTime&&b.createTime>0&&"string"==typeof b.token&&b.token.length>0&&"string"==typeof T.auth&&T.auth.length>0&&"string"==typeof T.p256dh&&T.p256dh.length>0&&"string"==typeof T.endpoint&&T.endpoint.length>0&&"string"==typeof T.swScope&&T.swScope.length>0&&"string"==typeof T.vapidKey&&T.vapidKey.length>0}(T)?T:null;var V}),Tf.apply(this,arguments)}const Oa="firebase-messaging-database",ji=1,bi="firebase-messaging-store";let Qs=null;function Xs(){return Qs||(Qs=(0,Ce.X3)(Oa,ji,{upgrade:(b,T)=>{0===T&&b.createObjectStore(bi)}})),Qs}function ir(b){return Ul.apply(this,arguments)}function Ul(){return Ul=(0,F.Z)(function*(b){const T=_o(b),V=yield(yield Xs()).transaction(bi).objectStore(bi).get(T);if(V)return V;{const K=yield function zt(b){return Tf.apply(this,arguments)}(b.appConfig.senderId);if(K)return yield Zn(b,K),K}}),Ul.apply(this,arguments)}function Zn(b,T){return Ir.apply(this,arguments)}function Ir(){return(Ir=(0,F.Z)(function*(b,T){const x=_o(b),K=(yield Xs()).transaction(bi,"readwrite");return yield K.objectStore(bi).put(T,x),yield K.done,T})).apply(this,arguments)}function Hi(){return(Hi=(0,F.Z)(function*(b){const T=_o(b),V=(yield Xs()).transaction(bi,"readwrite");yield V.objectStore(bi).delete(T),yield V.done})).apply(this,arguments)}function _o({appConfig:b}){return b.appId}const Fn=new te.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function md(b,T){return Cu.apply(this,arguments)}function Cu(){return(Cu=(0,F.Z)(function*(b,T){const x=yield vd(b),V=$l(T),K={method:"POST",headers:x,body:JSON.stringify(V)};let ne;try{ne=yield(yield fetch(bu(b.appConfig),K)).json()}catch(Me){throw Fn.create("token-subscribe-failed",{errorInfo:Me?.toString()})}if(ne.error)throw Fn.create("token-subscribe-failed",{errorInfo:ne.error.message});if(!ne.token)throw Fn.create("token-subscribe-no-token");return ne.token})).apply(this,arguments)}function Bl(){return(Bl=(0,F.Z)(function*(b,T){const x=yield vd(b),V=$l(T.subscriptionOptions),K={method:"PATCH",headers:x,body:JSON.stringify(V)};let ne;try{ne=yield(yield fetch(`${bu(b.appConfig)}/${T.token}`,K)).json()}catch(Me){throw Fn.create("token-update-failed",{errorInfo:Me?.toString()})}if(ne.error)throw Fn.create("token-update-failed",{errorInfo:ne.error.message});if(!ne.token)throw Fn.create("token-update-no-token");return ne.token})).apply(this,arguments)}function jl(b,T){return yd.apply(this,arguments)}function yd(){return(yd=(0,F.Z)(function*(b,T){const V={method:"DELETE",headers:yield vd(b)};try{const ne=yield(yield fetch(`${bu(b.appConfig)}/${T}`,V)).json();if(ne.error)throw Fn.create("token-unsubscribe-failed",{errorInfo:ne.error.message})}catch(K){throw Fn.create("token-unsubscribe-failed",{errorInfo:K?.toString()})}})).apply(this,arguments)}function bu({projectId:b}){return`${mo}/projects/${b}/registrations`}function vd(b){return Hl.apply(this,arguments)}function Hl(){return(Hl=(0,F.Z)(function*({appConfig:b,installations:T}){const x=yield T.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":b.apiKey,"x-goog-firebase-installations-auth":`FIS ${x}`})})).apply(this,arguments)}function $l({p256dh:b,auth:T,endpoint:x,vapidKey:V}){const K={web:{endpoint:x,auth:T,p256dh:b}};return V!==Bi&&(K.web.applicationPubKey=V),K}const wd=6048e5;function Ed(){return Ed=(0,F.Z)(function*(b){const T=yield function Af(b,T){return Ln.apply(this,arguments)}(b.swRegistration,b.vapidKey),x={vapidKey:b.vapidKey,swScope:b.swRegistration.scope,endpoint:T.endpoint,auth:hi(T.getKey("auth")),p256dh:hi(T.getKey("p256dh"))},V=yield ir(b.firebaseDependencies);if(V){if(function Mf(b,T){return T.vapidKey===b.vapidKey&&T.endpoint===b.endpoint&&T.auth===b.auth&&T.p256dh===b.p256dh}(V.subscriptionOptions,x))return Date.now()>=V.createTime+wd?function Cd(b,T){return bd.apply(this,arguments)}(b,{token:V.token,createTime:Date.now(),subscriptionOptions:x}):V.token;try{yield jl(b.firebaseDependencies,V.token)}catch(K){console.warn(K)}return Pa(b.firebaseDependencies,x)}return Pa(b.firebaseDependencies,x)}),Ed.apply(this,arguments)}function Sf(){return Sf=(0,F.Z)(function*(b){const T=yield ir(b.firebaseDependencies);T&&(yield jl(b.firebaseDependencies,T.token),yield function Iu(b){return Hi.apply(this,arguments)}(b.firebaseDependencies));const x=yield b.swRegistration.pushManager.getSubscription();return!x||x.unsubscribe()}),Sf.apply(this,arguments)}function bd(){return bd=(0,F.Z)(function*(b,T){try{const x=yield function _d(b,T){return Bl.apply(this,arguments)}(b.firebaseDependencies,T),V=Object.assign(Object.assign({},T),{token:x,createTime:Date.now()});return yield Zn(b.firebaseDependencies,V),x}catch(x){throw yield function Id(b){return Sf.apply(this,arguments)}(b),x}}),bd.apply(this,arguments)}function Pa(b,T){return Du.apply(this,arguments)}function Du(){return(Du=(0,F.Z)(function*(b,T){const V={token:yield md(b,T),createTime:Date.now(),subscriptionOptions:T};return yield Zn(b,V),V.token})).apply(this,arguments)}function Ln(){return(Ln=(0,F.Z)(function*(b,T){return(yield b.pushManager.getSubscription())||b.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Ts(T)})})).apply(this,arguments)}function yo(b){const T={from:b.from,collapseKey:b.collapse_key,messageId:b.fcmMessageId};return function zl(b,T){if(!T.notification)return;b.notification={};const x=T.notification.title;x&&(b.notification.title=x);const V=T.notification.body;V&&(b.notification.body=V);const K=T.notification.image;K&&(b.notification.image=K);const ne=T.notification.icon;ne&&(b.notification.icon=ne)}(T,b),function mv(b,T){T.data&&(b.data=T.data)}(T,b),function Dd(b,T){var x,V,K,ne,Me;if(!(T.fcmOptions||null!==(x=T.notification)&&void 0!==x&&x.click_action))return;b.fcmOptions={};const et=null!==(K=null===(V=T.fcmOptions)||void 0===V?void 0:V.link)&&void 0!==K?K:null===(ne=T.notification)||void 0===ne?void 0:ne.click_action;et&&(b.fcmOptions.link=et);const st=null===(Me=T.fcmOptions)||void 0===Me?void 0:Me.analytics_label;st&&(b.fcmOptions.analyticsLabel=st)}(T,b),T}function Td(b,T){const x=[];for(let V=0;V<b.length;V++)x.push(b.charAt(V)),V<T.length&&x.push(T.charAt(V));return x.join("")}function Tu(b){return Fn.create("missing-app-config-values",{valueName:b})}Td("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Td("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class _v{constructor(T,x,V){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const K=function rm(b){if(!b||!b.options)throw Tu("App Configuration Object");if(!b.name)throw Tu("App Name");const T=["projectId","apiKey","appId","messagingSenderId"],{options:x}=b;for(const V of T)if(!x[V])throw Tu(V);return{appName:b.name,projectId:x.projectId,apiKey:x.apiKey,appId:x.appId,senderId:x.messagingSenderId}}(T);this.firebaseDependencies={app:T,appConfig:K,installations:x,analyticsProvider:V}}_delete(){return Promise.resolve()}}function Di(){return(Di=(0,F.Z)(function*(b){try{b.swRegistration=yield navigator.serviceWorker.register(ss,{scope:Et}),b.swRegistration.update().catch(()=>{})}catch(T){throw Fn.create("failed-service-worker-registration",{browserErrorMessage:T?.message})}})).apply(this,arguments)}function Vn(){return(Vn=(0,F.Z)(function*(b,T){if(!T&&!b.swRegistration&&(yield function ka(b){return Di.apply(this,arguments)}(b)),T||!b.swRegistration){if(!(T instanceof ServiceWorkerRegistration))throw Fn.create("invalid-sw-registration");b.swRegistration=T}})).apply(this,arguments)}function xf(){return(xf=(0,F.Z)(function*(b,T){T?b.vapidKey=T:b.vapidKey||(b.vapidKey=Bi)})).apply(this,arguments)}function Ko(){return Ko=(0,F.Z)(function*(b,T){if(!navigator)throw Fn.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw Fn.create("permission-blocked");return yield function Js(b,T){return xf.apply(this,arguments)}(b,T?.vapidKey),yield function Zo(b,T){return Vn.apply(this,arguments)}(b,T?.serviceWorkerRegistration),function Gl(b){return Ed.apply(this,arguments)}(b)}),Ko.apply(this,arguments)}function Sd(){return(Sd=(0,F.Z)(function*(b,T,x){const V=function Rf(b){switch(b){case Ds.NOTIFICATION_CLICKED:return"notification_open";case Ds.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(T);(yield b.firebaseDependencies.analyticsProvider.get()).logEvent(V,{message_id:x[os],message_name:x[bn],message_time:x[xa],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function Yo(){return Yo=(0,F.Z)(function*(b,T){const x=T.data;if(!x.isFirebaseMessaging)return;b.onMessageHandler&&x.messageType===Ds.PUSH_RECEIVED&&("function"==typeof b.onMessageHandler?b.onMessageHandler(yo(x)):b.onMessageHandler.next(yo(x)));const V=x.data;(function ql(b){return"object"==typeof b&&!!b&&os in b})(V)&&"1"===V["google.c.a.e"]&&(yield function vo(b,T,x){return Sd.apply(this,arguments)}(b,x.messageType,V))}),Yo.apply(this,arguments)}const Md="@firebase/messaging",im=b=>{const T=new _v(b.getProvider("app").getImmediate(),b.getProvider("installations-internal").getImmediate(),b.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",x=>function Ad(b,T){return Yo.apply(this,arguments)}(T,x)),T},Su=b=>{const T=b.getProvider("messaging").getImmediate();return{getToken:V=>function Fa(b,T){return Ko.apply(this,arguments)}(T,V)}};function Nf(){return Wl.apply(this,arguments)}function Wl(){return(Wl=(0,F.Z)(function*(){try{yield(0,te.eu)()}catch{return!1}return typeof window<"u"&&(0,te.hl)()&&(0,te.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function sm(){(0,ee._registerComponent)(new he.wA("messaging",im,"PUBLIC")),(0,ee._registerComponent)(new he.wA("messaging-internal",Su,"PRIVATE")),(0,ee.registerVersion)(Md,"0.12.1"),(0,ee.registerVersion)(Md,"0.12.1","esm2017")}();const Nd="analytics",Of="firebase_id",wv="origin",$i=6e4,wo="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Au="https://www.googletagmanager.com/gtag/js",Ut=new fe.Yd("@firebase/analytics");function La(b){return Promise.all(b.map(T=>T.catch(x=>x)))}function Xo(){return(Xo=(0,F.Z)(function*(b,T,x,V,K,ne){const Me=V[K];try{if(Me)yield T[Me];else{const st=(yield La(x)).find(ot=>ot.measurementId===K);st&&(yield T[st.appId])}}catch(et){Ut.error(et)}b("config",K,ne)})).apply(this,arguments)}function gr(){return(gr=(0,F.Z)(function*(b,T,x,V,K){try{let ne=[];if(K&&K.send_to){let Me=K.send_to;Array.isArray(Me)||(Me=[Me]);const et=yield La(x);for(const st of Me){const ot=et.find(dt=>dt.measurementId===st),Bt=ot&&T[ot.appId];if(!Bt){ne=[];break}ne.push(Bt)}}0===ne.length&&(ne=Object.values(T)),yield Promise.all(ne),b("event",V,K||{})}catch(ne){Ut.error(ne)}})).apply(this,arguments)}const Xr=new te.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),Jo=30,Va=new class Gi{constructor(T={},x=1e3){this.throttleMetadata=T,this.intervalMillis=x}getThrottleMetadata(T){return this.throttleMetadata[T]}setThrottleMetadata(T,x){this.throttleMetadata[T]=x}deleteThrottleMetadata(T){delete this.throttleMetadata[T]}};function kd(b){return new Headers({Accept:"application/json","x-goog-api-key":b})}function xu(){return(xu=(0,F.Z)(function*(b){var T;const{appId:x,apiKey:V}=b,K={method:"GET",headers:kd(V)},ne=wo.replace("{app-id}",x),Me=yield fetch(ne,K);if(200!==Me.status&&304!==Me.status){let et="";try{const st=yield Me.json();null!==(T=st.error)&&void 0!==T&&T.message&&(et=st.error.message)}catch{}throw Xr.create("config-fetch-failed",{httpStatus:Me.status,responseMessage:et})}return Me.json()})).apply(this,arguments)}function Yl(){return(Yl=(0,F.Z)(function*(b,T=Va,x){const{appId:V,apiKey:K,measurementId:ne}=b.options;if(!V)throw Xr.create("no-app-id");if(!K){if(ne)return{measurementId:ne,appId:V};throw Xr.create("no-api-key")}const Me=T.getThrottleMetadata(V)||{backoffCount:0,throttleEndTimeMillis:Date.now()},et=new Xl;return setTimeout((0,F.Z)(function*(){et.abort()}),void 0!==x?x:$i),Ru({appId:V,apiKey:K,measurementId:ne},Me,et,T)})).apply(this,arguments)}function Ru(b,T,x){return Ql.apply(this,arguments)}function Ql(){return Ql=(0,F.Z)(function*(b,{throttleEndTimeMillis:T,backoffCount:x},V,K=Va){var ne;const{appId:Me,measurementId:et}=b;try{yield function Ua(b,T){return new Promise((x,V)=>{const K=Math.max(T-Date.now(),0),ne=setTimeout(x,K);b.addEventListener(()=>{clearTimeout(ne),V(Xr.create("fetch-throttle",{throttleEndTimeMillis:T}))})})}(V,T)}catch(st){if(et)return Ut.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${et} provided in the "measurementId" field in the local Firebase config. [${st?.message}]`),{appId:Me,measurementId:et};throw st}try{const st=yield function It(b){return xu.apply(this,arguments)}(b);return K.deleteThrottleMetadata(Me),st}catch(st){const ot=st;if(!function Io(b){if(!(b instanceof te.ZR&&b.customData))return!1;const T=Number(b.customData.httpStatus);return 429===T||500===T||503===T||504===T}(ot)){if(K.deleteThrottleMetadata(Me),et)return Ut.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${et} provided in the "measurementId" field in the local Firebase config. [${ot?.message}]`),{appId:Me,measurementId:et};throw st}const Bt=503===Number(null===(ne=ot?.customData)||void 0===ne?void 0:ne.httpStatus)?(0,te.$s)(x,K.intervalMillis,Jo):(0,te.$s)(x,K.intervalMillis),dt={throttleEndTimeMillis:Date.now()+Bt,backoffCount:x+1};return K.setThrottleMetadata(Me,dt),Ut.debug(`Calling attemptFetch again in ${Bt} millis`),Ru(b,dt,V,K)}}),Ql.apply(this,arguments)}class Xl{constructor(){this.listeners=[]}addEventListener(T){this.listeners.push(T)}abort(){this.listeners.forEach(T=>T())}}let Nu,fi;function Co(){return(Co=(0,F.Z)(function*(b,T,x,V,K){if(K&&K.global)b("event",x,V);else{const ne=yield T;b("event",x,Object.assign(Object.assign({},V),{send_to:ne}))}})).apply(this,arguments)}function kf(){return(kf=(0,F.Z)(function*(){if(!(0,te.hl)())return Ut.warn(Xr.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,te.eu)()}catch(b){return Ut.warn(Xr.create("indexeddb-unavailable",{errorInfo:b?.toString()}).message),!1}return!0})).apply(this,arguments)}function Cr(){return Cr=(0,F.Z)(function*(b,T,x,V,K,ne,Me){var et;const st=function mr(b){return Yl.apply(this,arguments)}(b);st.then(Dn=>{x[Dn.measurementId]=Dn.appId,b.options.measurementId&&Dn.measurementId!==b.options.measurementId&&Ut.warn(`The measurement ID in the local Firebase config (${b.options.measurementId}) does not match the measurement ID fetched from the server (${Dn.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(Dn=>Ut.error(Dn)),T.push(st);const ot=function cm(){return kf.apply(this,arguments)}().then(Dn=>{if(Dn)return V.getId()}),[Bt,dt]=yield Promise.all([st,ot]);(function Kl(b){const T=window.document.getElementsByTagName("script");for(const x of Object.values(T))if(x.src&&x.src.includes(Au)&&x.src.includes(b))return x;return null})(ne)||function Mu(b,T){const x=document.createElement("script");x.src=`${Au}?l=${b}&id=${T}`,x.async=!0,document.head.appendChild(x)}(ne,Bt.measurementId),fi&&(K("consent","default",fi),function ku(b){fi=b}(void 0)),K("js",new Date);const sr=null!==(et=Me?.config)&&void 0!==et?et:{};return sr[wv]="firebase",sr.update=!0,null!=dt&&(sr[Of]=dt),K("config",Bt.measurementId,sr),Nu&&(K("set",Nu),function ja(b){Nu=b}(void 0)),Bt.measurementId}),Cr.apply(this,arguments)}class as{constructor(T){this.app=T}_delete(){return delete us[this.app.options.appId],Promise.resolve()}}let us={},Ms=[];const zi={};let Ff,xs,ea="dataLayer",To=!1;function Lu(b,T,x){!function Jl(){const b=[];if((0,te.ru)()&&b.push("This is a browser extension environment."),(0,te.zI)()||b.push("Cookies are not available."),b.length>0){const T=b.map((V,K)=>`(${K+1}) ${V}`).join(" "),x=Xr.create("invalid-analytics-context",{errorInfo:T});Ut.warn(x.message)}}();const V=b.options.appId;if(!V)throw Xr.create("no-app-id");if(!b.options.apiKey){if(!b.options.measurementId)throw Xr.create("no-api-key");Ut.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${b.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=us[V])throw Xr.create("already-exists",{id:V});if(!To){!function Pr(b){let T=[];Array.isArray(window[b])?T=window[b]:window[b]=T}(ea);const{wrappedGtag:ne,gtagCore:Me}=function Pf(b,T,x,V,K){let ne=function(...Me){window[V].push(arguments)};return window[K]&&"function"==typeof window[K]&&(ne=window[K]),window[K]=function Od(b,T,x,V){function ne(){return ne=(0,F.Z)(function*(Me,et,st){try{"event"===Me?yield function Ss(b,T,x,V,K){return gr.apply(this,arguments)}(b,T,x,et,st):"config"===Me?yield function Eo(b,T,x,V,K,ne){return Xo.apply(this,arguments)}(b,T,x,V,et,st):"consent"===Me?b("consent","update",st):b("set",et)}catch(ot){Ut.error(ot)}}),ne.apply(this,arguments)}return function K(Me,et,st){return ne.apply(this,arguments)}}(ne,b,T,x),{gtagCore:ne,wrappedGtag:window[K]}}(us,Ms,zi,ea,"gtag");xs=ne,Ff=Me,To=!0}return us[V]=function Do(b,T,x,V,K,ne,Me){return Cr.apply(this,arguments)}(b,Ms,zi,T,Ff,ea,x),new as(b)}function ec(){return ta.apply(this,arguments)}function ta(){return(ta=(0,F.Z)(function*(){if((0,te.ru)()||!(0,te.zI)()||!(0,te.hl)())return!1;try{return yield(0,te.eu)()}catch{return!1}})).apply(this,arguments)}const So="@firebase/analytics";!function pm(){(0,ee._registerComponent)(new he.wA(Nd,(T,{options:x})=>Lu(T.getProvider("app").getImmediate(),T.getProvider("installations-internal").getImmediate(),x),"PUBLIC")),(0,ee._registerComponent)(new he.wA("analytics-internal",function b(T){try{const x=T.getProvider(Nd).getImmediate();return{logEvent:(V,K,ne)=>function fm(b,T,x,V){b=(0,te.m9)(b),function lm(b,T,x,V,K){return Co.apply(this,arguments)}(xs,us[b.app.options.appId],T,x,V).catch(K=>Ut.error(K))}(x,V,K,ne)}}catch(x){throw Xr.create("interop-component-reg-failed",{reason:x})}},"PRIVATE")),(0,ee.registerVersion)(So,"0.9.1"),(0,ee.registerVersion)(So,"0.9.1","esm2017")}();var Bd=k(1954),jd=k(2631);const $a=new class Ha extends jd.v{}(class gm extends Bd.o{constructor(T,x){super(T,x),this.scheduler=T,this.work=x}schedule(T,x=0){return x>0?super.schedule(T,x):(this.delay=x,this.state=T,this.scheduler.flush(this),this)}execute(T,x){return x>0||this.closed?super.execute(T,x):this._execute(T,x)}requestAsyncId(T,x,V=0){return null!=V&&V>0||null==V&&this.delay>0?super.requestAsyncId(T,x,V):(T.flush(this),0)}});var Ns=k(6321),Vu=k(9397),ls=k(3093),Ga=k(5137);const tc=new f.GfV("7.6.1"),Uu="__angularfire_symbol__analyticsIsSupportedValue",Jr="__angularfire_symbol__analyticsIsSupported",cs="__angularfire_symbol__remoteConfigIsSupportedValue",Bu="__angularfire_symbol__remoteConfigIsSupported",nn="__angularfire_symbol__messagingIsSupportedValue",ct="__angularfire_symbol__messagingIsSupported";function nc(b,T,x){if(T){if(1===T.length)return T[0];const ne=T.filter(Me=>Me.app===x);if(1===ne.length)return ne[0]}return x.container.getProvider(b).getImmediate({optional:!0})}globalThis[Jr]||(globalThis[Jr]=ec().then(b=>globalThis[Uu]=b).catch(()=>globalThis[Uu]=!1)),globalThis[ct]||(globalThis[ct]=Nf().then(b=>globalThis[nn]=b).catch(()=>globalThis[nn]=!1)),globalThis[Bu]||(globalThis[Bu]=vn().then(b=>globalThis[cs]=b).catch(()=>globalThis[cs]=!1));const Hu=(b,T)=>{const x=T?[T]:(0,Q.C6)(),V=[];return x.forEach(K=>{K.container.getProvider(b).instances.forEach(Me=>{V.includes(Me)||V.push(Me)})}),V};function za(){}class Os{constructor(T,x=$a){this.zone=T,this.delegate=x}now(){return this.delegate.now()}schedule(T,x,V){const K=this.zone;return this.delegate.schedule(function(Me){K.runGuarded(()=>{T.apply(this,[Me])})},x,V)}}class Tt{constructor(T){this.zone=T,this.task=null}call(T,x){const V=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",za,{},za,za)),x.pipe((0,Vu.b)({next:V,complete:V,error:V})).subscribe(T).add(V)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let $u=(()=>{class b{constructor(x){this.ngZone=x,this.outsideAngular=x.runOutsideAngular(()=>new Os(Zone.current)),this.insideAngular=x.run(()=>new Os(Zone.current,Ns.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return b.\u0275fac=function(x){return new(x||b)(f.LFG(f.R0b))},b.\u0275prov=f.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})();function Ps(){const b=globalThis.\u0275AngularFireScheduler;if(!b)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return b}function qa(b){return b.pipe((0,ls.Q)(Ps().outsideAngular))}function Gu(b){return Ps(),function Wa(b){return function(x){return(x=x.lift(new Tt(b.ngZone))).pipe((0,Ga.R)(b.outsideAngular),(0,ls.Q)(b.insideAngular))}}(Ps())(b)}},9058:(lt,Ee,k)=>{k.d(Ee,{$s:()=>ze,BH:()=>_e,DV:()=>ln,Dv:()=>Cn,G6:()=>fr,GJ:()=>Bn,L:()=>Ce,LL:()=>Oe,Pz:()=>J,Sg:()=>re,UG:()=>$,UI:()=>si,US:()=>he,Wj:()=>is,Wl:()=>Xt,Yr:()=>In,ZB:()=>G,ZR:()=>de,aH:()=>ut,b$:()=>At,cI:()=>je,dS:()=>oi,eu:()=>ie,g5:()=>F,gK:()=>Ei,gQ:()=>Pt,h$:()=>fe,hl:()=>zs,hu:()=>Q,jU:()=>be,lb:()=>tn,m9:()=>Zt,ne:()=>Vt,p$:()=>U,pd:()=>_t,r3:()=>pr,ru:()=>Ue,tV:()=>ae,uI:()=>Le,ug:()=>Ii,vZ:()=>Yr,w1:()=>On,w9:()=>Jt,xO:()=>wi,xb:()=>Pn,z$:()=>ye,zI:()=>le,zd:()=>Vi});const f={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Q=function(j,B){if(!j)throw F(B)},F=function(j){return new Error("Firebase Database ("+f.SDK_VERSION+") INTERNAL ASSERT FAILED: "+j)},ee=function(j){const B=[];let Z=0;for(let ve=0;ve<j.length;ve++){let se=j.charCodeAt(ve);se<128?B[Z++]=se:se<2048?(B[Z++]=se>>6|192,B[Z++]=63&se|128):55296==(64512&se)&&ve+1<j.length&&56320==(64512&j.charCodeAt(ve+1))?(se=65536+((1023&se)<<10)+(1023&j.charCodeAt(++ve)),B[Z++]=se>>18|240,B[Z++]=se>>12&63|128,B[Z++]=se>>6&63|128,B[Z++]=63&se|128):(B[Z++]=se>>12|224,B[Z++]=se>>6&63|128,B[Z++]=63&se|128)}return B},he={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(j,B){if(!Array.isArray(j))throw Error("encodeByteArray takes an array as a parameter");this.init_();const Z=B?this.byteToCharMapWebSafe_:this.byteToCharMap_,ve=[];for(let se=0;se<j.length;se+=3){const it=j[se],Rt=se+1<j.length,Gt=Rt?j[se+1]:0,Hn=se+2<j.length,pn=Hn?j[se+2]:0;let qn=(15&Gt)<<2|pn>>6,fo=63&pn;Hn||(fo=64,Rt||(qn=64)),ve.push(Z[it>>2],Z[(3&it)<<4|Gt>>4],Z[qn],Z[fo])}return ve.join("")},encodeString(j,B){return this.HAS_NATIVE_SUPPORT&&!B?btoa(j):this.encodeByteArray(ee(j),B)},decodeString(j,B){return this.HAS_NATIVE_SUPPORT&&!B?atob(j):function(j){const B=[];let Z=0,ve=0;for(;Z<j.length;){const se=j[Z++];if(se<128)B[ve++]=String.fromCharCode(se);else if(se>191&&se<224){const it=j[Z++];B[ve++]=String.fromCharCode((31&se)<<6|63&it)}else if(se>239&&se<365){const Hn=((7&se)<<18|(63&j[Z++])<<12|(63&j[Z++])<<6|63&j[Z++])-65536;B[ve++]=String.fromCharCode(55296+(Hn>>10)),B[ve++]=String.fromCharCode(56320+(1023&Hn))}else{const it=j[Z++],Rt=j[Z++];B[ve++]=String.fromCharCode((15&se)<<12|(63&it)<<6|63&Rt)}}return B.join("")}(this.decodeStringToByteArray(j,B))},decodeStringToByteArray(j,B){this.init_();const Z=B?this.charToByteMapWebSafe_:this.charToByteMap_,ve=[];for(let se=0;se<j.length;){const it=Z[j.charAt(se++)],Gt=se<j.length?Z[j.charAt(se)]:0;++se;const pn=se<j.length?Z[j.charAt(se)]:64;++se;const Je=se<j.length?Z[j.charAt(se)]:64;if(++se,null==it||null==Gt||null==pn||null==Je)throw Error();ve.push(it<<2|Gt>>4),64!==pn&&(ve.push(Gt<<4&240|pn>>2),64!==Je&&ve.push(pn<<6&192|Je))}return ve},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let j=0;j<this.ENCODED_VALS.length;j++)this.byteToCharMap_[j]=this.ENCODED_VALS.charAt(j),this.charToByteMap_[this.byteToCharMap_[j]]=j,this.byteToCharMapWebSafe_[j]=this.ENCODED_VALS_WEBSAFE.charAt(j),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[j]]=j,j>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(j)]=j,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(j)]=j)}}},fe=function(j){const B=ee(j);return he.encodeByteArray(B,!0)},Ce=function(j){return fe(j).replace(/\./g,"")},ae=function(j){try{return he.decodeString(j,!0)}catch(B){console.error("base64Decode failed: ",B)}return null};function U(j){return G(void 0,j)}function G(j,B){if(!(B instanceof Object))return B;switch(B.constructor){case Date:return new Date(B.getTime());case Object:void 0===j&&(j={});break;case Array:j=[];break;default:return B}for(const Z in B)!B.hasOwnProperty(Z)||!X(Z)||(j[Z]=G(j[Z],B[Z]));return j}function X(j){return"__proto__"!==j}const He=()=>{try{return function Fe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const j=process.env.__FIREBASE_DEFAULTS__;return j?JSON.parse(j):void 0})()||(()=>{if(typeof document>"u")return;let j;try{j=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const B=j&&ae(j[1]);return B&&JSON.parse(B)})()}catch(j){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${j}`)}},ut=()=>{var j;return null===(j=He())||void 0===j?void 0:j.config},J=j=>{var B;return null===(B=He())||void 0===B?void 0:B[`_${j}`]};class _e{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((B,Z)=>{this.resolve=B,this.reject=Z})}wrapCallback(B){return(Z,ve)=>{Z?this.reject(Z):this.resolve(ve),"function"==typeof B&&(this.promise.catch(()=>{}),1===B.length?B(Z):B(Z,ve))}}}function re(j,B){if(j.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const ve=B||"demo-project",se=j.iat||0,it=j.sub||j.user_id;if(!it)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const Rt=Object.assign({iss:`https://securetoken.google.com/${ve}`,aud:ve,iat:se,exp:se+3600,auth_time:se,sub:it,user_id:it,firebase:{sign_in_provider:"custom",identities:{}}},j);return[Ce(JSON.stringify({alg:"none",type:"JWT"})),Ce(JSON.stringify(Rt)),""].join(".")}function ye(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Le(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ye())}function $(){var j;const B=null===(j=He())||void 0===j?void 0:j.forceEnvironment;if("node"===B)return!0;if("browser"===B)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function be(){return"object"==typeof self&&self.self===self}function Ue(){const j="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof j&&void 0!==j.id}function At(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function On(){const j=ye();return j.indexOf("MSIE ")>=0||j.indexOf("Trident/")>=0}function In(){return!0===f.NODE_CLIENT||!0===f.NODE_ADMIN}function fr(){return!$()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zs(){try{return"object"==typeof indexedDB}catch{return!1}}function ie(){return new Promise((j,B)=>{try{let Z=!0;const ve="validate-browser-context-for-indexeddb-analytics-module",se=self.indexedDB.open(ve);se.onsuccess=()=>{se.result.close(),Z||self.indexedDB.deleteDatabase(ve),j(!0)},se.onupgradeneeded=()=>{Z=!1},se.onerror=()=>{var it;B((null===(it=se.error)||void 0===it?void 0:it.message)||"")}}catch(Z){B(Z)}})}function le(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class de extends Error{constructor(B,Z,ve){super(Z),this.code=B,this.customData=ve,this.name="FirebaseError",Object.setPrototypeOf(this,de.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Oe.prototype.create)}}class Oe{constructor(B,Z,ve){this.service=B,this.serviceName=Z,this.errors=ve}create(B,...Z){const ve=Z[0]||{},se=`${this.service}/${B}`,it=this.errors[B],Rt=it?function Ve(j,B){return j.replace(rt,(Z,ve)=>{const se=B[ve];return null!=se?String(se):`<${ve}?>`})}(it,ve):"Error";return new de(se,`${this.serviceName}: ${Rt} (${se}).`,ve)}}const rt=/\{\$([^}]+)}/g;function je(j){return JSON.parse(j)}function Xt(j){return JSON.stringify(j)}const wt=function(j){let B={},Z={},ve={},se="";try{const it=j.split(".");B=je(ae(it[0])||""),Z=je(ae(it[1])||""),se=it[2],ve=Z.d||{},delete Z.d}catch{}return{header:B,claims:Z,data:ve,signature:se}},Jt=function(j){const Z=wt(j).claims;return!!Z&&"object"==typeof Z&&Z.hasOwnProperty("iat")},Bn=function(j){const B=wt(j).claims;return"object"==typeof B&&!0===B.admin};function pr(j,B){return Object.prototype.hasOwnProperty.call(j,B)}function ln(j,B){if(Object.prototype.hasOwnProperty.call(j,B))return j[B]}function Pn(j){for(const B in j)if(Object.prototype.hasOwnProperty.call(j,B))return!1;return!0}function si(j,B,Z){const ve={};for(const se in j)Object.prototype.hasOwnProperty.call(j,se)&&(ve[se]=B.call(Z,j[se],se,j));return ve}function Yr(j,B){if(j===B)return!0;const Z=Object.keys(j),ve=Object.keys(B);for(const se of Z){if(!ve.includes(se))return!1;const it=j[se],Rt=B[se];if(Qr(it)&&Qr(Rt)){if(!Yr(it,Rt))return!1}else if(it!==Rt)return!1}for(const se of ve)if(!Z.includes(se))return!1;return!0}function Qr(j){return null!==j&&"object"==typeof j}function wi(j){const B=[];for(const[Z,ve]of Object.entries(j))Array.isArray(ve)?ve.forEach(se=>{B.push(encodeURIComponent(Z)+"="+encodeURIComponent(se))}):B.push(encodeURIComponent(Z)+"="+encodeURIComponent(ve));return B.length?"&"+B.join("&"):""}function Vi(j){const B={};return j.replace(/^\?/,"").split("&").forEach(ve=>{if(ve){const[se,it]=ve.split("=");B[decodeURIComponent(se)]=decodeURIComponent(it)}}),B}function _t(j){const B=j.indexOf("?");if(!B)return"";const Z=j.indexOf("#",B);return j.substring(B,Z>0?Z:void 0)}class Pt{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let B=1;B<this.blockSize;++B)this.pad_[B]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(B,Z){Z||(Z=0);const ve=this.W_;if("string"==typeof B)for(let Je=0;Je<16;Je++)ve[Je]=B.charCodeAt(Z)<<24|B.charCodeAt(Z+1)<<16|B.charCodeAt(Z+2)<<8|B.charCodeAt(Z+3),Z+=4;else for(let Je=0;Je<16;Je++)ve[Je]=B[Z]<<24|B[Z+1]<<16|B[Z+2]<<8|B[Z+3],Z+=4;for(let Je=16;Je<80;Je++){const qn=ve[Je-3]^ve[Je-8]^ve[Je-14]^ve[Je-16];ve[Je]=4294967295&(qn<<1|qn>>>31)}let pn,zn,se=this.chain_[0],it=this.chain_[1],Rt=this.chain_[2],Gt=this.chain_[3],Hn=this.chain_[4];for(let Je=0;Je<80;Je++){Je<40?Je<20?(pn=Gt^it&(Rt^Gt),zn=1518500249):(pn=it^Rt^Gt,zn=1859775393):Je<60?(pn=it&Rt|Gt&(it|Rt),zn=2400959708):(pn=it^Rt^Gt,zn=3395469782);const qn=(se<<5|se>>>27)+pn+Hn+zn+ve[Je]&4294967295;Hn=Gt,Gt=Rt,Rt=4294967295&(it<<30|it>>>2),it=se,se=qn}this.chain_[0]=this.chain_[0]+se&4294967295,this.chain_[1]=this.chain_[1]+it&4294967295,this.chain_[2]=this.chain_[2]+Rt&4294967295,this.chain_[3]=this.chain_[3]+Gt&4294967295,this.chain_[4]=this.chain_[4]+Hn&4294967295}update(B,Z){if(null==B)return;void 0===Z&&(Z=B.length);const ve=Z-this.blockSize;let se=0;const it=this.buf_;let Rt=this.inbuf_;for(;se<Z;){if(0===Rt)for(;se<=ve;)this.compress_(B,se),se+=this.blockSize;if("string"==typeof B){for(;se<Z;)if(it[Rt]=B.charCodeAt(se),++Rt,++se,Rt===this.blockSize){this.compress_(it),Rt=0;break}}else for(;se<Z;)if(it[Rt]=B[se],++Rt,++se,Rt===this.blockSize){this.compress_(it),Rt=0;break}}this.inbuf_=Rt,this.total_+=Z}digest(){const B=[];let Z=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let se=this.blockSize-1;se>=56;se--)this.buf_[se]=255&Z,Z/=256;this.compress_(this.buf_);let ve=0;for(let se=0;se<5;se++)for(let it=24;it>=0;it-=8)B[ve]=this.chain_[se]>>it&255,++ve;return B}}function Vt(j,B){const Z=new jn(j,B);return Z.subscribe.bind(Z)}class jn{constructor(B,Z){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=Z,this.task.then(()=>{B(this)}).catch(ve=>{this.error(ve)})}next(B){this.forEachObserver(Z=>{Z.next(B)})}error(B){this.forEachObserver(Z=>{Z.error(B)}),this.close(B)}complete(){this.forEachObserver(B=>{B.complete()}),this.close()}subscribe(B,Z,ve){let se;if(void 0===B&&void 0===Z&&void 0===ve)throw new Error("Missing Observer.");se=function Er(j,B){if("object"!=typeof j||null===j)return!1;for(const Z of B)if(Z in j&&"function"==typeof j[Z])return!0;return!1}(B,["next","error","complete"])?B:{next:B,error:Z,complete:ve},void 0===se.next&&(se.next=en),void 0===se.error&&(se.error=en),void 0===se.complete&&(se.complete=en);const it=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?se.error(this.finalError):se.complete()}catch{}}),this.observers.push(se),it}unsubscribeOne(B){void 0===this.observers||void 0===this.observers[B]||(delete this.observers[B],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(B){if(!this.finalized)for(let Z=0;Z<this.observers.length;Z++)this.sendOne(Z,B)}sendOne(B,Z){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[B])try{Z(this.observers[B])}catch(ve){typeof console<"u"&&console.error&&console.error(ve)}})}close(B){this.finalized||(this.finalized=!0,void 0!==B&&(this.finalError=B),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function en(){}const Cn=function(j,B,Z,ve){let se;if(ve<B?se="at least "+B:ve>Z&&(se=0===Z?"none":"no more than "+Z),se)throw new Error(j+" failed: Was called with "+ve+(1===ve?" argument.":" arguments.")+" Expects "+se+".")};function Ei(j,B){return`${j} failed: ${B} argument `}function is(j,B,Z,ve){if((!ve||Z)&&"function"!=typeof Z)throw new Error(Ei(j,B)+"must be a valid function.")}function tn(j,B,Z,ve){if((!ve||Z)&&("object"!=typeof Z||null===Z))throw new Error(Ei(j,B)+"must be a valid context object.")}const oi=function(j){const B=[];let Z=0;for(let ve=0;ve<j.length;ve++){let se=j.charCodeAt(ve);if(se>=55296&&se<=56319){const it=se-55296;ve++,Q(ve<j.length,"Surrogate pair missing trail surrogate."),se=65536+(it<<10)+(j.charCodeAt(ve)-56320)}se<128?B[Z++]=se:se<2048?(B[Z++]=se>>6|192,B[Z++]=63&se|128):se<65536?(B[Z++]=se>>12|224,B[Z++]=se>>6&63|128,B[Z++]=63&se|128):(B[Z++]=se>>18|240,B[Z++]=se>>12&63|128,B[Z++]=se>>6&63|128,B[Z++]=63&se|128)}return B},Ii=function(j){let B=0;for(let Z=0;Z<j.length;Z++){const ve=j.charCodeAt(Z);ve<128?B++:ve<2048?B+=2:ve>=55296&&ve<=56319?(B+=4,Z++):B+=3}return B},ai=1e3,qs=2,Ye=144e5,Ae=.5;function ze(j,B=ai,Z=qs){const ve=B*Math.pow(Z,j),se=Math.round(Ae*ve*(Math.random()-.5)*2);return Math.min(Ye,ve+se)}function Zt(j){return j&&j._delegate?j._delegate:j}},9390:(lt,Ee,k)=>{var f=k(5879);let Q=null;function F(){return Q}class te{}const he=new f.OlP("DocumentToken");let fe=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return(0,f.f3M)(ae)},providedIn:"platform"}),n})();const Ce=new f.OlP("Location Initialized");let ae=(()=>{class n extends fe{constructor(){super(),this._doc=(0,f.f3M)(he),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return F().getBaseHref(this._doc)}onPopState(t){const r=F().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=F().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return new n},providedIn:"platform"}),n})();function U(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function G(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function X(n){return n&&"?"!==n[0]?"?"+n:n}let Fe=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return(0,f.f3M)($e)},providedIn:"root"}),n})();const Se=new f.OlP("appBaseHref");let $e=(()=>{class n extends Fe{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??(0,f.f3M)(he).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return U(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+X(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,a){const l=this.prepareExternalUrl(i+X(a));this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){const l=this.prepareExternalUrl(i+X(a));this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(fe),f.LFG(Se,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ne=(()=>{class n extends Fe{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=U(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,a){let l=this.prepareExternalUrl(i+X(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){let l=this.prepareExternalUrl(i+X(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(fe),f.LFG(Se,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})(),He=(()=>{class n{constructor(t){this._subject=new f.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._basePath=function J(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(G(ut(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+X(r))}normalize(t){return n.stripTrailingSlash(function tt(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,ut(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+X(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+X(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}}return n.normalizeQueryParams=X,n.joinWithSlash=U,n.stripTrailingSlash=G,n.\u0275fac=function(t){return new(t||n)(f.LFG(Fe))},n.\u0275prov=f.Yz7({token:n,factory:function(){return function xe(){return new He((0,f.LFG)(Fe))}()},providedIn:"root"}),n})();function ut(n){return n.replace(/\/index.html$/,"")}class hd{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Go=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const r=this._viewContainer;t.forEachOperation((i,a,l)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new hd(i.item,this._ngForOf,-1,-1),null===l?void 0:l);else if(null==l)r.remove(null===a?void 0:a);else if(null!==a){const h=r.get(a);r.move(h,l),vu(h,i)}});for(let i=0,a=r.length;i<a;i++){const h=r.get(i).context;h.index=i,h.count=a,h.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{vu(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.s_b),f.Y36(f.Rgc),f.Y36(f.ZZ4))},n.\u0275dir=f.lG2({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function vu(n,e){n.context.$implicit=e.item}let zo=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new Sa,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){fd("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){fd("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.s_b),f.Y36(f.Rgc))},n.\u0275dir=f.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class Sa{constructor(){this.$implicit=null,this.ngIf=null}}function fd(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,f.AaK)(e)}'.`)}class Wn{createSubscription(e,t){return(0,f.rg0)(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){(0,f.rg0)(()=>e.unsubscribe())}}class kn{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}}const Ks=new kn,li=new Wn;let ci=(()=>{class n{constructor(t){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,r=>this._updateLatestValue(t,r))}_selectStrategy(t){if((0,f.QGY)(t))return Ks;if((0,f.F4k)(t))return li;throw function Nt(n,e){return new f.vHH(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,r){t===this._obj&&(this._latestValue=r,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.sBO,16))},n.\u0275pipe=f.Yjl({name:"async",type:n,pure:!1,standalone:!0}),n})(),jr=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})();function rr(n){return"server"===n}let Oa=(()=>{class n{}return n.\u0275prov=(0,f.Yz7)({token:n,providedIn:"root",factory:()=>new ji((0,f.LFG)(he),window)}),n})();class ji{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function Qs(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const a=i.shadowRoot;if(a){const l=a.getElementById(e)||a.querySelector(`[name="${e}"]`);if(l)return l}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(r-a[0],i-a[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=bi(this.window.history)||bi(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function bi(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class Mu extends te{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Pr extends Mu{static makeCurrent(){!function ee(n){Q||(Q=n)}(new Pr)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Xo(){return Eo=Eo||document.querySelector("base"),Eo?Eo.getAttribute("href"):null}();return null==t?null:function gr(n){Ss=Ss||document.createElement("a"),Ss.setAttribute("href",n);const e=Ss.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Eo=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function Fl(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,a]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(a)}return null}(document.cookie,e)}}let Ss,Eo=null,Pf=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const Kl=new f.OlP("EventManagerPlugins");let As=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(a=>a.supports(t)),!r)throw new f.vHH(5101,!1);return this._eventNameToPlugin.set(t,r),r}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Kl),f.LFG(f.R0b))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();class Xr{constructor(e){this._doc=e}}const Jo="ng-app-id";let Pd=(()=>{class n{constructor(t,r,i,a={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=a,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=rr(a),this.resetHostNodes()}addStyles(t){for(const r of t)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(t){for(const r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){const r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${Jo}="${this.appId}"]`);if(t?.length){const r=new Map;return t.forEach(i=>{null!=i.textContent&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){const i=this.styleRef;if(i.has(t)){const a=i.get(t);return a.usage+=r,a.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){const i=this.styleNodesInDOM,a=i?.get(r);if(a?.parentNode===t)return i.delete(r),a.removeAttribute(Jo),a;{const l=this.doc.createElement("style");return this.nonce&&l.setAttribute("nonce",this.nonce),l.textContent=r,this.platformIsServer&&l.setAttribute(Jo,this.appId),l}}addStyleToHost(t,r){const i=this.getStyleElement(t,r);t.appendChild(i);const a=this.styleRef,l=a.get(r)?.elements;l?l.push(i):a.set(r,{elements:[i],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(he),f.LFG(f.AFp),f.LFG(f.Ojb,8),f.LFG(f.Lbi))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const Gi={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Va=/%COMP%/g,Yl=new f.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function Ua(n,e){return e.map(t=>t.replace(Va,n))}let Io=(()=>{class n{constructor(t,r,i,a,l,h,_,w=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=a,this.doc=l,this.platformId=h,this.ngZone=_,this.nonce=w,this.rendererByCompId=new Map,this.platformIsServer=rr(h),this.defaultRenderer=new Xl(t,l,_,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===f.ifc.ShadowDom&&(r={...r,encapsulation:f.ifc.Emulated});const i=this.getOrCreateRenderer(t,r);return i instanceof Ht?i.applyToHost(t):i instanceof Ie&&i.applyStyles(),i}getOrCreateRenderer(t,r){const i=this.rendererByCompId;let a=i.get(r.id);if(!a){const l=this.doc,h=this.ngZone,_=this.eventManager,w=this.sharedStylesHost,D=this.removeStylesOnCompDestroy,A=this.platformIsServer;switch(r.encapsulation){case f.ifc.Emulated:a=new Ht(_,w,r,this.appId,D,l,h,A);break;case f.ifc.ShadowDom:return new Fd(_,w,t,r,l,h,this.nonce,A);default:a=new Ie(_,w,r,D,l,h,A)}i.set(r.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(As),f.LFG(Pd),f.LFG(f.AFp),f.LFG(Yl),f.LFG(he),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(f.Ojb))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();class Xl{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Gi[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Co(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Co(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?this.doc.querySelector(e):e;if(!r)throw new f.vHH(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const a=Gi[i];a?e.setAttributeNS(a,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=Gi[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(f.JOm.DashCase|f.JOm.Important)?e.style.setProperty(t,r,i&f.JOm.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&f.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){if("string"==typeof e&&!(e=F().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function Co(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Fd extends Xl{constructor(e,t,r,i,a,l,h,_){super(e,a,l,_),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const w=Ua(i.id,i.styles);for(const D of w){const A=document.createElement("style");h&&A.setAttribute("nonce",h),A.textContent=D,this.shadowRoot.appendChild(A)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Ie extends Xl{constructor(e,t,r,i,a,l,h,_){super(e,a,l,h),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=_?Ua(_,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class Ht extends Ie{constructor(e,t,r,i,a,l,h,_){const w=i+"-"+r.id;super(e,t,r,a,l,h,_,w),this.contentAttr=function Ru(n){return"_ngcontent-%COMP%".replace(Va,n)}(w),this.hostAttr=function Ql(n){return"_nghost-%COMP%".replace(Va,n)}(w)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}let Ou=(()=>{class n extends Xr{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(he))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const Ba=["alt","control","meta","shift"],Kn={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Pu={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let bo=(()=>{class n extends Xr{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const a=n.parseEventName(r),l=n.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>F().onAndCancel(t,a.domEventName,l))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const a=n._normalizeKey(r.pop());let l="",h=r.indexOf("code");if(h>-1&&(r.splice(h,1),l="code."),Ba.forEach(w=>{const D=r.indexOf(w);D>-1&&(r.splice(D,1),l+=w+".")}),l+=a,0!=r.length||0===a.length)return null;const _={};return _.domEventName=i,_.fullKey=l,_}static matchEventFullKeyCode(t,r){let i=Kn[t.key]||t.key,a="";return r.indexOf("code.")>-1&&(i=t.code,a="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),Ba.forEach(l=>{l!==i&&(0,Pu[l])(t)&&(a+=l+".")}),a+=i,a===r)}static eventCallback(t,r,i){return a=>{n.matchEventFullKeyCode(a,t)&&i.runGuarded(()=>r(a))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(he))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const us=(0,f.eFA)(f._c5,"browser",[{provide:f.Lbi,useValue:"browser"},{provide:f.g9A,useValue:function kf(){Pr.makeCurrent()},multi:!0},{provide:he,useFactory:function Cr(){return(0,f.RDi)(document),document},deps:[]}]),Ms=new f.OlP(""),zi=[{provide:f.rWj,useClass:class Od{addToWindow(e){f.dqk.getAngularTestability=(r,i=!0)=>{const a=e.findTestabilityInTree(r,i);if(null==a)throw new f.vHH(5103,!1);return a},f.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),f.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),f.dqk.frameworkStabilizers||(f.dqk.frameworkStabilizers=[]),f.dqk.frameworkStabilizers.push(r=>{const i=f.dqk.getAllAngularTestabilities();let a=i.length,l=!1;const h=function(_){l=l||_,a--,0==a&&r(l)};i.forEach(_=>{_.whenStable(h)})})}findTestabilityInTree(e,t,r){return null==t?null:e.getTestability(t)??(r?F().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:f.lri,useClass:f.dDg,deps:[f.R0b,f.eoX,f.rWj]},{provide:f.dDg,useClass:f.dDg,deps:[f.R0b,f.eoX,f.rWj]}],ea=[{provide:f.zSh,useValue:"root"},{provide:f.qLn,useFactory:function Do(){return new f.qLn},deps:[]},{provide:Kl,useClass:Ou,multi:!0,deps:[he,f.R0b,f.Lbi]},{provide:Kl,useClass:bo,multi:!0,deps:[he]},Io,Pd,As,{provide:f.FYo,useExisting:Io},{provide:class ir{},useClass:Pf,deps:[]},[]];let Fu=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:f.AFp,useValue:t.appId}]}}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Ms,12))},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[...ea,...zi],imports:[jr,f.hGG]}),n})(),Jl=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(he))},n.\u0275prov=f.Yz7({token:n,factory:function(t){let r=null;return r=t?new t:function Ld(){return new Jl((0,f.LFG)(he))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;var Jr=k(5592),cs=k(4674),nn=k(2459),ct=k(2096),$r=k(5619);const{isArray:Ev}=Array,{getPrototypeOf:ju,prototype:Iv,keys:nc}=Object;function Hu(n){if(1===n.length){const e=n[0];if(Ev(e))return{args:e,keys:null};if(function za(n){return n&&"object"==typeof n&&ju(n)===Iv}(e)){const t=nc(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}var Os=k(2737),Tt=k(7398);const{isArray:$u}=Array;function Ao(n){return(0,Tt.U)(e=>function Ps(n,e){return $u(e)?n(...e):n(e)}(n,e))}var kr=k(4564);function qa(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}var Fr=k(8251),Gu=k(7103);function Wa(...n){const e=(0,kr.yG)(n),t=(0,kr.jO)(n),{args:r,keys:i}=Hu(n);if(0===r.length)return(0,nn.D)([],e);const a=new Jr.y(function Uf(n,e,t=Os.y){return r=>{ds(e,()=>{const{length:i}=n,a=new Array(i);let l=i,h=i;for(let _=0;_<i;_++)ds(e,()=>{const w=(0,nn.D)(n[_],e);let D=!1;w.subscribe((0,Fr.x)(r,A=>{a[_]=A,D||(D=!0,h--),h||r.next(t(a.slice()))},()=>{--l||r.complete()}))},r)},r)}}(r,e,i?l=>qa(i,l):Os.y));return t?a.pipe(Ao(t)):a}function ds(n,e,t){n?(0,Gu.f)(t,n,e):e()}const T=(0,k(2306).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var x=k(7537);function K(...n){return function V(){return(0,x.J)(1)}()((0,nn.D)(n,(0,kr.yG)(n)))}var ne=k(4829);function Me(n){return new Jr.y(e=>{(0,ne.Xf)(n()).subscribe(e)})}var et=k(8407);function st(n,e){const t=(0,cs.m)(n)?n:()=>n,r=i=>i.error(t());return new Jr.y(e?i=>e.schedule(r,0,i):r)}var ot=k(6232),Bt=k(7394),dt=k(9360);function sr(){return(0,dt.e)((n,e)=>{let t=null;n._refCount++;const r=(0,Fr.x)(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,a=t;t=null,i&&(!a||i===a)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class Dn extends Jr.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,dt.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Bt.w0;const t=this.getSubject();e.add(this.source.subscribe((0,Fr.x)(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Bt.w0.EMPTY)}return e}refCount(){return sr()(this)}}var qi=k(8645),Tn=k(4664);function Ti(n){return n<=0?()=>ot.E:(0,dt.e)((e,t)=>{let r=0;e.subscribe((0,Fr.x)(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function or(...n){const e=(0,kr.yG)(n);return(0,dt.e)((t,r)=>{(e?K(n,t,e):K(n,t)).subscribe(r)})}function ar(n,e){return(0,dt.e)((t,r)=>{let i=0;t.subscribe((0,Fr.x)(r,a=>n.call(e,a,i++)&&r.next(a)))})}var ur=k(1631);function zu(n){return(0,dt.e)((e,t)=>{let r=!1;e.subscribe((0,Fr.x)(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function mm(n=_m){return(0,dt.e)((e,t)=>{let r=!1;e.subscribe((0,Fr.x)(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function _m(){return new T}function hs(n,e){const t=arguments.length>=2;return r=>r.pipe(n?ar((i,a)=>n(i,a,r)):Os.y,Ti(1),t?zu(e):mm(()=>new T))}function eo(n,e){return(0,cs.m)(e)?(0,ur.z)(n,e,1):(0,ur.z)(n,1)}var _r=k(9397);function Wi(n){return(0,dt.e)((e,t)=>{let a,r=null,i=!1;r=e.subscribe((0,Fr.x)(t,void 0,void 0,l=>{a=(0,ne.Xf)(n(l,Wi(n)(e))),r?(r.unsubscribe(),r=null,a.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,a.subscribe(t))})}function ks(n,e){return(0,dt.e)(function ym(n,e,t,r,i){return(a,l)=>{let h=t,_=e,w=0;a.subscribe((0,Fr.x)(l,D=>{const A=w++;_=h?n(_,D,A):(h=!0,D),r&&l.next(_)},i&&(()=>{h&&l.next(_),l.complete()})))}}(n,e,arguments.length>=2,!0))}function na(n){return n<=0?()=>ot.E:(0,dt.e)((e,t)=>{let r=[];e.subscribe((0,Fr.x)(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function vm(n){return(0,dt.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const jt="primary",$d=Symbol("RouteTitle");class $I{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function rc(n){return new $I(n)}function wm(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let a=0;a<r.length;a++){const l=r[a],h=n[a];if(l.startsWith(":"))i[l.substring(1)]=h;else if(l!==h.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function to(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let a=0;a<t.length;a++)if(i=t[a],!Em(n[i],e[i]))return!1;return!0}function Em(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,a)=>r[a]===i)}return n===e}function yr(n){return n.length>0?n[n.length-1]:null}function ra(n){return function Bu(n){return!!n&&(n instanceof Jr.y||(0,cs.m)(n.lift)&&(0,cs.m)(n.subscribe))}(n)?n:(0,f.QGY)(n)?(0,nn.D)(Promise.resolve(n)):(0,ct.of)(n)}const Wu={exact:function Bf(n,e,t){if(!Ki(n.segments,e.segments)||!jf(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!Bf(n.children[r],e.children[r],t))return!1;return!0},subset:Ku},Im={exact:function ic(n,e){return to(n,e)},subset:function Zu(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Em(n[t],e[t]))},ignored:()=>!0};function Zi(n,e,t){return Wu[t.paths](n.root,e.root,t.matrixParams)&&Im[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function Ku(n,e,t){return Gd(n,e,e.segments,t)}function Gd(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!Ki(i,t)||e.hasChildren()||!jf(i,t,r))}if(n.segments.length===t.length){if(!Ki(n.segments,t)||!jf(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!Ku(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),a=t.slice(n.segments.length);return!!(Ki(n.segments,i)&&jf(n.segments,i,r)&&n.children[jt])&&Gd(n.children[jt],e,a,r)}}function jf(n,e,t){return e.every((r,i)=>Im[t](n[i].parameters,r.parameters))}class Za{constructor(e=new _n([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=rc(this.queryParams)),this._queryParamMap}toString(){return Dv.serialize(this)}}class _n{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return zd(this)}}class br{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=rc(this.parameters)),this._parameterMap}toString(){return Zd(this)}}function Ki(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}let Yu=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return new $f},providedIn:"root"}),n})();class $f{parse(e){const t=new Sv(e);return new Za(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${sc(e.root,!0)}`,r=function zf(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${qd(t)}=${qd(i)}`).join("&"):`${qd(t)}=${qd(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function Cm(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Dv=new $f;function zd(n){return n.segments.map(e=>Zd(e)).join("/")}function sc(n,e){if(!n.hasChildren())return zd(n);if(e){const t=n.children[jt]?sc(n.children[jt],!1):"",r=[];return Object.entries(n.children).forEach(([i,a])=>{i!==jt&&r.push(`${i}:${sc(a,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function bv(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===jt&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==jt&&(t=t.concat(e(i,r)))}),t}(n,(r,i)=>i===jt?[sc(n.children[jt],!1)]:[`${i}:${sc(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[jt]?`${zd(n)}/${t[0]}`:`${zd(n)}/(${t.join("//")})`}}function Gf(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function qd(n){return Gf(n).replace(/%3B/gi,";")}function fs(n){return Gf(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Wd(n){return decodeURIComponent(n)}function oc(n){return Wd(n.replace(/\+/g,"%20"))}function Zd(n){return`${fs(n.path)}${function Kd(n){return Object.keys(n).map(e=>`;${fs(e)}=${fs(n[e])}`).join("")}(n.parameters)}`}const bm=/^[^\/()?;#]+/;function ac(n){const e=n.match(bm);return e?e[0]:""}const Qu=/^[^\/()?;=#]+/,Tv=/^[^=?&#]+/,Xu=/^[^&#]+/;class Sv{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new _n([],{}):new _n([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[jt]=new _n(e,t)),r}parseSegment(){const e=ac(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new f.vHH(4009,!1);return this.capture(e),new br(Wd(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function Dm(n){const e=n.match(Qu);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=ac(this.remaining);i&&(r=i,this.capture(r))}e[Wd(t)]=Wd(r)}parseQueryParam(e){const t=function qf(n){const e=n.match(Tv);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const l=function uc(n){const e=n.match(Xu);return e?e[0]:""}(this.remaining);l&&(r=l,this.capture(r))}const i=oc(t),a=oc(r);if(e.hasOwnProperty(i)){let l=e[i];Array.isArray(l)||(l=[l],e[i]=l),l.push(a)}else e[i]=a}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=ac(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new f.vHH(4010,!1);let a;r.indexOf(":")>-1?(a=r.slice(0,r.indexOf(":")),this.capture(a),this.capture(":")):e&&(a=jt);const l=this.parseChildren();t[a]=1===Object.keys(l).length?l[jt]:new _n([],l),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new f.vHH(4011,!1)}}function Av(n){return n.segments.length>0?new _n([],{[jt]:n}):n}function Wf(n){const e={};for(const r of Object.keys(n.children)){const a=Wf(n.children[r]);if(r===jt&&0===a.segments.length&&a.hasChildren())for(const[l,h]of Object.entries(a.children))e[l]=h;else(a.segments.length>0||a.hasChildren())&&(e[r]=a)}return function Tm(n){if(1===n.numberOfChildren&&n.children[jt]){const e=n.children[jt];return new _n(n.segments.concat(e.segments),e.children)}return n}(new _n(n.segments,e))}function ia(n){return n instanceof Za}function Sm(n){let e;const i=Av(function t(a){const l={};for(const _ of a.children){const w=t(_);l[_.outlet]=w}const h=new _n(a.url,l);return a===n&&(e=h),h}(n.root));return e??i}function Yd(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(0===e.length)return Zf(i,i,i,t,r);const a=function Am(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new xv(!0,0,n);let e=0,t=!1;const r=n.reduce((i,a,l)=>{if("object"==typeof a&&null!=a){if(a.outlets){const h={};return Object.entries(a.outlets).forEach(([_,w])=>{h[_]="string"==typeof w?w.split("/"):w}),[...i,{outlets:h}]}if(a.segmentPath)return[...i,a.segmentPath]}return"string"!=typeof a?[...i,a]:0===l?(a.split("/").forEach((h,_)=>{0==_&&"."===h||(0==_&&""===h?t=!0:".."===h?e++:""!=h&&i.push(h))}),i):[...i,a]},[]);return new xv(t,e,r)}(e);if(a.toRoot())return Zf(i,i,new _n([],{}),t,r);const l=function Mm(n,e,t){if(n.isAbsolute)return new Kf(e,!0,0);if(!t)return new Kf(e,!1,NaN);if(null===t.parent)return new Kf(t,!0,0);const r=Mo(n.commands[0])?0:1;return function Rv(n,e,t){let r=n,i=e,a=t;for(;a>i;){if(a-=i,r=r.parent,!r)throw new f.vHH(4005,!1);i=r.segments.length}return new Kf(r,!1,i-a)}(t,t.segments.length-1+r,n.numberOfDoubleDots)}(a,i,n),h=l.processChildren?Qd(l.segmentGroup,l.index,a.commands):Nv(l.segmentGroup,l.index,a.commands);return Zf(i,l.segmentGroup,h,t,r)}function Mo(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Ju(n){return"object"==typeof n&&null!=n&&n.outlets}function Zf(n,e,t,r,i){let l,a={};r&&Object.entries(r).forEach(([_,w])=>{a[_]=Array.isArray(w)?w.map(D=>`${D}`):`${w}`}),l=n===e?t:el(n,e,t);const h=Av(Wf(l));return new Za(h,a,i)}function el(n,e,t){const r={};return Object.entries(n.children).forEach(([i,a])=>{r[i]=a===e?t:el(a,e,t)}),new _n(n.segments,r)}class xv{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Mo(r[0]))throw new f.vHH(4003,!1);const i=r.find(Ju);if(i&&i!==yr(r))throw new f.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Kf{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function Nv(n,e,t){if(n||(n=new _n([],{})),0===n.segments.length&&n.hasChildren())return Qd(n,e,t);const r=function Ka(n,e,t){let r=0,i=e;const a={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return a;const l=n.segments[i],h=t[r];if(Ju(h))break;const _=`${h}`,w=r<t.length-1?t[r+1]:null;if(i>0&&void 0===_)break;if(_&&w&&"object"==typeof w&&void 0===w.outlets){if(!kv(_,w,l))return a;r+=2}else{if(!kv(_,{},l))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const a=new _n(n.segments.slice(0,r.pathIndex),{});return a.children[jt]=new _n(n.segments.slice(r.pathIndex),n.children),Qd(a,0,i)}return r.match&&0===i.length?new _n(n.segments,{}):r.match&&!n.hasChildren()?xm(n,e,t):r.match?Qd(n,0,i):xm(n,e,t)}function Qd(n,e,t){if(0===t.length)return new _n(n.segments,{});{const r=function Yf(n){return Ju(n[0])?n[0].outlets:{[jt]:n}}(t),i={};if(!r[jt]&&n.children[jt]&&1===n.numberOfChildren&&0===n.children[jt].segments.length){const a=Qd(n.children[jt],e,t);return new _n(n.segments,a.children)}return Object.entries(r).forEach(([a,l])=>{"string"==typeof l&&(l=[l]),null!==l&&(i[a]=Nv(n.children[a],e,l))}),Object.entries(n.children).forEach(([a,l])=>{void 0===r[a]&&(i[a]=l)}),new _n(n.segments,i)}}function xm(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const a=t[i];if(Ju(a)){const _=Ov(a.outlets);return new _n(r,_)}if(0===i&&Mo(t[0])){r.push(new br(n.segments[e].path,Pv(t[0]))),i++;continue}const l=Ju(a)?a.outlets[jt]:`${a}`,h=i<t.length-1?t[i+1]:null;l&&h&&Mo(h)?(r.push(new br(l,Pv(h))),i+=2):(r.push(new br(l,{})),i++)}return new _n(r,{})}function Ov(n){const e={};return Object.entries(n).forEach(([t,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(e[t]=xm(new _n([],{}),0,r))}),e}function Pv(n){const e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function kv(n,e,t){return n==t.path&&to(e,t.parameters)}const Xd="imperative";class no{constructor(e,t){this.id=e,this.url=t}}class Ya extends no{constructor(e,t,r="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ps extends no{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Qa extends no{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Xa extends no{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=16}}class Jd extends no{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class sa extends no{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Rm extends no{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Si extends no{constructor(e,t,r,i,a){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=a,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class oa extends no{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class lc extends no{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class eh{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Qf{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Xf{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Fv{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Jf{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ep{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class xo{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Vv{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new tl,this.attachRef=null}}let tl=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){const i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){const r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Vv,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Nm{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=th(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=th(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=mn(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return mn(e,this._root).map(t=>t.value)}}function th(n,e){if(n===e.value)return e;for(const t of e.children){const r=th(n,t);if(r)return r}return null}function mn(n,e){if(n===e.value)return[e];for(const t of e.children){const r=mn(n,t);if(r.length)return r.unshift(e),r}return[]}class Yi{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Ro(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class nh extends Nm{constructor(e,t){super(e),this.snapshot=t,ih(this,e)}toString(){return this.snapshot.toString()}}function Nn(n,e){const t=function No(n,e){const l=new Ja([],{},{},"",{},jt,e,null,{});return new Om("",new Yi(l,[]))}(0,e),r=new $r.X([new br("",{})]),i=new $r.X({}),a=new $r.X({}),l=new $r.X({}),h=new $r.X(""),_=new Oo(r,i,l,h,a,jt,e,t.root);return _.snapshot=t.root,new nh(new Yi(_,[]),t)}class Oo{constructor(e,t,r,i,a,l,h,_){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=a,this.outlet=l,this.component=h,this._futureSnapshot=_,this.title=this.dataSubject?.pipe((0,Tt.U)(w=>w[$d]))??(0,ct.of)(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Tt.U)(e=>rc(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Tt.U)(e=>rc(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function rh(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],a=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function Uv(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class Ja{get title(){return this.data?.[$d]}constructor(e,t,r,i,a,l,h,_,w){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=h,this.routeConfig=_,this._resolve=w}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=rc(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=rc(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Om extends Nm{constructor(e,t){super(t),this.url=e,ih(this,t)}toString(){return Pm(this._root)}}function ih(n,e){e.value._routerState=n,e.children.forEach(t=>ih(n,t))}function Pm(n){const e=n.children.length>0?` { ${n.children.map(Pm).join(", ")} } `:"";return`${n.value}${e}`}function sh(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,to(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),to(e.params,t.params)||n.paramsSubject.next(t.params),function qu(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!to(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),to(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function v(n,e){const t=to(n.params,e.params)&&function Hf(n,e){return Ki(n,e)&&n.every((t,r)=>to(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||v(n.parent,e.parent))}let p=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=jt,this.activateEvents=new f.vpe,this.deactivateEvents=new f.vpe,this.attachEvents=new f.vpe,this.detachEvents=new f.vpe,this.parentContexts=(0,f.f3M)(tl),this.location=(0,f.f3M)(f.s_b),this.changeDetector=(0,f.f3M)(f.sBO),this.environmentInjector=(0,f.f3M)(f.lqb),this.inputBinder=(0,f.f3M)(E,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new f.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new f.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new f.vHH(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new f.vHH(4013,!1);this._activatedRoute=t;const i=this.location,l=t.snapshot.component,h=this.parentContexts.getOrCreateContext(this.name).children,_=new m(t,h,i.injector);this.activated=i.createComponent(l,{index:i.length,injector:_,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=f.lG2({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[f.TTD]}),n})();class m{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Oo?this.route:e===tl?this.childContexts:this.parent.get(e,t)}}const E=new f.OlP("");let M=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:r}=t,i=Wa([r.queryParams,r.params,r.data]).pipe((0,Tn.w)(([a,l,h],_)=>(h={...a,...l,...h},0===_?(0,ct.of)(h):Promise.resolve(h)))).subscribe(a=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(t);const l=(0,f.qFp)(r.component);if(l)for(const{templateName:h}of l.inputs)t.activatedComponentRef.setInput(h,a[h]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();function q(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function ge(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return q(n,r,i);return q(n,r)})}(n,e,t);return new Yi(r,i)}{if(n.shouldAttach(e.value)){const a=n.retrieve(e.value);if(null!==a){const l=a.route;return l.value._futureSnapshot=e.value,l.children=e.children.map(h=>q(n,h)),l}}const r=function Be(n){return new Oo(new $r.X(n.url),new $r.X(n.params),new $r.X(n.queryParams),new $r.X(n.fragment),new $r.X(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(a=>q(n,a));return new Yi(r,i)}}const Qe="ngNavigationCancelingError";function bt(n,e){const{redirectTo:t,navigationBehaviorOptions:r}=ia(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=ft(!1,0,e);return i.url=t,i.navigationBehaviorOptions=r,i}function ft(n,e,t){const r=new Error("NavigationCancelingError: "+(n||""));return r[Qe]=!0,r.cancellationCode=e,t&&(r.url=t),r}function $n(n){return Qi(n)&&ia(n.url)}function Qi(n){return n&&n[Qe]}let eu=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=f.Xpm({type:n,selectors:[["ng-component"]],standalone:!0,features:[f.jDz],decls:1,vars:0,template:function(t,r){1&t&&f._UZ(0,"router-outlet")},dependencies:[p],encapsulation:2}),n})();function uh(n){const e=n.children&&n.children.map(uh),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==jt&&(t.component=eu),t}function pi(n){return n.outlet||jt}function tp(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class dc{constructor(e,t,r,i,a){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=a}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),sh(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=Ro(t);e.children.forEach(a=>{const l=a.value.outlet;this.deactivateRoutes(a,i[l],r),delete i[l]}),Object.values(i).forEach(a=>{this.deactivateRouteAndItsChildren(a,r)})}deactivateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(i===a)if(i.component){const l=r.getContext(i.outlet);l&&this.deactivateChildRoutes(e,t,l.children)}else this.deactivateChildRoutes(e,t,r);else a&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=Ro(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);if(r&&r.outlet){const l=r.outlet.detach(),h=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:l,route:e,contexts:h})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=Ro(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){const i=Ro(t);e.children.forEach(a=>{this.activateRoutes(a,i[a.value.outlet],r),this.forwardEvent(new ep(a.value.snapshot))}),e.children.length&&this.forwardEvent(new Fv(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(sh(i),i===a)if(i.component){const l=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,l.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const l=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const h=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),l.children.onOutletReAttached(h.contexts),l.attachRef=h.componentRef,l.route=h.route.value,l.outlet&&l.outlet.attach(h.componentRef,h.route.value),sh(h.route.value),this.activateChildRoutes(e,null,l.children)}else{const h=tp(i.snapshot);l.attachRef=null,l.route=i,l.injector=h,l.outlet&&l.outlet.activateWith(i,l.injector),this.activateChildRoutes(e,null,l.children)}}else this.activateChildRoutes(e,null,r)}}class Gv{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class np{constructor(e,t){this.component=e,this.route=t}}function YS(n,e,t){const r=n._root;return rp(r,e?e._root:null,t,[r.value])}function tu(n,e){const t=Symbol(),r=e.get(n,t);return r===t?"function"!=typeof n||(0,f.Z0I)(n)?e.get(n):n:r}function rp(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=Ro(e);return n.children.forEach(l=>{(function qI(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=n.value,l=e?e.value:null,h=t?t.getContext(n.value.outlet):null;if(l&&a.routeConfig===l.routeConfig){const _=function WI(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Ki(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Ki(n.url,e.url)||!to(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!v(n,e)||!to(n.queryParams,e.queryParams);default:return!v(n,e)}}(l,a,a.routeConfig.runGuardsAndResolvers);_?i.canActivateChecks.push(new Gv(r)):(a.data=l.data,a._resolvedData=l._resolvedData),rp(n,e,a.component?h?h.children:null:t,r,i),_&&h&&h.outlet&&h.outlet.isActivated&&i.canDeactivateChecks.push(new np(h.outlet.component,l))}else l&&lh(e,h,i),i.canActivateChecks.push(new Gv(r)),rp(n,null,a.component?h?h.children:null:t,r,i)})(l,a[l.value.outlet],t,r.concat([l.value]),i),delete a[l.value.outlet]}),Object.entries(a).forEach(([l,h])=>lh(h,t.getContext(l),i)),i}function lh(n,e,t){const r=Ro(n),i=n.value;Object.entries(r).forEach(([a,l])=>{lh(l,i.component?e?e.children.getContext(a):null:e,t)}),t.canDeactivateChecks.push(new np(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function hc(n){return"function"==typeof n}function ch(n){return n instanceof T||"EmptyError"===n?.name}const Bm=Symbol("INITIAL_VALUE");function fc(){return(0,Tn.w)(n=>Wa(n.map(e=>e.pipe(Ti(1),or(Bm)))).pipe((0,Tt.U)(e=>{for(const t of e)if(!0!==t){if(t===Bm)return Bm;if(!1===t||t instanceof Za)return t}return!0}),ar(e=>e!==Bm),Ti(1)))}function XI(n){return(0,et.z)((0,_r.b)(e=>{if(ia(e))throw bt(0,e)}),(0,Tt.U)(e=>!0===e))}class Hm{constructor(e){this.segmentGroup=e||null}}class $m{constructor(e){this.urlTree=e}}function hh(n){return st(new Hm(n))}function fh(n){return st(new $m(n))}class JI{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new f.vHH(4002,!1)}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return(0,ct.of)(r);if(i.numberOfChildren>1||!i.children[jt])return st(new f.vHH(4e3,!1));i=i.children[jt]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreateUrlTree(e,t,r,i){const a=this.createSegmentGroup(e,t.root,r,i);return new Za(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return Object.entries(e).forEach(([i,a])=>{if("string"==typeof a&&a.startsWith(":")){const h=a.substring(1);r[i]=t[h]}else r[i]=a}),r}createSegmentGroup(e,t,r,i){const a=this.createSegments(e,t.segments,r,i);let l={};return Object.entries(t.children).forEach(([h,_])=>{l[h]=this.createSegmentGroup(e,_,r,i)}),new _n(a,l)}createSegments(e,t,r,i){return t.map(a=>a.path.startsWith(":")?this.findPosParam(e,a,i):this.findOrReturn(a,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new f.vHH(4001,!1);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}const zm={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function eC(n,e,t,r,i){const a=qm(n,e,t);return a.matched?(r=function cc(n,e){return n.providers&&!n._injector&&(n._injector=(0,f.MMx)(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,r),function oP(n,e,t,r){const i=e.canMatch;if(!i||0===i.length)return(0,ct.of)(!0);const a=i.map(l=>{const h=tu(l,n);return ra(function Um(n){return n&&hc(n.canMatch)}(h)?h.canMatch(e,t):n.runInContext(()=>h(e,t)))});return(0,ct.of)(a).pipe(fc(),XI())}(r,e,t).pipe((0,Tt.U)(l=>!0===l?a:{...zm}))):(0,ct.of)(a)}function qm(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...zm}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||wm)(t,n,e);if(!i)return{...zm};const a={};Object.entries(i.posParams??{}).forEach(([h,_])=>{a[h]=_.path});const l=i.consumed.length>0?{...a,...i.consumed[i.consumed.length-1].parameters}:a;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:l,positionalParamSegments:i.posParams??{}}}function tC(n,e,t,r){return t.length>0&&function iA(n,e,t){return t.some(r=>Po(n,e,r)&&pi(r)!==jt)}(n,t,r)?{segmentGroup:new _n(e,rA(r,new _n(t,n.children))),slicedSegments:[]}:0===t.length&&function sA(n,e,t){return t.some(r=>Po(n,e,r))}(n,t,r)?{segmentGroup:new _n(n.segments,nA(n,0,t,r,n.children)),slicedSegments:t}:{segmentGroup:new _n(n.segments,n.children),slicedSegments:t}}function nA(n,e,t,r,i){const a={};for(const l of r)if(Po(n,t,l)&&!i[pi(l)]){const h=new _n([],{});a[pi(l)]=h}return{...i,...a}}function rA(n,e){const t={};t[jt]=e;for(const r of n)if(""===r.path&&pi(r)!==jt){const i=new _n([],{});t[pi(r)]=i}return t}function Po(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class uP{constructor(e,t,r,i,a,l,h){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=a,this.paramsInheritanceStrategy=l,this.urlSerializer=h,this.allowRedirects=!0,this.applyRedirects=new JI(this.urlSerializer,this.urlTree)}noMatchError(e){return new f.vHH(4002,!1)}recognize(){const e=tC(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,jt).pipe(Wi(t=>{if(t instanceof $m)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof Hm?this.noMatchError(t):t}),(0,Tt.U)(t=>{const r=new Ja([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},jt,this.rootComponentType,null,{}),i=new Yi(r,t),a=new Om("",i),l=function Mv(n,e,t=null,r=null){return Yd(Sm(n),e,t,r)}(r,[],this.urlTree.queryParams,this.urlTree.fragment);return l.queryParams=this.urlTree.queryParams,a.url=this.urlSerializer.serialize(l),this.inheritParamsAndData(a._root),{state:a,tree:l}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,jt).pipe(Wi(r=>{throw r instanceof Hm?this.noMatchError(r):r}))}inheritParamsAndData(e){const t=e.value,r=rh(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0)}processChildren(e,t,r){const i=[];for(const a of Object.keys(r.children))"primary"===a?i.unshift(a):i.push(a);return(0,nn.D)(i).pipe(eo(a=>{const l=r.children[a],h=function $v(n,e){const t=n.filter(r=>pi(r)===e);return t.push(...n.filter(r=>pi(r)!==e)),t}(t,a);return this.processSegmentGroup(e,h,l,a)}),ks((a,l)=>(a.push(...l),a)),zu(null),function HI(n,e){const t=arguments.length>=2;return r=>r.pipe(n?ar((i,a)=>n(i,a,r)):Os.y,na(1),t?zu(e):mm(()=>new T))}(),(0,ur.z)(a=>{if(null===a)return hh(r);const l=aA(a);return function lP(n){n.sort((e,t)=>e.value.outlet===jt?-1:t.value.outlet===jt?1:e.value.outlet.localeCompare(t.value.outlet))}(l),(0,ct.of)(l)}))}processSegment(e,t,r,i,a,l){return(0,nn.D)(t).pipe(eo(h=>this.processSegmentAgainstRoute(h._injector??e,t,h,r,i,a,l).pipe(Wi(_=>{if(_ instanceof Hm)return(0,ct.of)(null);throw _}))),hs(h=>!!h),Wi(h=>{if(ch(h))return function oA(n,e,t){return 0===e.length&&!n.children[t]}(r,i,a)?(0,ct.of)([]):hh(r);throw h}))}processSegmentAgainstRoute(e,t,r,i,a,l,h){return function sp(n,e,t,r){return!!(pi(n)===r||r!==jt&&Po(e,t,n))&&("**"===n.path||qm(e,n,t).matched)}(r,i,a,l)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,i,r,a,l,h):h&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,a,l):hh(i):hh(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,l):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const a=this.applyRedirects.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?fh(a):this.applyRedirects.lineralizeSegments(r,a).pipe((0,ur.z)(l=>{const h=new _n(l,{});return this.processSegment(e,t,h,l,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){const{matched:h,consumedSegments:_,remainingSegments:w,positionalParamSegments:D}=qm(t,i,a);if(!h)return hh(t);const A=this.applyRedirects.applyRedirectCommands(_,i.redirectTo,D);return i.redirectTo.startsWith("/")?fh(A):this.applyRedirects.lineralizeSegments(i,A).pipe((0,ur.z)(O=>this.processSegment(e,r,t,O.concat(w),l,!1)))}matchSegmentAgainstRoute(e,t,r,i,a,l){let h;if("**"===r.path){const _=i.length>0?yr(i).parameters:{},w=new Ja(i,_,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,nC(r),pi(r),r.component??r._loadedComponent??null,r,rC(r));h=(0,ct.of)({snapshot:w,consumedSegments:[],remainingSegments:[]}),t.children={}}else h=eC(t,r,i,e).pipe((0,Tt.U)(({matched:_,consumedSegments:w,remainingSegments:D,parameters:A})=>_?{snapshot:new Ja(w,A,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,nC(r),pi(r),r.component??r._loadedComponent??null,r,rC(r)),consumedSegments:w,remainingSegments:D}:null));return h.pipe((0,Tn.w)(_=>null===_?hh(t):this.getChildConfig(e=r._injector??e,r,i).pipe((0,Tn.w)(({routes:w})=>{const D=r._loadedInjector??e,{snapshot:A,consumedSegments:O,remainingSegments:H}=_,{segmentGroup:z,slicedSegments:ce}=tC(t,O,H,w);if(0===ce.length&&z.hasChildren())return this.processChildren(D,w,z).pipe((0,Tt.U)(ht=>null===ht?null:[new Yi(A,ht)]));if(0===w.length&&0===ce.length)return(0,ct.of)([new Yi(A,[])]);const Te=pi(r)===a;return this.processSegment(D,w,z,ce,Te?jt:a,!0).pipe((0,Tt.U)(ht=>[new Yi(A,ht)]))}))))}getChildConfig(e,t,r){return t.children?(0,ct.of)({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?(0,ct.of)({routes:t._loadedRoutes,injector:t._loadedInjector}):function tA(n,e,t,r){const i=e.canLoad;if(void 0===i||0===i.length)return(0,ct.of)(!0);const a=i.map(l=>{const h=tu(l,n);return ra(function Vm(n){return n&&hc(n.canLoad)}(h)?h.canLoad(e,t):n.runInContext(()=>h(e,t)))});return(0,ct.of)(a).pipe(fc(),XI())}(e,t,r).pipe((0,ur.z)(i=>i?this.configLoader.loadChildren(e,t).pipe((0,_r.b)(a=>{t._loadedRoutes=a.routes,t._loadedInjector=a.injector})):function Zv(n){return st(ft(!1,3))}())):(0,ct.of)({routes:[],injector:e})}}function cP(n){const e=n.value.routeConfig;return e&&""===e.path}function aA(n){const e=[],t=new Set;for(const r of n){if(!cP(r)){e.push(r);continue}const i=e.find(a=>r.value.routeConfig===a.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=aA(r.children);e.push(new Yi(r.value,i))}return e.filter(r=>!t.has(r))}function nC(n){return n.data||{}}function rC(n){return n.resolve||{}}function Yv(n){return"string"==typeof n.title||null===n.title}function Wm(n){return(0,Tn.w)(e=>{const t=n(e);return t?(0,nn.D)(t).pipe((0,Tt.U)(()=>e)):(0,ct.of)(e)})}const ap=new f.OlP("ROUTES");let sC=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,f.f3M)(f.Sil)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return(0,ct.of)(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=ra(t.loadComponent()).pipe((0,Tt.U)(Zm),(0,_r.b)(a=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=a}),vm(()=>{this.componentLoaders.delete(t)})),i=new Dn(r,()=>new qi.x).pipe(sr());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return(0,ct.of)({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const a=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe((0,Tt.U)(h=>{this.onLoadEndListener&&this.onLoadEndListener(r);let _,w;return Array.isArray(h)?w=h:(_=h.create(t).injector,w=_.get(ap,[],f.XFs.Self|f.XFs.Optional).flat()),{routes:w.map(uh),injector:_}}),vm(()=>{this.childrenLoaders.delete(r)})),l=new Dn(a,()=>new qi.x).pipe(sr());return this.childrenLoaders.set(r,l),l}loadModuleFactoryOrRoutes(t){return ra(t()).pipe((0,Tt.U)(Zm),(0,ur.z)(r=>r instanceof f.YKP||Array.isArray(r)?(0,ct.of)(r):(0,nn.D)(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Zm(n){return function dP(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let ph=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new qi.x,this.configLoader=(0,f.f3M)(sC),this.environmentInjector=(0,f.f3M)(f.lqb),this.urlSerializer=(0,f.f3M)(Yu),this.rootContexts=(0,f.f3M)(tl),this.inputBindingEnabled=null!==(0,f.f3M)(E,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,ct.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=i=>this.events.next(new Qf(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new eh(i))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:r})}setupNavigations(t){return this.transitions=new $r.X({id:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Xd,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ar(r=>0!==r.id),(0,Tt.U)(r=>({...r,extractedUrl:t.urlHandlingStrategy.extract(r.rawUrl)})),(0,Tn.w)(r=>{let i=!1,a=!1;return(0,ct.of)(r).pipe((0,_r.b)(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,Tn.w)(l=>{const h=t.browserUrlTree.toString(),_=!t.navigated||l.extractedUrl.toString()!==h||h!==t.currentUrlTree.toString();if(!_&&"reload"!==(l.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const D="";return this.events.next(new Xa(l.id,t.serializeUrl(r.rawUrl),D,0)),t.rawUrlTree=l.rawUrl,l.resolve(null),ot.E}if(t.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return dA(l.source)&&(t.browserUrlTree=l.extractedUrl),(0,ct.of)(l).pipe((0,Tn.w)(D=>{const A=this.transitions?.getValue();return this.events.next(new Ya(D.id,this.urlSerializer.serialize(D.extractedUrl),D.source,D.restoredState)),A!==this.transitions?.getValue()?ot.E:Promise.resolve(D)}),function lA(n,e,t,r,i,a){return(0,ur.z)(l=>function aP(n,e,t,r,i,a,l="emptyOnly"){return new uP(n,e,t,r,i,l,a).recognize()}(n,e,t,r,l.extractedUrl,i,a).pipe((0,Tt.U)(({state:h,tree:_})=>({...l,targetSnapshot:h,urlAfterRedirects:_}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),(0,_r.b)(D=>{if(r.targetSnapshot=D.targetSnapshot,r.urlAfterRedirects=D.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:D.urlAfterRedirects},"eager"===t.urlUpdateStrategy){if(!D.extras.skipLocationChange){const O=t.urlHandlingStrategy.merge(D.urlAfterRedirects,D.rawUrl);t.setBrowserUrl(O,D)}t.browserUrlTree=D.urlAfterRedirects}const A=new sa(D.id,this.urlSerializer.serialize(D.extractedUrl),this.urlSerializer.serialize(D.urlAfterRedirects),D.targetSnapshot);this.events.next(A)}));if(_&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:D,extractedUrl:A,source:O,restoredState:H,extras:z}=l,ce=new Ya(D,this.urlSerializer.serialize(A),O,H);this.events.next(ce);const Te=Nn(0,this.rootComponentType).snapshot;return r={...l,targetSnapshot:Te,urlAfterRedirects:A,extras:{...z,skipLocationChange:!1,replaceUrl:!1}},(0,ct.of)(r)}{const D="";return this.events.next(new Xa(l.id,t.serializeUrl(r.extractedUrl),D,1)),t.rawUrlTree=l.rawUrl,l.resolve(null),ot.E}}),(0,_r.b)(l=>{const h=new Rm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),(0,Tt.U)(l=>r={...l,guards:YS(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),function XS(n,e){return(0,ur.z)(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:a,canDeactivateChecks:l}}=t;return 0===l.length&&0===a.length?(0,ct.of)({...t,guardsResult:!0}):function JS(n,e,t,r){return(0,nn.D)(n).pipe((0,ur.z)(i=>function dh(n,e,t,r,i){const a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!a||0===a.length)return(0,ct.of)(!0);const l=a.map(h=>{const _=tp(e)??i,w=tu(h,_);return ra(function zv(n){return n&&hc(n.canDeactivate)}(w)?w.canDeactivate(n,e,t,r):_.runInContext(()=>w(n,e,t,r))).pipe(hs())});return(0,ct.of)(l).pipe(fc())}(i.component,i.route,t,e,r)),hs(i=>!0!==i,!0))}(l,r,i,n).pipe((0,ur.z)(h=>h&&function ZI(n){return"boolean"==typeof n}(h)?function eA(n,e,t,r){return(0,nn.D)(e).pipe(eo(i=>K(function QI(n,e){return null!==n&&e&&e(new Xf(n)),(0,ct.of)(!0)}(i.route.parent,r),function YI(n,e){return null!==n&&e&&e(new Jf(n)),(0,ct.of)(!0)}(i.route,r),function Wv(n,e,t){const r=e[e.length-1],a=e.slice(0,e.length-1).reverse().map(l=>function sP(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(l)).filter(l=>null!==l).map(l=>Me(()=>{const h=l.guards.map(_=>{const w=tp(l.node)??t,D=tu(_,w);return ra(function KI(n){return n&&hc(n.canActivateChild)}(D)?D.canActivateChild(r,n):w.runInContext(()=>D(r,n))).pipe(hs())});return(0,ct.of)(h).pipe(fc())}));return(0,ct.of)(a).pipe(fc())}(n,i.path,t),function jm(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return(0,ct.of)(!0);const i=r.map(a=>Me(()=>{const l=tp(e)??t,h=tu(a,l);return ra(function ip(n){return n&&hc(n.canActivate)}(h)?h.canActivate(e,n):l.runInContext(()=>h(e,n))).pipe(hs())}));return(0,ct.of)(i).pipe(fc())}(n,i.route,t))),hs(i=>!0!==i,!0))}(r,a,n,e):(0,ct.of)(h)),(0,Tt.U)(h=>({...t,guardsResult:h})))})}(this.environmentInjector,l=>this.events.next(l)),(0,_r.b)(l=>{if(r.guardsResult=l.guardsResult,ia(l.guardsResult))throw bt(0,l.guardsResult);const h=new Si(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(h)}),ar(l=>!!l.guardsResult||(t.restoreHistory(l),this.cancelNavigationTransition(l,"",3),!1)),Wm(l=>{if(l.guards.canActivateChecks.length)return(0,ct.of)(l).pipe((0,_r.b)(h=>{const _=new oa(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(_)}),(0,Tn.w)(h=>{let _=!1;return(0,ct.of)(h).pipe(function cA(n,e){return(0,ur.z)(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return(0,ct.of)(t);let a=0;return(0,nn.D)(i).pipe(eo(l=>function Kv(n,e,t,r){const i=n.routeConfig,a=n._resolve;return void 0!==i?.title&&!Yv(i)&&(a[$d]=i.title),function nu(n,e,t,r){const i=function op(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===i.length)return(0,ct.of)({});const a={};return(0,nn.D)(i).pipe((0,ur.z)(l=>function iC(n,e,t,r){const i=tp(e)??r,a=tu(n,i);return ra(a.resolve?a.resolve(e,t):i.runInContext(()=>a(e,t)))}(n[l],e,t,r).pipe(hs(),(0,_r.b)(h=>{a[l]=h}))),na(1),function Cv(n){return(0,Tt.U)(()=>n)}(a),Wi(l=>ch(l)?ot.E:st(l)))}(a,n,e,r).pipe((0,Tt.U)(l=>(n._resolvedData=l,n.data=rh(n,t).resolve,i&&Yv(i)&&(n.data[$d]=i.title),null)))}(l.route,r,n,e)),(0,_r.b)(()=>a++),na(1),(0,ur.z)(l=>a===i.length?(0,ct.of)(t):ot.E))})}(t.paramsInheritanceStrategy,this.environmentInjector),(0,_r.b)({next:()=>_=!0,complete:()=>{_||(t.restoreHistory(h),this.cancelNavigationTransition(h,"",2))}}))}),(0,_r.b)(h=>{const _=new lc(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(_)}))}),Wm(l=>{const h=_=>{const w=[];_.routeConfig?.loadComponent&&!_.routeConfig._loadedComponent&&w.push(this.configLoader.loadComponent(_.routeConfig).pipe((0,_r.b)(D=>{_.component=D}),(0,Tt.U)(()=>{})));for(const D of _.children)w.push(...h(D));return w};return Wa(h(l.targetSnapshot.root)).pipe(zu(),Ti(1))}),Wm(()=>this.afterPreactivation()),(0,Tt.U)(l=>{const h=function N(n,e,t){const r=q(n,e._root,t?t._root:void 0);return new nh(r,e)}(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return r={...l,targetRouterState:h}}),(0,_r.b)(l=>{t.currentUrlTree=l.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(l.urlAfterRedirects,l.rawUrl),t.routerState=l.targetRouterState,"deferred"===t.urlUpdateStrategy&&(l.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,l),t.browserUrlTree=l.urlAfterRedirects)}),((n,e,t,r)=>(0,Tt.U)(i=>(new dc(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)))(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Ti(1),(0,_r.b)({next:l=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new ps(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{i=!0}}),vm(()=>{i||a||this.cancelNavigationTransition(r,"",1),this.currentNavigation?.id===r.id&&(this.currentNavigation=null)}),Wi(l=>{if(a=!0,Qi(l)){$n(l)||(t.navigated=!0,t.restoreHistory(r,!0));const h=new Qa(r.id,this.urlSerializer.serialize(r.extractedUrl),l.message,l.cancellationCode);if(this.events.next(h),$n(l)){const _=t.urlHandlingStrategy.merge(l.url,t.rawUrlTree),w={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||dA(r.source)};t.scheduleNavigation(_,Xd,null,w,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{t.restoreHistory(r,!0);const h=new Jd(r.id,this.urlSerializer.serialize(r.extractedUrl),l,r.targetSnapshot??void 0);this.events.next(h);try{r.resolve(t.errorHandler(l))}catch(_){r.reject(_)}}return ot.E}))}))}cancelNavigationTransition(t,r,i){const a=new Qa(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(a),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function dA(n){return n!==Xd}let hA=(()=>{class n{buildTitle(t){let r,i=t.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(a=>a.outlet===jt);return r}getResolvedTitleForRoute(t){return t.data[$d]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return(0,f.f3M)(oC)},providedIn:"root"}),n})(),oC=(()=>{class n extends hA{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Jl))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),fA=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return(0,f.f3M)(gA)},providedIn:"root"}),n})();class pA{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let gA=(()=>{class n extends pA{}return n.\u0275fac=function(){let e;return function(r){return(e||(e=f.n5z(n)))(r||n)}}(),n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Km=new f.OlP("",{providedIn:"root",factory:()=>({})});let aC=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return(0,f.f3M)(Ym)},providedIn:"root"}),n})(),Ym=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var up=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(up||{});function Qm(n,e){n.events.pipe(ar(t=>t instanceof ps||t instanceof Qa||t instanceof Jd||t instanceof Xa),(0,Tt.U)(t=>t instanceof ps||t instanceof Xa?up.COMPLETE:t instanceof Qa&&(0===t.code||1===t.code)?up.REDIRECTING:up.FAILED),ar(t=>t!==up.REDIRECTING),Ti(1)).subscribe(()=>{e()})}function mA(n){throw n}function gh(n,e,t){return e.parse("/")}const _A={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},yA={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Fs=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,f.f3M)(f.c2e),this.isNgZoneEnabled=!1,this.options=(0,f.f3M)(Km,{optional:!0})||{},this.pendingTasks=(0,f.f3M)(f.HDt),this.errorHandler=this.options.errorHandler||mA,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||gh,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,f.f3M)(aC),this.routeReuseStrategy=(0,f.f3M)(fA),this.titleStrategy=(0,f.f3M)(hA),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=(0,f.f3M)(ap,{optional:!0})?.flat()??[],this.navigationTransitions=(0,f.f3M)(ph),this.urlSerializer=(0,f.f3M)(Yu),this.location=(0,f.f3M)(He),this.componentInputBindingEnabled=!!(0,f.f3M)(E,{optional:!0}),this.isNgZoneEnabled=(0,f.f3M)(f.R0b)instanceof f.R0b&&f.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Za,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Nn(0,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId??0},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Xd,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,r,t.state)},0)}))}navigateToSyncWithBrowser(t,r,i){const a={replaceUrl:!0},l=i?.navigationId?i:null;if(i){const _={...i};delete _.navigationId,delete _.\u0275routerPageId,0!==Object.keys(_).length&&(a.state=_)}const h=this.parseUrl(t);this.scheduleNavigation(h,r,l,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(uh),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:i,queryParams:a,fragment:l,queryParamsHandling:h,preserveFragment:_}=r,w=_?this.currentUrlTree.fragment:l;let A,D=null;switch(h){case"merge":D={...this.currentUrlTree.queryParams,...a};break;case"preserve":D=this.currentUrlTree.queryParams;break;default:D=a||null}null!==D&&(D=this.removeEmptyProps(D));try{A=Sm(i?i.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),A=this.currentUrlTree.root}return Yd(A,t,D,w??null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=ia(t)?t:this.parseUrl(t),a=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(a,Xd,null,r)}navigate(t,r={skipLocationChange:!1}){return function uC(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new f.vHH(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?{..._A}:!1===r?{...yA}:r,ia(t))return Zi(this.currentUrlTree,t,i);const a=this.parseUrl(t);return Zi(this.currentUrlTree,a,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const a=t[i];return null!=a&&(r[i]=a),r},{})}scheduleNavigation(t,r,i,a,l){if(this.disposed)return Promise.resolve(!1);let h,_,w;l?(h=l.resolve,_=l.reject,w=l.promise):w=new Promise((A,O)=>{h=A,_=O});const D=this.pendingTasks.add();return Qm(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(D))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:a,resolve:h,reject:_,promise:w,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),w.catch(A=>Promise.reject(A))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){const l={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(i,"",l)}else{const a={...r.extras.state,...this.generateNgRouterState(r.id,(this.browserPageId??0)+1)};this.location.go(i,"",a)}}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const a=this.currentPageId-(this.browserPageId??this.currentPageId);0!==a?this.location.historyGo(a):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===a&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),pc=(()=>{class n{constructor(t,r,i,a,l,h){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=a,this.el=l,this.locationStrategy=h,this.href=null,this.commands=null,this.onChanges=new qi.x,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const _=l.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===_||"area"===_,this.isAnchorElement?this.subscription=t.events.subscribe(w=>{w instanceof ps&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,r,i,a,l){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||r||i||a||l||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:(0,f.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,r){const i=this.renderer,a=this.el.nativeElement;null!==r?i.setAttribute(a,t,r):i.removeAttribute(a,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Fs),f.Y36(Oo),f.$8M("tabindex"),f.Y36(f.Qsj),f.Y36(f.SBq),f.Y36(Fe))},n.\u0275dir=f.lG2({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,r){1&t&&f.NdJ("click",function(a){return r.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),2&t&&f.uIk("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",f.VuI],skipLocationChange:["skipLocationChange","skipLocationChange",f.VuI],replaceUrl:["replaceUrl","replaceUrl",f.VuI],routerLink:"routerLink"},standalone:!0,features:[f.Xq5,f.TTD]}),n})();class lC{}let hP=(()=>{class n{constructor(t,r,i,a,l){this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=l}setUpPreloading(){this.subscription=this.router.events.pipe(ar(t=>t instanceof ps),eo(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const a of r){a.providers&&!a._injector&&(a._injector=(0,f.MMx)(a.providers,t,`Route: ${a.path}`));const l=a._injector??t,h=a._loadedInjector??l;(a.loadChildren&&!a._loadedRoutes&&void 0===a.canLoad||a.loadComponent&&!a._loadedComponent)&&i.push(this.preloadConfig(l,a)),(a.children||a._loadedRoutes)&&i.push(this.processRoutes(h,a.children??a._loadedRoutes))}return(0,nn.D)(i).pipe((0,x.J)())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):(0,ct.of)(null);const a=i.pipe((0,ur.z)(l=>null===l?(0,ct.of)(void 0):(r._loadedRoutes=l.routes,r._loadedInjector=l.injector,this.processRoutes(l.injector??t,l.routes))));if(r.loadComponent&&!r._loadedComponent){const l=this.loader.loadComponent(r);return(0,nn.D)([a,l]).pipe((0,x.J)())}return a})}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Fs),f.LFG(f.Sil),f.LFG(f.lqb),f.LFG(lC),f.LFG(sC))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const gc=new f.OlP("");let gn=(()=>{class n{constructor(t,r,i,a,l={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=a,this.options=l,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},l.scrollPositionRestoration=l.scrollPositionRestoration||"disabled",l.anchorScrolling=l.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Ya?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof ps?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Xa&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof xo&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new xo(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){f.$Z()},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();function aa(n,e){return{\u0275kind:n,\u0275providers:e}}function Xv(){const n=(0,f.f3M)(f.zs3);return e=>{const t=n.get(f.z2F);if(e!==t.components[0])return;const r=n.get(Fs),i=n.get(Jm);1===n.get(dC)&&r.initialNavigation(),n.get(ew,null,f.XFs.Optional)?.setUpPreloading(),n.get(gc,null,f.XFs.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const Jm=new f.OlP("",{factory:()=>new qi.x}),dC=new f.OlP("",{providedIn:"root",factory:()=>1}),ew=new f.OlP("");function fC(n){return aa(0,[{provide:ew,useExisting:hP},{provide:lC,useExisting:n}])}const t_=new f.OlP("ROUTER_FORROOT_GUARD"),n_=[He,{provide:Yu,useClass:$f},Fs,tl,{provide:Oo,useFactory:function Qv(n){return n.routerState.root},deps:[Fs]},sC,[]];function mc(){return new f.PXZ("Router",Fs)}let r_=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[n_,[],{provide:ap,multi:!0,useValue:t},{provide:t_,useFactory:gC,deps:[[Fs,new f.FiY,new f.tp0]]},{provide:Km,useValue:r||{}},r?.useHash?{provide:Fe,useClass:Ne}:{provide:Fe,useClass:$e},{provide:gc,useFactory:()=>{const n=(0,f.f3M)(Oa),e=(0,f.f3M)(f.R0b),t=(0,f.f3M)(Km),r=(0,f.f3M)(ph),i=(0,f.f3M)(Yu);return t.scrollOffset&&n.setOffset(t.scrollOffset),new gn(i,r,n,e,t)}},r?.preloadingStrategy?fC(r.preloadingStrategy).\u0275providers:[],{provide:f.PXZ,multi:!0,useFactory:mc},r?.initialNavigation?_h(r):[],r?.bindToComponentInputs?aa(8,[M,{provide:E,useExisting:M}]).\u0275providers:[],[{provide:mC,useFactory:Xv},{provide:f.tb,multi:!0,useExisting:mC}]]}}static forChild(t){return{ngModule:n,providers:[{provide:ap,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(t_,8))},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})();function gC(n){return"guarded"}function _h(n){return["disabled"===n.initialNavigation?aa(3,[{provide:f.ip1,multi:!0,useFactory:()=>{const e=(0,f.f3M)(Fs);return()=>{e.setUpLocationChangeListener()}}},{provide:dC,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?aa(2,[{provide:dC,useValue:0},{provide:f.ip1,multi:!0,deps:[f.zs3],useFactory:e=>{const t=e.get(Ce,Promise.resolve());return()=>t.then(()=>new Promise(r=>{const i=e.get(Fs),a=e.get(Jm);Qm(i,()=>{r(!0)}),e.get(ph).afterPreactivation=()=>(r(!0),a.closed?(0,ct.of)(void 0):a),i.initialNavigation()}))}}]).\u0275providers:[]]}const mC=new f.OlP("");var vC=k(3019),nw=k(3093),xA=k(4552);class RA extends qi.x{constructor(e=1/0,t=1/0,r=xA.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:a,_windowTime:l}=this;t||(r.push(e),!i&&r.push(a.now()+l)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,a=i.slice();for(let l=0;l<a.length&&!e.closed;l+=r?1:2)e.next(a[l]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,a=(i?1:2)*e;if(e<1/0&&a<r.length&&r.splice(0,r.length-a),!i){const l=t.now();let h=0;for(let _=1;_<r.length&&r[_]<=l;_+=2)h=_;h&&r.splice(0,h+1)}}}var NA=k(3020);function OA(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=n??1/0,(0,NA.B)({connector:()=>new RA(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function lp(n,e){return(0,cs.m)(e)?(0,Tn.w)(()=>n,e):(0,Tn.w)(()=>n)}var rw=k(5137),dn=k(2994),Dr=k(6304);k(3182);var me=k(5861),gs=k(4303),ko=k(4537),P=k(9058),Ls=k(7879);const sw=new Map,ow={activated:!1,tokenObservers:[]},aw={initialized:!1,enabled:!1};function Lr(n){return sw.get(n)||Object.assign({},ow)}function cp(){return aw}const uw="https://content-firebaseappcheck.googleapis.com/v1",UA="exchangeDebugToken",dp={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class vh{constructor(e,t,r,i,a){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,me.Z)(function*(){t.stop();try{t.pending=new P.BH,yield function hp(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new P.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const Ai=new P.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function pp(){return(pp=(0,me.Z)(function*({url:n,body:e},t){const r={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){const A=yield i.getHeartbeatsHeader();A&&(r["X-Firebase-Client"]=A)}const a={method:"POST",body:JSON.stringify(e),headers:r};let l,h;try{l=yield fetch(n,a)}catch(A){throw Ai.create("fetch-network-error",{originalErrorMessage:A?.message})}if(200!==l.status)throw Ai.create("fetch-status-error",{httpStatus:l.status});try{h=yield l.json()}catch(A){throw Ai.create("fetch-parse-error",{originalErrorMessage:A?.message})}const _=h.ttl.match(/^([\d.]+)(s)$/);if(!_||!_[2]||isNaN(Number(_[1])))throw Ai.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});const w=1e3*Number(_[1]),D=Date.now();return{token:h.token,expireTimeMillis:D+w,issuedAtTimeMillis:D}})).apply(this,arguments)}const cw="firebase-app-check-database",wh=1,nl="firebase-app-check-store";let mp=null;function l_(){return(l_=(0,me.Z)(function*(n,e){const r=(yield function TC(){return mp||(mp=new Promise((n,e)=>{try{const t=indexedDB.open(cw,wh);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(Ai.create("storage-open",{originalErrorMessage:null===(i=r.target.error)||void 0===i?void 0:i.message}))},t.onupgradeneeded=r=>{0===r.oldVersion&&r.target.result.createObjectStore(nl,{keyPath:"compositeKey"})}}catch(t){e(Ai.create("storage-open",{originalErrorMessage:t?.message}))}}),mp)}()).transaction(nl,"readwrite"),a=r.objectStore(nl).put({compositeKey:n,value:e});return new Promise((l,h)=>{a.onsuccess=_=>{l()},r.onerror=_=>{var w;h(Ai.create("storage-set",{originalErrorMessage:null===(w=_.target.error)||void 0===w?void 0:w.message}))}})})).apply(this,arguments)}const c_=new Ls.Yd("@firebase/app-check");function MC(n,e){return(0,P.hl)()?function $A(n,e){return function SC(n,e){return l_.apply(this,arguments)}(function hw(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{c_.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Eh(){return(Eh=(0,me.Z)(function*(){const n=cp();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const NC={error:"UNKNOWN_ERROR"};function OC(n){return P.US.encodeString(JSON.stringify(n),!1)}function Ot(n){return h_.apply(this,arguments)}function h_(){return(h_=(0,me.Z)(function*(n,e=!1){const t=n.app;!function bC(n){if(!Lr(n).activated)throw Ai.create("use-before-activation",{appName:n.name})}(t);const r=Lr(t);let a,i=r.token;if(i&&!Ih(i)&&(r.token=void 0,i=void 0),!i){const _=yield r.cachedTokenPromise;_&&(Ih(_)?i=_:yield MC(t,void 0))}if(!e&&i&&Ih(i))return{token:i.token};let h,l=!1;if(function WA(){return cp().enabled}()){r.exchangeTokenPromise||(r.exchangeTokenPromise=function u_(n,e){return pp.apply(this,arguments)}(function CP(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${uw}/projects/${t}/apps/${r}:${UA}?key=${i}`,body:{debug_token:e}}}(t,yield function fw(){return Eh.apply(this,arguments)}()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),l=!0);const _=yield r.exchangeTokenPromise;return yield MC(t,_),r.token=_,{token:_.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),l=!0),i=yield Lr(t).exchangeTokenPromise}catch(_){"appCheck/throttled"===_.code?c_.warn(_.message):c_.error(_),a=_}return i?a?h=Ih(i)?{token:i.token,internalError:a}:pw(a):(h={token:i.token},r.token=i,yield MC(t,i)):h=pw(a),l&&function LC(n,e){const t=Lr(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch{}}(t,h),h})).apply(this,arguments)}function PC(n,e){const t=Lr(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function kC(n){const{app:e}=n,t=Lr(e);let r=t.tokenRefresher;r||(r=function FC(n){const{app:e}=n;return new vh((0,me.Z)(function*(){let r;if(r=Lr(e).token?yield Ot(n,!0):yield Ot(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const t=Lr(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},dp.RETRIAL_MIN_WAIT,dp.RETRIAL_MAX_WAIT)}(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function Ih(n){return n.expireTimeMillis-Date.now()>0}function pw(n){return{token:OC(NC),error:n}}class ZA{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=Lr(this.app);for(const t of e)PC(this.app,t.next);return Promise.resolve()}}const $C="app-check-internal";!function GC(){(0,gs._registerComponent)(new ko.wA("app-check",n=>function VC(n,e){return new ZA(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider($C).initialize()})),(0,gs._registerComponent)(new ko.wA($C,n=>function KA(n){return{getToken:e=>Ot(n,e),addTokenListener:e=>function f_(n,e,t,r){const{app:i}=n,a=Lr(i);if(a.tokenObservers=[...a.tokenObservers,{next:t,error:r,type:e}],a.token&&Ih(a.token)){const h=a.token;Promise.resolve().then(()=>{t({token:h.token}),kC(n)}).catch(()=>{})}a.cachedTokenPromise.then(()=>kC(n))}(n,"INTERNAL",e),removeTokenListener:e=>PC(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,gs.registerVersion)("@firebase/app-check","0.6.1")}();class wp{constructor(){return(0,dn.vb)("app-check")}}typeof window<"u"&&window;var y_=k(7142);const Ew=new f.OlP("angularfire2.auth.use-emulator"),io=new f.OlP("angularfire2.auth.settings"),Ep=new f.OlP("angularfire2.auth.tenant-id"),Iw=new f.OlP("angularfire2.auth.langugage-code"),v_=new f.OlP("angularfire2.auth.use-device-language"),Cw=new f.OlP("angularfire.auth.persistence"),w_=(n,e,t,r,i,a,l,h)=>(0,Dr.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const _=e.runOutsideAngular(()=>n.auth());if(t&&_.useEmulator(...t),r&&(_.tenantId=r),_.languageCode=i,a&&_.useDeviceLanguage(),l)for(const[w,D]of Object.entries(l))_.settings[w]=D;return h&&_.setPersistence(h),_},[t,r,i,a,l,h]);let wc=(()=>{class n{constructor(t,r,i,a,l,h,_,w,D,A,O,H){const z=new qi.x,ce=(0,ct.of)(void 0).pipe((0,nw.Q)(l.outsideAngular),(0,Tn.w)(()=>a.runOutsideAngular(()=>Promise.resolve().then(k.bind(k,8443)))),(0,Tt.U)(()=>(0,Dr.on)(t,a,r)),(0,Tt.U)(Te=>w_(Te,a,h,w,D,A,_,O)),OA({bufferSize:1,refCount:!1}));if(rr(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,ct.of)(null);else{ce.pipe(hs()).subscribe();const ht=ce.pipe((0,Tn.w)(at=>at.getRedirectResult().then(Dt=>Dt,()=>null)),dn.iC,OA({bufferSize:1,refCount:!1})),yt=ce.pipe((0,Tn.w)(at=>new Jr.y(Dt=>({unsubscribe:a.runOutsideAngular(()=>at.onAuthStateChanged(Lt=>Dt.next(Lt),Lt=>Dt.error(Lt),()=>Dt.complete()))})))),nt=ce.pipe((0,Tn.w)(at=>new Jr.y(Dt=>({unsubscribe:a.runOutsideAngular(()=>at.onIdTokenChanged(Lt=>Dt.next(Lt),Lt=>Dt.error(Lt),()=>Dt.complete()))}))));this.authState=ht.pipe(lp(yt),(0,rw.R)(l.outsideAngular),(0,nw.Q)(l.insideAngular)),this.user=ht.pipe(lp(nt),(0,rw.R)(l.outsideAngular),(0,nw.Q)(l.insideAngular)),this.idToken=this.user.pipe((0,Tn.w)(at=>at?(0,nn.D)(at.getIdToken()):(0,ct.of)(null))),this.idTokenResult=this.user.pipe((0,Tn.w)(at=>at?(0,nn.D)(at.getIdTokenResult()):(0,ct.of)(null))),this.credential=(0,vC.T)(ht,z,this.authState.pipe(ar(at=>!at))).pipe((0,Tt.U)(at=>at?.user?at:null),(0,rw.R)(l.outsideAngular),(0,nw.Q)(l.insideAngular))}return(0,Dr.pX)(this,ce,a,{spy:{apply:(Te,ht,yt)=>{(Te.startsWith("signIn")||Te.startsWith("createUser"))&&yt.then(nt=>z.next(nt))}}})}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Dr.Dh),f.LFG(Dr.xv,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(dn.HU),f.LFG(Ew,8),f.LFG(io,8),f.LFG(Ep,8),f.LFG(Iw,8),f.LFG(v_,8),f.LFG(Cw,8),f.LFG(wp,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),E_=(()=>{class n{constructor(){y_.Z.registerVersion("angularfire",dn.q4.full,"auth-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[wc]}),n})(),nM=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.Qsj),f.Y36(f.SBq))},n.\u0275dir=f.lG2({type:n}),n})(),sl=(()=>{class n extends nM{}return n.\u0275fac=function(){let e;return function(r){return(e||(e=f.n5z(n)))(r||n)}}(),n.\u0275dir=f.lG2({type:n,features:[f.qOj]}),n})();const Lo=new f.OlP("NgValueAccessor"),Tw={provide:Lo,useExisting:(0,f.Gpc)(()=>Ec),multi:!0},rM=new f.OlP("CompositionEventMode");let Ec=(()=>{class n extends nM{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function ru(){const n=F()?F().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.Qsj),f.Y36(f.SBq),f.Y36(rM,8))},n.\u0275dir=f.lG2({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,r){1&t&&f.NdJ("input",function(a){return r._handleInput(a.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(a){return r._compositionEnd(a.target.value)})},features:[f._Bn([Tw]),f.qOj]}),n})();const Mi=new f.OlP("NgValidators"),ol=new f.OlP("NgAsyncValidators");function JC(n){return null!=n}function Mw(n){return(0,f.QGY)(n)?(0,nn.D)(n):n}function xw(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function Dh(n,e){return e.map(t=>t(n))}function Rw(n){return n.map(e=>function oM(n){return!n.validate}(e)?e:t=>e.validate(t))}function Ow(n){return null!=n?function Nw(n){if(!n)return null;const e=n.filter(JC);return 0==e.length?null:function(t){return xw(Dh(t,e))}}(Rw(n)):null}function Ic(n){return null!=n?function eb(n){if(!n)return null;const e=n.filter(JC);return 0==e.length?null:function(t){return function bw(...n){const e=(0,kr.jO)(n),{args:t,keys:r}=Hu(n),i=new Jr.y(a=>{const{length:l}=t;if(!l)return void a.complete();const h=new Array(l);let _=l,w=l;for(let D=0;D<l;D++){let A=!1;(0,ne.Xf)(t[D]).subscribe((0,Fr.x)(a,O=>{A||(A=!0,w--),h[D]=O},()=>_--,void 0,()=>{(!_||!A)&&(w||a.next(r?qa(r,h):h),a.complete())}))}});return e?i.pipe(Ao(e)):i}(Dh(t,e).map(Mw)).pipe((0,Tt.U)(xw))}}(Rw(n)):null}function tb(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Pw(n){return n?Array.isArray(n)?n:[n]:[]}function C_(n,e){return Array.isArray(n)?n.includes(e):n===e}function ib(n,e){const t=Pw(e);return Pw(n).forEach(i=>{C_(t,i)||t.push(i)}),t}function sb(n,e){return Pw(e).filter(t=>!C_(n,t))}class ob{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ow(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Ic(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class xi extends ob{get formDirective(){return null}get path(){return null}}class la extends ob{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class ab{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let bp=(()=>{class n extends ab{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(la,2))},n.\u0275dir=f.lG2({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,r){2&t&&f.ekj("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[f.qOj]}),n})(),Fw=(()=>{class n extends ab{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(xi,10))},n.\u0275dir=f.lG2({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,r){2&t&&f.ekj("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[f.qOj]}),n})();const su="VALID",Gr="INVALID",so="PENDING",al="DISABLED";function ms(n){return(ou(n)?n.validators:n)||null}function ul(n,e){return(ou(e)?e.asyncValidators:n)||null}function ou(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class Dc{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===su}get invalid(){return this.status===Gr}get pending(){return this.status==so}get disabled(){return this.status===al}get enabled(){return this.status!==al}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(ib(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(ib(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(sb(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(sb(e,this._rawAsyncValidators))}hasValidator(e){return C_(this._rawValidators,e)}hasAsyncValidator(e){return C_(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=so,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=al,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=su,this._forEachChild(r=>{r.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===su||this.status===so)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?al:su}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=so,this._hasOwnPendingAsyncValidator=!0;const t=Mw(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new f.vpe,this.statusChanges=new f.vpe}_calculateStatus(){return this._allControlsDisabled()?al:this.errors?Gr:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(so)?so:this._anyControlsHaveStatus(Gr)?Gr:su}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){ou(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function Bw(n){return Array.isArray(n)?Ow(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function Th(n){return Array.isArray(n)?Ic(n):n||null}(this._rawAsyncValidators)}}class ll extends Dc{constructor(e,t,r){super(ms(t),ul(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){(function bc(n,e,t){n._forEachChild((r,i)=>{if(void 0===t[i])throw new f.vHH(1002,"")})})(this,0,e),Object.keys(e).forEach(r=>{(function Cc(n,e,t){const r=n.controls;if(!(e?Object.keys(r):r).length)throw new f.vHH(1e3,"");if(!r[t])throw new f.vHH(1001,"")})(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(r=>{const i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>!!r._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,a)=>{r=t(r,i,a)}),r}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}const Tc=new f.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>Sp}),Sp="always";function Sh(n,e,t=Sp){Rp(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function BP(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&fb(n,e)})}(n,e),function fM(n,e){const t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function jP(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&fb(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function hb(n,e){if(e.valueAccessor.setDisabledState){const t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function xp(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function Rp(n,e){const t=function nb(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(tb(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const r=function rb(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(tb(r,e.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const i=()=>n.updateValueAndValidity();xp(e._rawValidators,i),xp(e._rawAsyncValidators,i)}function fb(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}const yM={provide:xi,useExisting:(0,f.Gpc)(()=>Pp)},au=(()=>Promise.resolve())();let Pp=(()=>{class n extends xi{constructor(t,r,i){super(),this.callSetDisabledState=i,this.submitted=!1,this._directives=new Set,this.ngSubmit=new f.vpe,this.form=new ll({},Ow(t),Ic(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){au.then(()=>{const r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),Sh(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){au.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){au.then(()=>{const r=this._findContainer(t.path),i=new ll({});(function pM(n,e){Rp(n,e)})(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){au.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){au.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,function Np(n,e){n._syncPendingControls(),e.forEach(t=>{const r=t.control;"submit"===r.updateOn&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Mi,10),f.Y36(ol,10),f.Y36(Tc,8))},n.\u0275dir=f.lG2({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,r){1&t&&f.NdJ("submit",function(a){return r.onSubmit(a)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[f._Bn([yM]),f.qOj]}),n})();function gb(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function mb(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const _b=class extends Dc{constructor(e=null,t,r){super(ms(t),ul(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ou(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=mb(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){gb(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){gb(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){mb(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},wM={provide:la,useExisting:(0,f.Gpc)(()=>Ac)},wb=(()=>Promise.resolve())();let Ac=(()=>{class n extends la{constructor(t,r,i,a,l,h){super(),this._changeDetectorRef=l,this.callSetDisabledState=h,this.control=new _b,this._registered=!1,this.name="",this.update=new f.vpe,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=function T_(n,e){if(!e)return null;let t,r,i;return Array.isArray(e),e.forEach(a=>{a.constructor===Ec?t=a:function Hw(n){return Object.getPrototypeOf(n.constructor)===sl}(a)?r=a:i=a}),i||r||t||null}(0,a)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function Sc(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Sh(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){wb.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const r=t.isDisabled.currentValue,i=0!==r&&(0,f.VuI)(r);wb.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function Ap(n,e){return[...e.path,n]}(t,this._parent):[t]}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(xi,9),f.Y36(Mi,10),f.Y36(ol,10),f.Y36(Lo,10),f.Y36(f.sBO,8),f.Y36(Tc,8))},n.\u0275dir=f.lG2({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[f._Bn([wM]),f.qOj,f.TTD]}),n})(),A_=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=f.lG2({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),Gw=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})(),WP=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[Gw]}),n})(),Fb=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Tc,useValue:t.callSetDisabledState??Sp}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[WP]}),n})();function Lb(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"div")(1,"h1"),f._uU(2),f.qZA(),f.TgZ(3,"div",3)(4,"button",4),f.NdJ("click",function(){f.CHM(t);const i=f.oxw();return f.KtG(i.logout())}),f._uU(5,"Logout"),f.qZA()()()}if(2&n){const t=e.ngIf;f.xp6(2),f.hij("Welcome, ",t.email,"")}}function Vb(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"div",5)(1,"h1"),f._uU(2,"Login to continue"),f.qZA(),f.TgZ(3,"input",6),f.NdJ("ngModelChange",function(i){f.CHM(t);const a=f.oxw();return f.KtG(a.email=i)}),f.qZA(),f.TgZ(4,"input",7),f.NdJ("ngModelChange",function(i){f.CHM(t);const a=f.oxw();return f.KtG(a.password=i)}),f.qZA(),f.TgZ(5,"button",4),f.NdJ("click",function(){f.CHM(t);const i=f.oxw();return f.KtG(i.loginWithEmail())}),f._uU(6,"Login"),f.qZA(),f.TgZ(7,"button",8),f._uU(8,"Create Account"),f.qZA()()}if(2&n){const t=f.oxw();f.xp6(3),f.Q6J("ngModel",t.email),f.xp6(1),f.Q6J("ngModel",t.password)}}let Ah=(()=>{class n{constructor(t){this.auth=t}loginWithEmail(){this.auth.signInWithEmailAndPassword(this.email,this.password).catch(t=>{alert(t.message)})}logout(){this.auth.signOut()}resetPassword(){this.auth.sendPasswordResetEmail(this.email).catch(t=>{alert(t.message)})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(wc))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-auth"]],decls:5,vars:4,consts:[[1,"login-container"],[4,"ngIf","ngIfElse"],["login",""],[1,"login-btns__div"],[3,"click"],[1,"login-box"],["type","email","placeholder","Enter E-Mail",3,"ngModel","ngModelChange"],["type","password","placeholder","Enter Password",3,"ngModel","ngModelChange"],["routerLink","/create"]],template:function(t,r){if(1&t&&(f.TgZ(0,"div",0),f.YNc(1,Lb,6,1,"div",1),f.ALo(2,"async"),f.YNc(3,Vb,9,2,"ng-template",null,2,f.W1O),f.qZA()),2&t){const i=f.MAs(4);f.xp6(1),f.Q6J("ngIf",f.lcZ(2,2,r.auth.user))("ngIfElse",i)}},dependencies:[zo,pc,Ec,bp,Ac,ci],styles:[".login-btns__div[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:0 auto}.login-btns__div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 1em}.login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:5vh}.login-box[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:8px;padding:2em;background-color:#fff;box-shadow:0 4px 8px #0000001a;max-width:400px;margin:0 auto}.login-box[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-top:0;text-align:center}.login-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:block;width:100%;padding:.5em;margin-bottom:1em;border:1px solid #ccc;border-radius:4px}.login-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:1em;background-color:#313438;color:#fff;border:none;border-radius:4px;text-transform:uppercase;font-weight:700;cursor:pointer;margin-right:5px}.login-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#f5f5f5;color:#313438}"]}),n})();var n0=k(6321);function r0(){return(0,dt.e)((n,e)=>{let t,r=!1;n.subscribe((0,Fr.x)(e,i=>{const a=t;t=i,r&&e.next([a,i]),r=!0}))})}var pt,s0=k(3997),F_=(k(8443),k(3106)),ek=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ca={},oo=oo||{},kt=ek||self;function L_(){}function Vs(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Xi(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var V_="closure_uid_"+(1e9*Math.random()>>>0),Ub=0;function OM(n,e,t){return n.call.apply(n.bind,arguments)}function PM(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function Ri(n,e,t){return(Ri=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?OM:PM).apply(null,arguments)}function U_(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function zr(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Wb=function(r,i,a){for(var l=Array(arguments.length-2),h=2;h<arguments.length;h++)l[h-2]=arguments[h];return e.prototype[i].apply(r,l)}}function ao(){this.s=this.s,this.o=this.o}ao.prototype.s=!1,ao.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function Vo(n){Object.prototype.hasOwnProperty.call(n,V_)&&n[V_]||(n[V_]=++Ub)}(this)},ao.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const o0=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function a0(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function Bb(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(Vs(r)){const i=n.length||0,a=r.length||0;n.length=i+a;for(let l=0;l<a;l++)n[i+l]=r[l]}else n.push(r)}}function gi(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}gi.prototype.h=function(){this.defaultPrevented=!0};var jb=function(){if(!kt.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{kt.addEventListener("test",L_,e),kt.removeEventListener("test",L_,e)}catch{}return n}();function xc(n){return/^[\s\xa0]*$/.test(n)}var Hb=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function B_(n,e){return n<e?-1:n>e?1:0}function jp(){var n=kt.navigator;return n&&(n=n.userAgent)?n:""}function Uo(n){return-1!=jp().indexOf(n)}function u0(n){return u0[" "](n),n}u0[" "]=L_;var Hp,n,l0=Uo("Opera"),uu=Uo("Trident")||Uo("MSIE"),c0=Uo("Edge"),j_=c0||uu,d0=Uo("Gecko")&&!(-1!=jp().toLowerCase().indexOf("webkit")&&!Uo("Edge"))&&!(Uo("Trident")||Uo("MSIE"))&&!Uo("Edge"),$b=-1!=jp().toLowerCase().indexOf("webkit")&&!Uo("Edge");function h0(){var n=kt.document;return n?n.documentMode:void 0}e:{var H_="",$_=(n=jp(),d0?/rv:([^\);]+)(\)|;)/.exec(n):c0?/Edge\/([\d\.]+)/.exec(n):uu?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):$b?/WebKit\/(\S+)/.exec(n):l0?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if($_&&(H_=$_?$_[1]:""),uu){var f0=h0();if(null!=f0&&f0>parseFloat(H_)){Hp=String(f0);break e}}Hp=H_}var LM={};var UM=kt.document&&uu&&(h0()||parseInt(Hp,10))||void 0;function $p(n,e){if(gi.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(d0){e:{try{u0(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:BM[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&$p.X.h.call(this)}}zr($p,gi);var BM={2:"touch",3:"pen",4:"mouse"};$p.prototype.h=function(){$p.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Gp="closure_listenable_"+(1e6*Math.random()|0),jM=0;function HM(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ha=i,this.key=++jM,this.ba=this.ea=!1}function G_(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function g0(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function zb(n){const e={};for(const t in n)e[t]=n[t];return e}const qb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Wb(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let a=0;a<qb.length;a++)t=qb[a],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function z_(n){this.src=n,this.g={},this.h=0}function m0(n,e){var t=e.type;if(t in n.g){var a,r=n.g[t],i=o0(r,e);(a=0<=i)&&Array.prototype.splice.call(r,i,1),a&&(G_(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function q_(n,e,t,r){for(var i=0;i<n.length;++i){var a=n[i];if(!a.ba&&a.listener==e&&a.capture==!!t&&a.ha==r)return i}return-1}z_.prototype.add=function(n,e,t,r,i){var a=n.toString();(n=this.g[a])||(n=this.g[a]=[],this.h++);var l=q_(n,e,r,i);return-1<l?(e=n[l],t||(e.ea=!1)):((e=new HM(e,this.src,a,!!r,i)).ea=t,n.push(e)),e};var W_="closure_lm_"+(1e6*Math.random()|0),Z_={};function _0(n,e,t,r,i){if(r&&r.once)return v0(n,e,t,r,i);if(Array.isArray(e)){for(var a=0;a<e.length;a++)_0(n,e[a],t,r,i);return null}return t=C0(t),n&&n[Gp]?n.N(e,t,Xi(r)?!!r.capture:!!r,i):y0(n,e,t,!1,r,i)}function y0(n,e,t,r,i,a){if(!e)throw Error("Invalid event type");var l=Xi(i)?!!i.capture:!!i,h=lu(n);if(h||(n[W_]=h=new z_(n)),(t=h.add(e,t,r,l,a)).proxy)return t;if(r=function Zb(){const e=Kb;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)jb||(i=l),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(E0(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function v0(n,e,t,r,i){if(Array.isArray(e)){for(var a=0;a<e.length;a++)v0(n,e[a],t,r,i);return null}return t=C0(t),n&&n[Gp]?n.O(e,t,Xi(r)?!!r.capture:!!r,i):y0(n,e,t,!0,r,i)}function w0(n,e,t,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)w0(n,e[a],t,r,i);else r=Xi(r)?!!r.capture:!!r,t=C0(t),n&&n[Gp]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=q_(a=n.g[e],t,r,i))&&(G_(a[t]),Array.prototype.splice.call(a,t,1),0==a.length&&(delete n.g[e],n.h--))):n&&(n=lu(n))&&(e=n.g[e.toString()],n=-1,e&&(n=q_(e,t,r,i)),(t=-1<n?e[n]:null)&&K_(t))}function K_(n){if("number"!=typeof n&&n&&!n.ba){var e=n.src;if(e&&e[Gp])m0(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(E0(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=lu(e))?(m0(t,n),0==t.h&&(t.src=null,e[W_]=null)):G_(n)}}}function E0(n){return n in Z_?Z_[n]:Z_[n]="on"+n}function Kb(n,e){if(n.ba)n=!0;else{e=new $p(e,this);var t=n.listener,r=n.ha||n.src;n.ea&&K_(n),n=t.call(r,e)}return n}function lu(n){return(n=n[W_])instanceof z_?n:null}var I0="__closure_events_fn_"+(1e9*Math.random()>>>0);function C0(n){return"function"==typeof n?n:(n[I0]||(n[I0]=function(e){return n.handleEvent(e)}),n[I0])}function lr(){ao.call(this),this.i=new z_(this),this.P=this,this.I=null}function Ni(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new gi(e,n);else if(e instanceof gi)e.target=e.target||n;else{var i=e;Wb(e=new gi(r,n),i)}if(i=!0,t)for(var a=t.length-1;0<=a;a--){var l=e.g=t[a];i=Mh(l,r,!0,e)&&i}if(i=Mh(l=e.g=n,r,!0,e)&&i,i=Mh(l,r,!1,e)&&i,t)for(a=0;a<t.length;a++)i=Mh(l=e.g=t[a],r,!1,e)&&i}function Mh(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var l=e[a];if(l&&!l.ba&&l.capture==t){var h=l.listener,_=l.ha||l.src;l.ea&&m0(n.i,l),i=!1!==h.call(_,r)&&i}}return i&&!r.defaultPrevented}zr(lr,ao),lr.prototype[Gp]=!0,lr.prototype.removeEventListener=function(n,e,t,r){w0(this,n,e,t,r)},lr.prototype.M=function(){if(lr.X.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)G_(t[r]);delete n.g[e],n.h--}}this.I=null},lr.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},lr.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var Yb=kt.JSON.stringify;function Qb(){var n=zp;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var b0,$M=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new xh,n=>n.reset());class xh{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function GM(n){kt.setTimeout(()=>{throw n},0)}function Jb(n,e){b0||function Rh(){var n=kt.Promise.resolve(void 0);b0=function(){n.then(Y_)}}(),D0||(b0(),D0=!0),zp.add(n,e)}var D0=!1,zp=new class Xb{constructor(){this.h=this.g=null}add(e,t){const r=$M.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function Y_(){for(var n;n=Qb();){try{n.h.call(n.g)}catch(t){GM(t)}var e=$M;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}D0=!1}function mi(n,e){lr.call(this),this.h=n||1,this.g=e||kt,this.j=Ri(this.lb,this),this.l=Date.now()}function eD(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function Q_(n,e,t){if("function"==typeof n)t&&(n=Ri(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Ri(n.handleEvent,n)}return 2147483647<Number(e)?-1:kt.setTimeout(n,e||0)}function T0(n){n.g=Q_(()=>{n.g=null,n.i&&(n.i=!1,T0(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}zr(mi,lr),(pt=mi.prototype).ca=!1,pt.R=null,pt.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Ni(this,"tick"),this.ca&&(eD(this),this.start()))}},pt.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},pt.M=function(){mi.X.M.call(this),eD(this),delete this.g};class zM extends ao{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:T0(this)}M(){super.M(),this.g&&(kt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nh(n){ao.call(this),this.h=n,this.g={}}zr(Nh,ao);var S0=[];function A0(n,e,t,r){Array.isArray(t)||(t&&(S0[0]=t.toString()),t=S0);for(var i=0;i<t.length;i++){var a=_0(e,t[i],r||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function M0(n){g0(n.g,function(e,t){this.g.hasOwnProperty(t)&&K_(e)},n),n.g={}}function X_(){this.g=!0}function da(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function KM(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var l=1;l<i.length;l++)i[l]=""}}}return Yb(t)}catch{return e}}(n,t)+(r?" "+r:"")})}Nh.prototype.M=function(){Nh.X.M.call(this),M0(this)},Nh.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},X_.prototype.Aa=function(){this.g=!1},X_.prototype.info=function(){};var Rc={},qp=null;function Wp(){return qp=qp||new lr}function x0(n){gi.call(this,Rc.Pa,n)}function Oh(n){const e=Wp();Ni(e,new x0(e))}function tD(n,e){gi.call(this,Rc.STAT_EVENT,n),this.stat=e}function qr(n){const e=Wp();Ni(e,new tD(e,n))}function Ph(n,e){gi.call(this,Rc.Qa,n),this.size=e}function Zp(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return kt.setTimeout(function(){n()},e)}Rc.Pa="serverreachability",zr(x0,gi),Rc.STAT_EVENT="statevent",zr(tD,gi),Rc.Qa="timingevent",zr(Ph,gi);var J_={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},nD={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function ey(){}function N0(){}ey.prototype.h=null;var P0,Kp={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function ty(){gi.call(this,"d")}function O0(){gi.call(this,"c")}function k0(){}function ny(n,e,t,r){this.l=n,this.j=e,this.m=t,this.U=r||1,this.S=new Nh(this),this.O=tk,this.T=new mi(n=j_?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new YM}function YM(){this.i=null,this.g="",this.h=!1}zr(ty,gi),zr(O0,gi),zr(k0,ey),k0.prototype.g=function(){return new XMLHttpRequest},k0.prototype.i=function(){return{}},P0=new k0;var tk=45e3,ry={},Nc={};function F0(n,e,t){n.K=1,n.v=uy(ha(e)),n.s=t,n.P=!0,rD(n,null)}function rD(n,e){n.F=Date.now(),Yp(n),n.A=ha(n.v);var t=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),hD(t.i,"t",r),n.C=0,t=n.l.H,n.h=new YM,n.g=xD(n.l,t?e:null,!n.s),0<n.N&&(n.L=new zM(Ri(n.La,n,n.g),n.N)),A0(n.S,n.g,"readystatechange",n.ib),e=n.H?zb(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),Oh(),function qM(n,e,t,r,i,a){n.info(function(){if(n.g)if(a)for(var l="",h=a.split("&"),_=0;_<h.length;_++){var w=h[_].split("=");if(1<w.length){var D=w[0];w=w[1];var A=D.split("_");l=2<=A.length&&"type"==A[1]?l+(D+"=")+w+"&":l+(D+"=redacted&")}}else l=null;else l=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+l})}(n.j,n.u,n.A,n.m,n.U,n.s)}function L0(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function kh(n,e,t){let i,r=!0;for(;!n.I&&n.C<t.length;){if(i=QM(n,t),i==Nc){4==e&&(n.o=4,qr(14),r=!1),da(n.j,n.m,null,"[Incomplete Response]");break}if(i==ry){n.o=4,qr(15),da(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}da(n.j,n.m,i,null),oy(n,i)}L0(n)&&i!=Nc&&i!=ry&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,qr(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.$&&(n.$=!0,(e=n.l).g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),fy(e),e.K=!0,qr(11))):(da(n.j,n.m,t,"[Invalid Chunked Response]"),Oc(n),sy(n))}function QM(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?Nc:(t=Number(e.substring(t,r)),isNaN(t)?ry:(r+=1)+t>e.length?Nc:(e=e.substr(r,t),n.C=r+t,e))}function Yp(n){n.V=Date.now()+n.O,iD(n,n.O)}function iD(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Zp(Ri(n.gb,n),e)}function iy(n){n.B&&(kt.clearTimeout(n.B),n.B=null)}function sy(n){0==n.l.G||n.I||TD(n.l,n)}function Oc(n){iy(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,eD(n.T),M0(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function oy(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||ly(t.h,n)))if(!n.J&&ly(t.h,n)&&3==t.G){try{var r=t.Fa.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;py(t),ng(t)}J0(t),qr(18)}}else t.Ba=i[1],0<t.Ba-t.T&&37500>i[2]&&t.L&&0==t.A&&!t.v&&(t.v=Zp(Ri(t.cb,t),6e3));if(1>=gD(t.h)&&t.ja){try{t.ja()}catch{}t.ja=void 0}}else kc(t,11)}else if((n.J||t.g==n)&&py(t),!xc(e))for(i=t.Fa.g.parse(e),e=0;e<i.length;e++){let w=i[e];if(t.T=w[0],w=w[1],2==t.G)if("c"==w[0]){t.I=w[1],t.ka=w[2];const D=w[3];null!=D&&(t.ma=D,t.j.info("VER="+t.ma));const A=w[4];null!=A&&(t.Ca=A,t.j.info("SVER="+t.Ca));const O=w[5];null!=O&&"number"==typeof O&&0<O&&(t.J=r=1.5*O,t.j.info("backChannelRequestTimeoutMs_="+r)),r=t;const H=n.g;if(H){const z=H.g?H.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(z){var a=r.h;a.g||-1==z.indexOf("spdy")&&-1==z.indexOf("quic")&&-1==z.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(B0(a,a.h),a.h=null))}if(r.D){const ce=H.g?H.g.getResponseHeader("X-HTTP-Session-Id"):null;ce&&(r.za=ce,Un(r.F,r.D,ce))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms"));var l=n;if((r=t).sa=MD(r,r.H?r.ka:null,r.V),l.J){mD(r.h,l);var h=l,_=r.J;_&&h.setTimeout(_),h.B&&(iy(h),Yp(h)),r.g=l}else bD(r);0<t.i.length&&rg(t)}else"stop"!=w[0]&&"close"!=w[0]||kc(t,7);else 3==t.G&&("stop"==w[0]||"close"==w[0]?"stop"==w[0]?kc(t,7):X0(t):"noop"!=w[0]&&t.l&&t.l.wa(w),t.A=0)}Oh()}catch{}}function Fh(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(Vs(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function JM(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Vs(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function XM(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(Vs(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,a=0;a<i;a++)e.call(void 0,r[a],t&&t[a],n)}(pt=ny.prototype).setTimeout=function(n){this.O=n},pt.ib=function(n){n=n.target;const e=this.L;e&&3==pa(n)?e.l():this.La(n)},pt.La=function(n){try{if(n==this.g)e:{const D=pa(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>D)&&(3!=D||j_||this.g&&(this.h.h||this.g.fa()||K0(this.g)))){this.I||4!=D||7==e||Oh(),iy(this);var t=this.g.aa();this.Y=t;t:if(L0(this)){var r=K0(this.g);n="";var i=r.length,a=4==pa(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Oc(this),sy(this);var l="";break t}this.h.i=new kt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:a&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,l=this.h.g}else l=this.g.fa();if(this.i=200==t,function WM(n,e,t,r,i,a,l){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+a+" "+l})}(this.j,this.u,this.A,this.m,this.U,D,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var h,_=this.g;if((h=_.g?_.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!xc(h)){var w=h;break t}}w=null}if(!(t=w)){this.i=!1,this.o=3,qr(12),Oc(this),sy(this);break e}da(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,oy(this,t)}this.P?(kh(this,D,l),j_&&this.i&&3==D&&(A0(this.S,this.T,"tick",this.hb),this.T.start())):(da(this.j,this.m,l,null),oy(this,l)),4==D&&Oc(this),this.i&&!this.I&&(4==D?TD(this.l,this):(this.i=!1,Yp(this)))}else 400==t&&0<l.indexOf("Unknown SID")?(this.o=3,qr(12)):(this.o=0,qr(13)),Oc(this),sy(this)}}}catch{}},pt.hb=function(){if(this.g){var n=pa(this.g),e=this.g.fa();this.C<e.length&&(iy(this),kh(this,n,e),this.i&&4!=n&&Yp(this))}},pt.cancel=function(){this.I=!0,Oc(this)},pt.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function ZM(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Oh(),qr(17)),Oc(this),this.o=2,sy(this)):iD(this,this.V-n)};var sD=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pc(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Pc){this.h=void 0!==e?e:n.h,ay(this,n.j),this.s=n.s,this.g=n.g,Qp(this,n.m),this.l=n.l,e=n.i;var t=new Xp;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),aD(this,t),this.o=n.o}else n&&(t=String(n).match(sD))?(this.h=!!e,ay(this,t[1]||"",!0),this.s=Lh(t[2]||""),this.g=Lh(t[3]||"",!0),Qp(this,t[4]),this.l=Lh(t[5]||"",!0),aD(this,t[6]||"",!0),this.o=Lh(t[7]||"")):(this.h=!!e,this.i=new Xp(null,this.h))}function ha(n){return new Pc(n)}function ay(n,e,t){n.j=t?Lh(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Qp(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function aD(n,e,t){e instanceof Xp?(n.i=e,function rx(n,e){e&&!n.j&&(hl(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(cD(this,r),hD(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=Vh(e,nx)),n.i=new Xp(e,n.h))}function Un(n,e,t){n.i.set(e,t)}function uy(n){return Un(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Lh(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Vh(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,ex),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function ex(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Pc.prototype.toString=function(){var n=[],e=this.j;e&&n.push(Vh(e,uD,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(Vh(e,uD,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(Vh(t,"/"==t.charAt(0)?V0:tx,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",Vh(t,lD)),n.join("")};var uD=/[#\/\?@]/g,tx=/[#\?:]/g,V0=/[#\?]/g,nx=/[#\?@]/g,lD=/#/g;function Xp(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function hl(n){n.g||(n.g=new Map,n.h=0,n.i&&function oD(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var a=n[t].substring(0,r);i=n[t].substring(r+1)}else a=n[t];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function cD(n,e){hl(n),e=Uh(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function dD(n,e){return hl(n),e=Uh(n,e),n.g.has(e)}function hD(n,e,t){cD(n,e),0<t.length&&(n.i=null,n.g.set(Uh(n,e),a0(t)),n.h+=t.length)}function Uh(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function U0(n){this.l=n||fD,n=kt.PerformanceNavigationTiming?0<(n=kt.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(kt.g&&kt.g.Ga&&kt.g.Ga()&&kt.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(pt=Xp.prototype).add=function(n,e){hl(this),this.i=null,n=Uh(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},pt.forEach=function(n,e){hl(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},pt.oa=function(){hl(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let a=0;a<i.length;a++)t.push(e[r])}return t},pt.W=function(n){hl(this);let e=[];if("string"==typeof n)dD(this,n)&&(e=e.concat(this.g.get(Uh(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},pt.set=function(n,e){return hl(this),this.i=null,dD(this,n=Uh(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},pt.get=function(n,e){return n&&0<(n=this.W(n)).length?String(n[0]):e},pt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const a=encodeURIComponent(String(r)),l=this.W(r);for(r=0;r<l.length;r++){var i=a;""!==l[r]&&(i+="="+encodeURIComponent(String(l[r]))),n.push(i)}}return this.i=n.join("&")};var fD=10;function pD(n){return!!n.h||!!n.g&&n.g.size>=n.j}function gD(n){return n.h?1:n.g?n.g.size:0}function ly(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function B0(n,e){n.g?n.g.add(e):n.h=e}function mD(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function _D(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return a0(n.i)}function Jp(){}function j0(){this.g=new Jp}function yD(n,e,t){const r=t||"";try{Fh(n,function(i,a){let l=i;Xi(i)&&(l=Yb(i)),e.push(r+a+"="+encodeURIComponent(l))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function cy(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function eg(n){this.l=n.ac||null,this.j=n.jb||!1}function Bh(n,e){lr.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=$0,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}U0.prototype.cancel=function(){if(this.i=_D(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},Jp.prototype.stringify=function(n){return kt.JSON.stringify(n,void 0)},Jp.prototype.parse=function(n){return kt.JSON.parse(n,void 0)},zr(eg,ey),eg.prototype.g=function(){return new Bh(this.l,this.j)},eg.prototype.i=function(n){return function(){return n}}({}),zr(Bh,lr);var $0=0;function G0(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function fa(n){n.readyState=4,n.l=null,n.j=null,n.A=null,jh(n)}function jh(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(pt=Bh.prototype).open=function(n,e){if(this.readyState!=$0)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,jh(this)},pt.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||kt).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},pt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,fa(this)),this.readyState=$0},pt.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,jh(this)),this.g&&(this.readyState=3,jh(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof kt.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;G0(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},pt.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?fa(this):jh(this),3==this.readyState&&G0(this)}},pt.Va=function(n){this.g&&(this.response=this.responseText=n,fa(this))},pt.Ua=function(n){this.g&&(this.response=n,fa(this))},pt.ga=function(){this.g&&fa(this)},pt.setRequestHeader=function(n,e){this.v.append(n,e)},pt.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},pt.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(Bh.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var sx=kt.JSON.parse;function Tr(n){lr.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=dy,this.K=this.L=!1}zr(Tr,lr);var dy="",z0=/^https?$/i,ox=["POST","PUT"];function q0(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,wD(n),Hh(n)}function wD(n){n.D||(n.D=!0,Ni(n,"complete"),Ni(n,"error"))}function W0(n){if(n.h&&typeof oo<"u"&&(!n.C[1]||4!=pa(n)||2!=n.aa()))if(n.v&&4==pa(n))Q_(n.Ha,0,n);else if(Ni(n,"readystatechange"),4==pa(n)){n.h=!1;try{const h=n.aa();e:switch(h){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===h){var i=String(n.H).match(sD)[1]||null;if(!i&&kt.self&&kt.self.location){var a=kt.self.location.protocol;i=a.substr(0,a.length-1)}r=!z0.test(i?i.toLowerCase():"")}t=r}if(t)Ni(n,"complete"),Ni(n,"success");else{n.m=6;try{var l=2<pa(n)?n.g.statusText:""}catch{l=""}n.j=l+" ["+n.aa()+"]",wD(n)}}finally{Hh(n)}}}function Hh(n,e){if(n.g){Z0(n);const t=n.g,r=n.C[0]?L_:null;n.g=null,n.C=null,e||Ni(n,"ready");try{t.onreadystatechange=r}catch{}}}function Z0(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(kt.clearTimeout(n.A),n.A=null)}function pa(n){return n.g?n.g.readyState:0}function K0(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case dy:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function Y0(n){let e="";return g0(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function Q0(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=Y0(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Un(n,e,t))}function tg(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function ED(n){this.Ca=0,this.i=[],this.j=new X_,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=tg("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=tg("baseRetryDelayMs",5e3,n),this.bb=tg("retryDelaySeedMs",1e4,n),this.$a=tg("forwardChannelMaxRetries",2,n),this.ta=tg("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new U0(n&&n.concurrentRequestLimit),this.Fa=new j0,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function X0(n){if(ax(n),3==n.G){var e=n.U++,t=ha(n.F);Un(t,"SID",n.I),Un(t,"RID",e),Un(t,"TYPE","terminate"),hy(n,t),(e=new ny(n,n.j,e,void 0)).K=2,e.v=uy(ha(t)),t=!1,kt.navigator&&kt.navigator.sendBeacon&&(t=kt.navigator.sendBeacon(e.v.toString(),"")),!t&&kt.Image&&((new Image).src=e.v,t=!0),t||(e.g=xD(e.l,null),e.g.da(e.v)),e.F=Date.now(),Yp(e)}AD(n)}function ng(n){n.g&&(fy(n),n.g.cancel(),n.g=null)}function ax(n){ng(n),n.u&&(kt.clearTimeout(n.u),n.u=null),py(n),n.h.cancel(),n.m&&("number"==typeof n.m&&kt.clearTimeout(n.m),n.m=null)}function rg(n){pD(n.h)||n.m||(n.m=!0,Jb(n.Ja,n),n.C=0)}function ID(n,e){var t;t=e?e.m:n.U++;const r=ha(n.F);Un(r,"SID",n.I),Un(r,"RID",t),Un(r,"AID",n.T),hy(n,r),n.o&&n.s&&Q0(r,n.o,n.s),t=new ny(n,n.j,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=CD(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),B0(n.h,t),F0(t,r,e)}function hy(n,e){n.ia&&g0(n.ia,function(t,r){Un(e,r,t)}),n.l&&Fh({},function(t,r){Un(e,r,t)})}function CD(n,e,t){t=Math.min(n.i.length,t);var r=n.l?Ri(n.l.Ra,n.l,n):null;e:{var i=n.i;let a=-1;for(;;){const l=["count="+t];-1==a?0<t?(a=i[0].h,l.push("ofs="+a)):a=0:l.push("ofs="+a);let h=!0;for(let _=0;_<t;_++){let w=i[_].h;const D=i[_].g;if(w-=a,0>w)a=Math.max(0,i[_].h-100),h=!1;else try{yD(D,l,"req"+w+"_")}catch{r&&r(D)}}if(h){r=l.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,r}function bD(n){n.g||n.u||(n.Z=1,Jb(n.Ia,n),n.A=0)}function J0(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=Zp(Ri(n.Ia,n),SD(n,n.A)),n.A++,0))}function fy(n){null!=n.B&&(kt.clearTimeout(n.B),n.B=null)}function DD(n){n.g=new ny(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var e=ha(n.sa);Un(e,"RID","rpc"),Un(e,"SID",n.I),Un(e,"CI",n.L?"0":"1"),Un(e,"AID",n.T),Un(e,"TYPE","xmlhttp"),hy(n,e),n.o&&n.s&&Q0(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=uy(ha(e)),t.s=null,t.P=!0,rD(t,n)}function py(n){null!=n.v&&(kt.clearTimeout(n.v),n.v=null)}function TD(n,e){var t=null;if(n.g==e){py(n),fy(n),n.g=null;var r=2}else{if(!ly(n.h,e))return;t=e.D,mD(n.h,e),r=1}if(0!=n.G)if(n.pa=e.Y,e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var i=n.C;Ni(r=Wp(),new Ph(r,t)),rg(n)}else bD(n);else if(3==(i=e.o)||0==i&&0<n.pa||!(1==r&&function ux(n,e){return!(gD(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=Zp(Ri(n.Ja,n,e),SD(n,n.C)),n.C++,0)))}(n,e)||2==r&&J0(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),i){case 1:kc(n,5);break;case 4:kc(n,10);break;case 3:kc(n,6);break;default:kc(n,2)}}function SD(n,e){let t=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(t*=2),t*e}function kc(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var r=Ri(n.kb,n);t||(t=new Pc("//www.google.com/images/cleardot.gif"),kt.location&&"http"==kt.location.protocol||ay(t,"https"),uy(t)),function H0(n,e){const t=new X_;if(kt.Image){const r=new Image;r.onload=U_(cy,t,r,"TestLoadImage: loaded",!0,e),r.onerror=U_(cy,t,r,"TestLoadImage: error",!1,e),r.onabort=U_(cy,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=U_(cy,t,r,"TestLoadImage: timeout",!1,e),kt.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else qr(2);n.G=0,n.l&&n.l.va(e),AD(n),ax(n)}function AD(n){if(n.G=0,n.la=[],n.l){const e=_D(n.h);(0!=e.length||0!=n.i.length)&&(Bb(n.la,e),Bb(n.la,n.i),n.h.i.length=0,a0(n.i),n.i.length=0),n.l.ua()}}function MD(n,e,t){var r=t instanceof Pc?ha(t):new Pc(t,void 0);if(""!=r.g)e&&(r.g=e+"."+r.g),Qp(r,r.m);else{var i=kt.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var a=new Pc(null,void 0);r&&ay(a,r),e&&(a.g=e),i&&Qp(a,i),t&&(a.l=t),r=a}return e=n.za,(t=n.D)&&e&&Un(r,t,e),Un(r,"VER",n.ma),hy(n,r),r}function xD(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Tr(t&&n.Da&&!n.ra?new eg({jb:!0}):n.ra)).Ka(n.H),e}function $h(){}function ig(){if(uu&&!(10<=Number(UM)))throw Error("Environmental error: no available transport.")}function _s(n,e){lr.call(this),this.g=new ED(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Yb)&&!xc(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!xc(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Fc(this)}function eE(n){ty.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function tE(){O0.call(this),this.status=1}function Fc(n){this.g=n}(pt=Tr.prototype).Ka=function(n){this.L=n},pt.da=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():P0.g(),this.C=function R0(n){return n.h||(n.h=n.i())}(this.u?this.u:P0),this.g.onreadystatechange=Ri(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(a){return void q0(this,a)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const a of r.keys())t.set(a,r.get(a))}r=Array.from(t.keys()).find(a=>"content-type"==a.toLowerCase()),i=kt.FormData&&n instanceof kt.FormData,!(0<=o0(ox,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,l]of t)this.g.setRequestHeader(a,l);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Z0(this),0<this.B&&((this.K=function vD(n){return uu&&function VM(){return function FM(n){var e=LM;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=Hb(String(Hp)).split("."),t=Hb("9").split("."),r=Math.max(e.length,t.length);for(let l=0;0==n&&l<r;l++){var i=e[l]||"",a=t[l]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==i[0].length&&0==a[0].length)break;n=B_(0==i[1].length?0:parseInt(i[1],10),0==a[1].length?0:parseInt(a[1],10))||B_(0==i[2].length,0==a[2].length)||B_(i[2],a[2]),i=i[3],a=a[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ri(this.qa,this)):this.A=Q_(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){q0(this,a)}},pt.qa=function(){typeof oo<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ni(this,"timeout"),this.abort(8))},pt.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Ni(this,"complete"),Ni(this,"abort"),Hh(this))},pt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Hh(this,!0)),Tr.X.M.call(this)},pt.Ha=function(){this.s||(this.F||this.v||this.l?W0(this):this.fb())},pt.fb=function(){W0(this)},pt.aa=function(){try{return 2<pa(this)?this.g.status:-1}catch{return-1}},pt.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},pt.Sa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),sx(e)}},pt.Ea=function(){return this.m},pt.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(pt=ED.prototype).ma=8,pt.G=1,pt.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const i=new ny(this,this.j,n,void 0);let a=this.s;if(this.S&&(a?(a=zb(a),Wb(a,this.S)):a=this.S),null!==this.o||this.N||(i.H=a,a=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){var r=this.i[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=CD(this,i,e),Un(t=ha(this.F),"RID",n),Un(t,"CVER",22),this.D&&Un(t,"X-HTTP-Session-Id",this.D),hy(this,t),a&&(this.N?e="headers="+encodeURIComponent(String(Y0(a)))+"&"+e:this.o&&Q0(t,this.o,a)),B0(this.h,i),this.Ya&&Un(t,"TYPE","init"),this.O?(Un(t,"$req",e),Un(t,"SID","null"),i.Z=!0,F0(i,t,null)):F0(i,t,e),this.G=2}}else 3==this.G&&(n?ID(this,n):0==this.i.length||pD(this.h)||ID(this))},pt.Ia=function(){if(this.u=null,DD(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=Zp(Ri(this.eb,this),n)}},pt.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,qr(10),ng(this),DD(this))},pt.cb=function(){null!=this.v&&(this.v=null,ng(this),J0(this),qr(19))},pt.kb=function(n){n?(this.j.info("Successfully pinged google.com"),qr(2)):(this.j.info("Failed to ping google.com"),qr(1))},(pt=$h.prototype).xa=function(){},pt.wa=function(){},pt.va=function(){},pt.ua=function(){},pt.Ra=function(){},ig.prototype.g=function(n,e){return new _s(n,e)},zr(_s,lr),_s.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;qr(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=MD(n,null,n.V),rg(n)},_s.prototype.close=function(){X0(this.g)},_s.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=Yb(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.ab++,n)),3==e.G&&rg(e)},_s.prototype.M=function(){this.g.l=null,delete this.j,X0(this.g),delete this.g,_s.X.M.call(this)},zr(eE,ty),zr(tE,O0),zr(Fc,$h),Fc.prototype.xa=function(){Ni(this.g,"a")},Fc.prototype.wa=function(n){Ni(this.g,new eE(n))},Fc.prototype.va=function(n){Ni(this.g,new tE)},Fc.prototype.ua=function(){Ni(this.g,"b")},ig.prototype.createWebChannel=ig.prototype.g,_s.prototype.send=_s.prototype.u,_s.prototype.open=_s.prototype.m,_s.prototype.close=_s.prototype.close,J_.NO_ERROR=0,J_.TIMEOUT=8,J_.HTTP_ERROR=6,nD.COMPLETE="complete",N0.EventType=Kp,Kp.OPEN="a",Kp.CLOSE="b",Kp.ERROR="c",Kp.MESSAGE="d",lr.prototype.listen=lr.prototype.N,Tr.prototype.listenOnce=Tr.prototype.O,Tr.prototype.getLastError=Tr.prototype.Oa,Tr.prototype.getLastErrorCode=Tr.prototype.Ea,Tr.prototype.getStatus=Tr.prototype.aa,Tr.prototype.getResponseJson=Tr.prototype.Sa,Tr.prototype.getResponseText=Tr.prototype.fa,Tr.prototype.send=Tr.prototype.da,Tr.prototype.setWithCredentials=Tr.prototype.Ka;var RD=ca.createWebChannelTransport=function(){return new ig},lx=ca.getStatEventTarget=function(){return Wp()},ND=ca.ErrorCode=J_,nk=ca.EventType=nD,OD=ca.Event=Rc,PD=ca.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},cx=ca.FetchXmlHttpFactory=eg,gy=ca.WebChannel=N0,dx=ca.XhrIo=Tr;const Gh="@firebase/firestore";class ti{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ti.UNAUTHENTICATED=new ti(null),ti.GOOGLE_CREDENTIALS=new ti("google-credentials-uid"),ti.FIRST_PARTY=new ti("first-party-uid"),ti.MOCK_USER=new ti("mock-user");let fl="9.16.0";const _i=new Ls.Yd("@firebase/firestore");function nE(){return _i.logLevel}function Pe(n,...e){if(_i.logLevel<=Ls.in.DEBUG){const t=e.map(iE);_i.debug(`Firestore (${fl}): ${n}`,...t)}}function Sr(n,...e){if(_i.logLevel<=Ls.in.ERROR){const t=e.map(iE);_i.error(`Firestore (${fl}): ${n}`,...t)}}function Lc(n,...e){if(_i.logLevel<=Ls.in.WARN){const t=e.map(iE);_i.warn(`Firestore (${fl}): ${n}`,...t)}}function iE(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Xe(n="Unexpected state"){const e=`FIRESTORE (${fl}) INTERNAL ASSERTION FAILED: `+n;throw Sr(e),new Error(e)}function gt(n,e){n||Xe()}function Ze(n,e){return n}const ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Re extends P.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Wr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class sE{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ti.UNAUTHENTICATED))}shutdown(){}}class px{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class kD{constructor(e){this.t=e,this.currentUser=ti.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const a=w=>this.i!==i?(i=this.i,t(w)):Promise.resolve();let l=new Wr;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Wr,e.enqueueRetryable(()=>a(this.currentUser))};const h=()=>{const w=l;e.enqueueRetryable((0,me.Z)(function*(){yield w.promise,yield a(r.currentUser)}))},_=w=>{Pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=w,this.auth.addAuthTokenListener(this.o),h()};this.t.onInit(w=>_(w)),setTimeout(()=>{if(!this.auth){const w=this.t.getImmediate({optional:!0});w?_(w):(Pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Wr)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(gt("string"==typeof r.accessToken),new sE(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return gt(null===e||"string"==typeof e),new ti(e)}}class my{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i,this.type="FirstParty",this.user=ti.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(gt(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class gx{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i}getToken(){return Promise.resolve(new my(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(ti.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class FD{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class LD{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const r=a=>{null!=a.error&&Pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.A;return this.A=a.token,Pe("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const i=a=>{Pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.T.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.T.getImmediate({optional:!0});a?i(a):Pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(gt("string"==typeof t.token),this.A=t.token,new FD(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function oE(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class aE{static R(){const t=62*Math.floor(256/62);let r="";for(;r.length<20;){const i=oE(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[a]%62))}return r}}function Ft(n,e){return n<e?-1:n>e?1:0}function Vc(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function uE(n){return n+"\0"}class Yn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Re(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Re(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Re(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Re(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Yn.fromMillis(Date.now())}static fromDate(e){return Yn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Yn(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ft(this.nanoseconds,e.nanoseconds):Ft(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class vt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new vt(e)}static min(){return new vt(new Yn(0,0))}static max(){return new vt(new Yn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Uc{constructor(e,t,r){void 0===t?t=0:t>e.length&&Xe(),void 0===r?r=e.length-t:r>e.length-t&&Xe(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===Uc.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Uc?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=e.get(i),l=t.get(i);if(a<l)return-1;if(a>l)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class an extends Uc{construct(e,t,r){return new an(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Re(ue.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new an(t)}static emptyPath(){return new an([])}}const VD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qn extends Uc{construct(e,t,r){return new Qn(e,t,r)}static isValidIdentifier(e){return VD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Qn(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(0===r.length)throw new Re(ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;i<e.length;){const h=e[i];if("\\"===h){if(i+1===e.length)throw new Re(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const _=e[i+1];if("\\"!==_&&"."!==_&&"`"!==_)throw new Re(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=_,i+=2}else"`"===h?(l=!l,i++):"."!==h||l?(r+=h,i++):(a(),i++)}if(a(),l)throw new Re(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Qn(t)}static emptyPath(){return new Qn([])}}class Ge{constructor(e){this.path=e}static fromPath(e){return new Ge(an.fromString(e))}static fromName(e){return new Ge(an.fromString(e).popFirst(5))}static empty(){return new Ge(an.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===an.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return an.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ge(new an(e.slice()))}}class _y{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function lE(n){return n.fields.find(e=>2===e.kind)}function Bc(n){return n.fields.filter(e=>2!==e.kind)}_y.UNKNOWN_ID=-1;class sg{constructor(e,t){this.fieldPath=e,this.kind=t}}class zh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new zh(0,ys.min())}}function UD(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=vt.fromTimestamp(1e9===r?new Yn(t+1,0):new Yn(t,r));return new ys(i,Ge.empty(),e)}function dE(n){return new ys(n.readTime,n.key,-1)}class ys{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ys(vt.min(),Ge.empty(),-1)}static max(){return new ys(vt.max(),Ge.empty(),-1)}}function hE(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=Ge.comparator(n.documentKey,e.documentKey),0!==t?t:Ft(n.largestBatchId,e.largestBatchId))}const fE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class pE{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function pl(n){return yy.apply(this,arguments)}function yy(){return yy=(0,me.Z)(function*(n){if(n.code!==ue.FAILED_PRECONDITION||n.message!==fE)throw n;Pe("LocalStore","Unexpectedly lost primary lease")}),yy.apply(this,arguments)}class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Xe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):oe.reject(t)}static resolve(e){return new oe((t,r)=>{t(e)})}static reject(e){return new oe((t,r)=>{r(e)})}static waitFor(e){return new oe((t,r)=>{let i=0,a=0,l=!1;e.forEach(h=>{++i,h.next(()=>{++a,l&&a===i&&t()},_=>r(_))}),l=!0,a===i&&t()})}static or(e){let t=oe.resolve(!1);for(const r of e)t=t.next(i=>i?oe.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,a)=>{r.push(t.call(this,i,a))}),this.waitFor(r)}static mapArray(e,t){return new oe((r,i)=>{const a=e.length,l=new Array(a);let h=0;for(let _=0;_<a;_++){const w=_;t(e[w]).next(D=>{l[w]=D,++h,h===a&&r(l)},D=>i(D))}})}static doWhile(e,t){return new oe((r,i)=>{const a=()=>{!0===e()?t().next(()=>{a()},i):r()};a()})}}class ni{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.P=new Wr,this.transaction.oncomplete=()=>{this.P.resolve()},this.transaction.onabort=()=>{t.error?this.P.reject(new og(e,t.error)):this.P.resolve()},this.transaction.onerror=r=>{const i=Hc(r.target.error);this.P.reject(new og(e,i))}}static open(e,t,r,i){try{return new ni(t,e.transaction(i,r))}catch(a){throw new og(t,a)}}get v(){return this.P.promise}abort(e){e&&this.P.reject(e),this.aborted||(Pe("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new rk(t)}}class Oi{constructor(e,t,r){this.name=e,this.version=t,this.S=r,12.2===Oi.D((0,P.z$)())&&Sr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Pe("SimpleDb","Removing database:",e),gl(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!(0,P.hl)())return!1;if(Oi.N())return!0;const e=(0,P.z$)(),t=Oi.D(e),r=0<t&&t<10,i=Oi.k(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static N(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.O)}static M(e,t){return e.store(t)}static D(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static k(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}F(e){var t=this;return(0,me.Z)(function*(){return t.db||(Pe("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const a=indexedDB.open(t.name,t.version);a.onsuccess=l=>{r(l.target.result)},a.onblocked=()=>{i(new og(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const h=l.target.error;i("VersionError"===h.name?new Re(ue.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===h.name?new Re(ue.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+h):new og(e,h))},a.onupgradeneeded=l=>{Pe("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',l.oldVersion),t.S.$(l.target.result,a.transaction,l.oldVersion,t.version).next(()=>{Pe("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=r=>t.B(r)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var a=this;return(0,me.Z)(function*(){const l="readonly"===t;let h=0;for(;;){++h;try{a.db=yield a.F(e);const _=ni.open(a.db,e,l?"readonly":"readwrite",r),w=i(_).next(D=>(_.V(),D)).catch(D=>(_.abort(D),oe.reject(D))).toPromise();return w.catch(()=>{}),yield _.v,w}catch(_){const w=_,D="FirebaseError"!==w.name&&h<3;if(Pe("SimpleDb","Transaction failed with error:",w.message,"Retrying:",D),a.close(),!D)return Promise.reject(w)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class yx{constructor(e){this.q=e,this.U=!1,this.K=null}get isDone(){return this.U}get G(){return this.K}set cursor(e){this.q=e}done(){this.U=!0}j(e){this.K=e}delete(){return gl(this.q.delete())}}class og extends Re{constructor(e,t){super(ue.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function jc(n){return"IndexedDbTransactionError"===n.name}class rk{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(Pe("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(Pe("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),gl(r)}add(e){return Pe("SimpleDb","ADD",this.store.name,e,e),gl(this.store.add(e))}get(e){return gl(this.store.get(e)).next(t=>(void 0===t&&(t=null),Pe("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return Pe("SimpleDb","DELETE",this.store.name,e),gl(this.store.delete(e))}count(){return Pe("SimpleDb","COUNT",this.store.name),gl(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),a=[];return this.H(i,(l,h)=>{a.push(h)}).next(()=>a)}{const i=this.store.getAll(r.range);return new oe((a,l)=>{i.onerror=h=>{l(h.target.error)},i.onsuccess=h=>{a(h.target.result)}})}}J(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new oe((i,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{i(l.target.result)}})}Y(e,t){Pe("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,(a,l,h)=>h.delete())}Z(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}tt(e){const t=this.cursor({});return new oe((r,i)=>{t.onerror=a=>{const l=Hc(a.target.error);i(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next(h=>{h?l.continue():r()}):r()}})}H(e,t){const r=[];return new oe((i,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const h=l.target.result;if(!h)return void i();const _=new yx(h),w=t(h.primaryKey,h.value,_);if(w instanceof oe){const D=w.catch(A=>(_.done(),oe.reject(A)));r.push(D)}_.isDone?i():null===_.G?h.continue():h.continue(_.G)}}).next(()=>oe.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function gl(n){return new oe((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=Hc(r.target.error);t(i)}})}let vy=!1;function Hc(n){const e=Oi.D((0,P.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return vy||(vy=!0,setTimeout(()=>{throw r},0)),r}}return n}class vx{constructor(e,t){this.asyncQueue=e,this.et=t,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}nt(e){var t=this;Pe("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,me.Z)(function*(){t.task=null;try{Pe("IndexBackiller",`Documents written: ${yield t.et.st()}`)}catch(r){jc(r)?Pe("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield pl(r)}yield t.nt(6e4)}))}}class gE{constructor(e,t){this.localStore=e,this.persistence=t}st(e=50){var t=this;return(0,me.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.it(r,e))})()}it(e,t){const r=new Set;let i=t,a=!0;return oe.doWhile(()=>!0===a&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(l=>{if(null!==l&&!r.has(l))return Pe("IndexBackiller",`Processing collection: ${l}`),this.rt(e,l,i).next(h=>{i-=h,r.add(l)});a=!1})).next(()=>t-i)}rt(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next(()=>this.ot(i,a)).next(h=>(Pe("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>l.size)}))}ot(e,t){let r=e;return t.changes.forEach((i,a)=>{const l=dE(a);hE(l,r)>0&&(r=l)}),new ys(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}let Us=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ut(i),this.ct=i=>r.writeSequenceNumber(i))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}return n.at=-1,n})();class BD{constructor(e,t,r,i,a,l,h,_){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.useFetchStreams=_}}class ml{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new ml("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof ml&&e.projectId===this.projectId&&e.database===this.database}}function jD(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function $c(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function wy(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function qh(n){return null==n}function ag(n){return 0===n&&1/n==-1/0}function ug(n){return"number"==typeof n&&Number.isInteger(n)&&!ag(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}class ri{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new ri(t)}static fromUint8Array(e){const t=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new ri(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ft(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ri.EMPTY_BYTE_STRING=new ri("");const HD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _l(n){if(gt(!!n),"string"==typeof n){let e=0;const t=HD.exec(n);if(gt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:cr(n.seconds),nanos:cr(n.nanos)}}function cr(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function uo(n){return"string"==typeof n?ri.fromBase64String(n):ri.fromUint8Array(n)}function _E(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function yE(n){const e=n.mapValue.fields.__previous_value__;return _E(e)?yE(e):e}function Gc(n){const e=_l(n.mapValue.fields.__local_write_time__.timestampValue);return new Yn(e.seconds,e.nanos)}const zc={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ey={nullValue:"NULL_VALUE"};function Wh(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?_E(n)?4:IE(n)?9007199254740991:10:Xe()}function ga(n,e){if(n===e)return!0;const t=Wh(n);if(t!==Wh(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Gc(n).isEqual(Gc(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=_l(r.timestampValue),l=_l(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,uo(n.bytesValue).isEqual(uo(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return cr(r.geoPointValue.latitude)===cr(i.geoPointValue.latitude)&&cr(r.geoPointValue.longitude)===cr(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return cr(r.integerValue)===cr(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=cr(r.doubleValue),l=cr(i.doubleValue);return a===l?ag(a)===ag(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return Vc(n.arrayValue.values||[],e.arrayValue.values||[],ga);case 10:return function(r,i){const a=r.mapValue.fields||{},l=i.mapValue.fields||{};if(jD(a)!==jD(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(void 0===l[h]||!ga(a[h],l[h])))return!1;return!0}(n,e);default:return Xe()}var i}function lg(n,e){return void 0!==(n.values||[]).find(t=>ga(t,e))}function yl(n,e){if(n===e)return 0;const t=Wh(n),r=Wh(e);if(t!==r)return Ft(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ft(n.booleanValue,e.booleanValue);case 2:return function(i,a){const l=cr(i.integerValue||i.doubleValue),h=cr(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,e);case 3:return vE(n.timestampValue,e.timestampValue);case 4:return vE(Gc(n),Gc(e));case 5:return Ft(n.stringValue,e.stringValue);case 6:return function(i,a){const l=uo(i),h=uo(a);return l.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),h=a.split("/");for(let _=0;_<l.length&&_<h.length;_++){const w=Ft(l[_],h[_]);if(0!==w)return w}return Ft(l.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,a){const l=Ft(cr(i.latitude),cr(a.latitude));return 0!==l?l:Ft(cr(i.longitude),cr(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,a){const l=i.values||[],h=a.values||[];for(let _=0;_<l.length&&_<h.length;++_){const w=yl(l[_],h[_]);if(w)return w}return Ft(l.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,a){if(i===zc.mapValue&&a===zc.mapValue)return 0;if(i===zc.mapValue)return 1;if(a===zc.mapValue)return-1;const l=i.fields||{},h=Object.keys(l),_=a.fields||{},w=Object.keys(_);h.sort(),w.sort();for(let D=0;D<h.length&&D<w.length;++D){const A=Ft(h[D],w[D]);if(0!==A)return A;const O=yl(l[h[D]],_[w[D]]);if(0!==O)return O}return Ft(h.length,w.length)}(n.mapValue,e.mapValue);default:throw Xe()}}function vE(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Ft(n,e);const t=_l(n),r=_l(e),i=Ft(t.seconds,r.seconds);return 0!==i?i:Ft(t.nanos,r.nanos)}function qc(n){return wE(n)}function wE(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=_l(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?uo(n.bytesValue).toBase64():"referenceValue"in n?Ge.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",a=!0;for(const l of r.values||[])a?a=!1:i+=",",i+=wE(l);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let a="{",l=!0;for(const h of i)l?l=!1:a+=",",a+=`${h}:${wE(r.fields[h])}`;return a+"}"}(n.mapValue):Xe();var e}function vl(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Iy(n){return!!n&&"integerValue"in n}function cg(n){return!!n&&"arrayValue"in n}function $D(n){return!!n&&"nullValue"in n}function EE(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Cy(n){return!!n&&"mapValue"in n}function Zh(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return $c(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Zh(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Zh(n.arrayValue.values[t]);return e}return Object.assign({},n)}function IE(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function GD(n){return"nullValue"in n?Ey:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?vl(ml.empty(),Ge.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Xe()}function zD(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?vl(ml.empty(),Ge.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?zc:Xe()}function qD(n,e){const t=yl(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function WD(n,e){const t=yl(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Wc{constructor(e,t){this.position=e,this.inclusive=t}}function CE(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],l=n.position[i];if(r=a.field.isKeyField()?Ge.comparator(Ge.fromName(l.referenceValue),t.key):yl(l,t.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function wx(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ga(n.position[t],e.position[t]))return!1;return!0}class Ex{}class cn extends Ex{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new Cx(e,t,r):"array-contains"===t?new ik(e,r):"in"===t?new QD(e,r):"not-in"===t?new XD(e,r):"array-contains-any"===t?new Tx(e,r):new cn(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new Dy(e,r):new bx(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(yl(t,this.value)):null!==t&&Wh(this.value)===Wh(t)&&this.matchesComparison(yl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Xe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Sn extends Ex{constructor(e,t){super(),this.filters=e,this.op=t,this.ht=null}static create(e,t){return new Sn(e,t)}matches(e){return dg(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ht||(this.ht=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.lt(t=>t.isInequality());return null!==e?e.field:null}lt(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function dg(n){return"and"===n.op}function ZD(n){return"or"===n.op}function KD(n){return Ix(n)&&dg(n)}function Ix(n){for(const e of n.filters)if(e instanceof Sn)return!1;return!0}function YD(n){if(n instanceof cn)return n.field.canonicalString()+n.op.toString()+qc(n.value);if(KD(n))return n.filters.map(e=>YD(e)).join(",");{const e=n.filters.map(t=>YD(t)).join(",");return`${n.op}(${e})`}}function bE(n,e){return n instanceof cn?(t=n,(r=e)instanceof cn&&t.op===r.op&&t.field.isEqual(r.field)&&ga(t.value,r.value)):n instanceof Sn?function(t,r){return r instanceof Sn&&t.op===r.op&&t.filters.length===r.filters.length&&t.filters.reduce((i,a,l)=>i&&bE(a,r.filters[l]),!0)}(n,e):void Xe();var t,r}function by(n,e){const t=n.filters.concat(e);return Sn.create(t,n.op)}function DE(n){return n instanceof cn?`${(e=n).field.canonicalString()} ${e.op} ${qc(e.value)}`:n instanceof Sn?function(e){return e.op.toString()+" {"+e.getFilters().map(DE).join(" ,")+"}"}(n):"Filter";var e}class Cx extends cn{constructor(e,t,r){super(e,t,r),this.key=Ge.fromName(r.referenceValue)}matches(e){const t=Ge.comparator(e.key,this.key);return this.matchesComparison(t)}}class Dy extends cn{constructor(e,t){super(e,"in",t),this.keys=Dx(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class bx extends cn{constructor(e,t){super(e,"not-in",t),this.keys=Dx(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Dx(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>Ge.fromName(r.referenceValue))}class ik extends cn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return cg(t)&&lg(t.arrayValue,this.value)}}class QD extends cn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&lg(this.value.arrayValue,t)}}class XD extends cn{constructor(e,t){super(e,"not-in",t)}matches(e){if(lg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!lg(this.value.arrayValue,t)}}class Tx extends cn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!cg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>lg(this.value.arrayValue,r))}}class Kh{constructor(e,t="asc"){this.field=e,this.dir=t}}function Sx(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Ar{constructor(e,t){this.comparator=e,this.root=t||ii.EMPTY}insert(e,t){return new Ar(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ii.BLACK,null,null))}remove(e){return new Ar(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ii.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ty(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ty(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ty(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ty(this.root,e,this.comparator,!0)}}class Ty{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ii{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??ii.RED,this.left=i??ii.EMPTY,this.right=a??ii.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new ii(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===a?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ii.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return ii.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ii.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ii.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Xe();const e=this.left.check();if(e!==this.right.check())throw Xe();return e+(this.isRed()?0:1)}}ii.EMPTY=null,ii.RED=!0,ii.BLACK=!1,ii.EMPTY=new class{constructor(){this.size=0}get key(){throw Xe()}get value(){throw Xe()}get color(){throw Xe()}get left(){throw Xe()}get right(){throw Xe()}copy(n,e,t,r,i){return this}insert(n,e,t){return new ii(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class En{constructor(e){this.comparator=e,this.data=new Ar(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ax(this.data.getIterator())}getIteratorFrom(e){return new Ax(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof En)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new En(this.comparator);return t.data=e,t}}class Ax{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Pi(n){return n.hasNext()?n.getNext():void 0}class Ji{constructor(e){this.fields=e,e.sort(Qn.comparator)}static empty(){return new Ji([])}unionWith(e){let t=new En(Qn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ji(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Vc(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class yi{constructor(e){this.value=e}static empty(){return new yi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Cy(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zh(t)}setAll(e){let t=Qn.emptyPath(),r={},i=[];e.forEach((l,h)=>{if(!t.isImmediateParentOf(h)){const _=this.getFieldsMap(t);this.applyChanges(_,r,i),r={},i=[],t=h.popLast()}l?r[h.lastSegment()]=Zh(l):i.push(h.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());Cy(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ga(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Cy(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){$c(t,(i,a)=>e[i]=a);for(const i of r)delete e[i]}clone(){return new yi(Zh(this.value))}}function Mx(n){const e=[];return $c(n.fields,(t,r)=>{const i=new Qn([t]);if(Cy(r)){const a=Mx(r.mapValue).fields;if(0===a.length)e.push(i);else for(const l of a)e.push(i.child(l))}else e.push(i)}),new Ji(e)}class Yt{constructor(e,t,r,i,a,l,h){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=l,this.documentState=h}static newInvalidDocument(e){return new Yt(e,0,vt.min(),vt.min(),vt.min(),yi.empty(),0)}static newFoundDocument(e,t,r,i){return new Yt(e,1,t,vt.min(),r,i,0)}static newNoDocument(e,t){return new Yt(e,2,t,vt.min(),vt.min(),yi.empty(),0)}static newUnknownDocument(e,t){return new Yt(e,3,t,vt.min(),vt.min(),yi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(vt.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=vt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Yt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Yt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class xx{constructor(e,t=null,r=[],i=[],a=null,l=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=l,this.endAt=h,this.ft=null}}function hg(n,e=null,t=[],r=[],i=null,a=null,l=null){return new xx(n,e,t,r,i,a,l)}function Zc(n){const e=Ze(n);if(null===e.ft){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>YD(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),qh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>qc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>qc(r)).join(",")),e.ft=t}return e.ft}function fg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Sx(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!bE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!wx(n.startAt,e.startAt)&&wx(n.endAt,e.endAt)}function Yh(n){return Ge.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function pg(n,e){return n.filters.filter(t=>t instanceof cn&&t.field.isEqual(e))}function TE(n,e,t){let r=Ey,i=!0;for(const a of pg(n,e)){let l=Ey,h=!0;switch(a.op){case"<":case"<=":l=GD(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,h=!1;break;case"!=":case"not-in":l=Ey}qD({value:r,inclusive:i},{value:l,inclusive:h})<0&&(r=l,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];qD({value:r,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}function JD(n,e,t){let r=zc,i=!0;for(const a of pg(n,e)){let l=zc,h=!0;switch(a.op){case">=":case">":l=zD(a.value),h=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,h=!1;break;case"!=":case"not-in":l=zc}WD({value:r,inclusive:i},{value:l,inclusive:h})>0&&(r=l,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];WD({value:r,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}class ma{constructor(e,t=null,r=[],i=[],a=null,l="F",h=null,_=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=l,this.startAt=h,this.endAt=_,this.dt=null,this._t=null}}function SE(n,e,t,r,i,a,l,h){return new ma(n,e,t,r,i,a,l,h)}function Kc(n){return new ma(n)}function AE(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function ME(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function gg(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function xE(n){return null!==n.collectionGroup}function cu(n){const e=Ze(n);if(null===e.dt){e.dt=[];const t=gg(e),r=ME(e);if(null!==t&&null===r)t.isKeyField()||e.dt.push(new Kh(t)),e.dt.push(new Kh(Qn.keyField(),"asc"));else{let i=!1;for(const a of e.explicitOrderBy)e.dt.push(a),a.field.isKeyField()&&(i=!0);if(!i){const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.dt.push(new Kh(Qn.keyField(),a))}}}return e.dt}function vr(n){const e=Ze(n);if(!e._t)if("F"===e.limitType)e._t=hg(e.path,e.collectionGroup,cu(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const a of cu(e))t.push(new Kh(a.field,"desc"===a.dir?"asc":"desc"));const r=e.endAt?new Wc(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Wc(e.startAt.position,e.startAt.inclusive):null;e._t=hg(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e._t}function Sy(n,e){e.getFirstInequalityField(),gg(n);const t=n.filters.concat([e]);return new ma(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Qh(n,e,t){return new ma(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Yc(n,e){return fg(vr(n),vr(e))&&n.limitType===e.limitType}function eT(n){return`${Zc(vr(n))}|lt:${n.limitType}`}function tT(n){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(r=>DE(r)).join(", ")}]`),qh(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(r=>{return`${(i=r).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>qc(r)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>qc(r)).join(",")),`Target(${t})`}(vr(n))}; limitType=${n.limitType})`}function Ay(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):Ge.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of cu(t))if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,a,l){const h=CE(i,a,l);return i.inclusive?h<=0:h<0}(t.startAt,cu(t),r)||t.endAt&&!function(i,a,l){const h=CE(i,a,l);return i.inclusive?h>=0:h>0}(t.endAt,cu(t),r)));var t,r}function nT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function rT(n){return(e,t)=>{let r=!1;for(const i of cu(n)){const a=Rx(i,e,t);if(0!==a)return a;r=r||i.field.isKeyField()}return 0}}function Rx(n,e,t){const r=n.field.isKeyField()?Ge.comparator(e.key,t.key):function(i,a,l){const h=a.data.field(i),_=l.data.field(i);return null!==h&&null!==_?yl(h,_):Xe()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Xe()}}function iT(n,e){if(n.wt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ag(e)?"-0":e}}function RE(n){return{integerValue:""+n}}function Nx(n,e){return ug(e)?RE(e):iT(n,e)}class mg{constructor(){this._=void 0}}function Ox(n,e,t){return n instanceof wl?function(r,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(a.fields.__previous_value__=i),{mapValue:a}}(t,e):n instanceof El?NE(n,e):n instanceof Qc?OE(n,e):function(r,i){const a=Px(r,i),l=Jc(a)+Jc(r.gt);return Iy(a)&&Iy(r.gt)?RE(l):iT(r.yt,l)}(n,e)}function sT(n,e,t){return n instanceof El?NE(n,e):n instanceof Qc?OE(n,e):t}function Px(n,e){return n instanceof Xc?Iy(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class wl extends mg{}class El extends mg{constructor(e){super(),this.elements=e}}function NE(n,e){const t=_g(e);for(const r of n.elements)t.some(i=>ga(i,r))||t.push(r);return{arrayValue:{values:t}}}class Qc extends mg{constructor(e){super(),this.elements=e}}function OE(n,e){let t=_g(e);for(const r of n.elements)t=t.filter(i=>!ga(i,r));return{arrayValue:{values:t}}}class Xc extends mg{constructor(e,t){super(),this.yt=e,this.gt=t}}function Jc(n){return cr(n.integerValue||n.doubleValue)}function _g(n){return cg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Xh{constructor(e,t){this.field=e,this.transform=t}}class kx{constructor(e,t){this.version=e,this.transformResults=t}}class Xn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Xn}static exists(e){return new Xn(void 0,e)}static updateTime(e){return new Xn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function PE(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class yg{}function aT(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new vg(n.key,Xn.none()):new ed(n.key,n.data,Xn.none());{const t=n.data,r=yi.empty();let i=new En(Qn.comparator);for(let a of e.fields)if(!i.has(a)){let l=t.field(a);null===l&&a.length>1&&(a=a.popLast(),l=t.field(a)),null===l?r.delete(a):r.set(a,l),i=i.add(a)}return new du(n.key,r,new Ji(i.toArray()),Xn.none())}}function Fx(n,e,t){n instanceof ed?function(r,i,a){const l=r.value.clone(),h=lT(r.fieldTransforms,i,a.transformResults);l.setAll(h),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof du?function(r,i,a){if(!PE(r.precondition,i))return void i.convertToUnknownDocument(a.version);const l=lT(r.fieldTransforms,i,a.transformResults),h=i.data;h.setAll(uT(r)),h.setAll(l),i.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function My(n,e,t,r){return n instanceof ed?function(i,a,l,h){if(!PE(i.precondition,a))return l;const _=i.value.clone(),w=Vx(i.fieldTransforms,h,a);return _.setAll(w),a.convertToFoundDocument(a.version,_).setHasLocalMutations(),null}(n,e,t,r):n instanceof du?function(i,a,l,h){if(!PE(i.precondition,a))return l;const _=Vx(i.fieldTransforms,h,a),w=a.data;return w.setAll(uT(i)),w.setAll(_),a.convertToFoundDocument(a.version,w).setHasLocalMutations(),null===l?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(D=>D.field))}(n,e,t,r):(l=t,PE(n.precondition,a=e)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l);var a,l}function sk(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=Px(r.transform,i||null);null!=a&&(null===t&&(t=yi.empty()),t.set(r.field,a))}return t||null}function Lx(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&Vc(t,r,(i,a)=>function oT(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof El&&r instanceof El||t instanceof Qc&&r instanceof Qc?Vc(t.elements,r.elements,ga):t instanceof Xc&&r instanceof Xc?ga(t.gt,r.gt):t instanceof wl&&r instanceof wl);var t,r}(i,a))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class ed extends yg{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class du extends yg{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function uT(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function lT(n,e,t){const r=new Map;gt(n.length===t.length);for(let i=0;i<t.length;i++){const a=n[i],l=a.transform,h=e.data.field(a.field);r.set(a.field,sT(l,h,t[i]))}return r}function Vx(n,e,t){const r=new Map;for(const i of n){const a=i.transform,l=t.data.field(i.field);r.set(i.field,Ox(a,l,e))}return r}class vg extends yg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class cT extends yg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class ok{constructor(e){this.count=e}}var Zr,hn;function wg(n){switch(n){default:return Xe();case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0}}function dT(n){if(void 0===n)return Sr("GRPC error has no .code"),ue.UNKNOWN;switch(n){case Zr.OK:return ue.OK;case Zr.CANCELLED:return ue.CANCELLED;case Zr.UNKNOWN:return ue.UNKNOWN;case Zr.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case Zr.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case Zr.INTERNAL:return ue.INTERNAL;case Zr.UNAVAILABLE:return ue.UNAVAILABLE;case Zr.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case Zr.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case Zr.NOT_FOUND:return ue.NOT_FOUND;case Zr.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case Zr.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case Zr.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case Zr.ABORTED:return ue.ABORTED;case Zr.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case Zr.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case Zr.DATA_LOSS:return ue.DATA_LOSS;default:return Xe()}}(hn=Zr||(Zr={}))[hn.OK=0]="OK",hn[hn.CANCELLED=1]="CANCELLED",hn[hn.UNKNOWN=2]="UNKNOWN",hn[hn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",hn[hn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",hn[hn.NOT_FOUND=5]="NOT_FOUND",hn[hn.ALREADY_EXISTS=6]="ALREADY_EXISTS",hn[hn.PERMISSION_DENIED=7]="PERMISSION_DENIED",hn[hn.UNAUTHENTICATED=16]="UNAUTHENTICATED",hn[hn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",hn[hn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",hn[hn.ABORTED=10]="ABORTED",hn[hn.OUT_OF_RANGE=11]="OUT_OF_RANGE",hn[hn.UNIMPLEMENTED=12]="UNIMPLEMENTED",hn[hn.INTERNAL=13]="INTERNAL",hn[hn.UNAVAILABLE=14]="UNAVAILABLE",hn[hn.DATA_LOSS=15]="DATA_LOSS";class Il{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,a]of r)if(this.equalsFn(i,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){$c(this.inner,(t,r)=>{for(const[i,a]of r)e(i,a)})}isEmpty(){return wy(this.inner)}size(){return this.innerSize}}const hT=new Ar(Ge.comparator);function Vr(){return hT}const kE=new Ar(Ge.comparator);function td(...n){let e=kE;for(const t of n)e=e.insert(t.key,t);return e}function xy(n){let e=kE;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function _a(){return nd()}function Ry(){return nd()}function nd(){return new Il(n=>n.toString(),(n,e)=>n.isEqual(e))}const Ny=new Ar(Ge.comparator),ak=new En(Ge.comparator);function qt(...n){let e=ak;for(const t of n)e=e.add(t);return e}const uk=new En(Ft);function Eg(){return uk}class Ig{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Cg.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Ig(vt.min(),i,Eg(),Vr(),qt())}}class Cg{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Cg(r,t,qt(),qt(),qt())}}class Oy{constructor(e,t,r,i){this.It=e,this.removedTargetIds=t,this.key=r,this.Tt=i}}class fT{constructor(e,t){this.targetId=e,this.Et=t}}class FE{constructor(e,t,r=ri.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class LE{constructor(){this.At=0,this.Rt=mT(),this.bt=ri.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}get current(){return this.Pt}get resumeToken(){return this.bt}get Vt(){return 0!==this.At}get St(){return this.vt}Dt(e){e.approximateByteSize()>0&&(this.vt=!0,this.bt=e)}Ct(){let e=qt(),t=qt(),r=qt();return this.Rt.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Xe()}}),new Cg(this.bt,this.Pt,e,t,r)}xt(){this.vt=!1,this.Rt=mT()}Nt(e,t){this.vt=!0,this.Rt=this.Rt.insert(e,t)}kt(e){this.vt=!0,this.Rt=this.Rt.remove(e)}Ot(){this.At+=1}Mt(){this.At-=1}Ft(){this.vt=!0,this.Pt=!0}}class pT{constructor(e){this.$t=e,this.Bt=new Map,this.Lt=Vr(),this.qt=gT(),this.Ut=new En(Ft)}Kt(e){for(const t of e.It)e.Tt&&e.Tt.isFoundDocument()?this.Gt(t,e.Tt):this.Qt(t,e.key,e.Tt);for(const t of e.removedTargetIds)this.Qt(t,e.key,e.Tt)}jt(e){this.forEachTarget(e,t=>{const r=this.Wt(t);switch(e.state){case 0:this.zt(t)&&r.Dt(e.resumeToken);break;case 1:r.Mt(),r.Vt||r.xt(),r.Dt(e.resumeToken);break;case 2:r.Mt(),r.Vt||this.removeTarget(t);break;case 3:this.zt(t)&&(r.Ft(),r.Dt(e.resumeToken));break;case 4:this.zt(t)&&(this.Ht(t),r.Dt(e.resumeToken));break;default:Xe()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Bt.forEach((r,i)=>{this.zt(i)&&t(i)})}Jt(e){const t=e.targetId,r=e.Et.count,i=this.Yt(t);if(i){const a=i.target;if(Yh(a))if(0===r){const l=new Ge(a.path);this.Qt(t,l,Yt.newNoDocument(l,vt.min()))}else gt(1===r);else this.Xt(t)!==r&&(this.Ht(t),this.Ut=this.Ut.add(t))}}Zt(e){const t=new Map;this.Bt.forEach((a,l)=>{const h=this.Yt(l);if(h){if(a.current&&Yh(h.target)){const _=new Ge(h.target.path);null!==this.Lt.get(_)||this.te(l,_)||this.Qt(l,_,Yt.newNoDocument(_,e))}a.St&&(t.set(l,a.Ct()),a.xt())}});let r=qt();this.qt.forEach((a,l)=>{let h=!0;l.forEachWhile(_=>{const w=this.Yt(_);return!w||2===w.purpose||(h=!1,!1)}),h&&(r=r.add(a))}),this.Lt.forEach((a,l)=>l.setReadTime(e));const i=new Ig(e,t,this.Ut,this.Lt,r);return this.Lt=Vr(),this.qt=gT(),this.Ut=new En(Ft),i}Gt(e,t){if(!this.zt(e))return;const r=this.te(e,t.key)?2:0;this.Wt(e).Nt(t.key,r),this.Lt=this.Lt.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ee(t.key).add(e))}Qt(e,t,r){if(!this.zt(e))return;const i=this.Wt(e);this.te(e,t)?i.Nt(t,1):i.kt(t),this.qt=this.qt.insert(t,this.ee(t).delete(e)),r&&(this.Lt=this.Lt.insert(t,r))}removeTarget(e){this.Bt.delete(e)}Xt(e){const t=this.Wt(e).Ct();return this.$t.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ot(e){this.Wt(e).Ot()}Wt(e){let t=this.Bt.get(e);return t||(t=new LE,this.Bt.set(e,t)),t}ee(e){let t=this.qt.get(e);return t||(t=new En(Ft),this.qt=this.qt.insert(e,t)),t}zt(e){const t=null!==this.Yt(e);return t||Pe("WatchChangeAggregator","Detected inactive target",e),t}Yt(e){const t=this.Bt.get(e);return t&&t.Vt?null:this.$t.ne(e)}Ht(e){this.Bt.set(e,new LE),this.$t.getRemoteKeysForTarget(e).forEach(t=>{this.Qt(e,t,null)})}te(e,t){return this.$t.getRemoteKeysForTarget(e).has(t)}}function gT(){return new Ar(Ge.comparator)}function mT(){return new Ar(Ge.comparator)}const _T={asc:"ASCENDING",desc:"DESCENDING"},VE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lk={and:"AND",or:"OR"};class yT{constructor(e,t){this.databaseId=e,this.wt=t}}function Cl(n,e){return n.wt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vT(n,e){return n.wt?e.toBase64():e.toUint8Array()}function Ux(n,e){return Cl(n,e.toTimestamp())}function Ur(n){return gt(!!n),vt.fromTimestamp(function(e){const t=_l(e);return new Yn(t.seconds,t.nanos)}(n))}function wT(n,e){return(t=n,new an(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function ET(n){const e=an.fromString(n);return gt($x(e)),e}function bg(n,e){return wT(n.databaseId,e.path)}function ya(n,e){const t=ET(e);if(t.get(1)!==n.databaseId.projectId)throw new Re(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Re(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ge(Bx(t))}function UE(n,e){return wT(n.databaseId,e)}function BE(n){const e=ET(n);return 4===e.length?an.emptyPath():Bx(e)}function Jh(n){return new an(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Bx(n){return gt(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function IT(n,e,t){return{name:bg(n,e),fields:t.value.mapValue.fields}}function Py(n,e,t){const r=ya(n,e.name),i=Ur(e.updateTime),a=e.createTime?Ur(e.createTime):vt.min(),l=new yi({mapValue:{fields:e.fields}}),h=Yt.newFoundDocument(r,i,a,l);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function Dg(n,e){let t;if(e instanceof ed)t={update:IT(n,e.key,e.value)};else if(e instanceof vg)t={delete:bg(n,e.key)};else if(e instanceof du)t={update:IT(n,e.key,e.data),updateMask:hk(e.fieldMask)};else{if(!(e instanceof cT))return Xe();t={verify:bg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof wl)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof El)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Qc)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Xc)return{fieldPath:a.field.canonicalString(),increment:l.gt};throw Xe()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:Ux(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:Xe()),t;var i}function Tg(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?Xn.updateTime(Ur(i.updateTime)):void 0!==i.exists?Xn.exists(i.exists):Xn.none():Xn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let h=null;"setToServerValue"in l?(gt("REQUEST_TIME"===l.setToServerValue),h=new wl):"appendMissingElements"in l?h=new El(l.appendMissingElements.values||[]):"removeAllFromArray"in l?h=new Qc(l.removeAllFromArray.values||[]):"increment"in l?h=new Xc(a,l.increment):Xe();const _=Qn.fromServerFormat(l.fieldPath);return new Xh(_,h)}(n,i)):[];var i;if(e.update){const i=ya(n,e.update.name),a=new yi({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=new Ji((e.updateMask.fieldPaths||[]).map(w=>Qn.fromServerFormat(w)));return new du(i,a,l,t,r)}return new ed(i,a,t,r)}if(e.delete){const i=ya(n,e.delete);return new vg(i,t)}if(e.verify){const i=ya(n,e.verify);return new cT(i,t)}return Xe()}function DT(n,e){return{documents:[UE(n,e.path)]}}function ky(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=UE(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=UE(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(_){if(0!==_.length)return ST(Sn.create(_,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const a=function(_){if(0!==_.length)return _.map(w=>{return{field:Sg((D=w).field),direction:Fy(D.dir)};var D})}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const l=(w=e.limit,n.wt||qh(w)?w:{value:w});var w,h,_;return null!==l&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt={before:(h=e.startAt).inclusive,values:h.position}),e.endAt&&(t.structuredQuery.endAt={before:!(_=e.endAt).inclusive,values:_.position}),t}function jE(n){let e=BE(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){gt(1===r);const D=t.from[0];D.allDescendants?i=D.collectionId:e=e.child(D.collectionId)}let a=[];t.where&&(a=function(D){const A=TT(D);return A instanceof Sn&&KD(A)?A.getFilters():[A]}(t.where));let l=[];t.orderBy&&(l=t.orderBy.map(D=>{return new Kh(Ag((A=D).field),function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction));var A}));let h=null;t.limit&&(h=function(D){let A;return A="object"==typeof D?D.value:D,qh(A)?null:A}(t.limit));let _=null;var D;t.startAt&&(_=new Wc((D=t.startAt).values||[],!!D.before));let w=null;return t.endAt&&(w=function(D){return new Wc(D.values||[],!D.before)}(t.endAt)),SE(e,i,l,a,h,"F",_,w)}function TT(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ag(e.unaryFilter.field);return cn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const r=Ag(e.unaryFilter.field);return cn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ag(e.unaryFilter.field);return cn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Ag(e.unaryFilter.field);return cn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Xe()}}(n):void 0!==n.fieldFilter?cn.create(Ag((e=n).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Xe()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return Sn.create(e.compositeFilter.filters.map(t=>TT(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Xe()}}(e.compositeFilter.op))}(n):Xe();var e}function Fy(n){return _T[n]}function dk(n){return VE[n]}function Hx(n){return lk[n]}function Sg(n){return{fieldPath:n.canonicalString()}}function Ag(n){return Qn.fromServerFormat(n.fieldPath)}function ST(n){return n instanceof cn?function(e){if("=="===e.op){if(EE(e.value))return{unaryFilter:{field:Sg(e.field),op:"IS_NAN"}};if($D(e.value))return{unaryFilter:{field:Sg(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(EE(e.value))return{unaryFilter:{field:Sg(e.field),op:"IS_NOT_NAN"}};if($D(e.value))return{unaryFilter:{field:Sg(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Sg(e.field),op:dk(e.op),value:e.value}}}(n):n instanceof Sn?function(e){const t=e.getFilters().map(r=>ST(r));return 1===t.length?t[0]:{compositeFilter:{op:Hx(e.op),filters:t}}}(n):Xe()}function hk(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function $x(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function vs(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Gx(e)),e=fk(n.get(t),e);return Gx(e)}function fk(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=a}}return t}function Gx(n){return n+"\x01\x01"}function va(n){const e=n.length;if(gt(e>=2),2===e)return gt("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),an.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const l=n.indexOf("\x01",a);switch((l<0||l>t)&&Xe(),n.charAt(l+1)){case"\x01":const h=n.substring(a,l);let _;0===i.length?_=h:(i+=h,_=i,i=""),r.push(_);break;case"\x10":i+=n.substring(a,l),i+="\0";break;case"\x11":i+=n.substring(a,l+1);break;default:Xe()}a=l+2}return new an(r)}const zx=["userId","batchId"];function HE(n,e){return[n,vs(e)]}function qx(n,e,t){return[n,vs(e),t]}const pk={},gk=["prefixPath","collectionGroup","readTime","documentId"],Wx=["prefixPath","collectionGroup","documentId"],mk=["collectionGroup","readTime","prefixPath","documentId"],s=["canonicalId","targetId"],o=["targetId","path"],u=["path","targetId"],c=["collectionId","parent"],d=["indexId","uid"],g=["uid","sequenceNumber"],y=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],I=["indexId","uid","orderedDocumentKey"],C=["userId","collectionPath","documentId"],S=["userId","collectionPath","largestBatchId"],R=["userId","collectionGroup","largestBatchId"],L=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],W=[...L,"documentOverlays"],Y=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],we=Y,ke=[...we,"indexConfiguration","indexState","indexEntries"];class qe extends pE{constructor(e,t){super(),this.se=e,this.currentSequenceNumber=t}}function We(n,e){const t=Ze(n);return Oi.M(t.se,e)}class De{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&Fx(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=My(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=My(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Ry();return this.mutations.forEach(i=>{const a=e.get(i.key),l=a.overlayedDocument;let h=this.applyToLocalView(l,a.mutatedFields);h=t.has(i.key)?null:h;const _=aT(l,h);null!==_&&r.set(i.key,_),l.isValidDocument()||l.convertToNoDocument(vt.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),qt())}isEqual(e){return this.batchId===e.batchId&&Vc(this.mutations,e.mutations,(t,r)=>Lx(t,r))&&Vc(this.baseMutations,e.baseMutations,(t,r)=>Lx(t,r))}}class xt{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){gt(e.mutations.length===r.length);let i=Ny;const a=e.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,r[l].version);return new xt(e,t,r,i)}}class Qt{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class $t{constructor(e,t,r,i,a=vt.min(),l=vt.min(),h=ri.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h}withSequenceNumber(e){return new $t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new $t(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new $t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class vi{constructor(e){this.ie=e}}function AT(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Vy(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:bg(i=n.ie,(a=e).key),fields:a.data.value.mapValue.fields,updateTime:Cl(i,a.version.toTimestamp()),createTime:Cl(i,a.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Mg(e.version)};else{if(!e.isUnknownDocument())return Xe();r.unknownDocument={path:t.path.toArray(),version:Mg(e.version)}}var i,a;return r}function Vy(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Mg(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function xg(n){const e=new Yn(n.seconds,n.nanoseconds);return vt.fromTimestamp(e)}function Rg(n,e){const t=(e.baseMutations||[]).map(a=>Tg(n.ie,a));for(let a=0;a<e.mutations.length-1;++a)a+1<e.mutations.length&&void 0!==e.mutations[a+1].transform&&(e.mutations[a].updateTransforms=e.mutations[a+1].transform.fieldTransforms,e.mutations.splice(a+1,1),++a);const r=e.mutations.map(a=>Tg(n.ie,a)),i=Yn.fromMillis(e.localWriteTimeMs);return new De(e.batchId,i,t,r)}function $E(n){const e=xg(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?xg(n.lastLimboFreeSnapshotVersion):vt.min();let r;var i;return void 0!==n.query.documents?(gt(1===(i=n.query).documents.length),r=vr(Kc(BE(i.documents[0])))):r=vr(jE(n.query)),new $t(r,n.targetId,0,n.lastListenSequenceNumber,e,t,ri.fromBase64String(n.resumeToken))}function _k(n,e){const t=Mg(e.snapshotVersion),r=Mg(e.lastLimboFreeSnapshotVersion);let i;i=Yh(e.target)?DT(n.ie,e.target):ky(n.ie,e.target);const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Zc(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Zx(n){const e=jE({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Qh(e,e.limit,"L"):e}function Kx(n,e){return new Qt(e.largestBatchId,Tg(n.ie,e.overlayMutation))}function yk(n,e){const t=e.path.lastSegment();return[n,vs(e.path.popLast()),t]}function vk(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Mg(r.readTime),documentKey:vs(r.documentKey.path),largestBatchId:r.largestBatchId}}class NU{getBundleMetadata(e,t){return wk(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:xg(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return wk(e).put({bundleId:(r=t).id,createTime:Mg(Ur(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return Ek(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:Zx(i.bundledQuery),readTime:xg(i.readTime)};var i})}saveNamedQuery(e,t){return Ek(e).put({name:(r=t).name,readTime:Mg(Ur(r.readTime)),bundledQuery:r.bundledQuery});var r}}function wk(n){return We(n,"bundles")}function Ek(n){return We(n,"namedQueries")}class MT{constructor(e,t){this.yt=e,this.userId=t}static re(e,t){return new MT(e,t.uid||"")}getOverlay(e,t){return GE(e).get(yk(this.userId,t)).next(r=>r?Kx(this.yt,r):null)}getOverlays(e,t){const r=_a();return oe.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((a,l)=>{const h=new Qt(t,l);i.push(this.oe(e,h))}),oe.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(l=>i.add(vs(l.getCollectionPath())));const a=[];return i.forEach(l=>{const h=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(GE(e).Y("collectionPathOverlayIndex",h))}),oe.waitFor(a)}getOverlaysForCollection(e,t,r){const i=_a(),a=vs(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return GE(e).W("collectionPathOverlayIndex",l).next(h=>{for(const _ of h){const w=Kx(this.yt,_);i.set(w.getKey(),w)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const a=_a();let l;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return GE(e).Z({index:"collectionGroupOverlayIndex",range:h},(_,w,D)=>{const A=Kx(this.yt,w);a.size()<i||A.largestBatchId===l?(a.set(A.getKey(),A),l=A.largestBatchId):D.done()}).next(()=>a)}oe(e,t){return GE(e).put(function(r,i,a){const[l,h,_]=yk(i,a.mutation.key);return{userId:i,collectionPath:h,documentId:_,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Dg(r.ie,a.mutation)}}(this.yt,this.userId,t))}}function GE(n){return We(n,"documentOverlays")}class Ng{constructor(){}ue(e,t){this.ce(e,t),t.ae()}ce(e,t){if("nullValue"in e)this.he(t,5);else if("booleanValue"in e)this.he(t,10),t.le(e.booleanValue?1:0);else if("integerValue"in e)this.he(t,15),t.le(cr(e.integerValue));else if("doubleValue"in e){const r=cr(e.doubleValue);isNaN(r)?this.he(t,13):(this.he(t,15),ag(r)?t.le(0):t.le(r))}else if("timestampValue"in e){const r=e.timestampValue;this.he(t,20),"string"==typeof r?t.fe(r):(t.fe(`${r.seconds||""}`),t.le(r.nanos||0))}else if("stringValue"in e)this.de(e.stringValue,t),this._e(t);else if("bytesValue"in e)this.he(t,30),t.we(uo(e.bytesValue)),this._e(t);else if("referenceValue"in e)this.me(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.he(t,45),t.le(r.latitude||0),t.le(r.longitude||0)}else"mapValue"in e?IE(e)?this.he(t,Number.MAX_SAFE_INTEGER):(this.ge(e.mapValue,t),this._e(t)):"arrayValue"in e?(this.ye(e.arrayValue,t),this._e(t)):Xe()}de(e,t){this.he(t,25),this.pe(e,t)}pe(e,t){t.fe(e)}ge(e,t){const r=e.fields||{};this.he(t,55);for(const i of Object.keys(r))this.de(i,t),this.ce(r[i],t)}ye(e,t){const r=e.values||[];this.he(t,50);for(const i of r)this.ce(i,t)}me(e,t){this.he(t,37),Ge.fromName(e).path.forEach(r=>{this.he(t,60),this.pe(r,t)})}he(e,t){e.le(t)}_e(e){e.le(2)}}function OU(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Ik(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const a=OU(255&t[i]);if(r+=a,8!==a)break}return r}(n);return Math.ceil(e/8)}Ng.Ie=new Ng;class PU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Te(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ee(r.value),r=t.next();this.Ae()}Re(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.be(r.value),r=t.next();this.Pe()}ve(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ee(r);else if(r<2048)this.Ee(960|r>>>6),this.Ee(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ee(480|r>>>12),this.Ee(128|63&r>>>6),this.Ee(128|63&r);else{const i=t.codePointAt(0);this.Ee(240|i>>>18),this.Ee(128|63&i>>>12),this.Ee(128|63&i>>>6),this.Ee(128|63&i)}}this.Ae()}Ve(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.be(r);else if(r<2048)this.be(960|r>>>6),this.be(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.be(480|r>>>12),this.be(128|63&r>>>6),this.be(128|63&r);else{const i=t.codePointAt(0);this.be(240|i>>>18),this.be(128|63&i>>>12),this.be(128|63&i>>>6),this.be(128|63&i)}}this.Pe()}Se(e){const t=this.De(e),r=Ik(t);this.Ce(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}xe(e){const t=this.De(e),r=Ik(t);this.Ce(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Ne(){this.ke(255),this.ke(255)}Oe(){this.Me(255),this.Me(255)}reset(){this.position=0}seed(e){this.Ce(e.length),this.buffer.set(e,this.position),this.position+=e.length}Fe(){return this.buffer.slice(0,this.position)}De(e){const t=function(i){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,i,!1),new Uint8Array(a.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ee(e){const t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(t)}be(e){const t=255&e;0===t?(this.Me(0),this.Me(255)):255===t?(this.Me(255),this.Me(0)):this.Me(e)}Ae(){this.ke(0),this.ke(1)}Pe(){this.Me(0),this.Me(1)}ke(e){this.Ce(1),this.buffer[this.position++]=e}Me(e){this.Ce(1),this.buffer[this.position++]=~e}Ce(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class kU{constructor(e){this.$e=e}we(e){this.$e.Te(e)}fe(e){this.$e.ve(e)}le(e){this.$e.Se(e)}ae(){this.$e.Ne()}}class FU{constructor(e){this.$e=e}we(e){this.$e.Re(e)}fe(e){this.$e.Ve(e)}le(e){this.$e.xe(e)}ae(){this.$e.Oe()}}class zE{constructor(){this.$e=new PU,this.Be=new kU(this.$e),this.Le=new FU(this.$e)}seed(e){this.$e.seed(e)}qe(e){return 0===e?this.Be:this.Le}Fe(){return this.$e.Fe()}reset(){this.$e.reset()}}class Og{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ue(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Og(this.indexId,this.documentKey,this.arrayValue,r)}}function ef(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=Ck(n.arrayValue,e.arrayValue),0!==t?t:(t=Ck(n.directionalValue,e.directionalValue),0!==t?t:Ge.comparator(n.documentKey,e.documentKey)))}function Ck(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class LU{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ke=e.orderBy,this.Ge=[];for(const t of e.filters){const r=t;r.isInequality()?this.Qe=r:this.Ge.push(r)}}je(e){gt(e.collectionGroup===this.collectionId);const t=lE(e);if(void 0!==t&&!this.We(t))return!1;const r=Bc(e);let i=0,a=0;for(;i<r.length&&this.We(r[i]);++i);if(i===r.length)return!0;if(void 0!==this.Qe){const l=r[i];if(!this.ze(this.Qe,l)||!this.He(this.Ke[a++],l))return!1;++i}for(;i<r.length;++i)if(a>=this.Ke.length||!this.He(this.Ke[a++],r[i]))return!1;return!0}We(e){for(const t of this.Ge)if(this.ze(t,e))return!0;return!1}ze(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}He(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function bk(n){var e,t;if(gt(n instanceof cn||n instanceof Sn),n instanceof cn){if(n instanceof QD){const i=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(a=>cn.create(n.field,"==",a)))||[];return Sn.create(i,"or")}return n}const r=n.filters.map(i=>bk(i));return Sn.create(r,n.op)}function VU(n){if(0===n.getFilters().length)return[];const e=Xx(bk(n));return gt(Dk(e)),Yx(e)||Qx(e)?[e]:e.getFilters()}function Yx(n){return n instanceof cn}function Qx(n){return n instanceof Sn&&KD(n)}function Dk(n){return Yx(n)||Qx(n)||function(e){if(e instanceof Sn&&ZD(e)){for(const t of e.getFilters())if(!Yx(t)&&!Qx(t))return!1;return!0}return!1}(n)}function Xx(n){if(gt(n instanceof cn||n instanceof Sn),n instanceof cn)return n;if(1===n.filters.length)return Xx(n.filters[0]);const e=n.filters.map(r=>Xx(r));let t=Sn.create(e,n.op);return t=xT(t),Dk(t)?t:(gt(t instanceof Sn),gt(dg(t)),gt(t.filters.length>1),t.filters.reduce((r,i)=>Jx(r,i)))}function Jx(n,e){let t;return gt(n instanceof cn||n instanceof Sn),gt(e instanceof cn||e instanceof Sn),t=n instanceof cn?e instanceof cn?Sn.create([n,e],"and"):Tk(n,e):e instanceof cn?Tk(e,n):function(r,i){if(gt(r.filters.length>0&&i.filters.length>0),dg(r)&&dg(i))return by(r,i.getFilters());const a=ZD(r)?r:i,l=ZD(r)?i:r,h=a.filters.map(_=>Jx(_,l));return Sn.create(h,"or")}(n,e),xT(t)}function Tk(n,e){if(dg(e))return by(e,n.getFilters());{const t=e.filters.map(r=>Jx(n,r));return Sn.create(t,"or")}}function xT(n){if(gt(n instanceof cn||n instanceof Sn),n instanceof cn)return n;const e=n.getFilters();if(1===e.length)return xT(e[0]);if(Ix(n))return n;const t=e.map(i=>xT(i)),r=[];return t.forEach(i=>{i instanceof cn?r.push(i):i instanceof Sn&&(i.op===n.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:Sn.create(r,n.op)}class UU{constructor(){this.Je=new eR}addToCollectionParentIndex(e,t){return this.Je.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.Je.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(ys.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(ys.min())}updateCollectionGroup(e,t,r){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class eR{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new En(an.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new En(an.comparator)).toArray()}}const RT=new Uint8Array(0);class BU{constructor(e,t){this.user=e,this.databaseId=t,this.Ye=new eR,this.Xe=new Il(r=>Zc(r),(r,i)=>fg(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Ye.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.Ye.add(t)});const a={collectionId:r,parent:vs(i)};return Sk(e).put(a)}return oe.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[uE(t),""],!1,!0);return Sk(e).W(i).next(a=>{for(const l of a){if(l.collectionId!==t)break;r.push(va(l.parent))}return r})}addFieldIndex(e,t){const r=NT(e),i={indexId:(l=t).indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])};var l;delete i.indexId;const a=r.add(i);if(t.indexState){const l=WE(e);return a.next(h=>{l.put(vk(h,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const r=NT(e),i=WE(e),a=qE(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=qE(e);let i=!0;const a=new Map;return oe.forEach(this.Ze(t),l=>this.tn(e,l).next(h=>{i&&(i=!!h),a.set(l,h)})).next(()=>{if(i){let l=qt();const h=[];return oe.forEach(a,(_,w)=>{var D;Pe("IndexedDbIndexManager",`Using index ${D=_,`id=${D.indexId}|cg=${D.collectionGroup}|f=${D.fields.map(nt=>`${nt.fieldPath}:${nt.kind}`).join(",")}`} to execute ${Zc(t)}`);const A=function(nt,at){const Dt=lE(at);if(void 0===Dt)return null;for(const Lt of pg(nt,Dt.fieldPath))switch(Lt.op){case"array-contains-any":return Lt.value.arrayValue.values||[];case"array-contains":return[Lt.value]}return null}(w,_),O=function(nt,at){const Dt=new Map;for(const Lt of Bc(at))for(const Rr of pg(nt,Lt.fieldPath))switch(Rr.op){case"==":case"in":Dt.set(Lt.fieldPath.canonicalString(),Rr.value);break;case"not-in":case"!=":return Dt.set(Lt.fieldPath.canonicalString(),Rr.value),Array.from(Dt.values())}return null}(w,_),H=function(nt,at){const Dt=[];let Lt=!0;for(const Rr of Bc(at)){const _u=0===Rr.kind?TE(nt,Rr.fieldPath,nt.startAt):JD(nt,Rr.fieldPath,nt.startAt);Dt.push(_u.value),Lt&&(Lt=_u.inclusive)}return new Wc(Dt,Lt)}(w,_),z=function(nt,at){const Dt=[];let Lt=!0;for(const Rr of Bc(at)){const _u=0===Rr.kind?JD(nt,Rr.fieldPath,nt.endAt):TE(nt,Rr.fieldPath,nt.endAt);Dt.push(_u.value),Lt&&(Lt=_u.inclusive)}return new Wc(Dt,Lt)}(w,_),ce=this.en(_,w,H),Te=this.en(_,w,z),ht=this.nn(_,w,O),yt=this.sn(_.indexId,A,ce,H.inclusive,Te,z.inclusive,ht);return oe.forEach(yt,nt=>r.J(nt,t.limit).next(at=>{at.forEach(Dt=>{const Lt=Ge.fromSegments(Dt.documentKey);l.has(Lt)||(l=l.add(Lt),h.push(Lt))})}))}).next(()=>h)}return oe.resolve(null)})}Ze(e){let t=this.Xe.get(e);return t||(t=0===e.filters.length?[e]:VU(Sn.create(e.filters,"and")).map(r=>hg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Xe.set(e,t),t)}sn(e,t,r,i,a,l,h){const _=(null!=t?t.length:1)*Math.max(r.length,a.length),w=_/(null!=t?t.length:1),D=[];for(let A=0;A<_;++A){const O=t?this.rn(t[A/w]):RT,H=this.on(e,O,r[A%w],i),z=this.un(e,O,a[A%w],l),ce=h.map(Te=>this.on(e,O,Te,!0));D.push(...this.createRange(H,z,ce))}return D}on(e,t,r,i){const a=new Og(e,Ge.empty(),t,r);return i?a:a.Ue()}un(e,t,r,i){const a=new Og(e,Ge.empty(),t,r);return i?a.Ue():a}tn(e,t){const r=new LU(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(a=>{let l=null;for(const h of a)r.je(h)&&(!l||h.fields.length>l.fields.length)&&(l=h);return l})}getIndexType(e,t){let r=2;const i=this.Ze(t);return oe.forEach(i,a=>this.tn(e,a).next(l=>{l?0!==r&&l.fields.length<function(h){let _=new En(Qn.comparator),w=!1;for(const D of h.filters)for(const A of D.getFlattenedFilters())A.field.isKeyField()||("array-contains"===A.op||"array-contains-any"===A.op?w=!0:_=_.add(A.field));for(const D of h.orderBy)D.field.isKeyField()||(_=_.add(D.field));return _.size+(w?1:0)}(a)&&(r=1):r=0})).next(()=>null!==t.limit&&i.length>1&&2===r?1:r)}cn(e,t){const r=new zE;for(const i of Bc(e)){const a=t.data.field(i.fieldPath);if(null==a)return null;const l=r.qe(i.kind);Ng.Ie.ue(a,l)}return r.Fe()}rn(e){const t=new zE;return Ng.Ie.ue(e,t.qe(0)),t.Fe()}an(e,t){const r=new zE;return Ng.Ie.ue(vl(this.databaseId,t),r.qe(function(i){const a=Bc(i);return 0===a.length?0:a[a.length-1].kind}(e))),r.Fe()}nn(e,t,r){if(null===r)return[];let i=[];i.push(new zE);let a=0;for(const l of Bc(e)){const h=r[a++];for(const _ of i)if(this.hn(t,l.fieldPath)&&cg(h))i=this.ln(i,l,h);else{const w=_.qe(l.kind);Ng.Ie.ue(h,w)}}return this.fn(i)}en(e,t,r){return this.nn(e,t,r.position)}fn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Fe();return t}ln(e,t,r){const i=[...e],a=[];for(const l of r.arrayValue.values||[])for(const h of i){const _=new zE;_.seed(h.Fe()),Ng.Ie.ue(l,_.qe(t.kind)),a.push(_)}return a}hn(e,t){return!!e.filters.find(r=>r instanceof cn&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=NT(e),i=WE(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(a=>{const l=[];return oe.forEach(a,h=>i.get([h.indexId,this.uid]).next(_=>{l.push(function(w,D){const A=D?new zh(D.sequenceNumber,new ys(xg(D.readTime),new Ge(va(D.documentKey)),D.largestBatchId)):zh.empty(),O=w.fields.map(([H,z])=>new sg(Qn.fromServerFormat(H),z));return new _y(w.indexId,w.collectionGroup,O,A)}(h,_))})).next(()=>l)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==a?a:Ft(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=NT(e),a=WE(e);return this.dn(e).next(l=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(h=>oe.forEach(h,_=>a.put(vk(_.indexId,this.user,l,r)))))}updateIndexEntries(e,t){const r=new Map;return oe.forEach(t,(i,a)=>{const l=r.get(i.collectionGroup);return(l?oe.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),oe.forEach(h,_=>this._n(e,i,_).next(w=>{const D=this.wn(a,_);return w.isEqual(D)?oe.resolve():this.mn(e,a,_,w,D)}))))})}gn(e,t,r,i){return qE(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.an(r,t.key),documentKey:t.key.path.toArray()})}yn(e,t,r,i){return qE(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.an(r,t.key),t.key.path.toArray()])}_n(e,t,r){const i=qE(e);let a=new En(ef);return i.Z({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.an(r,t)])},(l,h)=>{a=a.add(new Og(r.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>a)}wn(e,t){let r=new En(ef);const i=this.cn(t,e);if(null==i)return r;const a=lE(t);if(null!=a){const l=e.data.field(a.fieldPath);if(cg(l))for(const h of l.arrayValue.values||[])r=r.add(new Og(t.indexId,e.key,this.rn(h),i))}else r=r.add(new Og(t.indexId,e.key,RT,i));return r}mn(e,t,r,i,a){Pe("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const l=[];return function(h,_,w,D,A){const O=h.getIterator(),H=_.getIterator();let z=Pi(O),ce=Pi(H);for(;z||ce;){let Te=!1,ht=!1;if(z&&ce){const yt=w(z,ce);yt<0?ht=!0:yt>0&&(Te=!0)}else null!=z?ht=!0:Te=!0;Te?(D(ce),ce=Pi(H)):ht?(A(z),z=Pi(O)):(z=Pi(O),ce=Pi(H))}}(i,a,ef,h=>{l.push(this.gn(e,t,r,h))},h=>{l.push(this.yn(e,t,r,h))}),oe.waitFor(l)}dn(e){let t=1;return WE(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,a)=>{a.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((l,h)=>ef(l,h)).filter((l,h,_)=>!h||0!==ef(l,_[h-1]));const i=[];i.push(e);for(const l of r){const h=ef(l,e),_=ef(l,t);if(0===h)i[0]=e.Ue();else if(h>0&&_<0)i.push(l),i.push(l.Ue());else if(_>0)break}i.push(t);const a=[];for(let l=0;l<i.length;l+=2){if(this.pn(i[l],i[l+1]))return[];a.push(IDBKeyRange.bound([i[l].indexId,this.uid,i[l].arrayValue,i[l].directionalValue,RT,[]],[i[l+1].indexId,this.uid,i[l+1].arrayValue,i[l+1].directionalValue,RT,[]]))}return a}pn(e,t){return ef(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Ak)}getMinOffset(e,t){return oe.mapArray(this.Ze(t),r=>this.tn(e,r).next(i=>i||Xe())).next(Ak)}}function Sk(n){return We(n,"collectionParents")}function qE(n){return We(n,"indexEntries")}function NT(n){return We(n,"indexConfiguration")}function WE(n){return We(n,"indexState")}function Ak(n){gt(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;hE(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ys(e.readTime,e.documentKey,t)}const Mk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class lo{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new lo(e,lo.DEFAULT_COLLECTION_PERCENTILE,lo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function xk(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),a=[],l=IDBKeyRange.only(t.batchId);let h=0;const _=r.Z({range:l},(D,A,O)=>(h++,O.delete()));a.push(_.next(()=>{gt(1===h)}));const w=[];for(const D of t.mutations){const A=qx(e,D.key.path,t.batchId);a.push(i.delete(A)),w.push(D.key)}return oe.waitFor(a).next(()=>w)}function OT(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Xe();e=n.noDocument}return JSON.stringify(e).length}lo.DEFAULT_COLLECTION_PERCENTILE=10,lo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,lo.DEFAULT=new lo(41943040,lo.DEFAULT_COLLECTION_PERCENTILE,lo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),lo.DISABLED=new lo(-1,0,0);class PT{constructor(e,t,r,i){this.userId=e,this.yt=t,this.indexManager=r,this.referenceDelegate=i,this.In={}}static re(e,t,r,i){gt(""!==e.uid);const a=e.isAuthenticated()?e.uid:"";return new PT(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return tf(e).Z({index:"userMutationsIndex",range:r},(i,a,l)=>{t=!1,l.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const a=Uy(e),l=tf(e);return l.add({}).next(h=>{gt("number"==typeof h);const _=new De(h,t,r,i),w=function(O,H,z){const ce=z.baseMutations.map(ht=>Dg(O.ie,ht)),Te=z.mutations.map(ht=>Dg(O.ie,ht));return{userId:H,batchId:z.batchId,localWriteTimeMs:z.localWriteTime.toMillis(),baseMutations:ce,mutations:Te}}(this.yt,this.userId,_),D=[];let A=new En((O,H)=>Ft(O.canonicalString(),H.canonicalString()));for(const O of i){const H=qx(this.userId,O.key.path,h);A=A.add(O.key.path.popLast()),D.push(l.put(w)),D.push(a.put(H,pk))}return A.forEach(O=>{D.push(this.indexManager.addToCollectionParentIndex(e,O))}),e.addOnCommittedListener(()=>{this.In[h]=_.keys()}),oe.waitFor(D).next(()=>_)})}lookupMutationBatch(e,t){return tf(e).get(t).next(r=>r?(gt(r.userId===this.userId),Rg(this.yt,r)):null)}Tn(e,t){return this.In[t]?oe.resolve(this.In[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.In[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return tf(e).Z({index:"userMutationsIndex",range:i},(l,h,_)=>{h.userId===this.userId&&(gt(h.batchId>=r),a=Rg(this.yt,h)),_.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return tf(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(i,a,l)=>{r=a.batchId,l.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return tf(e).W("userMutationsIndex",t).next(r=>r.map(i=>Rg(this.yt,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=HE(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Uy(e).Z({range:i},(l,h,_)=>{const[w,D,A]=l,O=va(D);if(w===this.userId&&t.path.isEqual(O))return tf(e).get(A).next(H=>{if(!H)throw Xe();gt(H.userId===this.userId),a.push(Rg(this.yt,H))});_.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new En(Ft);const i=[];return t.forEach(a=>{const l=HE(this.userId,a.path),h=IDBKeyRange.lowerBound(l),_=Uy(e).Z({range:h},(w,D,A)=>{const[O,H,z]=w,ce=va(H);O===this.userId&&a.path.isEqual(ce)?r=r.add(z):A.done()});i.push(_)}),oe.waitFor(i).next(()=>this.En(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=HE(this.userId,r),l=IDBKeyRange.lowerBound(a);let h=new En(Ft);return Uy(e).Z({range:l},(_,w,D)=>{const[A,O,H]=_,z=va(O);A===this.userId&&r.isPrefixOf(z)?z.length===i&&(h=h.add(H)):D.done()}).next(()=>this.En(e,h))}En(e,t){const r=[],i=[];return t.forEach(a=>{i.push(tf(e).get(a).next(l=>{if(null===l)throw Xe();gt(l.userId===this.userId),r.push(Rg(this.yt,l))}))}),oe.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return xk(e.se,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.An(t.batchId)}),oe.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}An(e){delete this.In[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return oe.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return Uy(e).Z({range:r},(a,l,h)=>{if(a[0]===this.userId){const _=va(a[1]);i.push(_)}else h.done()}).next(()=>{gt(0===i.length)})})}containsKey(e,t){return Rk(e,this.userId,t)}Rn(e){return Nk(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Rk(n,e,t){const r=HE(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return Uy(n).Z({range:a,X:!0},(h,_,w)=>{const[D,A,O]=h;D===e&&A===i&&(l=!0),w.done()}).next(()=>l)}function tf(n){return We(n,"mutations")}function Uy(n){return We(n,"documentMutations")}function Nk(n){return We(n,"mutationQueues")}class Pg{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new Pg(0)}static vn(){return new Pg(-1)}}class jU{constructor(e,t){this.referenceDelegate=e,this.yt=t}allocateTargetId(e){return this.Vn(e).next(t=>{const r=new Pg(t.highestTargetId);return t.highestTargetId=r.next(),this.Sn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Vn(e).next(t=>vt.fromTimestamp(new Yn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Vn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Vn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Sn(e,i)))}addTargetData(e,t){return this.Dn(e,t).next(()=>this.Vn(e).next(r=>(r.targetCount+=1,this.Cn(t,r),this.Sn(e,r))))}updateTargetData(e,t){return this.Dn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>By(e).delete(t.targetId)).next(()=>this.Vn(e)).next(r=>(gt(r.targetCount>0),r.targetCount-=1,this.Sn(e,r)))}removeTargets(e,t,r){let i=0;const a=[];return By(e).Z((l,h)=>{const _=$E(h);_.sequenceNumber<=t&&null===r.get(_.targetId)&&(i++,a.push(this.removeTargetData(e,_)))}).next(()=>oe.waitFor(a)).next(()=>i)}forEachTarget(e,t){return By(e).Z((r,i)=>{const a=$E(i);t(a)})}Vn(e){return Ok(e).get("targetGlobalKey").next(t=>(gt(null!==t),t))}Sn(e,t){return Ok(e).put("targetGlobalKey",t)}Dn(e,t){return By(e).put(_k(this.yt,t))}Cn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Vn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Zc(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return By(e).Z({range:i,index:"queryTargetsIndex"},(l,h,_)=>{const w=$E(h);fg(t,w.target)&&(a=w,_.done())}).next(()=>a)}addMatchingKeys(e,t,r){const i=[],a=nf(e);return t.forEach(l=>{const h=vs(l.path);i.push(a.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,l))}),oe.waitFor(i)}removeMatchingKeys(e,t,r){const i=nf(e);return oe.forEach(t,a=>{const l=vs(a.path);return oe.waitFor([i.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])})}removeMatchingKeysForTargetId(e,t){const r=nf(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=nf(e);let a=qt();return i.Z({range:r,X:!0},(l,h,_)=>{const w=va(l[1]),D=new Ge(w);a=a.add(D)}).next(()=>a)}containsKey(e,t){const r=vs(t.path),i=IDBKeyRange.bound([r],[uE(r)],!1,!0);let a=0;return nf(e).Z({index:"documentTargetsIndex",X:!0,range:i},([l,h],_,w)=>{0!==l&&(a++,w.done())}).next(()=>a>0)}ne(e,t){return By(e).get(t).next(r=>r?$E(r):null)}}function By(n){return We(n,"targets")}function Ok(n){return We(n,"targetGlobal")}function nf(n){return We(n,"targetDocuments")}function Pk([n,e],[t,r]){const i=Ft(n,t);return 0===i?Ft(e,r):i}class HU{constructor(e){this.xn=e,this.buffer=new En(Pk),this.Nn=0}kn(){return++this.Nn}On(e){const t=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Pk(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class $U{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Mn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}stop(){this.Mn&&(this.Mn.cancel(),this.Mn=null)}get started(){return null!==this.Mn}Fn(e){var t=this;Pe("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Mn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,me.Z)(function*(){t.Mn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){jc(r)?Pe("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield pl(r)}yield t.Fn(3e5)}))}}class GU{constructor(e,t){this.$n=e,this.params=t}calculateTargetCount(e,t){return this.$n.Bn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return oe.resolve(Us.at);const r=new HU(t);return this.$n.forEachTarget(e,i=>r.On(i.sequenceNumber)).next(()=>this.$n.Ln(e,i=>r.On(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.$n.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.$n.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Pe("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(Mk)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Mk):this.qn(e,t))}getCacheSize(e){return this.$n.getCacheSize(e)}qn(e,t){let r,i,a,l,h,_,w;const D=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(A=>(A>this.params.maximumSequenceNumbersToCollect?(Pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${A}`),i=this.params.maximumSequenceNumbersToCollect):i=A,l=Date.now(),this.nthSequenceNumber(e,i))).next(A=>(r=A,h=Date.now(),this.removeTargets(e,r,t))).next(A=>(a=A,_=Date.now(),this.removeOrphanedDocuments(e,r))).next(A=>(w=Date.now(),nE()<=Ls.in.DEBUG&&Pe("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${l-D}ms\n\tDetermined least recently used ${i} in `+(h-l)+`ms\n\tRemoved ${a} targets in `+(_-h)+`ms\n\tRemoved ${A} documents in `+(w-_)+`ms\nTotal Duration: ${w-D}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:A})))}}class zU{constructor(e,t){this.db=e,this.garbageCollector=new GU(this,t)}Bn(e){const t=this.Un(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Un(e){let t=0;return this.Ln(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Ln(e,t){return this.Kn(e,(r,i)=>t(i))}addReference(e,t,r){return kT(e,r)}removeReference(e,t,r){return kT(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return kT(e,t)}Gn(e,t){return function(r,i){let a=!1;return Nk(r).tt(l=>Rk(r,l,i).next(h=>(h&&(a=!0),oe.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Kn(e,(l,h)=>{if(h<=t){const _=this.Gn(e,l).next(w=>{if(!w)return a++,r.getEntry(e,l).next(()=>(r.removeEntry(l,vt.min()),nf(e).delete([0,vs(l.path)])))});i.push(_)}}).next(()=>oe.waitFor(i)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return kT(e,t)}Kn(e,t){const r=nf(e);let i,a=Us.at;return r.Z({index:"documentTargetsIndex"},([l,h],{path:_,sequenceNumber:w})=>{0===l?(a!==Us.at&&t(new Ge(va(i)),a),a=w,i=_):a=Us.at}).next(()=>{a!==Us.at&&t(new Ge(va(i)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function kT(n,e){return nf(n).put((r=n.currentSequenceNumber,{targetId:0,path:vs(e.path),sequenceNumber:r}));var r}class kk{constructor(){this.changes=new Il(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Yt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?oe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class qU{constructor(e){this.yt=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return kg(e).put(r)}removeEntry(e,t,r){return kg(e).delete(function(i,a){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Vy(a),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Qn(e,r)))}getEntry(e,t){let r=Yt.newInvalidDocument(t);return kg(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(ZE(t))},(i,a)=>{r=this.jn(t,a)}).next(()=>r)}Wn(e,t){let r={size:0,document:Yt.newInvalidDocument(t)};return kg(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(ZE(t))},(i,a)=>{r={document:this.jn(t,a),size:OT(a)}}).next(()=>r)}getEntries(e,t){let r=Vr();return this.zn(e,t,(i,a)=>{const l=this.jn(i,a);r=r.insert(i,l)}).next(()=>r)}Hn(e,t){let r=Vr(),i=new Ar(Ge.comparator);return this.zn(e,t,(a,l)=>{const h=this.jn(a,l);r=r.insert(a,h),i=i.insert(a,OT(l))}).next(()=>({documents:r,Jn:i}))}zn(e,t,r){if(t.isEmpty())return oe.resolve();let i=new En(Uk);t.forEach(_=>i=i.add(_));const a=IDBKeyRange.bound(ZE(i.first()),ZE(i.last())),l=i.getIterator();let h=l.getNext();return kg(e).Z({index:"documentKeyIndex",range:a},(_,w,D)=>{const A=Ge.fromSegments([...w.prefixPath,w.collectionGroup,w.documentId]);for(;h&&Uk(h,A)<0;)r(h,null),h=l.getNext();h&&h.isEqual(A)&&(r(h,w),h=l.hasNext()?l.getNext():null),h?D.j(ZE(h)):D.done()}).next(()=>{for(;h;)r(h,null),h=l.hasNext()?l.getNext():null})}getAllFromCollection(e,t,r){const i=[t.popLast().toArray(),t.lastSegment(),Vy(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return kg(e).W(IDBKeyRange.bound(i,a,!0)).next(l=>{let h=Vr();for(const _ of l){const w=this.jn(Ge.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);h=h.insert(w.key,w)}return h})}getAllFromCollectionGroup(e,t,r,i){let a=Vr();const l=Vk(t,r),h=Vk(t,ys.max());return kg(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(l,h,!0)},(_,w,D)=>{const A=this.jn(Ge.fromSegments(w.prefixPath.concat(w.collectionGroup,w.documentId)),w);a=a.insert(A.key,A),a.size===i&&D.done()}).next(()=>a)}newChangeBuffer(e){return new WU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Lk(e).get("remoteDocumentGlobalKey").next(t=>(gt(!!t),t))}Qn(e,t){return Lk(e).put("remoteDocumentGlobalKey",t)}jn(e,t){if(t){const r=function Ly(n,e){let t;if(e.document)t=Py(n.ie,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Ge.fromSegments(e.noDocument.path),i=xg(e.noDocument.readTime);t=Yt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Xe();{const r=Ge.fromSegments(e.unknownDocument.path),i=xg(e.unknownDocument.version);t=Yt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new Yn(r[0],r[1]);return vt.fromTimestamp(i)}(e.readTime)),t}(this.yt,t);if(!r.isNoDocument()||!r.version.isEqual(vt.min()))return r}return Yt.newInvalidDocument(e)}}function Fk(n){return new qU(n)}class WU extends kk{constructor(e,t){super(),this.Yn=e,this.trackRemovals=t,this.Xn=new Il(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new En((a,l)=>Ft(a.canonicalString(),l.canonicalString()));return this.changes.forEach((a,l)=>{const h=this.Xn.get(a);if(t.push(this.Yn.removeEntry(e,a,h.readTime)),l.isValidDocument()){const _=AT(this.Yn.yt,l);i=i.add(a.path.popLast());const w=OT(_);r+=w-h.size,t.push(this.Yn.addEntry(e,a,_))}else if(r-=h.size,this.trackRemovals){const _=AT(this.Yn.yt,l.convertToNoDocument(vt.min()));t.push(this.Yn.addEntry(e,a,_))}}),i.forEach(a=>{t.push(this.Yn.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.Yn.updateMetadata(e,r)),oe.waitFor(t)}getFromCache(e,t){return this.Yn.Wn(e,t).next(r=>(this.Xn.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Yn.Hn(e,t).next(({documents:r,Jn:i})=>(i.forEach((a,l)=>{this.Xn.set(a,{size:l,readTime:r.get(a).readTime})}),r))}}function Lk(n){return We(n,"remoteDocumentGlobal")}function kg(n){return We(n,"remoteDocumentsV14")}function ZE(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Vk(n,e){const t=e.documentKey.path.toArray();return[n,Vy(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Uk(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=Ft(t[a],r[a]),i)return i;return i=Ft(t.length,r.length),i||(i=Ft(t[t.length-2],r[r.length-2]),i||Ft(t[t.length-1],r[r.length-1]))}class ZU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Bk{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==r&&My(r.mutation,i,Ji.empty(),Yn.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,qt()).next(()=>r))}getLocalViewOfDocuments(e,t,r=qt()){const i=_a();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(a=>{let l=td();return a.forEach((h,_)=>{l=l.insert(h,_.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const r=_a();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,qt()))}populateOverlays(e,t,r){const i=[];return r.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((l,h)=>{t.set(l,h)})})}computeViews(e,t,r,i){let a=Vr();const l=nd(),h=nd();return t.forEach((_,w)=>{const D=r.get(w.key);i.has(w.key)&&(void 0===D||D.mutation instanceof du)?a=a.insert(w.key,w):void 0!==D?(l.set(w.key,D.mutation.getFieldMask()),My(D.mutation,w,D.mutation.getFieldMask(),Yn.now())):l.set(w.key,Ji.empty())}),this.recalculateAndSaveOverlays(e,a).next(_=>(_.forEach((w,D)=>l.set(w,D)),t.forEach((w,D)=>{var A;return h.set(w,new ZU(D,null!==(A=l.get(w))&&void 0!==A?A:null))}),h))}recalculateAndSaveOverlays(e,t){const r=nd();let i=new Ar((l,h)=>l-h),a=qt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const h of l)h.keys().forEach(_=>{const w=t.get(_);if(null===w)return;let D=r.get(_)||Ji.empty();D=h.applyToLocalView(w,D),r.set(_,D);const A=(i.get(h.batchId)||qt()).add(_);i=i.insert(h.batchId,A)})}).next(()=>{const l=[],h=i.getReverseIterator();for(;h.hasNext();){const _=h.getNext(),w=_.key,D=_.value,A=Ry();D.forEach(O=>{if(!a.has(O)){const H=aT(t.get(O),r.get(O));null!==H&&A.set(O,H),a=a.add(O)}}),l.push(this.documentOverlayCache.saveOverlays(e,w,A))}return oe.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return Ge.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):xE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):oe.resolve(_a());let h=-1,_=a;return l.next(w=>oe.forEach(w,(D,A)=>(h<A.largestBatchId&&(h=A.largestBatchId),a.get(D)?oe.resolve():this.remoteDocumentCache.getEntry(e,D).next(O=>{_=_.insert(D,O)}))).next(()=>this.populateOverlays(e,w,a)).next(()=>this.computeViews(e,_,w,qt())).next(D=>({batchId:h,changes:xy(D)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ge(t)).next(r=>{let i=td();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let a=td();return this.indexManager.getCollectionParents(e,i).next(l=>oe.forEach(l,h=>{const _=(w=t,D=h.child(i),new ma(D,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt));var w,D;return this.getDocumentsMatchingCollectionQuery(e,_,r).next(w=>{w.forEach((D,A)=>{a=a.insert(D,A)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.remoteDocumentCache.getAllFromCollection(e,t.path,r).next(a=>(i=a,this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId))).next(a=>{a.forEach((h,_)=>{const w=_.getKey();null===i.get(w)&&(i=i.insert(w,Yt.newInvalidDocument(w)))});let l=td();return i.forEach((h,_)=>{const w=a.get(h);void 0!==w&&My(w.mutation,_,Ji.empty(),Yn.now()),Ay(t,_)&&(l=l.insert(h,_))}),l})}}class KU{constructor(e){this.yt=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return oe.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var r;return this.Zn.set(t.id,{id:(r=t).id,version:r.version,createTime:Ur(r.createTime)}),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,{name:(r=t).name,query:Zx(r.bundledQuery),readTime:Ur(r.readTime)}),oe.resolve();var r}}class YU{constructor(){this.overlays=new Ar(Ge.comparator),this.es=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=_a();return oe.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,a)=>{this.oe(e,t,a)}),oe.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.es.get(r);return void 0!==i&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.es.delete(r)),oe.resolve()}getOverlaysForCollection(e,t,r){const i=_a(),a=t.length+1,l=new Ge(t.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const _=h.getNext().value,w=_.getKey();if(!t.isPrefixOf(w.path))break;w.path.length===a&&_.largestBatchId>r&&i.set(_.getKey(),_)}return oe.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new Ar((w,D)=>w-D);const l=this.overlays.getIterator();for(;l.hasNext();){const w=l.getNext().value;if(w.getKey().getCollectionGroup()===t&&w.largestBatchId>r){let D=a.get(w.largestBatchId);null===D&&(D=_a(),a=a.insert(w.largestBatchId,D)),D.set(w.getKey(),w)}}const h=_a(),_=a.getIterator();for(;_.hasNext()&&(_.getNext().value.forEach((w,D)=>h.set(w,D)),!(h.size()>=i)););return oe.resolve(h)}oe(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const l=this.es.get(i.largestBatchId).delete(r.key);this.es.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new Qt(t,r));let a=this.es.get(t);void 0===a&&(a=qt(),this.es.set(t,a)),this.es.set(t,a.add(r.key))}}class tR{constructor(){this.ns=new En(ki.ss),this.rs=new En(ki.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const r=new ki(e,t);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.cs(new ki(e,t))}hs(e,t){e.forEach(r=>this.removeReference(r,t))}ls(e){const t=new Ge(new an([])),r=new ki(t,e),i=new ki(t,e+1),a=[];return this.rs.forEachInRange([r,i],l=>{this.cs(l),a.push(l.key)}),a}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new Ge(new an([])),r=new ki(t,e),i=new ki(t,e+1);let a=qt();return this.rs.forEachInRange([r,i],l=>{a=a.add(l.key)}),a}containsKey(e){const t=new ki(e,0),r=this.ns.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class ki{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return Ge.comparator(e.key,t.key)||Ft(e._s,t._s)}static os(e,t){return Ft(e._s,t._s)||Ge.comparator(e.key,t.key)}}class QU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new En(ki.ss)}checkEmpty(e){return oe.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const a=this.ws;this.ws++;const l=new De(a,t,r,i);this.mutationQueue.push(l);for(const h of i)this.gs=this.gs.add(new ki(h.key,a)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return oe.resolve(l)}lookupMutationBatch(e,t){return oe.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.ps(t+1),a=i<0?0:i;return oe.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ki(t,0),i=new ki(t,Number.POSITIVE_INFINITY),a=[];return this.gs.forEachInRange([r,i],l=>{const h=this.ys(l._s);a.push(h)}),oe.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new En(Ft);return t.forEach(i=>{const a=new ki(i,0),l=new ki(i,Number.POSITIVE_INFINITY);this.gs.forEachInRange([a,l],h=>{r=r.add(h._s)})}),oe.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;Ge.isDocumentKey(a)||(a=a.child(""));const l=new ki(new Ge(a),0);let h=new En(Ft);return this.gs.forEachWhile(_=>{const w=_.key.path;return!!r.isPrefixOf(w)&&(w.length===i&&(h=h.add(_._s)),!0)},l),oe.resolve(this.Is(h))}Is(e){const t=[];return e.forEach(r=>{const i=this.ys(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){gt(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return oe.forEach(t.mutations,i=>{const a=new ki(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.gs=r})}An(e){}containsKey(e,t){const r=new ki(t,0),i=this.gs.firstAfterOrEqual(r);return oe.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return oe.resolve()}Ts(e,t){return this.ps(e)}ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class XU{constructor(e){this.Es=e,this.docs=new Ar(Ge.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,l=this.Es(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return oe.resolve(r?r.document.mutableCopy():Yt.newInvalidDocument(t))}getEntries(e,t){let r=Vr();return t.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():Yt.newInvalidDocument(i))}),oe.resolve(r)}getAllFromCollection(e,t,r){let i=Vr();const a=new Ge(t.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:h,value:{document:_}}=l.getNext();if(!t.isPrefixOf(h.path))break;h.path.length>t.length+1||hE(dE(_),r)<=0||(i=i.insert(_.key,_.mutableCopy()))}return oe.resolve(i)}getAllFromCollectionGroup(e,t,r,i){Xe()}As(e,t){return oe.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new JU(this)}getSize(e){return oe.resolve(this.size)}}class JU extends kk{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Yn.addEntry(e,i)):this.Yn.removeEntry(r)}),oe.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}class eB{constructor(e){this.persistence=e,this.Rs=new Il(t=>Zc(t),fg),this.lastRemoteSnapshotVersion=vt.min(),this.highestTargetId=0,this.bs=0,this.Ps=new tR,this.targetCount=0,this.vs=Pg.Pn()}forEachTarget(e,t){return this.Rs.forEach((r,i)=>t(i)),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.bs&&(this.bs=t),oe.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new Pg(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.Dn(t),oe.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.Rs.forEach((l,h)=>{h.sequenceNumber<=t&&null===r.get(h.targetId)&&(this.Rs.delete(l),a.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),oe.waitFor(a).next(()=>i)}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const r=this.Rs.get(t)||null;return oe.resolve(r)}addMatchingKeys(e,t,r){return this.Ps.us(t,r),oe.resolve()}removeMatchingKeys(e,t,r){this.Ps.hs(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(l=>{a.push(i.markPotentiallyOrphaned(e,l))}),oe.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Ps.ds(t);return oe.resolve(r)}containsKey(e,t){return oe.resolve(this.Ps.containsKey(t))}}class jk{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new Us(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new eB(this),this.indexManager=new UU,this.remoteDocumentCache=new XU(r=>this.referenceDelegate.xs(r)),this.yt=new vi(t),this.Ns=new KU(this.yt)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new YU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Vs[e.toKey()];return r||(r=new QU(t,this.referenceDelegate),this.Vs[e.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,r){Pe("MemoryPersistence","Starting transaction:",e);const i=new tB(this.Ss.next());return this.referenceDelegate.ks(),r(i).next(a=>this.referenceDelegate.Os(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ms(e,t){return oe.or(Object.values(this.Vs).map(r=>()=>r.containsKey(e,t)))}}class tB extends pE{constructor(e){super(),this.currentSequenceNumber=e}}class FT{constructor(e){this.persistence=e,this.Fs=new tR,this.$s=null}static Bs(e){return new FT(e)}get Ls(){if(this.$s)return this.$s;throw Xe()}addReference(e,t,r){return this.Fs.addReference(r,t),this.Ls.delete(r.toString()),oe.resolve()}removeReference(e,t,r){return this.Fs.removeReference(r,t),this.Ls.add(r.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach(i=>this.Ls.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.Ls.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}ks(){this.$s=new Set}Os(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.Ls,r=>{const i=Ge.fromPath(r);return this.qs(e,i).next(a=>{a||t.removeEntry(i,vt.min())})}).next(()=>(this.$s=null,t.apply(e)))}updateLimboDocument(e,t){return this.qs(e,t).next(r=>{r?this.Ls.delete(t.toString()):this.Ls.add(t.toString())})}xs(e){return 0}qs(e,t){return oe.or([()=>oe.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ms(e,t)])}}class nB{constructor(e){this.yt=e}$(e,t,r,i){const a=new ni("createOrUpgrade",t);var h;r<1&&i>=1&&(e.createObjectStore("owner"),(h=e).createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",zx,{unique:!0}),h.createObjectStore("documentMutations"),Hk(e),function(h){h.createObjectStore("remoteDocuments")}(e));let l=oe.resolve();return r<3&&i>=3&&(0!==r&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),Hk(e)),l=l.next(()=>function(h){const _=h.store("targetGlobal"),w={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:vt.min().toTimestamp(),targetCount:0};return _.put("targetGlobalKey",w)}(a))),r<4&&i>=4&&(0!==r&&(l=l.next(()=>function(h,_){return _.store("mutations").W().next(w=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",zx,{unique:!0});const D=_.store("mutations"),A=w.map(O=>D.put(O));return oe.waitFor(A)})}(e,a))),l=l.next(()=>{!function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(l=l.next(()=>this.Us(a))),r<6&&i>=6&&(l=l.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Ks(a)))),r<7&&i>=7&&(l=l.next(()=>this.Gs(a))),r<8&&i>=8&&(l=l.next(()=>this.Qs(e,a))),r<9&&i>=9&&(l=l.next(()=>{!function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(l=l.next(()=>this.js(a))),r<11&&i>=11&&(l=l.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(l=l.next(()=>{!function(h){const _=h.createObjectStore("documentOverlays",{keyPath:C});_.createIndex("collectionPathOverlayIndex",S,{unique:!1}),_.createIndex("collectionGroupOverlayIndex",R,{unique:!1})}(e)})),r<13&&i>=13&&(l=l.next(()=>function(h){const _=h.createObjectStore("remoteDocumentsV14",{keyPath:gk});_.createIndex("documentKeyIndex",Wx),_.createIndex("collectionGroupIndex",mk)}(e)).next(()=>this.Ws(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(l=l.next(()=>this.zs(e,a))),r<15&&i>=15&&(l=l.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:d}).createIndex("sequenceNumberIndex",g,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:y}).createIndex("documentKeyIndex",I,{unique:!1})}(e))),l}Ks(e){let t=0;return e.store("remoteDocuments").Z((r,i)=>{t+=OT(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Us(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>oe.forEach(i,a=>{const l=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",l).next(h=>oe.forEach(h,_=>{gt(_.userId===a.userId);const w=Rg(this.yt,_);return xk(e,a.userId,w).next(()=>{})}))}))}Gs(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const a=[];return r.Z((l,h)=>{const _=new an(l),w=[0,vs(_)];a.push(t.get(w).next(D=>D?oe.resolve():t.put({targetId:0,path:vs(_),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>oe.waitFor(a))})}Qs(e,t){e.createObjectStore("collectionParents",{keyPath:c});const r=t.store("collectionParents"),i=new eR,a=l=>{if(i.add(l)){const h=l.lastSegment(),_=l.popLast();return r.put({collectionId:h,parent:vs(_)})}};return t.store("remoteDocuments").Z({X:!0},(l,h)=>{const _=new an(l);return a(_.popLast())}).next(()=>t.store("documentMutations").Z({X:!0},([l,h,_],w)=>{const D=va(h);return a(D.popLast())}))}js(e){const t=e.store("targets");return t.Z((r,i)=>{const a=$E(i),l=_k(this.yt,a);return t.put(l)})}Ws(e,t){const r=t.store("remoteDocuments"),i=[];return r.Z((a,l)=>{const h=t.store("remoteDocumentsV14"),_=(w=l,w.document?new Ge(an.fromString(w.document.name).popFirst(5)):w.noDocument?Ge.fromSegments(w.noDocument.path):w.unknownDocument?Ge.fromSegments(w.unknownDocument.path):Xe()).path.toArray();var w;const D={prefixPath:_.slice(0,_.length-2),collectionGroup:_[_.length-2],documentId:_[_.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(h.put(D))}).next(()=>oe.waitFor(i))}zs(e,t){const r=t.store("mutations"),i=Fk(this.yt),a=new jk(FT.Bs,this.yt.ie);return r.W().next(l=>{const h=new Map;return l.forEach(_=>{var w;let D=null!==(w=h.get(_.userId))&&void 0!==w?w:qt();Rg(this.yt,_).keys().forEach(A=>D=D.add(A)),h.set(_.userId,D)}),oe.forEach(h,(_,w)=>{const D=new ti(w),A=MT.re(this.yt,D),O=a.getIndexManager(D),H=PT.re(D,this.yt,O,a.referenceDelegate);return new Bk(i,H,A,O).recalculateAndSaveOverlaysForDocumentKeys(new qe(t,Us.at),_).next()})})}}function Hk(n){n.createObjectStore("targetDocuments",{keyPath:o}).createIndex("documentTargetsIndex",u,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",s,{unique:!0}),n.createObjectStore("targetGlobal")}const nR="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class rR{constructor(e,t,r,i,a,l,h,_,w,D,A=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Hs=a,this.window=l,this.document=h,this.Js=w,this.Ys=D,this.Xs=A,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=O=>Promise.resolve(),!rR.C())throw new Re(ue.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new zU(this,i),this.ii=t+"main",this.yt=new vi(_),this.ri=new Oi(this.ii,this.Xs,new nB(this.yt)),this.Cs=new jU(this.referenceDelegate,this.yt),this.remoteDocumentCache=Fk(this.yt),this.Ns=new NU,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===D&&Sr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ui().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Re(ue.FAILED_PRECONDITION,nR);return this.ci(),this.ai(),this.hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Cs.getHighestSequenceNumber(e))}).then(e=>{this.Ss=new Us(e,this.Js)}).then(()=>{this.Ds=!0}).catch(e=>(this.ri&&this.ri.close(),Promise.reject(e)))}li(e){var t=this;return this.si=function(){var r=(0,me.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ri.L(function(){var t=(0,me.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Hs.enqueueAndForget((0,me.Z)(function*(){t.started&&(yield t.ui())})))}ui(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>LT(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)))})}).next(()=>this.di(e)).next(t=>this.isPrimary&&!t?this._i(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(jc(e))return Pe("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Pe("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Hs.enqueueRetryable(()=>this.si(e)),this.isPrimary=e})}fi(e){return KE(e).get("owner").next(t=>oe.resolve(this.mi(t)))}gi(e){return LT(e).delete(this.clientId)}yi(){var e=this;return(0,me.Z)(function*(){if(e.isPrimary&&!e.pi(e.ni,18e5)){e.ni=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=We(r,"clientMetadata");return i.W().next(a=>{const l=e.Ii(a,18e5),h=a.filter(_=>-1===l.indexOf(_));return oe.forEach(h,_=>i.delete(_.clientId)).next(()=>h)})}).catch(()=>[]);if(e.oi)for(const r of t)e.oi.removeItem(e.Ti(r.clientId))}})()}hi(){this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ui().then(()=>this.yi()).then(()=>this.hi()))}mi(e){return!!e&&e.ownerId===this.clientId}di(e){return this.Ys?oe.resolve(!0):KE(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)){if(this.mi(t)&&this.networkEnabled)return!0;if(!this.mi(t)){if(!t.allowTabSynchronization)throw new Re(ue.FAILED_PRECONDITION,nR);return!1}}return!(!this.networkEnabled||!this.inForeground)||LT(e).W().next(r=>void 0===this.Ii(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(t=>(this.isPrimary!==t&&Pe("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,me.Z)(function*(){e.Ds=!1,e.Ai(),e.ei&&(e.ei.cancel(),e.ei=null),e.Ri(),e.bi(),yield e.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new qe(t,Us.at);return e._i(r).next(()=>e.gi(r))}),e.ri.close(),e.Pi()})()}Ii(e,t){return e.filter(r=>this.pi(r.updateTimeMs,t)&&!this.Ei(r.clientId))}vi(){return this.runTransaction("getActiveClients","readonly",e=>LT(e).W().next(t=>this.Ii(t,18e5).map(r=>r.clientId)))}get started(){return this.Ds}getMutationQueue(e,t){return PT.re(e,this.yt,t,this.referenceDelegate)}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new BU(e,this.yt.ie.databaseId)}getDocumentOverlayCache(e){return MT.re(this.yt,e)}getBundleCache(){return this.Ns}runTransaction(e,t,r){Pe("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",a=15===(l=this.Xs)?ke:14===l?we:13===l?Y:12===l?W:11===l?L:void Xe();var l;let h;return this.ri.runTransaction(e,i,a,_=>(h=new qe(_,this.Ss?this.Ss.next():Us.at),"readwrite-primary"===t?this.fi(h).next(w=>!!w||this.di(h)).next(w=>{if(!w)throw Sr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)),new Re(ue.FAILED_PRECONDITION,fE);return r(h)}).next(w=>this.wi(h).next(()=>w)):this.Vi(h).next(()=>r(h)))).then(_=>(h.raiseOnCommittedEvent(),_))}Vi(e){return KE(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)&&!this.mi(t)&&!(this.Ys||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Re(ue.FAILED_PRECONDITION,nR)})}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return KE(e).put("owner",t)}static C(){return Oi.C()}_i(e){const t=KE(e);return t.get("owner").next(r=>this.mi(r)?(Pe("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):oe.resolve())}pi(e,t){const r=Date.now();return!(e<r-t||e>r&&(Sr(`Detected an update time that is in the future: ${e} > ${r}`),1))}ci(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=()=>{this.Hs.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ui()))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}Ri(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}ai(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=()=>{this.Ai(),(0,P.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Hs.enterRestrictedMode(!0),this.Hs.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}bi(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ei(e){var t;try{const r=null!==(null===(t=this.oi)||void 0===t?void 0:t.getItem(this.Ti(e)));return Pe("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Sr("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ai(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(e){Sr("Failed to set zombie client id.",e)}}Pi(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch{}}Ti(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function KE(n){return We(n,"owner")}function LT(n){return We(n,"clientMetadata")}function iR(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class sR{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Si=r,this.Di=i}static Ci(e,t){let r=qt(),i=qt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new sR(e,t.fromCache,r,i)}}class $k{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,r,i){return this.ki(e,t).next(a=>a||this.Oi(e,t,i,r)).next(a=>a||this.Mi(e,t))}ki(e,t){if(AE(t))return oe.resolve(null);let r=vr(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Qh(t,null,"F"),r=vr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const l=qt(...a);return this.Ni.getDocuments(e,l).next(h=>this.indexManager.getMinOffset(e,r).next(_=>{const w=this.Fi(t,h);return this.$i(t,w,l,_.readTime)?this.ki(e,Qh(t,null,"F")):this.Bi(e,w,t,_)}))})))}Oi(e,t,r,i){return AE(t)||i.isEqual(vt.min())?this.Mi(e,t):this.Ni.getDocuments(e,r).next(a=>{const l=this.Fi(t,a);return this.$i(t,l,r,i)?this.Mi(e,t):(nE()<=Ls.in.DEBUG&&Pe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),tT(t)),this.Bi(e,l,t,UD(i,-1)))})}Fi(e,t){let r=new En(rT(e));return t.forEach((i,a)=>{Ay(e,a)&&(r=r.add(a))}),r}$i(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Mi(e,t){return nE()<=Ls.in.DEBUG&&Pe("QueryEngine","Using full collection scan to execute query:",tT(t)),this.Ni.getDocumentsMatchingQuery(e,t,ys.min())}Bi(e,t,r,i){return this.Ni.getDocumentsMatchingQuery(e,r,i).next(a=>(t.forEach(l=>{a=a.insert(l.key,l)}),a))}}class rB{constructor(e,t,r,i){this.persistence=e,this.Li=t,this.yt=i,this.qi=new Ar(Ft),this.Ui=new Il(a=>Zc(a),fg),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(r)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Bk(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.qi))}}function Gk(n,e,t,r){return new rB(n,e,t,r)}function zk(n,e){return oR.apply(this,arguments)}function oR(){return oR=(0,me.Z)(function*(n,e){const t=Ze(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,t.Qi(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const l=[],h=[];let _=qt();for(const w of i){l.push(w.batchId);for(const D of w.mutations)_=_.add(D.key)}for(const w of a){h.push(w.batchId);for(const D of w.mutations)_=_.add(D.key)}return t.localDocuments.getDocuments(r,_).next(w=>({ji:w,removedBatchIds:l,addedBatchIds:h}))})})}),oR.apply(this,arguments)}function qk(n){const e=Ze(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Cs.getLastRemoteSnapshotVersion(t))}function Wk(n,e,t){let r=qt(),i=qt();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let l=Vr();return t.forEach((h,_)=>{const w=a.get(h);_.isFoundDocument()!==w.isFoundDocument()&&(i=i.add(h)),_.isNoDocument()&&_.version.isEqual(vt.min())?(e.removeEntry(h,_.readTime),l=l.insert(h,_)):!w.isValidDocument()||_.version.compareTo(w.version)>0||0===_.version.compareTo(w.version)&&w.hasPendingWrites?(e.addEntry(_),l=l.insert(h,_)):Pe("LocalStore","Ignoring outdated watch update for ",h,". Current version:",w.version," Watch version:",_.version)}),{Wi:l,zi:i}})}function oB(n,e){const t=Ze(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function jy(n,e){const t=Ze(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Cs.getTargetData(r,e).next(a=>a?(i=a,oe.resolve(i)):t.Cs.allocateTargetId(r).next(l=>(i=new $t(e,l,0,r.currentSequenceNumber),t.Cs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.qi.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.qi=t.qi.insert(r.targetId,r),t.Ui.set(e,r.targetId)),r})}function Hy(n,e,t){return aR.apply(this,arguments)}function aR(){return aR=(0,me.Z)(function*(n,e,t){const r=Ze(n),i=r.qi.get(e),a=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",a,l=>r.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!jc(l))throw l;Pe("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}r.qi=r.qi.remove(e),r.Ui.delete(i.target)}),aR.apply(this,arguments)}function VT(n,e,t){const r=Ze(n);let i=vt.min(),a=qt();return r.persistence.runTransaction("Execute query","readonly",l=>function(h,_,w){const D=Ze(h),A=D.Ui.get(w);return void 0!==A?oe.resolve(D.qi.get(A)):D.Cs.getTargetData(_,w)}(r,l,vr(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(l,h.targetId).next(_=>{a=_})}).next(()=>r.Li.getDocumentsMatchingQuery(l,e,t?i:vt.min(),t?a:qt())).next(h=>(Yk(r,nT(e),h),{documents:h,Hi:a})))}function Zk(n,e){const t=Ze(n),r=Ze(t.Cs),i=t.qi.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",a=>r.ne(a,e).next(l=>l?l.target:null))}function Kk(n,e){const t=Ze(n),r=t.Ki.get(e)||vt.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Gi.getAllFromCollectionGroup(i,e,UD(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(Yk(t,e,i),i))}function Yk(n,e,t){let r=n.Ki.get(e)||vt.min();t.forEach((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Ki.set(e,r)}function uR(){return uR=(0,me.Z)(function*(n,e,t,r){const i=Ze(n);let a=qt(),l=Vr();for(const w of t){const D=e.Ji(w.metadata.name);w.document&&(a=a.add(D));const A=e.Yi(w);A.setReadTime(e.Xi(w.metadata.readTime)),l=l.insert(D,A)}const h=i.Gi.newChangeBuffer({trackRemovals:!0}),_=yield jy(i,(w=r,vr(Kc(an.fromString(`__bundle__/docs/${w}`)))));var w;return i.persistence.runTransaction("Apply bundle documents","readwrite",w=>Wk(w,h,l).next(D=>(h.apply(w),D)).next(D=>i.Cs.removeMatchingKeysForTargetId(w,_.targetId).next(()=>i.Cs.addMatchingKeys(w,a,_.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(w,D.Wi,D.zi)).next(()=>D.Wi)))}),uR.apply(this,arguments)}function uB(n,e){return lR.apply(this,arguments)}function lR(){return lR=(0,me.Z)(function*(n,e,t=qt()){const r=yield jy(n,vr(Zx(e.bundledQuery))),i=Ze(n);return i.persistence.runTransaction("Save named query","readwrite",a=>{const l=Ur(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return i.Ns.saveNamedQuery(a,e);const h=r.withResumeToken(ri.EMPTY_BYTE_STRING,l);return i.qi=i.qi.insert(h.targetId,h),i.Cs.updateTargetData(a,h).next(()=>i.Cs.removeMatchingKeysForTargetId(a,r.targetId)).next(()=>i.Cs.addMatchingKeys(a,t,r.targetId)).next(()=>i.Ns.saveNamedQuery(a,e))})}),lR.apply(this,arguments)}function Qk(n,e){return`firestore_clients_${n}_${e}`}function Xk(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function cR(n,e){return`firestore_targets_${n}_${e}`}class UT{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Zi(e,t,r){const i=JSON.parse(r);let a,l="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return l&&i.error&&(l="string"==typeof i.error.message&&"string"==typeof i.error.code,l&&(a=new Re(i.error.code,i.error.message))),l?new UT(e,t,i.state,a):(Sr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class YE{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Zi(e,t){const r=JSON.parse(t);let i,a="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return a&&r.error&&(a="string"==typeof r.error.message&&"string"==typeof r.error.code,a&&(i=new Re(r.error.code,r.error.message))),a?new YE(e,r.state,i):(Sr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class BT{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Zi(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,a=Eg();for(let l=0;i&&l<r.activeTargetIds.length;++l)i=ug(r.activeTargetIds[l]),a=a.add(r.activeTargetIds[l]);return i?new BT(e,a):(Sr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class dR{constructor(e,t){this.clientId=e,this.onlineState=t}static Zi(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new dR(t.clientId,t.onlineState):(Sr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class hR{constructor(){this.activeTargetIds=Eg()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fR{constructor(e,t,r,i,a){this.window=e,this.Hs=t,this.persistenceKey=r,this.sr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new Ar(Ft),this.started=!1,this.cr=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.ar=Qk(this.persistenceKey,this.sr),this.hr=`firestore_sequence_number_${this.persistenceKey}`,this.ur=this.ur.insert(this.sr,new hR),this.lr=new RegExp(`^firestore_clients_${l}_([^_]*)$`),this.dr=new RegExp(`^firestore_mutations_${l}_(\\d+)(?:_(.*))?$`),this._r=new RegExp(`^firestore_targets_${l}_(\\d+)$`),this.wr=`firestore_online_state_${this.persistenceKey}`,this.mr=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}static C(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,me.Z)(function*(){const t=yield e.syncEngine.vi();for(const i of t){if(i===e.sr)continue;const a=e.getItem(Qk(e.persistenceKey,i));if(a){const l=BT.Zi(i,a);l&&(e.ur=e.ur.insert(l.clientId,l))}}e.gr();const r=e.storage.getItem(e.wr);if(r){const i=e.yr(r);i&&e.pr(i)}for(const i of e.cr)e.rr(i);e.cr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.hr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ir(this.ur)}isActiveQueryTarget(e){let t=!1;return this.ur.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Tr(e,"pending")}updateMutationState(e,t,r){this.Tr(e,t,r),this.Er(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(cR(this.persistenceKey,e));if(r){const i=YE.Zi(e,r);i&&(t=i.state)}}return this.Ar.er(e),this.gr(),t}removeLocalQueryTarget(e){this.Ar.nr(e),this.gr()}isLocalQueryTarget(e){return this.Ar.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(cR(this.persistenceKey,e))}updateQueryState(e,t,r){this.Rr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Er(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.br(e)}notifyBundleLoaded(e){this.Pr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Pe("SharedClientState","READ",e,t),t}setItem(e,t){Pe("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Pe("SharedClientState","REMOVE",e),this.storage.removeItem(e)}rr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(Pe("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ar)return void Sr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Hs.enqueueRetryable((0,me.Z)(function*(){if(t.started){if(null!==r.key)if(t.lr.test(r.key)){if(null==r.newValue){const i=t.vr(r.key);return t.Vr(i,null)}{const i=t.Sr(r.key,r.newValue);if(i)return t.Vr(i.clientId,i)}}else if(t.dr.test(r.key)){if(null!==r.newValue){const i=t.Dr(r.key,r.newValue);if(i)return t.Cr(i)}}else if(t._r.test(r.key)){if(null!==r.newValue){const i=t.Nr(r.key,r.newValue);if(i)return t.kr(i)}}else if(r.key===t.wr){if(null!==r.newValue){const i=t.yr(r.newValue);if(i)return t.pr(i)}}else if(r.key===t.hr){const i=function(a){let l=Us.at;if(null!=a)try{const h=JSON.parse(a);gt("number"==typeof h),l=h}catch(h){Sr("SharedClientState","Failed to read sequence number from WebStorage",h)}return l}(r.newValue);i!==Us.at&&t.sequenceNumberHandler(i)}else if(r.key===t.mr){const i=t.Or(r.newValue);yield Promise.all(i.map(a=>t.syncEngine.Mr(a)))}}else t.cr.push(r)}))}}get Ar(){return this.ur.get(this.sr)}gr(){this.setItem(this.ar,this.Ar.tr())}Tr(e,t,r){const i=new UT(this.currentUser,e,t,r),a=Xk(this.persistenceKey,this.currentUser,e);this.setItem(a,i.tr())}Er(e){const t=Xk(this.persistenceKey,this.currentUser,e);this.removeItem(t)}br(e){this.storage.setItem(this.wr,JSON.stringify({clientId:this.sr,onlineState:e}))}Rr(e,t,r){const i=cR(this.persistenceKey,e),a=new YE(e,t,r);this.setItem(i,a.tr())}Pr(e){const t=JSON.stringify(Array.from(e));this.setItem(this.mr,t)}vr(e){const t=this.lr.exec(e);return t?t[1]:null}Sr(e,t){const r=this.vr(e);return BT.Zi(r,t)}Dr(e,t){const r=this.dr.exec(e),i=Number(r[1]);return UT.Zi(new ti(void 0!==r[2]?r[2]:null),i,t)}Nr(e,t){const r=this._r.exec(e),i=Number(r[1]);return YE.Zi(i,t)}yr(e){return dR.Zi(e)}Or(e){return JSON.parse(e)}Cr(e){var t=this;return(0,me.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Fr(e.batchId,e.state,e.error);Pe("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}kr(e){return this.syncEngine.$r(e.targetId,e.state,e.error)}Vr(e,t){const r=t?this.ur.insert(e,t):this.ur.remove(e),i=this.Ir(this.ur),a=this.Ir(r),l=[],h=[];return a.forEach(_=>{i.has(_)||l.push(_)}),i.forEach(_=>{a.has(_)||h.push(_)}),this.syncEngine.Br(l,h).then(()=>{this.ur=r})}pr(e){this.ur.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ir(e){let t=Eg();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class Jk{constructor(){this.Lr=new hR,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Lr.er(e),this.qr[e]||"not-current"}updateQueryState(e,t,r){this.qr[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.qr[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new hR,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class lB{Ur(e){}shutdown(){}}class e1{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}Ur(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){Pe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){Pe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const cB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class dB{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class hB extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.oo=(e.ssl?"https":"http")+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,t,r,i,a){const l=this.ho(e,t);Pe("RestConnection","Sending: ",l,r);const h={};return this.lo(h,i,a),this.fo(e,l,h,r).then(_=>(Pe("RestConnection","Received: ",_),_),_=>{throw Lc("RestConnection",`${e} failed with error: `,_,"url: ",l,"request:",r),_})}_o(e,t,r,i,a,l){return this.ao(e,t,r,i,a)}lo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+fl,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),r&&r.headers.forEach((i,a)=>e[a]=i)}ho(e,t){return`${this.oo}/v1/${t}:${cB[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,t,r,i){return new Promise((a,l)=>{const h=new dx;h.setWithCredentials(!0),h.listenOnce(nk.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case ND.NO_ERROR:const w=h.getResponseJson();Pe("Connection","XHR received:",JSON.stringify(w)),a(w);break;case ND.TIMEOUT:Pe("Connection",'RPC "'+e+'" timed out'),l(new Re(ue.DEADLINE_EXCEEDED,"Request time out"));break;case ND.HTTP_ERROR:const D=h.getStatus();if(Pe("Connection",'RPC "'+e+'" failed with status:',D,"response text:",h.getResponseText()),D>0){let A=h.getResponseJson();Array.isArray(A)&&(A=A[0]);const O=A?.error;if(O&&O.status&&O.message){const H=function(z){const ce=z.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(ce)>=0?ce:ue.UNKNOWN}(O.status);l(new Re(H,O.message))}else l(new Re(ue.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new Re(ue.UNAVAILABLE,"Connection failed."));break;default:Xe()}}finally{Pe("Connection",'RPC "'+e+'" completed.')}});const _=JSON.stringify(i);h.send(t,"POST",_,r,15)})}wo(e,t,r){const i=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=RD(),l=lx(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(h.xmlHttpFactory=new cx({})),this.lo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const _=i.join("");Pe("Connection","Creating WebChannel: "+_,h);const w=a.createWebChannel(_,h);let D=!1,A=!1;const O=new dB({Hr:z=>{A?Pe("Connection","Not sending because WebChannel is closed:",z):(D||(Pe("Connection","Opening WebChannel transport."),w.open(),D=!0),Pe("Connection","WebChannel sending:",z),w.send(z))},Jr:()=>w.close()}),H=(z,ce,Te)=>{z.listen(ce,ht=>{try{Te(ht)}catch(yt){setTimeout(()=>{throw yt},0)}})};return H(w,gy.EventType.OPEN,()=>{A||Pe("Connection","WebChannel transport opened.")}),H(w,gy.EventType.CLOSE,()=>{A||(A=!0,Pe("Connection","WebChannel transport closed"),O.io())}),H(w,gy.EventType.ERROR,z=>{A||(A=!0,Lc("Connection","WebChannel transport errored:",z),O.io(new Re(ue.UNAVAILABLE,"The operation could not be completed")))}),H(w,gy.EventType.MESSAGE,z=>{var ce;if(!A){const Te=z.data[0];gt(!!Te);const yt=Te.error||(null===(ce=Te[0])||void 0===ce?void 0:ce.error);if(yt){Pe("Connection","WebChannel received error:",yt);const nt=yt.status;let at=function(Lt){const Rr=Zr[Lt];if(void 0!==Rr)return dT(Rr)}(nt),Dt=yt.message;void 0===at&&(at=ue.INTERNAL,Dt="Unknown error status: "+nt+" with message "+yt.message),A=!0,O.io(new Re(at,Dt)),w.close()}else Pe("Connection","WebChannel received:",Te),O.ro(Te)}}),H(l,OD.STAT_EVENT,z=>{z.stat===PD.PROXY?Pe("Connection","Detected buffering proxy"):z.stat===PD.NOPROXY&&Pe("Connection","Detected no buffering proxy")}),setTimeout(()=>{O.so()},0),O}}function t1(){return typeof window<"u"?window:null}function jT(){return typeof document<"u"?document:null}function QE(n){return new yT(n,!0)}class pR{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Hs=e,this.timerId=t,this.mo=r,this.yo=i,this.po=a,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const t=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),i=Math.max(0,t-r);i>0&&Pe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Io} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,i,()=>(this.Eo=Date.now(),e())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class n1{constructor(e,t,r,i,a,l,h,_){this.Hs=e,this.vo=r,this.Vo=i,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=_,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new pR(e,t)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var e=this;return(0,me.Z)(function*(){e.No()&&(yield e.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(e){this.Lo(),this.stream.send(e)}$o(){var e=this;return(0,me.Z)(function*(){if(e.ko())return e.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}qo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(e,t){var r=this;return(0,me.Z)(function*(){r.Lo(),r.qo(),r.xo.cancel(),r.So++,4!==e?r.xo.reset():t&&t.code===ue.RESOURCE_EXHAUSTED?(Sr(t.toString()),Sr("Using maximum backoff delay to prevent overloading the backend."),r.xo.Ao()):t&&t.code===ue.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Uo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Zr(t)})()}Uo(){}auth(){this.state=1;const e=this.Ko(this.So),t=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.So===t&&this.Go(r,i)},r=>{e(()=>{const i=new Re(ue.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(i)})})}Go(e,t){const r=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(i=>{r(()=>this.Qo(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Oo(){var e=this;this.state=5,this.xo.Ro((0,me.Z)(function*(){e.state=0,e.start()}))}Qo(e){return Pe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return t=>{this.Hs.enqueueAndForget(()=>this.So===e?t():(Pe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class fB extends n1{constructor(e,t,r,i,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,l),this.yt=a}jo(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.xo.reset();const t=function bT(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(_=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===_?1:"REMOVE"===_?2:"CURRENT"===_?3:"RESET"===_?4:Xe(),i=e.targetChange.targetIds||[],a=function(_,w){return _.wt?(gt(void 0===w||"string"==typeof w),ri.fromBase64String(w||"")):(gt(void 0===w||w instanceof Uint8Array),ri.fromUint8Array(w||new Uint8Array))}(n,e.targetChange.resumeToken),l=e.targetChange.cause,h=l&&function(_){const w=void 0===_.code?ue.UNKNOWN:dT(_.code);return new Re(w,_.message||"")}(l);t=new FE(r,i,a,h||null)}else if("documentChange"in e){const r=e.documentChange,i=ya(n,r.document.name),a=Ur(r.document.updateTime),l=r.document.createTime?Ur(r.document.createTime):vt.min(),h=new yi({mapValue:{fields:r.document.fields}}),_=Yt.newFoundDocument(i,a,l,h);t=new Oy(r.targetIds||[],r.removedTargetIds||[],_.key,_)}else if("documentDelete"in e){const r=e.documentDelete,i=ya(n,r.document),a=r.readTime?Ur(r.readTime):vt.min(),l=Yt.newNoDocument(i,a);t=new Oy([],r.removedTargetIds||[],l.key,l)}else if("documentRemove"in e){const r=e.documentRemove,i=ya(n,r.document);t=new Oy([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return Xe();{const r=e.filter,a=new ok(r.count||0);t=new fT(r.targetId,a)}}var _;return t}(this.yt,e),r=function(i){if(!("targetChange"in i))return vt.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?vt.min():a.readTime?Ur(a.readTime):vt.min()}(e);return this.listener.Wo(t,r)}zo(e){const t={};t.database=Jh(this.yt),t.addTarget=function(i,a){let l;const h=a.target;return l=Yh(h)?{documents:DT(i,h)}:{query:ky(i,h)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0?l.resumeToken=vT(i,a.resumeToken):a.snapshotVersion.compareTo(vt.min())>0&&(l.readTime=Cl(i,a.snapshotVersion.toTimestamp())),l}(this.yt,e);const r=function ck(n,e){const t=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Xe()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Bo(t)}Ho(e){const t={};t.database=Jh(this.yt),t.removeTarget=e,this.Bo(t)}}class pB extends n1{constructor(e,t,r,i,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,l),this.yt=a,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}Uo(){this.Jo&&this.Xo([])}jo(e,t){return this.connection.wo("Write",e,t)}onMessage(e){if(gt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const t=function jx(n,e){return n&&n.length>0?(gt(void 0!==e),n.map(t=>function(r,i){let a=Ur(r.updateTime?r.updateTime:i);return a.isEqual(vt.min())&&(a=Ur(i)),new kx(a,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=Ur(e.commitTime);return this.listener.Zo(r,t)}return gt(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=Jh(this.yt),this.Bo(e)}Xo(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Dg(this.yt,r))};this.Bo(t)}}class gB extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.yt=i,this.nu=!1}su(){if(this.nu)throw new Re(ue.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,t,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.ao(e,t,r,i,a)).catch(i=>{throw"FirebaseError"===i.name?(i.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Re(ue.UNKNOWN,i.toString())})}_o(e,t,r,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection._o(e,t,r,a,l,i)).catch(a=>{throw"FirebaseError"===a.name?(a.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Re(ue.UNKNOWN,a.toString())})}terminate(){this.nu=!0}}class _B{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Sr(t),this.ou=!1):Pe("OnlineStateTracker",t)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class yB{constructor(e,t,r,i,a){var l=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=a,this.mu.Ur(h=>{r.enqueueAndForget((0,me.Z)(function*(){var _;rd(l)&&(Pe("RemoteStore","Restarting streams for network reachability change."),yield(_=(0,me.Z)(function*(w){const D=Ze(w);D._u.add(4),yield $y(D),D.gu.set("Unknown"),D._u.delete(4),yield XE(D)}),function(w){return _.apply(this,arguments)})(l))}))}),this.gu=new _B(r,i)}}function XE(n){return mR.apply(this,arguments)}function mR(){return mR=(0,me.Z)(function*(n){if(rd(n))for(const e of n.wu)yield e(!0)}),mR.apply(this,arguments)}function $y(n){return _R.apply(this,arguments)}function _R(){return _R=(0,me.Z)(function*(n){for(const e of n.wu)yield e(!1)}),_R.apply(this,arguments)}function HT(n,e){const t=Ze(n);t.du.has(e.targetId)||(t.du.set(e.targetId,e),wR(t)?vR(t):zy(t).ko()&&yR(t,e))}function JE(n,e){const t=Ze(n),r=zy(t);t.du.delete(e),r.ko()&&r1(t,e),0===t.du.size&&(r.ko()?r.Fo():rd(t)&&t.gu.set("Unknown"))}function yR(n,e){n.yu.Ot(e.targetId),zy(n).zo(e)}function r1(n,e){n.yu.Ot(e),zy(n).Ho(e)}function vR(n){n.yu=new pT({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ne:e=>n.du.get(e)||null}),zy(n).start(),n.gu.uu()}function wR(n){return rd(n)&&!zy(n).No()&&n.du.size>0}function rd(n){return 0===Ze(n)._u.size}function i1(n){n.yu=void 0}function vB(n){return ER.apply(this,arguments)}function ER(){return ER=(0,me.Z)(function*(n){n.du.forEach((e,t)=>{yR(n,e)})}),ER.apply(this,arguments)}function wB(n,e){return IR.apply(this,arguments)}function IR(){return IR=(0,me.Z)(function*(n,e){i1(n),wR(n)?(n.gu.hu(e),vR(n)):n.gu.set("Unknown")}),IR.apply(this,arguments)}function EB(n,e,t){return CR.apply(this,arguments)}function CR(){return CR=(0,me.Z)(function*(n,e,t){if(n.gu.set("Online"),e instanceof FE&&2===e.state&&e.cause)try{yield(r=(0,me.Z)(function*(i,a){const l=a.cause;for(const h of a.targetIds)i.du.has(h)&&(yield i.remoteSyncer.rejectListen(h,l),i.du.delete(h),i.yu.removeTarget(h))}),function(i,a){return r.apply(this,arguments)})(n,e)}catch(r){Pe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield $T(n,r)}else if(e instanceof Oy?n.yu.Kt(e):e instanceof fT?n.yu.Jt(e):n.yu.jt(e),!t.isEqual(vt.min()))try{const r=yield qk(n.localStore);t.compareTo(r)>=0&&(yield function(i,a){const l=i.yu.Zt(a);return l.targetChanges.forEach((h,_)=>{if(h.resumeToken.approximateByteSize()>0){const w=i.du.get(_);w&&i.du.set(_,w.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach(h=>{const _=i.du.get(h);if(!_)return;i.du.set(h,_.withResumeToken(ri.EMPTY_BYTE_STRING,_.snapshotVersion)),r1(i,h);const w=new $t(_.target,h,1,_.sequenceNumber);yR(i,w)}),i.remoteSyncer.applyRemoteEvent(l)}(n,t))}catch(r){Pe("RemoteStore","Failed to raise snapshot:",r),yield $T(n,r)}var r}),CR.apply(this,arguments)}function $T(n,e,t){return bR.apply(this,arguments)}function bR(){return bR=(0,me.Z)(function*(n,e,t){if(!jc(e))throw e;n._u.add(1),yield $y(n),n.gu.set("Offline"),t||(t=()=>qk(n.localStore)),n.asyncQueue.enqueueRetryable((0,me.Z)(function*(){Pe("RemoteStore","Retrying IndexedDB access"),yield t(),n._u.delete(1),yield XE(n)}))}),bR.apply(this,arguments)}function s1(n,e){return e().catch(t=>$T(n,t,e))}function Gy(n){return DR.apply(this,arguments)}function DR(){return DR=(0,me.Z)(function*(n){const e=Ze(n),t=rf(e);let r=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;IB(e);)try{const i=yield oB(e.localStore,r);if(null===i){0===e.fu.length&&t.Fo();break}r=i.batchId,CB(e,i)}catch(i){yield $T(e,i)}o1(e)&&a1(e)}),DR.apply(this,arguments)}function IB(n){return rd(n)&&n.fu.length<10}function CB(n,e){n.fu.push(e);const t=rf(n);t.ko()&&t.Yo&&t.Xo(e.mutations)}function o1(n){return rd(n)&&!rf(n).No()&&n.fu.length>0}function a1(n){rf(n).start()}function bB(n){return TR.apply(this,arguments)}function TR(){return TR=(0,me.Z)(function*(n){rf(n).eu()}),TR.apply(this,arguments)}function DB(n){return SR.apply(this,arguments)}function SR(){return SR=(0,me.Z)(function*(n){const e=rf(n);for(const t of n.fu)e.Xo(t.mutations)}),SR.apply(this,arguments)}function TB(n,e,t){return AR.apply(this,arguments)}function AR(){return AR=(0,me.Z)(function*(n,e,t){const r=n.fu.shift(),i=xt.from(r,e,t);yield s1(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Gy(n)}),AR.apply(this,arguments)}function SB(n,e){return MR.apply(this,arguments)}function MR(){return MR=(0,me.Z)(function*(n,e){var t;e&&rf(n).Yo&&(yield(t=(0,me.Z)(function*(r,i){if(wg(a=i.code)&&a!==ue.ABORTED){const l=r.fu.shift();rf(r).Mo(),yield s1(r,()=>r.remoteSyncer.rejectFailedWrite(l.batchId,i)),yield Gy(r)}var a}),function(r,i){return t.apply(this,arguments)})(n,e)),o1(n)&&a1(n)}),MR.apply(this,arguments)}function u1(n,e){return xR.apply(this,arguments)}function xR(){return xR=(0,me.Z)(function*(n,e){const t=Ze(n);t.asyncQueue.verifyOperationInProgress(),Pe("RemoteStore","RemoteStore received new credentials");const r=rd(t);t._u.add(3),yield $y(t),r&&t.gu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t._u.delete(3),yield XE(t)}),xR.apply(this,arguments)}function RR(n,e){return NR.apply(this,arguments)}function NR(){return NR=(0,me.Z)(function*(n,e){const t=Ze(n);e?(t._u.delete(2),yield XE(t)):e||(t._u.add(2),yield $y(t),t.gu.set("Unknown"))}),NR.apply(this,arguments)}function zy(n){return n.pu||(n.pu=function(e,t,r){const i=Ze(e);return i.su(),new fB(t,i.connection,i.authCredentials,i.appCheckCredentials,i.yt,r)}(n.datastore,n.asyncQueue,{Yr:vB.bind(null,n),Zr:wB.bind(null,n),Wo:EB.bind(null,n)}),n.wu.push(function(){var e=(0,me.Z)(function*(t){t?(n.pu.Mo(),wR(n)?vR(n):n.gu.set("Unknown")):(yield n.pu.stop(),i1(n))});return function(t){return e.apply(this,arguments)}}())),n.pu}function rf(n){return n.Iu||(n.Iu=function(e,t,r){const i=Ze(e);return i.su(),new pB(t,i.connection,i.authCredentials,i.appCheckCredentials,i.yt,r)}(n.datastore,n.asyncQueue,{Yr:bB.bind(null,n),Zr:SB.bind(null,n),tu:DB.bind(null,n),Zo:TB.bind(null,n)}),n.wu.push(function(){var e=(0,me.Z)(function*(t){t?(n.Iu.Mo(),yield Gy(n)):(yield n.Iu.stop(),n.fu.length>0&&(Pe("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(t){return e.apply(this,arguments)}}())),n.Iu}class OR{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Wr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}static createAndSchedule(e,t,r,i,a){const l=Date.now()+r,h=new OR(e,t,l,i,a);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Re(ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function qy(n,e){if(Sr("AsyncQueue",`${e}: ${n}`),jc(n))return new Re(ue.UNAVAILABLE,`${e}: ${n}`);throw n}class Wy{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ge.comparator(t.key,r.key):(t,r)=>Ge.comparator(t.key,r.key),this.keyedMap=td(),this.sortedSet=new Ar(this.comparator)}static emptySet(e){return new Wy(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Wy)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new Wy;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class l1{constructor(){this.Tu=new Ar(Ge.comparator)}track(e){const t=e.doc.key,r=this.Tu.get(t);r?0!==e.type&&3===r.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==r.type?this.Tu=this.Tu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Tu=this.Tu.remove(t):1===e.type&&2===r.type?this.Tu=this.Tu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):Xe():this.Tu=this.Tu.insert(t,e)}Eu(){const e=[];return this.Tu.inorderTraversal((t,r)=>{e.push(r)}),e}}class Zy{constructor(e,t,r,i,a,l,h,_,w){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=_,this.hasCachedResults=w}static fromInitialDocuments(e,t,r,i,a){const l=[];return t.forEach(h=>{l.push({type:0,doc:h})}),new Zy(e,t,Wy.emptySet(t),l,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Yc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class AB{constructor(){this.Au=void 0,this.listeners=[]}}class MB{constructor(){this.queries=new Il(e=>eT(e),Yc),this.onlineState="Unknown",this.Ru=new Set}}function PR(n,e){return kR.apply(this,arguments)}function kR(){return kR=(0,me.Z)(function*(n,e){const t=Ze(n),r=e.query;let i=!1,a=t.queries.get(r);if(a||(i=!0,a=new AB),i)try{a.Au=yield t.onListen(r)}catch(l){const h=qy(l,`Initialization of query '${tT(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,a),a.listeners.push(e),e.bu(t.onlineState),a.Au&&e.Pu(a.Au)&&VR(t)}),kR.apply(this,arguments)}function FR(n,e){return LR.apply(this,arguments)}function LR(){return LR=(0,me.Z)(function*(n,e){const t=Ze(n),r=e.query;let i=!1;const a=t.queries.get(r);if(a){const l=a.listeners.indexOf(e);l>=0&&(a.listeners.splice(l,1),i=0===a.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),LR.apply(this,arguments)}function xB(n,e){const t=Ze(n);let r=!1;for(const i of e){const l=t.queries.get(i.query);if(l){for(const h of l.listeners)h.Pu(i)&&(r=!0);l.Au=i}}r&&VR(t)}function RB(n,e,t){const r=Ze(n),i=r.queries.get(e);if(i)for(const a of i.listeners)a.onError(t);r.queries.delete(e)}function VR(n){n.Ru.forEach(e=>{e.next()})}class UR{constructor(e,t,r){this.query=e,this.vu=t,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new Zy(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),t=!0):this.Cu(e,this.onlineState)&&(this.xu(e),t=!0),this.Su=e,t}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}Cu(e,t){return!e.fromCache||(!this.options.Nu||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Du(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(e){e=Zy.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}class NB{constructor(e,t){this.ku=e,this.byteLength=t}Ou(){return"metadata"in this.ku}}class c1{constructor(e){this.yt=e}Ji(e){return ya(this.yt,e)}Yi(e){return e.metadata.exists?Py(this.yt,e.document,!1):Yt.newNoDocument(this.Ji(e.metadata.name),this.Xi(e.metadata.readTime))}Xi(e){return Ur(e)}}class OB{constructor(e,t,r){this.Mu=e,this.localStore=t,this.yt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=d1(e)}Fu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ku.namedQuery)this.queries.push(e.ku.namedQuery);else if(e.ku.documentMetadata){this.documents.push({metadata:e.ku.documentMetadata}),e.ku.documentMetadata.exists||++t;const r=an.fromString(e.ku.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ku.document&&(this.documents[this.documents.length-1].document=e.ku.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}$u(e){const t=new Map,r=new c1(this.yt);for(const i of e)if(i.metadata.queries){const a=r.Ji(i.metadata.name);for(const l of i.metadata.queries){const h=(t.get(l)||qt()).add(a);t.set(l,h)}}return t}complete(){var e=this;return(0,me.Z)(function*(){const t=yield function aB(n,e,t,r){return uR.apply(this,arguments)}(e.localStore,new c1(e.yt),e.documents,e.Mu.id),r=e.$u(e.documents);for(const i of e.queries)yield uB(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,Bu:e.collectionGroups,Lu:t}})()}}function d1(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class h1{constructor(e){this.key=e}}class f1{constructor(e){this.key=e}}class p1{constructor(e,t){this.query=e,this.qu=t,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=qt(),this.mutatedKeys=qt(),this.Gu=rT(e),this.Qu=new Wy(this.Gu)}get ju(){return this.qu}Wu(e,t){const r=t?t.zu:new l1,i=t?t.Qu:this.Qu;let a=t?t.mutatedKeys:this.mutatedKeys,l=i,h=!1;const _="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,w="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((D,A)=>{const O=i.get(D),H=Ay(this.query,A)?A:null,z=!!O&&this.mutatedKeys.has(O.key),ce=!!H&&(H.hasLocalMutations||this.mutatedKeys.has(H.key)&&H.hasCommittedMutations);let Te=!1;O&&H?O.data.isEqual(H.data)?z!==ce&&(r.track({type:3,doc:H}),Te=!0):this.Hu(O,H)||(r.track({type:2,doc:H}),Te=!0,(_&&this.Gu(H,_)>0||w&&this.Gu(H,w)<0)&&(h=!0)):!O&&H?(r.track({type:0,doc:H}),Te=!0):O&&!H&&(r.track({type:1,doc:O}),Te=!0,(_||w)&&(h=!0)),Te&&(H?(l=l.add(H),a=ce?a.add(D):a.delete(D)):(l=l.delete(D),a=a.delete(D)))}),null!==this.query.limit)for(;l.size>this.query.limit;){const D="F"===this.query.limitType?l.last():l.first();l=l.delete(D.key),a=a.delete(D.key),r.track({type:1,doc:D})}return{Qu:l,zu:r,$i:h,mutatedKeys:a}}Hu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const a=e.zu.Eu();a.sort((w,D)=>function(A,O){const H=z=>{switch(z){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xe()}};return H(A)-H(O)}(w.type,D.type)||this.Gu(w.doc,D.doc)),this.Ju(r);const l=t?this.Yu():[],h=0===this.Ku.size&&this.current?1:0,_=h!==this.Uu;return this.Uu=h,0!==a.length||_?{snapshot:new Zy(this.query,e.Qu,i,a,e.mutatedKeys,0===h,_,!1,!!r&&r.resumeToken.approximateByteSize()>0),Xu:l}:{Xu:l}}bu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new l1,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.qu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach(t=>this.qu=this.qu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.qu=this.qu.delete(t)),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=qt(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const t=[];return e.forEach(r=>{this.Ku.has(r)||t.push(new f1(r))}),this.Ku.forEach(r=>{e.has(r)||t.push(new h1(r))}),t}tc(e){this.qu=e.Hi,this.Ku=qt();const t=this.Wu(e.documents);return this.applyChanges(t,!0)}ec(){return Zy.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.Uu,this.hasCachedResults)}}class PB{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class kB{constructor(e){this.key=e,this.nc=!1}}class FB{constructor(e,t,r,i,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.sc={},this.ic=new Il(h=>eT(h),Yc),this.rc=new Map,this.oc=new Set,this.uc=new Ar(Ge.comparator),this.cc=new Map,this.ac=new tR,this.hc={},this.lc=new Map,this.fc=Pg.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function LB(n,e){return BR.apply(this,arguments)}function BR(){return BR=(0,me.Z)(function*(n,e){const t=lN(n);let r,i;const a=t.ic.get(e);if(a)r=a.targetId,t.sharedClientState.addLocalQueryTarget(r),i=a.view.ec();else{const l=yield jy(t.localStore,vr(e));t.isPrimaryClient&&HT(t.remoteStore,l);const h=t.sharedClientState.addLocalQueryTarget(l.targetId);r=l.targetId,i=yield jR(t,e,r,"current"===h,l.resumeToken)}return i}),BR.apply(this,arguments)}function jR(n,e,t,r,i){return HR.apply(this,arguments)}function HR(){return HR=(0,me.Z)(function*(n,e,t,r,i){n._c=(A,O,H)=>{return(z=(0,me.Z)(function*(ce,Te,ht,yt){let nt=Te.view.Wu(ht);nt.$i&&(nt=yield VT(ce.localStore,Te.query,!1).then(({documents:Lt})=>Te.view.Wu(Lt,nt)));const at=yt&&yt.targetChanges.get(Te.targetId),Dt=Te.view.applyChanges(nt,ce.isPrimaryClient,at);return XR(ce,Te.targetId,Dt.Xu),Dt.snapshot}),function(ce,Te,ht,yt){return z.apply(this,arguments)})(n,A,O,H);var z};const a=yield VT(n.localStore,e,!0),l=new p1(e,a.Hi),h=l.Wu(a.documents),_=Cg.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),w=l.applyChanges(h,n.isPrimaryClient,_);XR(n,t,w.Xu);const D=new PB(e,t,l);return n.ic.set(e,D),n.rc.has(t)?n.rc.get(t).push(e):n.rc.set(t,[e]),w.snapshot}),HR.apply(this,arguments)}function VB(n,e){return $R.apply(this,arguments)}function $R(){return $R=(0,me.Z)(function*(n,e){const t=Ze(n),r=t.ic.get(e),i=t.rc.get(r.targetId);if(i.length>1)return t.rc.set(r.targetId,i.filter(a=>!Yc(a,e))),void t.ic.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Hy(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),JE(t.remoteStore,r.targetId),Ky(t,r.targetId)}).catch(pl))):(Ky(t,r.targetId),yield Hy(t.localStore,r.targetId,!0))}),$R.apply(this,arguments)}function GR(){return GR=(0,me.Z)(function*(n,e,t){const r=cN(n);try{const i=yield function(a,l){const h=Ze(a),_=Yn.now(),w=l.reduce((O,H)=>O.add(H.key),qt());let D,A;return h.persistence.runTransaction("Locally write mutations","readwrite",O=>{let H=Vr(),z=qt();return h.Gi.getEntries(O,w).next(ce=>{H=ce,H.forEach((Te,ht)=>{ht.isValidDocument()||(z=z.add(Te))})}).next(()=>h.localDocuments.getOverlayedDocuments(O,H)).next(ce=>{D=ce;const Te=[];for(const ht of l){const yt=sk(ht,D.get(ht.key).overlayedDocument);null!=yt&&Te.push(new du(ht.key,yt,Mx(yt.value.mapValue),Xn.exists(!0)))}return h.mutationQueue.addMutationBatch(O,_,Te,l)}).next(ce=>{A=ce;const Te=ce.applyToLocalDocumentSet(D,z);return h.documentOverlayCache.saveOverlays(O,ce.batchId,Te)})}).then(()=>({batchId:A.batchId,changes:xy(D)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,h){let _=a.hc[a.currentUser.toKey()];_||(_=new Ar(Ft)),_=_.insert(l,h),a.hc[a.currentUser.toKey()]=_}(r,i.batchId,t),yield id(r,i.changes),yield Gy(r.remoteStore)}catch(i){const a=qy(i,"Failed to persist write");t.reject(a)}}),GR.apply(this,arguments)}function g1(n,e){return zR.apply(this,arguments)}function zR(){return zR=(0,me.Z)(function*(n,e){const t=Ze(n);try{const r=yield function sB(n,e){const t=Ze(n),r=e.snapshotVersion;let i=t.qi;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=t.Gi.newChangeBuffer({trackRemovals:!0});i=t.qi;const h=[];e.targetChanges.forEach((D,A)=>{const O=i.get(A);if(!O)return;h.push(t.Cs.removeMatchingKeys(a,D.removedDocuments,A).next(()=>t.Cs.addMatchingKeys(a,D.addedDocuments,A)));let H=O.withSequenceNumber(a.currentSequenceNumber);var z,ce,Te;e.targetMismatches.has(A)?H=H.withResumeToken(ri.EMPTY_BYTE_STRING,vt.min()).withLastLimboFreeSnapshotVersion(vt.min()):D.resumeToken.approximateByteSize()>0&&(H=H.withResumeToken(D.resumeToken,r)),i=i.insert(A,H),ce=H,Te=D,(0===(z=O).resumeToken.approximateByteSize()||ce.snapshotVersion.toMicroseconds()-z.snapshotVersion.toMicroseconds()>=3e8||Te.addedDocuments.size+Te.modifiedDocuments.size+Te.removedDocuments.size>0)&&h.push(t.Cs.updateTargetData(a,H))});let _=Vr(),w=qt();if(e.documentUpdates.forEach(D=>{e.resolvedLimboDocuments.has(D)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(a,D))}),h.push(Wk(a,l,e.documentUpdates).next(D=>{_=D.Wi,w=D.zi})),!r.isEqual(vt.min())){const D=t.Cs.getLastRemoteSnapshotVersion(a).next(A=>t.Cs.setTargetsMetadata(a,a.currentSequenceNumber,r));h.push(D)}return oe.waitFor(h).next(()=>l.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,_,w)).next(()=>_)}).then(a=>(t.qi=i,a))}(t.localStore,e);e.targetChanges.forEach((i,a)=>{const l=t.cc.get(a);l&&(gt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?l.nc=!0:i.modifiedDocuments.size>0?gt(l.nc):i.removedDocuments.size>0&&(gt(l.nc),l.nc=!1))}),yield id(t,r,e)}catch(r){yield pl(r)}}),zR.apply(this,arguments)}function m1(n,e,t){const r=Ze(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.ic.forEach((a,l)=>{const h=l.view.bu(e);h.snapshot&&i.push(h.snapshot)}),function(a,l){const h=Ze(a);h.onlineState=l;let _=!1;h.queries.forEach((w,D)=>{for(const A of D.listeners)A.bu(l)&&(_=!0)}),_&&VR(h)}(r.eventManager,e),i.length&&r.sc.Wo(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function BB(n,e,t){return qR.apply(this,arguments)}function qR(){return qR=(0,me.Z)(function*(n,e,t){const r=Ze(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.cc.get(e),a=i&&i.key;if(a){let l=new Ar(Ge.comparator);l=l.insert(a,Yt.newNoDocument(a,vt.min()));const h=qt().add(a),_=new Ig(vt.min(),new Map,new En(Ft),l,h);yield g1(r,_),r.uc=r.uc.remove(a),r.cc.delete(e),JR(r)}else yield Hy(r.localStore,e,!1).then(()=>Ky(r,e,t)).catch(pl)}),qR.apply(this,arguments)}function jB(n,e){return WR.apply(this,arguments)}function WR(){return WR=(0,me.Z)(function*(n,e){const t=Ze(n),r=e.batch.batchId;try{const i=yield function iB(n,e){const t=Ze(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),a=t.Gi.newChangeBuffer({trackRemovals:!0});return function(l,h,_,w){const D=_.batch,A=D.keys();let O=oe.resolve();return A.forEach(H=>{O=O.next(()=>w.getEntry(h,H)).next(z=>{const ce=_.docVersions.get(H);gt(null!==ce),z.version.compareTo(ce)<0&&(D.applyToRemoteDocument(z,_),z.isValidDocument()&&(z.setReadTime(_.commitVersion),w.addEntry(z)))})}),O.next(()=>l.mutationQueue.removeMutationBatch(h,D))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=qt();for(let _=0;_<l.mutationResults.length;++_)l.mutationResults[_].transformResults.length>0&&(h=h.add(l.batch.mutations[_].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}(t.localStore,e);QR(t,r,null),YR(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield id(t,i)}catch(i){yield pl(i)}}),WR.apply(this,arguments)}function HB(n,e,t){return ZR.apply(this,arguments)}function ZR(){return ZR=(0,me.Z)(function*(n,e,t){const r=Ze(n);try{const i=yield function(a,l){const h=Ze(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",_=>{let w;return h.mutationQueue.lookupMutationBatch(_,l).next(D=>(gt(null!==D),w=D.keys(),h.mutationQueue.removeMutationBatch(_,D))).next(()=>h.mutationQueue.performConsistencyCheck(_)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(_,w,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(_,w)).next(()=>h.localDocuments.getDocuments(_,w))})}(r.localStore,e);QR(r,e,t),YR(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield id(r,i)}catch(i){yield pl(i)}}),ZR.apply(this,arguments)}function KR(){return KR=(0,me.Z)(function*(n,e){const t=Ze(n);rd(t.remoteStore)||Pe("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(a){const l=Ze(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>l.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(-1===r)return void e.resolve();const i=t.lc.get(r)||[];i.push(e),t.lc.set(r,i)}catch(r){const i=qy(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),KR.apply(this,arguments)}function YR(n,e){(n.lc.get(e)||[]).forEach(t=>{t.resolve()}),n.lc.delete(e)}function QR(n,e,t){const r=Ze(n);let i=r.hc[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.hc[r.currentUser.toKey()]=i}}function Ky(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.rc.get(e))n.ic.delete(r),t&&n.sc.wc(r,t);n.rc.delete(e),n.isPrimaryClient&&n.ac.ls(e).forEach(r=>{n.ac.containsKey(r)||_1(n,r)})}function _1(n,e){n.oc.delete(e.path.canonicalString());const t=n.uc.get(e);null!==t&&(JE(n.remoteStore,t),n.uc=n.uc.remove(e),n.cc.delete(t),JR(n))}function XR(n,e,t){for(const r of t)r instanceof h1?(n.ac.addReference(r.key,e),GB(n,r)):r instanceof f1?(Pe("SyncEngine","Document no longer in limbo: "+r.key),n.ac.removeReference(r.key,e),n.ac.containsKey(r.key)||_1(n,r.key)):Xe()}function GB(n,e){const t=e.key,r=t.path.canonicalString();n.uc.get(t)||n.oc.has(r)||(Pe("SyncEngine","New document in limbo: "+t),n.oc.add(r),JR(n))}function JR(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const e=n.oc.values().next().value;n.oc.delete(e);const t=new Ge(an.fromString(e)),r=n.fc.next();n.cc.set(r,new kB(t)),n.uc=n.uc.insert(t,r),HT(n.remoteStore,new $t(vr(Kc(t.path)),r,2,Us.at))}}function id(n,e,t){return eN.apply(this,arguments)}function eN(){return eN=(0,me.Z)(function*(n,e,t){const r=Ze(n),i=[],a=[],l=[];var h;r.ic.isEmpty()||(r.ic.forEach((h,_)=>{l.push(r._c(_,e,t).then(w=>{if((w||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(_.targetId,w?.fromCache?"not-current":"current"),w){i.push(w);const D=sR.Ci(_.targetId,w);a.push(D)}}))}),yield Promise.all(l),r.sc.Wo(i),yield(h=(0,me.Z)(function*(_,w){const D=Ze(_);try{yield D.persistence.runTransaction("notifyLocalViewChanges","readwrite",A=>oe.forEach(w,O=>oe.forEach(O.Si,H=>D.persistence.referenceDelegate.addReference(A,O.targetId,H)).next(()=>oe.forEach(O.Di,H=>D.persistence.referenceDelegate.removeReference(A,O.targetId,H)))))}catch(A){if(!jc(A))throw A;Pe("LocalStore","Failed to update sequence numbers: "+A)}for(const A of w){const O=A.targetId;if(!A.fromCache){const H=D.qi.get(O),ce=H.withLastLimboFreeSnapshotVersion(H.snapshotVersion);D.qi=D.qi.insert(O,ce)}}}),function(_,w){return h.apply(this,arguments)})(r.localStore,a))}),eN.apply(this,arguments)}function zB(n,e){return tN.apply(this,arguments)}function tN(){return tN=(0,me.Z)(function*(n,e){const t=Ze(n);if(!t.currentUser.isEqual(e)){Pe("SyncEngine","User change. New user:",e.toKey());const r=yield zk(t.localStore,e);t.currentUser=e,(i=t).lc.forEach(l=>{l.forEach(h=>{h.reject(new Re(ue.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.lc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield id(t,r.ji)}var i}),tN.apply(this,arguments)}function qB(n,e){const t=Ze(n),r=t.cc.get(e);if(r&&r.nc)return qt().add(r.key);{let i=qt();const a=t.rc.get(e);if(!a)return i;for(const l of a){const h=t.ic.get(l);i=i.unionWith(h.view.ju)}return i}}function WB(n,e){return nN.apply(this,arguments)}function nN(){return nN=(0,me.Z)(function*(n,e){const t=Ze(n),r=yield VT(t.localStore,e.query,!0),i=e.view.tc(r);return t.isPrimaryClient&&XR(t,e.targetId,i.Xu),i}),nN.apply(this,arguments)}function ZB(n,e){return rN.apply(this,arguments)}function rN(){return rN=(0,me.Z)(function*(n,e){const t=Ze(n);return Kk(t.localStore,e).then(r=>id(t,r))}),rN.apply(this,arguments)}function KB(n,e,t,r){return iN.apply(this,arguments)}function iN(){return iN=(0,me.Z)(function*(n,e,t,r){const i=Ze(n),a=yield function(l,h){const _=Ze(l),w=Ze(_.mutationQueue);return _.persistence.runTransaction("Lookup mutation documents","readonly",D=>w.Tn(D,h).next(A=>A?_.localDocuments.getDocuments(D,A):oe.resolve(null)))}(i.localStore,e);var h;null!==a?("pending"===t?yield Gy(i.remoteStore):"acknowledged"===t||"rejected"===t?(QR(i,e,r||null),YR(i,e),h=e,Ze(Ze(i.localStore).mutationQueue).An(h)):Xe(),yield id(i,a)):Pe("SyncEngine","Cannot apply mutation batch with id: "+e)}),iN.apply(this,arguments)}function sN(){return sN=(0,me.Z)(function*(n,e){const t=Ze(n);if(lN(t),cN(t),!0===e&&!0!==t.dc){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield y1(t,r.toArray());t.dc=!0,yield RR(t.remoteStore,!0);for(const a of i)HT(t.remoteStore,a)}else if(!1===e&&!1!==t.dc){const r=[];let i=Promise.resolve();t.rc.forEach((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?r.push(l):i=i.then(()=>(Ky(t,l),Hy(t.localStore,l,!0))),JE(t.remoteStore,l)}),yield i,yield y1(t,r),function(a){const l=Ze(a);l.cc.forEach((h,_)=>{JE(l.remoteStore,_)}),l.ac.fs(),l.cc=new Map,l.uc=new Ar(Ge.comparator)}(t),t.dc=!1,yield RR(t.remoteStore,!1)}}),sN.apply(this,arguments)}function y1(n,e,t){return oN.apply(this,arguments)}function oN(){return oN=(0,me.Z)(function*(n,e,t){const r=Ze(n),i=[],a=[];for(const l of e){let h;const _=r.rc.get(l);if(_&&0!==_.length){h=yield jy(r.localStore,vr(_[0]));for(const w of _){const D=r.ic.get(w),A=yield WB(r,D);A.snapshot&&a.push(A.snapshot)}}else{const w=yield Zk(r.localStore,l);h=yield jy(r.localStore,w),yield jR(r,v1(w),l,!1,h.resumeToken)}i.push(h)}return r.sc.Wo(a),i}),oN.apply(this,arguments)}function v1(n){return SE(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function QB(n){const e=Ze(n);return Ze(Ze(e.localStore).persistence).vi()}function XB(n,e,t,r){return aN.apply(this,arguments)}function aN(){return aN=(0,me.Z)(function*(n,e,t,r){const i=Ze(n);if(i.dc)return void Pe("SyncEngine","Ignoring unexpected query state notification.");const a=i.rc.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=yield Kk(i.localStore,nT(a[0])),h=Ig.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,ri.EMPTY_BYTE_STRING);yield id(i,l,h);break}case"rejected":yield Hy(i.localStore,e,!0),Ky(i,e,r);break;default:Xe()}}),aN.apply(this,arguments)}function JB(n,e,t){return uN.apply(this,arguments)}function uN(){return uN=(0,me.Z)(function*(n,e,t){const r=lN(n);if(r.dc){for(const i of e){if(r.rc.has(i)){Pe("SyncEngine","Adding an already active target "+i);continue}const a=yield Zk(r.localStore,i),l=yield jy(r.localStore,a);yield jR(r,v1(a),l.targetId,!1,l.resumeToken),HT(r.remoteStore,l)}for(const i of t)r.rc.has(i)&&(yield Hy(r.localStore,i,!1).then(()=>{JE(r.remoteStore,i),Ky(r,i)}).catch(pl))}}),uN.apply(this,arguments)}function lN(n){const e=Ze(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=g1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=BB.bind(null,e),e.sc.Wo=xB.bind(null,e.eventManager),e.sc.wc=RB.bind(null,e.eventManager),e}function cN(n){const e=Ze(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=HB.bind(null,e),e}class w1{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,me.Z)(function*(){t.yt=QE(e.databaseInfo.databaseId),t.sharedClientState=t.gc(e),t.persistence=t.yc(e),yield t.persistence.start(),t.localStore=t.Ic(e),t.gcScheduler=t.Tc(e,t.localStore),t.indexBackfillerScheduler=t.Ec(e,t.localStore)})()}Tc(e,t){return null}Ec(e,t){return null}Ic(e){return Gk(this.persistence,new $k,e.initialUser,this.yt)}yc(e){return new jk(FT.Bs,this.yt)}gc(e){return new Jk}terminate(){var e=this;return(0,me.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class E1 extends w1{constructor(e,t,r){super(),this.Ac=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,me.Z)(function*(){yield t().call(r,e),yield r.Ac.initialize(r,e),yield cN(r.Ac.syncEngine),yield Gy(r.Ac.remoteStore),yield r.persistence.li(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}Ic(e){return Gk(this.persistence,new $k,e.initialUser,this.yt)}Tc(e,t){return new $U(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Ec(e,t){const r=new gE(t,this.persistence);return new vx(e.asyncQueue,r)}yc(e){const t=iR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?lo.withCacheSize(this.cacheSizeBytes):lo.DEFAULT;return new rR(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,t1(),jT(),this.yt,this.sharedClientState,!!this.forceOwnership)}gc(e){return new Jk}}class t2 extends E1{constructor(e,t){super(e,t,!1),this.Ac=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,me.Z)(function*(){yield t().call(r,e);const i=r.Ac.syncEngine;r.sharedClientState instanceof fR&&(r.sharedClientState.syncEngine={Fr:KB.bind(null,i),$r:XB.bind(null,i),Br:JB.bind(null,i),vi:QB.bind(null,i),Mr:ZB.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.li(function(){var a=(0,me.Z)(function*(l){yield function YB(n,e){return sN.apply(this,arguments)}(r.Ac.syncEngine,l),r.gcScheduler&&(l&&!r.gcScheduler.started?r.gcScheduler.start():l||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(l&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():l||r.indexBackfillerScheduler.stop())});return function(l){return a.apply(this,arguments)}}())})()}gc(e){const t=t1();if(!fR.C(t))throw new Re(ue.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=iR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new fR(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class dN{initialize(e,t){var r=this;return(0,me.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>m1(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=zB.bind(null,r.syncEngine),yield RR(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new MB}createDatastore(e){const t=QE(e.databaseInfo.databaseId),r=new hB(e.databaseInfo);return new gB(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,a=h=>m1(this.syncEngine,h,0),l=e1.C()?new e1:new lB,new yB(t,r,i,a,l);var t,r,i,a,l}createSyncEngine(e,t){return function(r,i,a,l,h,_,w){const D=new FB(r,i,a,l,h,_);return w&&(D.dc=!0),D}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,me.Z)(function*(t){const r=Ze(t);Pe("RemoteStore","RemoteStore shutting down."),r._u.add(5),yield $y(r),r.mu.shutdown(),r.gu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function hN(n,e,t){if(!t)throw new Re(ue.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function I1(n,e,t,r){if(!0===e&&!0===r)throw new Re(ue.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function C1(n){if(!Ge.isDocumentKey(n))throw new Re(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function b1(n){if(Ge.isDocumentKey(n))throw new Re(ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function GT(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":Xe()}function fn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Re(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=GT(n);throw new Re(ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function D1(n,e){if(e<=0)throw new Re(ue.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}const T1=new Map;class S1{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Re(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Re(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,I1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class eI{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new S1({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Re(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Re(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new S1(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new fx;switch(t.type){case"gapi":return new gx(t.client,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Re(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=T1.get(e);t&&(Pe("ComponentProvider","Removing Datastore"),T1.delete(e),t.terminate())}(this),Promise.resolve()}}class dr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new bl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new dr(this.firestore,e,this._key)}}class es{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new es(this.firestore,e,this._query)}}class bl extends es{constructor(e,t,r){super(e,t,Kc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new dr(this.firestore,null,new Ge(e))}withConverter(e){return new bl(this.firestore,e,this._path)}}function M1(n,e,...t){if(n=(0,P.m9)(n),hN("collection","path",e),n instanceof eI){const r=an.fromString(e,...t);return b1(r),new bl(n,null,r)}{if(!(n instanceof dr||n instanceof bl))throw new Re(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(an.fromString(e,...t));return b1(r),new bl(n.firestore,null,r)}}function zT(n,e,...t){if(n=(0,P.m9)(n),1===arguments.length&&(e=aE.R()),hN("doc","path",e),n instanceof eI){const r=an.fromString(e,...t);return C1(r),new dr(n,null,new Ge(r))}{if(!(n instanceof dr||n instanceof bl))throw new Re(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(an.fromString(e,...t));return C1(r),new dr(n.firestore,n instanceof bl?n.converter:null,new Ge(r))}}function x1(n,e){return n=(0,P.m9)(n),e=(0,P.m9)(e),(n instanceof dr||n instanceof bl)&&(e instanceof dr||e instanceof bl)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function fN(n,e){return n=(0,P.m9)(n),e=(0,P.m9)(e),n instanceof es&&e instanceof es&&n.firestore===e.firestore&&Yc(n._query,e._query)&&n.converter===e.converter}function R1(n,e=10240){let t=0;return{read:()=>(0,me.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,me.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class qT{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):Sr("Uncaught Error in snapshot listener:",e.toString())}bc(){this.muted=!0}Rc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class r2{constructor(e,t){this.Pc=e,this.yt=t,this.metadata=new Wr,this.buffer=new Uint8Array,this.vc=new TextDecoder("utf-8"),this.Vc().then(r=>{r&&r.Ou()?this.metadata.resolve(r.ku.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.ku)}`))},r=>this.metadata.reject(r))}close(){return this.Pc.cancel()}getMetadata(){var e=this;return(0,me.Z)(function*(){return e.metadata.promise})()}mc(){var e=this;return(0,me.Z)(function*(){return yield e.getMetadata(),e.Vc()})()}Vc(){var e=this;return(0,me.Z)(function*(){const t=yield e.Sc();if(null===t)return null;const r=e.vc.decode(t),i=Number(r);isNaN(i)&&e.Dc(`length string (${r}) is not valid number`);const a=yield e.Cc(i);return new NB(JSON.parse(a),t.length+i)})()}xc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Sc(){var e=this;return(0,me.Z)(function*(){for(;e.xc()<0&&!(yield e.Nc()););if(0===e.buffer.length)return null;const t=e.xc();t<0&&e.Dc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}Cc(e){var t=this;return(0,me.Z)(function*(){for(;t.buffer.length<e;)(yield t.Nc())&&t.Dc("Reached the end of bundle when more is expected.");const r=t.vc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Dc(e){throw this.Pc.cancel(),new Error(`Invalid bundle format: ${e}`)}Nc(){var e=this;return(0,me.Z)(function*(){const t=yield e.Pc.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class o2{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,me.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Re(ue.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,me.Z)(function*(a,l){const h=Ze(a),_=Jh(h.yt)+"/documents",w={documents:l.map(H=>bg(h.yt,H))},D=yield h._o("BatchGetDocuments",_,w,l.length),A=new Map;D.forEach(H=>{const z=function CT(n,e){return"found"in e?function(t,r){gt(!!r.found);const i=ya(t,r.found.name),a=Ur(r.found.updateTime),l=r.found.createTime?Ur(r.found.createTime):vt.min(),h=new yi({mapValue:{fields:r.found.fields}});return Yt.newFoundDocument(i,a,l,h)}(n,e):"missing"in e?function(t,r){gt(!!r.missing),gt(!!r.readTime);const i=ya(t,r.missing),a=Ur(r.readTime);return Yt.newNoDocument(i,a)}(n,e):Xe()}(h.yt,H);A.set(z.key.toString(),z)});const O=[];return l.forEach(H=>{const z=A.get(H.toString());gt(!!z),O.push(z)}),O}),function(a,l){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new vg(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,me.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const a=Ge.fromPath(i);e.mutations.push(new cT(a,e.precondition(a)))}),yield(r=(0,me.Z)(function*(i,a){const l=Ze(i),h=Jh(l.yt)+"/documents",_={writes:a.map(w=>Dg(l.yt,w))};yield l.ao("Commit",h,_)}),function(i,a){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Xe();t=vt.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Re(ue.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(vt.min())?Xn.exists(!1):Xn.updateTime(t):Xn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(vt.min()))throw new Re(ue.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Xn.updateTime(t)}return Xn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class a2{constructor(e,t,r,i,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=a,this.kc=r.maxAttempts,this.xo=new pR(this.asyncQueue,"transaction_retry")}run(){this.kc-=1,this.Oc()}Oc(){var e=this;this.xo.Ro((0,me.Z)(function*(){const t=new o2(e.datastore),r=e.Mc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(a=>{e.Fc(a)}))}).catch(i=>{e.Fc(i)})}))}Mc(e){try{const t=this.updateFunction(e);return!qh(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Fc(e){this.kc>0&&this.$c(e)?(this.kc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Oc(),Promise.resolve()))):this.deferred.reject(e)}$c(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!wg(t)}return!1}}class u2{constructor(e,t,r,i){var a=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ti.UNAUTHENTICATED,this.clientId=aE.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var l=(0,me.Z)(function*(h){Pe("FirestoreClient","Received user=",h.uid),yield a.authCredentialListener(h),a.user=h});return function(h){return l.apply(this,arguments)}}()),this.appCheckCredentials.start(r,l=>(Pe("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}getConfiguration(){var e=this;return(0,me.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Re(ue.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Wr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,me.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=qy(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function N1(n,e){return pN.apply(this,arguments)}function pN(){return pN=(0,me.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),Pe("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,me.Z)(function*(a){r.isEqual(a)||(yield zk(e.localStore,a),r=a)});return function(a){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),pN.apply(this,arguments)}function O1(n,e){return gN.apply(this,arguments)}function gN(){return gN=(0,me.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield mN(n);Pe("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>u1(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,a)=>u1(e.remoteStore,a)),n.onlineComponents=e}),gN.apply(this,arguments)}function mN(n){return _N.apply(this,arguments)}function _N(){return _N=(0,me.Z)(function*(n){return n.offlineComponents||(Pe("FirestoreClient","Using default OfflineComponentProvider"),yield N1(n,new w1)),n.offlineComponents}),_N.apply(this,arguments)}function WT(n){return yN.apply(this,arguments)}function yN(){return yN=(0,me.Z)(function*(n){return n.onlineComponents||(Pe("FirestoreClient","Using default OnlineComponentProvider"),yield O1(n,new dN)),n.onlineComponents}),yN.apply(this,arguments)}function P1(n){return mN(n).then(e=>e.persistence)}function ZT(n){return mN(n).then(e=>e.localStore)}function vN(n){return WT(n).then(e=>e.remoteStore)}function wN(n){return WT(n).then(e=>e.syncEngine)}function Yy(n){return EN.apply(this,arguments)}function EN(){return EN=(0,me.Z)(function*(n){const e=yield WT(n),t=e.eventManager;return t.onListen=LB.bind(null,e.syncEngine),t.onUnlisten=VB.bind(null,e.syncEngine),t}),EN.apply(this,arguments)}function F1(n,e,t={}){const r=new Wr;return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return function(i,a,l,h,_){const w=new qT({next:A=>{a.enqueueAndForget(()=>FR(i,D));const O=A.docs.has(l);!O&&A.fromCache?_.reject(new Re(ue.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&A.fromCache&&h&&"server"===h.source?_.reject(new Re(ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):_.resolve(A)},error:A=>_.reject(A)}),D=new UR(Kc(l.path),w,{includeMetadataChanges:!0,Nu:!0});return PR(i,D)}(yield Yy(n),n.asyncQueue,e,t,r)})),r.promise}function L1(n,e,t={}){const r=new Wr;return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return function(i,a,l,h,_){const w=new qT({next:A=>{a.enqueueAndForget(()=>FR(i,D)),A.fromCache&&"server"===h.source?_.reject(new Re(ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):_.resolve(A)},error:A=>_.reject(A)}),D=new UR(l,w,{includeMetadataChanges:!0,Nu:!0});return PR(i,D)}(yield Yy(n),n.asyncQueue,e,t,r)})),r.promise}class m2{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new pR(this,"async_queue_retry"),this.Wc=()=>{const t=jT();t&&Pe("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.Po()};const e=jT();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.qc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.qc){this.qc=!0,this.Qc=e||!1;const t=jT();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.qc)return new Promise(()=>{});const t=new Wr;return this.Hc(()=>this.qc&&this.Qc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Lc.push(e),this.Jc()))}Jc(){var e=this;return(0,me.Z)(function*(){if(0!==e.Lc.length){try{yield e.Lc[0](),e.Lc.shift(),e.xo.reset()}catch(t){if(!jc(t))throw t;Pe("AsyncQueue","Operation failed with retryable error: "+t)}e.Lc.length>0&&e.xo.Ro(()=>e.Jc())}})()}Hc(e){const t=this.Bc.then(()=>(this.Gc=!0,e().catch(r=>{throw this.Kc=r,this.Gc=!1,Sr("INTERNAL UNHANDLED ERROR: ",function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),l}(r)),r}).then(r=>(this.Gc=!1,r))));return this.Bc=t,t}enqueueAfterDelay(e,t,r){this.zc(),this.jc.indexOf(e)>-1&&(t=0);const i=OR.createAndSchedule(this,e,t,r,a=>this.Yc(a));return this.Uc.push(i),i}zc(){this.Kc&&Xe()}verifyOperationInProgress(){}Xc(){var e=this;return(0,me.Z)(function*(){let t;do{t=e.Bc,yield t}while(t!==e.Bc)})()}Zc(e){for(const t of this.Uc)if(t.timerId===e)return!0;return!1}ta(e){return this.Xc().then(()=>{this.Uc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Uc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Xc()})}ea(e){this.jc.push(e)}Yc(e){const t=this.Uc.indexOf(e);this.Uc.splice(t,1)}}function IN(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class _2{constructor(){this._progressObserver={},this._taskCompletionResolver=new Wr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class hr extends eI{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new m2,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||V1(this),this._firestoreClient.terminate()}}function Kr(n){return n._firestoreClient||V1(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function V1(n){var e;const t=n._freezeSettings(),r=(a=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new BD(n._databaseId,a,n._persistenceKey,(h=t).host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,h.useFetchStreams));var a,h;n._firestoreClient=new u2(n._authCredentials,n._appCheckCredentials,n._queue,r)}function U1(n,e,t){const r=new Wr;return n.asyncQueue.enqueue((0,me.Z)(function*(){try{yield N1(n,t),yield O1(n,e),r.resolve()}catch(i){const a=i;if(!("FirebaseError"===(l=a).name?l.code===ue.FAILED_PRECONDITION||l.code===ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||22===l.code||20===l.code||11===l.code))throw a;Lc("Error enabling offline persistence. Falling back to persistence disabled: "+a),r.reject(a)}var l})).then(()=>r.promise)}function B1(n){if(n._initialized||n._terminated)throw new Re(ue.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Dl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Dl(ri.fromBase64String(e))}catch(t){throw new Re(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Dl(ri.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class sd{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Re(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Fg{constructor(e){this._methodName=e}}class KT{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Re(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Re(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ft(this._lat,e._lat)||Ft(this._long,e._long)}}const S2=/^__.*__$/;class A2{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new du(e,this.data,this.fieldMask,t,this.fieldTransforms):new ed(e,this.data,t,this.fieldTransforms)}}class j1{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new du(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function H1(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xe()}}class YT{constructor(e,t,r,i,a,l){this.settings=e,this.databaseId=t,this.yt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.na(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(e){return new YT(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ia({path:r,oa:!1});return i.ua(e),i}ca(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ia({path:r,oa:!1});return i.na(),i}aa(e){return this.ia({path:void 0,oa:!0})}ha(e){return JT(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}na(){if(this.path)for(let e=0;e<this.path.length;e++)this.ua(this.path.get(e))}ua(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(H1(this.sa)&&S2.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}class M2{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.yt=r||QE(e)}da(e,t,r,i=!1){return new YT({sa:e,methodName:t,fa:r,path:Qn.emptyPath(),oa:!1,la:i},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}function Lg(n){const e=n._freezeSettings(),t=QE(n._databaseId);return new M2(n._databaseId,!!e.ignoreUndefinedProperties,t)}function QT(n,e,t,r,i,a={}){const l=n.da(a.merge||a.mergeFields?2:0,e,t,i);TN("Data must be an object, but it was:",l,r);const h=z1(r,l);let _,w;if(a.merge)_=new Ji(l.fieldMask),w=l.fieldTransforms;else if(a.mergeFields){const D=[];for(const A of a.mergeFields){const O=SN(e,A,t);if(!l.contains(O))throw new Re(ue.INVALID_ARGUMENT,`Field '${O}' is specified in your field mask but missing from your input data.`);W1(D,O)||D.push(O)}_=new Ji(D),w=l.fieldTransforms.filter(A=>_.covers(A.field))}else _=null,w=l.fieldTransforms;return new A2(new yi(h),_,w)}class tI extends Fg{_toFieldTransform(e){if(2!==e.sa)throw e.ha(1===e.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof tI}}function $1(n,e,t){return new YT({sa:3,fa:e.settings.fa,methodName:n._methodName,oa:t},e.databaseId,e.yt,e.ignoreUndefinedProperties)}class CN extends Fg{_toFieldTransform(e){return new Xh(e.path,new wl)}isEqual(e){return e instanceof CN}}class x2 extends Fg{constructor(e,t){super(e),this._a=t}_toFieldTransform(e){const t=$1(this,e,!0),r=this._a.map(a=>Vg(a,t)),i=new El(r);return new Xh(e.path,i)}isEqual(e){return this===e}}class R2 extends Fg{constructor(e,t){super(e),this._a=t}_toFieldTransform(e){const t=$1(this,e,!0),r=this._a.map(a=>Vg(a,t)),i=new Qc(r);return new Xh(e.path,i)}isEqual(e){return this===e}}class N2 extends Fg{constructor(e,t){super(e),this.wa=t}_toFieldTransform(e){const t=new Xc(e.yt,Nx(e.yt,this.wa));return new Xh(e.path,t)}isEqual(e){return this===e}}function bN(n,e,t,r){const i=n.da(1,e,t);TN("Data must be an object, but it was:",i,r);const a=[],l=yi.empty();$c(r,(_,w)=>{const D=XT(e,_,t);w=(0,P.m9)(w);const A=i.ca(D);if(w instanceof tI)a.push(D);else{const O=Vg(w,A);null!=O&&(a.push(D),l.set(D,O))}});const h=new Ji(a);return new j1(l,h,i.fieldTransforms)}function DN(n,e,t,r,i,a){const l=n.da(1,e,t),h=[SN(e,r,t)],_=[i];if(a.length%2!=0)throw new Re(ue.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let O=0;O<a.length;O+=2)h.push(SN(e,a[O])),_.push(a[O+1]);const w=[],D=yi.empty();for(let O=h.length-1;O>=0;--O)if(!W1(w,h[O])){const H=h[O];let z=_[O];z=(0,P.m9)(z);const ce=l.ca(H);if(z instanceof tI)w.push(H);else{const Te=Vg(z,ce);null!=Te&&(w.push(H),D.set(H,Te))}}const A=new Ji(w);return new j1(D,A,l.fieldTransforms)}function G1(n,e,t,r=!1){return Vg(t,n.da(r?4:3,e))}function Vg(n,e){if(q1(n=(0,P.m9)(n)))return TN("Unsupported field value:",e,n),z1(n,e);if(n instanceof Fg)return function(t,r){if(!H1(r.sa))throw r.ha(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.oa&&4!==e.sa)throw e.ha("Nested arrays are not supported");return function(t,r){const i=[];let a=0;for(const l of t){let h=Vg(l,r.aa(a));null==h&&(h={nullValue:"NULL_VALUE"}),i.push(h),a++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,P.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Nx(r.yt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=Yn.fromDate(t);return{timestampValue:Cl(r.yt,i)}}if(t instanceof Yn){const i=new Yn(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Cl(r.yt,i)}}if(t instanceof KT)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Dl)return{bytesValue:vT(r.yt,t._byteString)};if(t instanceof dr){const i=r.databaseId,a=t.firestore._databaseId;if(!a.isEqual(i))throw r.ha(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:wT(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.ha(`Unsupported field value: ${GT(t)}`)}(n,e)}function z1(n,e){const t={};return wy(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):$c(n,(r,i)=>{const a=Vg(i,e.ra(r));null!=a&&(t[r]=a)}),{mapValue:{fields:t}}}function q1(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Yn||n instanceof KT||n instanceof Dl||n instanceof dr||n instanceof Fg)}function TN(n,e,t){if(!q1(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=GT(t);throw e.ha("an object"===r?n+" a custom object":n+" "+r)}var r}function SN(n,e,t){if((e=(0,P.m9)(e))instanceof sd)return e._internalPath;if("string"==typeof e)return XT(n,e);throw JT("Field path arguments must be of type string or ",n,!1,void 0,t)}const O2=new RegExp("[~\\*/\\[\\]]");function XT(n,e,t){if(e.search(O2)>=0)throw JT(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new sd(...e.split("."))._internalPath}catch{throw JT(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function JT(n,e,t,r,i){const a=r&&!r.isEmpty(),l=void 0!==i;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let _="";return(a||l)&&(_+=" (found",a&&(_+=` in field ${r}`),l&&(_+=` in document ${i}`),_+=")"),new Re(ue.INVALID_ARGUMENT,h+n+_)}function W1(n,e){return n.some(t=>t.isEqual(e))}class nI{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new dr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new P2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(eS("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class P2 extends nI{data(){return super.data()}}function eS(n,e){return"string"==typeof e?XT(n,e):e instanceof sd?e._internalPath:e._delegate._internalPath}function Z1(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Re(ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AN{}class rI extends AN{}function sf(n,e,...t){let r=[];e instanceof AN&&r.push(e),r=r.concat(t),function(i){const a=i.filter(h=>h instanceof Qy).length,l=i.filter(h=>h instanceof iI).length;if(a>1||a>0&&l>0)throw new Re(ue.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class iI extends rI{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new iI(e,t,r)}_apply(e){const t=this._parse(e);return X1(e._query,t),new es(e.firestore,e.converter,Sy(e._query,t))}_parse(e){const t=Lg(e.firestore);return function(i,a,l,h,_,w,D){let A;if(_.isKeyField()){if("array-contains"===w||"array-contains-any"===w)throw new Re(ue.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if("in"===w||"not-in"===w){Q1(D,w);const O=[];for(const H of D)O.push(Y1(h,i,H));A={arrayValue:{values:O}}}else A=Y1(h,i,D)}else"in"!==w&&"not-in"!==w&&"array-contains-any"!==w||Q1(D,w),A=G1(l,"where",D,"in"===w||"not-in"===w);return cn.create(_,w,A)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class Qy extends AN{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Qy(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===t.length?t[0]:Sn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(r,i){let a=r;const l=i.getFlattenedFilters();for(const h of l)X1(a,h),a=Sy(a,h)}(e._query,t),new es(e.firestore,e.converter,Sy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class MN extends rI{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new MN(e,t)}_apply(e){const t=function(r,i,a){if(null!==r.startAt)throw new Re(ue.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Re(ue.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const l=new Kh(i,a);return function(h,_){if(null===ME(h)){const w=gg(h);null!==w&&J1(0,w,_.field)}}(r,l),l}(e._query,this._field,this._direction);return new es(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new ma(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class tS extends rI{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new tS(e,t,r)}_apply(e){return new es(e.firestore,e.converter,Qh(e._query,this._limit,this._limitType))}}class nS extends rI{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new nS(e,t,r)}_apply(e){const t=K1(e,this.type,this._docOrFields,this._inclusive);return new es(e.firestore,e.converter,(i=t,new ma((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class rS extends rI{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new rS(e,t,r)}_apply(e){const t=K1(e,this.type,this._docOrFields,this._inclusive);return new es(e.firestore,e.converter,(i=t,new ma((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function K1(n,e,t,r){if(t[0]=(0,P.m9)(t[0]),t[0]instanceof nI)return function(i,a,l,h,_){if(!h)throw new Re(ue.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const w=[];for(const D of cu(i))if(D.field.isKeyField())w.push(vl(a,h.key));else{const A=h.data.field(D.field);if(_E(A))throw new Re(ue.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+D.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===A){const O=D.field.canonicalString();throw new Re(ue.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${O}' (used as the orderBy) does not exist.`)}w.push(A)}return new Wc(w,_)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Lg(n.firestore);return function(a,l,h,_,w,D){const A=a.explicitOrderBy;if(w.length>A.length)throw new Re(ue.INVALID_ARGUMENT,`Too many arguments provided to ${_}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const O=[];for(let H=0;H<w.length;H++){const z=w[H];if(A[H].field.isKeyField()){if("string"!=typeof z)throw new Re(ue.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${_}(), but got a ${typeof z}`);if(!xE(a)&&-1!==z.indexOf("/"))throw new Re(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${_}() must be a plain document ID, but '${z}' contains a slash.`);const ce=a.path.child(an.fromString(z));if(!Ge.isDocumentKey(ce))throw new Re(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${_}() must result in a valid document path, but '${ce}' is not because it contains an odd number of segments.`);const Te=new Ge(ce);O.push(vl(l,Te))}else{const ce=G1(h,_,z);O.push(ce)}}return new Wc(O,D)}(n._query,n.firestore._databaseId,i,e,t,r)}}function Y1(n,e,t){if("string"==typeof(t=(0,P.m9)(t))){if(""===t)throw new Re(ue.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!xE(e)&&-1!==t.indexOf("/"))throw new Re(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(an.fromString(t));if(!Ge.isDocumentKey(r))throw new Re(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return vl(n,new Ge(r))}if(t instanceof dr)return vl(n,t._key);throw new Re(ue.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${GT(t)}.`)}function Q1(n,e){if(!Array.isArray(n)||0===n.length)throw new Re(ue.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new Re(ue.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function X1(n,e){if(e.isInequality()){const r=gg(n),i=e.field;if(null!==r&&!r.isEqual(i))throw new Re(ue.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${i.toString()}'`);const a=ME(n);null!==a&&J1(0,i,a)}const t=function(r,i){for(const a of r)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Re(ue.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function J1(n,e,t){if(!t.isEqual(e))throw new Re(ue.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class xN{convertValue(e,t="none"){switch(Wh(e)){case 0:return null;case 1:return e.booleanValue;case 2:return cr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(uo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Xe()}}convertObject(e,t){const r={};return $c(e.fields,(i,a)=>{r[i]=this.convertValue(a,t)}),r}convertGeoPoint(e){return new KT(cr(e.latitude),cr(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=yE(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Gc(e));default:return null}}convertTimestamp(e){const t=_l(e);return new Yn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=an.fromString(e);gt($x(r));const i=new ml(r.get(1),r.get(3)),a=new Ge(r.popFirst(5));return i.isEqual(t)||Sr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function iS(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class $2 extends xN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new dr(this.firestore,null,t)}}class Ug{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class od extends nI{constructor(e,t,r,i,a,l){super(e,t,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new sI(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(eS("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class sI extends od{data(e={}){return super.data(e)}}class af{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ug(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new sI(this._firestore,this._userDataWriter,r.key,r,new Ug(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Re(ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(l=>({type:"added",doc:new sI(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Ug(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:a++}))}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||3!==l.type).map(l=>{const h=new sI(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Ug(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let _=-1,w=-1;return 0!==l.type&&(_=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),1!==l.type&&(a=a.add(l.doc),w=a.indexOf(l.doc.key)),{type:G2(l.type),doc:h,oldIndex:_,newIndex:w}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function G2(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xe()}}function tF(n,e){return n instanceof od&&e instanceof od?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof af&&e instanceof af&&n._firestore===e._firestore&&fN(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class uf extends xN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new dr(this.firestore,null,t)}}function nF(n,e,t){n=fn(n,dr);const r=fn(n.firestore,hr),i=iS(n.converter,e,t);return Xy(r,[QT(Lg(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,Xn.none())])}function rF(n,e,t,...r){n=fn(n,dr);const i=fn(n.firestore,hr),a=Lg(i);let l;return l="string"==typeof(e=(0,P.m9)(e))||e instanceof sd?DN(a,"updateDoc",n._key,e,t,r):bN(a,"updateDoc",n._key,e),Xy(i,[l.toMutation(n._key,Xn.exists(!0))])}function iF(n,...e){var t,r,i;n=(0,P.m9)(n);let a={includeMetadataChanges:!1},l=0;"object"!=typeof e[l]||IN(e[l])||(a=e[l],l++);const h={includeMetadataChanges:a.includeMetadataChanges};if(IN(e[l])){const A=e[l];e[l]=null===(t=A.next)||void 0===t?void 0:t.bind(A),e[l+1]=null===(r=A.error)||void 0===r?void 0:r.bind(A),e[l+2]=null===(i=A.complete)||void 0===i?void 0:i.bind(A)}let _,w,D;if(n instanceof dr)w=fn(n.firestore,hr),D=Kc(n._key.path),_={next:A=>{e[l]&&e[l](RN(w,n,A))},error:e[l+1],complete:e[l+2]};else{const A=fn(n,es);w=fn(A.firestore,hr),D=A._query;const O=new uf(w);_={next:H=>{e[l]&&e[l](new af(w,O,A,H))},error:e[l+1],complete:e[l+2]},Z1(n._query)}return function(A,O,H,z){const ce=new qT(z),Te=new UR(O,ce,H);return A.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return PR(yield Yy(A),Te)})),()=>{ce.bc(),A.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return FR(yield Yy(A),Te)}))}}(Kr(w),D,h,_)}function Xy(n,e){return function(t,r){const i=new Wr;return t.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return function UB(n,e,t){return GR.apply(this,arguments)}(yield wN(t),r,i)})),i.promise}(Kr(n),e)}function RN(n,e,t){const r=t.docs.get(e._key),i=new uf(n);return new od(n,i,e._key,r,new Ug(t.hasPendingWrites,t.fromCache),e.converter)}const ej={maxAttempts:5};class sF{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Lg(e)}set(e,t,r){this._verifyNotCommitted();const i=lf(e,this._firestore),a=iS(i.converter,t,r),l=QT(this._dataReader,"WriteBatch.set",i._key,a,null!==i.converter,r);return this._mutations.push(l.toMutation(i._key,Xn.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=lf(e,this._firestore);let l;return l="string"==typeof(t=(0,P.m9)(t))||t instanceof sd?DN(this._dataReader,"WriteBatch.update",a._key,t,r,i):bN(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,Xn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=lf(e,this._firestore);return this._mutations=this._mutations.concat(new vg(t._key,Xn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Re(ue.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function lf(n,e){if((n=(0,P.m9)(n)).firestore!==e)throw new Re(ue.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class tj extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Lg(e)}get(e){const t=lf(e,this._firestore),r=new $2(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return Xe();const a=i[0];if(a.isFoundDocument())return new nI(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new nI(this._firestore,r,t._key,null,t.converter);throw Xe()})}set(e,t,r){const i=lf(e,this._firestore),a=iS(i.converter,t,r),l=QT(this._dataReader,"Transaction.set",i._key,a,null!==i.converter,r);return this._transaction.set(i._key,l),this}update(e,t,r,...i){const a=lf(e,this._firestore);let l;return l="string"==typeof(t=(0,P.m9)(t))||t instanceof sd?DN(this._dataReader,"Transaction.update",a._key,t,r,i):bN(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=lf(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=lf(e,this._firestore),r=new uf(this._firestore);return super.get(e).then(i=>new od(this._firestore,r,t._key,i._document,new Ug(!1,!1),t.converter))}}function NN(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Re("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function aF(){if(typeof Uint8Array>"u")throw new Re("unimplemented","Uint8Arrays are not available in this environment.")}function uF(){if(!function mE(){return typeof atob<"u"}())throw new Re("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){fl=gs.SDK_VERSION,(0,gs._registerComponent)(new ko.wA("firestore",(t,{instanceIdentifier:r,options:i})=>{const a=t.getProvider("app").getImmediate(),l=new hr(new kD(t.getProvider("auth-internal")),new LD(t.getProvider("app-check-internal")),function(h,_){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Re(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ml(h.options.projectId,_)}(a,r),a);return i=Object.assign({useFetchStreams:e},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),(0,gs.registerVersion)(Gh,"3.8.1",n),(0,gs.registerVersion)(Gh,"3.8.1","esm2017")}();class oI{constructor(e){this._delegate=e}static fromBase64String(e){return uF(),new oI(Dl.fromBase64String(e))}static fromUint8Array(e){return aF(),new oI(Dl.fromUint8Array(e))}toBase64(){return uF(),this._delegate.toBase64()}toUint8Array(){return aF(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function ON(n){return function cj(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class dj{enableIndexedDbPersistence(e,t){return function v2(n,e){B1(n=fn(n,hr));const t=Kr(n),r=n._freezeSettings(),i=new dN;return U1(t,i,new E1(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function w2(n){B1(n=fn(n,hr));const e=Kr(n),t=n._freezeSettings(),r=new dN;return U1(e,r,new t2(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function E2(n){if(n._initialized&&!n._terminated)throw new Re(ue.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Wr;return n._queue.enqueueAndForgetEvenWhileRestricted((0,me.Z)(function*(){try{yield(t=(0,me.Z)(function*(r){if(!Oi.C())return Promise.resolve();const i=r+"main";yield Oi.delete(i)}),function(r){return t.apply(this,arguments)})(iR(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class lF{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ml||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Lc("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function A1(n,e,t,r={}){var i;const a=(n=fn(n,eI))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==e&&Lc("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},a),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let l,h;if("string"==typeof r.mockUserToken)l=r.mockUserToken,h=ti.MOCK_USER;else{l=(0,P.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const _=r.mockUserToken.sub||r.mockUserToken.user_id;if(!_)throw new Re(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new ti(_)}n._authCredentials=new px(new sE(l,h))}}(this._delegate,e,t,r)}enableNetwork(){return function C2(n){return function l2(n){return n.asyncQueue.enqueue((0,me.Z)(function*(){const e=yield P1(n),t=yield vN(n);return e.setNetworkEnabled(!0),function(r){const i=Ze(r);return i._u.delete(0),XE(i)}(t)}))}(Kr(n=fn(n,hr)))}(this._delegate)}disableNetwork(){return function b2(n){return function c2(n){return n.asyncQueue.enqueue((0,me.Z)(function*(){const e=yield P1(n),t=yield vN(n);return e.setNetworkEnabled(!1),(r=(0,me.Z)(function*(i){const a=Ze(i);a._u.add(0),yield $y(a),a.gu.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(Kr(n=fn(n,hr)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,I1("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function I2(n){return function(e){const t=new Wr;return e.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return function $B(n,e){return KR.apply(this,arguments)}(yield wN(e),t)})),t.promise}(Kr(n=fn(n,hr)))}(this._delegate)}onSnapshotsInSync(e){return function J2(n,e){return function f2(n,e){const t=new qT(e);return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return r=yield Yy(n),i=t,Ze(r).Ru.add(i),void i.next();var r,i})),()=>{t.bc(),n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return r=yield Yy(n),i=t,void Ze(r).Ru.delete(i);var r,i}))}}(Kr(n=fn(n,hr)),IN(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Re("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Jy(this,M1(this._delegate,e))}catch(t){throw Bs(t,"collection()","Firestore.collection()")}}doc(e){try{return new wa(this,zT(this._delegate,e))}catch(t){throw Bs(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new js(this,function n2(n,e){if(n=fn(n,eI),hN("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Re(ue.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new es(n,null,(t=e,new ma(an.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Bs(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function nj(n,e,t){n=fn(n,hr);const r=Object.assign(Object.assign({},ej),t);return function(i){if(i.maxAttempts<1)throw new Re(ue.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,a,l){const h=new Wr;return i.asyncQueue.enqueueAndForget((0,me.Z)(function*(){const _=yield function k1(n){return WT(n).then(e=>e.datastore)}(i);new a2(i.asyncQueue,_,l,a,h).run()})),h.promise}(Kr(n),i=>e(new tj(n,i)),r)}(this._delegate,t=>e(new cF(this,t)))}batch(){return Kr(this._delegate),new dF(new sF(this._delegate,e=>Xy(this._delegate,e)))}loadBundle(e){return function D2(n,e){const t=Kr(n=fn(n,hr)),r=new _2;return function p2(n,e,t,r){const i=function(a,l){let h;return h="string"==typeof a?(new TextEncoder).encode(a):a,_=function(_,w){if(_ instanceof Uint8Array)return R1(_,w);if(_ instanceof ArrayBuffer)return R1(new Uint8Array(_),w);if(_ instanceof ReadableStream)return _.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),new r2(_,l);var _}(t,QE(e));n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){!function e2(n,e,t){const r=Ze(n);var i;(i=(0,me.Z)(function*(a,l,h){try{const _=yield l.getMetadata();if(yield function(O,H){const z=Ze(O),ce=Ur(H.createTime);return z.persistence.runTransaction("hasNewerBundle","readonly",Te=>z.Ns.getBundleMetadata(Te,H.id)).then(Te=>!!Te&&Te.createTime.compareTo(ce)>=0)}(a.localStore,_))return yield l.close(),h._completeWith({taskState:"Success",documentsLoaded:(O=_).totalDocuments,bytesLoaded:O.totalBytes,totalDocuments:O.totalDocuments,totalBytes:O.totalBytes}),Promise.resolve(new Set);h._updateProgress(d1(_));const w=new OB(_,a.localStore,l.yt);let D=yield l.mc();for(;D;){const O=yield w.Fu(D);O&&h._updateProgress(O),D=yield l.mc()}const A=yield w.complete();return yield id(a,A.Lu,void 0),yield function(O,H){const z=Ze(O);return z.persistence.runTransaction("Save bundle","readwrite",ce=>z.Ns.saveBundleMetadata(ce,H))}(a.localStore,_),h._completeWith(A.progress),Promise.resolve(A.Bu)}catch(_){return Lc("SyncEngine",`Loading bundle failed with ${_}`),h._failWith(_),Promise.resolve(new Set)}var O}),function(a,l,h){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield wN(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function T2(n,e){return function g2(n,e){return n.asyncQueue.enqueue((0,me.Z)(function*(){return function(t,r){const i=Ze(t);return i.persistence.runTransaction("Get named query","readonly",a=>i.Ns.getNamedQuery(a,r))}(yield ZT(n),e)}))}(Kr(n=fn(n,hr)),e).then(t=>t?new es(n,null,t.query):null)}(this._delegate,e).then(t=>t?new js(this,t):null)}}class sS extends xN{constructor(e){super(),this.firestore=e}convertBytes(e){return new oI(new Dl(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return wa.forKey(t,this.firestore,null)}}class cF{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new sS(e)}get(e){const t=jg(e);return this._delegate.get(t).then(r=>new aI(this._firestore,new od(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=jg(e);return r?(NN("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=jg(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=jg(e);return this._delegate.delete(t),this}}class dF{constructor(e){this._delegate=e}set(e,t,r){const i=jg(e);return r?(NN("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=jg(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=jg(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Bg{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new sI(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new uI(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Bg.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let a=i.get(t);return a||(a=new Bg(e,new sS(e),t),i.set(t,a)),a}}Bg.INSTANCES=new WeakMap;class wa{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new sS(e)}static forPath(e,t,r){if(e.length%2!=0)throw new Re("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new wa(t,new dr(t._delegate,r,new Ge(e)))}static forKey(e,t,r){return new wa(t,new dr(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Jy(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Jy(this.firestore,M1(this._delegate,e))}catch(t){throw Bs(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,P.m9)(e))instanceof dr&&x1(this._delegate,e)}set(e,t){t=NN("DocumentReference.set",t);try{return t?nF(this._delegate,e,t):nF(this._delegate,e)}catch(r){throw Bs(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?rF(this._delegate,e):rF(this._delegate,e,t,...r)}catch(i){throw Bs(i,"updateDoc()","DocumentReference.update()")}}delete(){return function Q2(n){return Xy(fn(n.firestore,hr),[new vg(n._key,Xn.none())])}(this._delegate)}onSnapshot(...e){const t=hF(e),r=fF(e,i=>new aI(this.firestore,new od(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return iF(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function q2(n){n=fn(n,dr);const e=fn(n.firestore,hr),t=Kr(e),r=new uf(e);return function d2(n,e){const t=new Wr;return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return(r=(0,me.Z)(function*(i,a,l){try{const h=yield function(_,w){const D=Ze(_);return D.persistence.runTransaction("read document","readonly",A=>D.localDocuments.getDocument(A,w))}(i,a);h.isFoundDocument()?l.resolve(h):h.isNoDocument()?l.resolve(null):l.reject(new Re(ue.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const _=qy(h,`Failed to get document '${a} from cache`);l.reject(_)}}),function(i,a,l){return r.apply(this,arguments)})(yield ZT(n),e,t);var r})),t.promise}(t,n._key).then(i=>new od(e,r,n._key,i,new Ug(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function W2(n){n=fn(n,dr);const e=fn(n.firestore,hr);return F1(Kr(e),n._key,{source:"server"}).then(t=>RN(e,n,t))}(this._delegate):function z2(n){n=fn(n,dr);const e=fn(n.firestore,hr);return F1(Kr(e),n._key).then(t=>RN(e,n,t))}(this._delegate),t.then(r=>new aI(this.firestore,new od(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new wa(this.firestore,this._delegate.withConverter(e?Bg.getInstance(this.firestore,e):null))}}function Bs(n,e,t){return n.message=n.message.replace(e,t),n}function hF(n){for(const e of n)if("object"==typeof e&&!ON(e))return e;return{}}function fF(n,e){var t,r;let i;return i=ON(n[0])?n[0]:ON(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:a=>{i.next&&i.next(e(a))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class aI{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new wa(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return tF(this._delegate,e._delegate)}}class uI extends aI{data(e){const t=this._delegate.data(e);return function hx(n,e){n||Xe()}(void 0!==t),t}}class js{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new sS(e)}where(e,t,r){try{return new js(this.firestore,sf(this._delegate,function k2(n,e,t){const r=e,i=eS("where",n);return iI._create(i,r,t)}(e,t,r)))}catch(i){throw Bs(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new js(this.firestore,sf(this._delegate,function F2(n,e="asc"){const t=e,r=eS("orderBy",n);return MN._create(r,t)}(e,t)))}catch(r){throw Bs(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new js(this.firestore,sf(this._delegate,function L2(n){return D1("limit",n),tS._create("limit",n,"F")}(e)))}catch(t){throw Bs(t,"limit()","Query.limit()")}}limitToLast(e){try{return new js(this.firestore,sf(this._delegate,function V2(n){return D1("limitToLast",n),tS._create("limitToLast",n,"L")}(e)))}catch(t){throw Bs(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new js(this.firestore,sf(this._delegate,function U2(...n){return nS._create("startAt",n,!0)}(...e)))}catch(t){throw Bs(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new js(this.firestore,sf(this._delegate,function B2(...n){return nS._create("startAfter",n,!1)}(...e)))}catch(t){throw Bs(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new js(this.firestore,sf(this._delegate,function j2(...n){return rS._create("endBefore",n,!1)}(...e)))}catch(t){throw Bs(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new js(this.firestore,sf(this._delegate,function H2(...n){return rS._create("endAt",n,!0)}(...e)))}catch(t){throw Bs(t,"endAt()","Query.endAt()")}}isEqual(e){return fN(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function K2(n){n=fn(n,es);const e=fn(n.firestore,hr),t=Kr(e),r=new uf(e);return function h2(n,e){const t=new Wr;return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return(r=(0,me.Z)(function*(i,a,l){try{const h=yield VT(i,a,!0),_=new p1(a,h.Hi),w=_.Wu(h.documents),D=_.applyChanges(w,!1);l.resolve(D.snapshot)}catch(h){const _=qy(h,`Failed to execute query '${a} against cache`);l.reject(_)}}),function(i,a,l){return r.apply(this,arguments)})(yield ZT(n),e,t);var r})),t.promise}(t,n._query).then(i=>new af(e,r,n,i))}(this._delegate):"server"===e?.source?function Y2(n){n=fn(n,es);const e=fn(n.firestore,hr),t=Kr(e),r=new uf(e);return L1(t,n._query,{source:"server"}).then(i=>new af(e,r,n,i))}(this._delegate):function Z2(n){n=fn(n,es);const e=fn(n.firestore,hr),t=Kr(e),r=new uf(e);return Z1(n._query),L1(t,n._query).then(i=>new af(e,r,n,i))}(this._delegate),t.then(r=>new PN(this.firestore,new af(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=hF(e),r=fF(e,i=>new PN(this.firestore,new af(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return iF(this._delegate,t,r)}withConverter(e){return new js(this.firestore,this._delegate.withConverter(e?Bg.getInstance(this.firestore,e):null))}}class fj{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new uI(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class PN{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new js(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new uI(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new fj(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new uI(this._firestore,r))})}isEqual(e){return tF(this._delegate,e._delegate)}}class Jy extends js{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new wa(this.firestore,e):null}doc(e){try{return new wa(this.firestore,void 0===e?zT(this._delegate):zT(this._delegate,e))}catch(t){throw Bs(t,"doc()","CollectionReference.doc()")}}add(e){return function X2(n,e){const t=fn(n.firestore,hr),r=zT(n),i=iS(n.converter,e);return Xy(t,[QT(Lg(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,Xn.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new wa(this.firestore,t))}isEqual(e){return x1(this._delegate,e._delegate)}withConverter(e){return new Jy(this.firestore,this._delegate.withConverter(e?Bg.getInstance(this.firestore,e):null))}}function jg(n){return fn(n,dr)}class kN{constructor(...e){this._delegate=new sd(...e)}static documentId(){return new kN(Qn.keyField().canonicalString())}isEqual(e){return(e=(0,P.m9)(e))instanceof sd&&this._delegate._internalPath.isEqual(e._internalPath)}}class Hg{constructor(e){this._delegate=e}static serverTimestamp(){const e=function ij(){return new CN("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Hg(e)}static delete(){const e=function rj(){return new tI("deleteField")}();return e._methodName="FieldValue.delete",new Hg(e)}static arrayUnion(...e){const t=function sj(...n){return new x2("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Hg(t)}static arrayRemove(...e){const t=function oj(...n){return new R2("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Hg(t)}static increment(e){const t=function aj(n){return new N2("increment",n)}(e);return t._methodName="FieldValue.increment",new Hg(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const pj={Firestore:lF,GeoPoint:KT,Timestamp:Yn,Blob:oI,Transaction:cF,WriteBatch:dF,DocumentReference:wa,DocumentSnapshot:aI,Query:js,QueryDocumentSnapshot:uI,QuerySnapshot:PN,CollectionReference:Jy,FieldPath:kN,FieldValue:Hg,setLogLevel:function hj(n){!function rE(n){_i.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function pF(n,e){return function _j(n,e=n0.z){return new Jr.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function FN(n,e){return pF(n,e).pipe((0,Tt.U)(t=>({payload:t,type:"query"})))}function oS(n,e){return FN(n,e).pipe(or(void 0),r0(),(0,Tt.U)(([t,r])=>{const i=r.payload.docChanges(),a=i.map(l=>({type:l.type,payload:l}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((l,h)=>{const _=i.find(D=>D.doc.ref.isEqual(l.ref)),w=t?.payload.docs.find(D=>D.ref.isEqual(l.ref));_&&JSON.stringify(_.doc.metadata)===JSON.stringify(l.metadata)||!_&&w&&JSON.stringify(w.metadata)===JSON.stringify(l.metadata)||a.push({type:"modified",payload:{oldIndex:h,newIndex:h,type:"modified",doc:l}})}),a}))}function gF(n,e,t){return oS(n,t).pipe(ks((r,i)=>function vj(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function wj(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return LN(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return LN(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return LN(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(a=>a.payload),e),[]),(0,s0.x)(),(0,Tt.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function LN(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function mF(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}!function mj(n){(function gj(n,e){n.INTERNAL.registerComponent(new ko.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},pj)))})(n,(e,t)=>new lF(e,t,new dj)),n.registerVersion("@firebase/firestore-compat","0.3.1")}(F_.Z);class _F{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=oS(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,Tt.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(or(void 0),r0(),ar(([r,i])=>i.length>0||!r),(0,Tt.U)(([r,i])=>i),dn.iC)}auditTrail(e){return this.stateChanges(e).pipe(ks((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=mF(e);return gF(this.query,t,this.afs.schedulers.outsideAngular).pipe(dn.iC)}valueChanges(e={}){return FN(this.query,this.afs.schedulers.outsideAngular).pipe((0,Tt.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),dn.iC)}get(e){return(0,nn.D)(this.query.get(e)).pipe(dn.iC)}add(e){return this.ref.add(e)}doc(e){return new yF(this.ref.doc(e),this.afs)}}class yF{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:a}=EF(r,t);return new _F(i,a,this.afs)}snapshotChanges(){return function yj(n,e){return pF(n,e).pipe(or(void 0),r0(),(0,Tt.U)(([t,r])=>r.exists?t?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(dn.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,Tt.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,nn.D)(this.ref.get(e)).pipe(dn.iC)}}class Ej{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?oS(this.query,this.afs.schedulers.outsideAngular).pipe((0,Tt.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),ar(t=>t.length>0),dn.iC):oS(this.query,this.afs.schedulers.outsideAngular).pipe(dn.iC)}auditTrail(e){return this.stateChanges(e).pipe(ks((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=mF(e);return gF(this.query,t,this.afs.schedulers.outsideAngular).pipe(dn.iC)}valueChanges(e={}){return FN(this.query,this.afs.schedulers.outsideAngular).pipe((0,Tt.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),dn.iC)}get(e){return(0,nn.D)(this.query.get(e)).pipe(dn.iC)}}const vF=new f.OlP("angularfire2.enableFirestorePersistence"),wF=new f.OlP("angularfire2.firestore.persistenceSettings"),Ij=new f.OlP("angularfire2.firestore.settings"),Cj=new f.OlP("angularfire2.firestore.use-emulator");function EF(n,e=(t=>t)){return{query:e(n),ref:n}}let aS=(()=>{class n{constructor(t,r,i,a,l,h,_,w,D,A,O,H,z,ce,Te,ht,yt){this.schedulers=_;const nt=(0,Dr.on)(t,h,r),at=D;A&&w_(nt,h,O,z,ce,Te,H,ht),[this.firestore,this.persistenceEnabled$]=(0,Dr.cc)(`${nt.name}.firestore`,"AngularFirestore",nt.name,()=>{const Dt=h.runOutsideAngular(()=>nt.firestore());if(a&&Dt.settings(a),at&&Dt.useEmulator(...at),i&&!rr(l)){const Lt=()=>{try{return(0,nn.D)(Dt.enablePersistence(w||void 0).then(()=>!0,()=>!1))}catch(Rr){return typeof console<"u"&&console.warn(Rr),(0,ct.of)(!1)}};return[Dt,h.runOutsideAngular(Lt)]}return[Dt,(0,ct.of)(!1)]},[a,at,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:a,query:l}=EF(i,r),h=this.schedulers.ngZone.run(()=>a);return new _F(h,l,this)}collectionGroup(t,r){const i=r||(l=>l),a=this.firestore.collectionGroup(t);return new Ej(i(a),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new yF(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Dr.Dh),f.LFG(Dr.xv,8),f.LFG(vF,8),f.LFG(Ij,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(dn.HU),f.LFG(wF,8),f.LFG(Cj,8),f.LFG(wc,8),f.LFG(Ew,8),f.LFG(io,8),f.LFG(Ep,8),f.LFG(Iw,8),f.LFG(v_,8),f.LFG(Cw,8),f.LFG(wp,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),bj=(()=>{class n{constructor(){y_.Z.registerVersion("angularfire",dn.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:vF,useValue:!0},{provide:wF,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[aS]}),n})();function Dj(n,e){if(1&n&&(f.TgZ(0,"li"),f._uU(1),f.qZA()),2&n){const t=e.$implicit;f.xp6(1),f.Oqu(t)}}function Tj(n,e){if(1&n&&(f.TgZ(0,"li"),f._uU(1),f.qZA()),2&n){const t=e.$implicit;f.xp6(1),f.Oqu(t)}}const Sj=function(n){return["/edit",n]};function Aj(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"li",3)(1,"h2"),f._uU(2),f.qZA(),f.TgZ(3,"p")(4,"strong"),f._uU(5,"Duration:"),f.qZA(),f._uU(6),f.qZA(),f.TgZ(7,"p")(8,"strong"),f._uU(9,"Ingredients:"),f.qZA()(),f.TgZ(10,"ul"),f.YNc(11,Dj,2,1,"li",4),f.qZA(),f.TgZ(12,"p")(13,"strong"),f._uU(14,"Steps:"),f.qZA()(),f.TgZ(15,"ol"),f.YNc(16,Tj,2,1,"li",4),f.qZA(),f.TgZ(17,"div"),f._UZ(18,"h1"),f.TgZ(19,"button",5),f._uU(20," Edit Recipe "),f.qZA(),f.TgZ(21,"button",6),f.NdJ("click",function(){const a=f.CHM(t).$implicit,l=f.oxw();return f.KtG(l.deleteRecipe(a.id))}),f._uU(22," Delete recipe "),f.qZA()()()}if(2&n){const t=e.$implicit;f.xp6(2),f.Oqu(t.name),f.xp6(4),f.hij(" ",t.duration," minutes"),f.xp6(5),f.Q6J("ngForOf",t.ingredients),f.xp6(5),f.Q6J("ngForOf",t.steps),f.xp6(3),f.Q6J("routerLink",f.VKq(5,Sj,t.id))}}let Mj=(()=>{class n{constructor(t){this.firestore=t}ngOnInit(){this.recipes$=this.firestore.collection("recipes").valueChanges()}deleteRecipe(t){alert("deleteRecipe"+t),this.firestore.collection("recipes").doc(t).delete().then(()=>{alert("Recipe successfully deleted! "+t)}).catch(r=>{alert("error deleting recipe: "+r)})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(aS))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-home"]],decls:6,vars:3,consts:[[1,"recipe-list-container"],[1,"recipe-list"],["class","recipe-item",4,"ngFor","ngForOf"],[1,"recipe-item"],[4,"ngFor","ngForOf"],["id","edit",3,"routerLink"],["id","deleteButton",3,"click"]],template:function(t,r){1&t&&(f.TgZ(0,"h1"),f._uU(1,"Recipes List"),f.qZA(),f.TgZ(2,"div",0)(3,"ul",1),f.YNc(4,Aj,23,7,"li",2),f.ALo(5,"async"),f.qZA()()),2&t&&(f.xp6(4),f.Q6J("ngForOf",f.lcZ(5,1,r.recipes$)))},dependencies:[Go,pc,ci],styles:[".recipe-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.recipe-item[_ngcontent-%COMP%]{padding:1em;margin-bottom:2em;background-color:#fff;border-radius:5px;box-shadow:0 2px 4px #0000001a}.recipe-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;color:#313438}"]}),n})();function xj(n,e){if(1&n&&(f.TgZ(0,"li"),f._uU(1),f.qZA()),2&n){const t=e.$implicit;f.xp6(1),f.Oqu(t)}}function Rj(n,e){if(1&n&&(f.TgZ(0,"li"),f._uU(1),f.qZA()),2&n){const t=e.$implicit;f.xp6(1),f.Oqu(t)}}let Nj=(()=>{class n{constructor(t){this.firestore=t,this.name="Angular",this.recipeName="",this.duration=0,this.id=self.crypto.randomUUID(),this.nextIngredient="",this.allIngredients=[],this.nextStep="",this.allSteps=[]}addIngredient(){this.allIngredients.push(this.nextIngredient),this.nextIngredient=""}addStep(){this.allSteps.push(this.nextStep),this.nextStep=""}addRecipe(){this.firestore.collection("recipes").doc(this.id).set({id:this.id,name:this.recipeName,duration:this.duration,ingredients:this.allIngredients,steps:this.allSteps}).then(function(){alert("Recipe saved!")}).catch(function(t){alert("error saving recipe: "+t)})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(aS))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-add"]],decls:24,vars:6,consts:[[1,"add-recipe-form"],["for","recipeName"],["type","text","id","recipeName","name","recipeName","placeholder","Recipe Name",1,"form-control",3,"ngModel","ngModelChange"],["for","duration"],["type","text","id","duration","name","duration","placeholder","Duration",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["type","text","name","ingredient","placeholder","Enter ingredient",1,"form-control",3,"ngModel","ngModelChange"],[3,"click"],["rows","5","name","steps","placeholder","Enter step",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn-add",3,"click"]],template:function(t,r){1&t&&(f.TgZ(0,"h1"),f._uU(1,"Add A Recipe"),f.qZA(),f.TgZ(2,"div",0)(3,"form")(4,"label",1),f._uU(5,"Recipe Name:"),f.qZA(),f.TgZ(6,"input",2),f.NdJ("ngModelChange",function(a){return r.recipeName=a}),f.qZA(),f.TgZ(7,"label",3),f._uU(8,"Duration:"),f.qZA(),f.TgZ(9,"input",4),f.NdJ("ngModelChange",function(a){return r.duration=a}),f.qZA(),f.TgZ(10,"label"),f._uU(11,"Ingredients:"),f.qZA(),f.YNc(12,xj,2,1,"li",5),f.TgZ(13,"input",6),f.NdJ("ngModelChange",function(a){return r.nextIngredient=a}),f.qZA(),f.TgZ(14,"button",7),f.NdJ("click",function(){return r.addIngredient()}),f._uU(15,"Add Ingredient"),f.qZA(),f.TgZ(16,"label"),f._uU(17,"Steps:"),f.qZA(),f.YNc(18,Rj,2,1,"li",5),f.TgZ(19,"textarea",8),f.NdJ("ngModelChange",function(a){return r.nextStep=a}),f.qZA(),f.TgZ(20,"button",7),f.NdJ("click",function(){return r.addStep()}),f._uU(21,"Add Step"),f.qZA(),f.TgZ(22,"button",9),f.NdJ("click",function(){return r.addRecipe()}),f._uU(23,"Add Recipe"),f.qZA()()()),2&t&&(f.xp6(6),f.Q6J("ngModel",r.recipeName),f.xp6(3),f.Q6J("ngModel",r.duration),f.xp6(3),f.Q6J("ngForOf",r.allIngredients),f.xp6(1),f.Q6J("ngModel",r.nextIngredient),f.xp6(5),f.Q6J("ngForOf",r.allSteps),f.xp6(1),f.Q6J("ngModel",r.nextStep))},dependencies:[Go,A_,Ec,bp,Fw,Ac,Pp],styles:[".add-recipe-form[_ngcontent-%COMP%]{padding:2em;background-color:#fff;border-radius:5px;box-shadow:0 2px 4px #0000001a}.add-recipe-form[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-control[_ngcontent-%COMP%]{padding:8px;margin-bottom:10px;border:1px solid #ccc;border-radius:4px}ul[_ngcontent-%COMP%]{list-style:none;padding-left:0}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:5px}label[_ngcontent-%COMP%]:not(:first-child){margin:2em 0 1em}label[_ngcontent-%COMP%]:first-child{margin:0 0 1em}textarea[_ngcontent-%COMP%]{padding:8px;margin-bottom:10px;border:1px solid #ccc;border-radius:4px}button[_ngcontent-%COMP%]{padding:8px 16px;color:#fff;background-color:#313438;border:1px solid #313438;border-radius:5px;max-width:max-content;text-transform:uppercase;cursor:pointer;font-weight:700}button[_ngcontent-%COMP%]:hover{color:#313438;background-color:transparent}.btn-add[_ngcontent-%COMP%]{font-size:1.1em;width:100%;max-width:none;padding:1em;margin-top:2em;background-color:#319cff;border:1px solid #319cff}.btn-add[_ngcontent-%COMP%]:hover{color:#319cff;background-color:transparent;border:1px solid #319cff}"]}),n})();function Oj(n,e){if(1&n&&(f.TgZ(0,"li"),f._uU(1),f.qZA()),2&n){const t=e.$implicit;f.xp6(1),f.Oqu(t)}}function Pj(n,e){if(1&n&&(f.TgZ(0,"li"),f._uU(1),f.qZA()),2&n){const t=e.$implicit;f.xp6(1),f.Oqu(t)}}let kj=(()=>{class n{constructor(t,r){this.firestore=t,this.route=r,this.id="",this.recipeName="",this.duration=0,this.newRecipeName="",this.newDuration=0,this.newIngredient="",this.newAllIngredients=[],this.newStep="",this.newAllSteps=[]}ngOnInit(){this.id=this.route.snapshot.paramMap.get("id"),this.getRecipeData(this.id)}getRecipeData(t){this.firestore.collection("recipes").doc(t).ref.get().then(r=>{if(r.exists){const i=r.data();this.recipeName=i.name,this.duration=i.duration,this.newRecipeName=i.name,this.newDuration=i.duration,this.newAllIngredients=i.ingredients,this.newAllSteps=i.steps}else console.log("This document doesn't exist")}).catch(r=>{console.log("There was an error getting your document:",r)})}addIngredient(){this.newAllIngredients.push(this.newIngredient),this.newIngredient=""}addStep(){this.newAllSteps.push(this.newStep),this.newStep=""}saveEditedRecipe(){this.firestore.collection("recipes").doc(this.id).set({id:this.id,name:this.newRecipeName,duration:this.newDuration,ingredients:this.newAllIngredients,steps:this.newAllSteps}).then(()=>{alert("New recipe successfully saved!")}).catch(t=>{alert("error saving new recipe: "+t)})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(aS),f.Y36(Oo))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-edit"]],decls:42,vars:10,consts:[[1,"edit-recipe-form"],["for","recipeName"],["type","text","id","recipeName","name","recipeName","placeholder","New recipe name",1,"form-control",3,"ngModel","ngModelChange"],["for","duration"],["type","text","id","duration","name","duration","placeholder","New duration",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["for","ingredient"],["type","text","name","ingredient","placeholder","Enter ingredient",1,"form-control",3,"ngModel","ngModelChange"],[3,"click"],["for","step"],["rows","5","name","steps","placeholder","Enter step",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn-edit",3,"click"]],template:function(t,r){1&t&&(f.TgZ(0,"h1"),f._uU(1,"Edit Recipe"),f.qZA(),f.TgZ(2,"div",0)(3,"form")(4,"p"),f._uU(5," Current Recipe Name: "),f.TgZ(6,"i"),f._uU(7),f.qZA()(),f.TgZ(8,"label",1),f._uU(9,"New Recipe Name: "),f.TgZ(10,"b"),f._uU(11),f.qZA()(),f.TgZ(12,"input",2),f.NdJ("ngModelChange",function(a){return r.newRecipeName=a}),f.qZA(),f.TgZ(13,"p"),f._uU(14," Current Recipe Duration: "),f.TgZ(15,"i"),f._uU(16),f.qZA()(),f.TgZ(17,"label",3),f._uU(18,"New duration: "),f.TgZ(19,"b"),f._uU(20),f.qZA()(),f.TgZ(21,"input",4),f.NdJ("ngModelChange",function(a){return r.newDuration=a}),f.qZA(),f.TgZ(22,"p"),f._uU(23,"Current Ingredients:"),f.qZA(),f.TgZ(24,"ul"),f.YNc(25,Oj,2,1,"li",5),f.qZA(),f.TgZ(26,"label",6),f._uU(27,"New ingredients:"),f.qZA(),f.TgZ(28,"input",7),f.NdJ("ngModelChange",function(a){return r.newIngredient=a}),f.qZA(),f.TgZ(29,"button",8),f.NdJ("click",function(){return r.addIngredient()}),f._uU(30,"Add new ingredient"),f.qZA(),f.TgZ(31,"p"),f._uU(32,"Current Steps:"),f.qZA(),f.TgZ(33,"ol"),f.YNc(34,Pj,2,1,"li",5),f.qZA(),f.TgZ(35,"label",9),f._uU(36,"New steps:"),f.qZA(),f.TgZ(37,"textarea",10),f.NdJ("ngModelChange",function(a){return r.newStep=a}),f.qZA(),f.TgZ(38,"button",8),f.NdJ("click",function(){return r.addStep()}),f._uU(39,"Add new step"),f.qZA(),f.TgZ(40,"button",11),f.NdJ("click",function(){return r.saveEditedRecipe()}),f._uU(41," Save edited recipe "),f.qZA()()()),2&t&&(f.xp6(7),f.Oqu(r.recipeName),f.xp6(4),f.Oqu(r.newRecipeName),f.xp6(1),f.Q6J("ngModel",r.newRecipeName),f.xp6(4),f.Oqu(r.duration),f.xp6(4),f.Oqu(r.newDuration),f.xp6(1),f.Q6J("ngModel",r.newDuration),f.xp6(4),f.Q6J("ngForOf",r.newAllIngredients),f.xp6(3),f.Q6J("ngModel",r.newIngredient),f.xp6(6),f.Q6J("ngForOf",r.newAllSteps),f.xp6(3),f.Q6J("ngModel",r.newStep))},dependencies:[Go,A_,Ec,bp,Fw,Ac,Pp],styles:[".edit-recipe-form[_ngcontent-%COMP%]{padding:2em;background-color:#fff;border-radius:5px;box-shadow:0 2px 4px #0000001a}.edit-recipe-form[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-control[_ngcontent-%COMP%]{padding:8px;margin-bottom:10px;border:1px solid #ccc;border-radius:4px}ul[_ngcontent-%COMP%]{list-style:none;padding-left:0}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:5px}label[_ngcontent-%COMP%]:not(:first-child){margin:2em 0 1em}label[_ngcontent-%COMP%]:first-child{margin:0 0 1em}textarea[_ngcontent-%COMP%]{padding:8px;margin-bottom:10px;border:1px solid #ccc;border-radius:4px}button[_ngcontent-%COMP%]{padding:8px 16px;color:#fff;background-color:#313438;border:1px solid #313438;border-radius:5px;max-width:max-content;text-transform:uppercase;cursor:pointer;font-weight:700}button[_ngcontent-%COMP%]:hover{color:#313438;background-color:transparent}.btn-edit[_ngcontent-%COMP%]{font-size:1.1em;width:100%;max-width:none;padding:1em;margin-top:2em;background-color:#319cff;border:1px solid #319cff}.btn-edit[_ngcontent-%COMP%]{color:#319cff;background-color:transparent;border:1px solid #319cff}"]}),n})(),Fj=(()=>{class n{constructor(t){this.auth=t}signUp(){this.auth.createUserWithEmailAndPassword(this.email,this.password).catch(t=>{alert(t.message)})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(wc))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-authentication"]],decls:13,vars:2,consts:[["type","email","placeholder","Email",3,"ngModel","ngModelChange"],["type","password","placeholder","Create password",3,"ngModel","ngModelChange"],[3,"click"],["routerLink","/login"]],template:function(t,r){1&t&&(f.TgZ(0,"h1"),f._uU(1,"Welcome! Create a new account."),f.qZA(),f.TgZ(2,"div")(3,"nav")(4,"h1"),f._uU(5,"Enter account details"),f.qZA(),f.TgZ(6,"input",0),f.NdJ("ngModelChange",function(a){return r.email=a}),f.qZA(),f.TgZ(7,"input",1),f.NdJ("ngModelChange",function(a){return r.password=a}),f.qZA(),f.TgZ(8,"button",2),f.NdJ("click",function(){return r.signUp()}),f._uU(9,"Create account"),f.qZA(),f._UZ(10,"h1"),f.TgZ(11,"button",3),f._uU(12,"Go back to login"),f.qZA()()()),2&t&&(f.xp6(6),f.Q6J("ngModel",r.email),f.xp6(1),f.Q6J("ngModel",r.password))},dependencies:[pc,Ec,bp,Ac]}),n})();const Lj=[{path:"home",component:Mj},{path:"login",component:Ah},{path:"edit/:id",component:kj},{path:"create",component:Fj},{path:"add",component:Nj},{path:"",redirectTo:"/login",pathMatch:"full"},{path:"**",redirectTo:"/login"}];let Vj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[r_.forRoot(Lj),r_]}),n})(),Uj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-header"]],decls:14,vars:0,consts:[["routerLink","/home"],["routerLink","/add"],["routerLink","/login"]],template:function(t,r){1&t&&(f.TgZ(0,"header")(1,"nav")(2,"p",0),f._uU(3,"Recipes App"),f.qZA(),f.TgZ(4,"ul")(5,"li")(6,"a",0),f._uU(7,"Home"),f.qZA()(),f.TgZ(8,"li")(9,"a",1),f._uU(10,"Add Recipe"),f.qZA()(),f.TgZ(11,"li")(12,"a",2),f._uU(13,"Login"),f.qZA()()()()())},dependencies:[pc],styles:["header[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;background-color:#313438;padding:2em 1em;margin:0 0 1em;border-radius:5px}header[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:block;padding:0;margin:1em 0 0;text-align:center;list-style-type:none}header[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:1em}header[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#cbcbcb;text-decoration:none;text-transform:uppercase}header[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#fff}header[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#319cff;text-transform:uppercase;font-size:2em;font-weight:900}header[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], header[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{cursor:pointer}@media (min-width: 700px){header[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;background-color:#313438;padding:2em 4em;margin:0 0 1em}header[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;padding:0;margin:0;list-style-type:none}header[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-right:1em;color:#cbcbcb;text-decoration:none;text-transform:uppercase}header[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:0}}"]}),n})(),Bj=(()=>{class n{constructor(){this.title="recipes"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-root"]],decls:2,vars:0,template:function(t,r){1&t&&f._UZ(0,"app-header")(1,"router-outlet")},dependencies:[p,Uj]}),n})();const IF="firebasestorage.googleapis.com",CF="storageBucket";class Mr extends P.ZR{constructor(e,t,r=0){super(VN(e),`Firebase Storage: ${t} (${VN(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Mr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return VN(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}function VN(n){return"storage/"+n}function UN(){return new Mr("unknown","An unknown error occurred, please check the error payload for server response.")}function bF(){return new Mr("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function DF(){return new Mr("canceled","User canceled the upload/download.")}function TF(){return new Mr("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function ev(n){return new Mr("invalid-argument",n)}function SF(){return new Mr("app-deleted","The Firebase app was deleted.")}function AF(n){return new Mr("invalid-root-operation","The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function lI(n,e){return new Mr("invalid-format","String does not match format '"+n+"': "+e)}function cI(n){throw new Mr("internal-error","Internal error: "+n)}class ws{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=ws.makeFromUrl(e,t)}catch{return new ws(e,"")}if(""===r.path)return r;throw function Qj(n){return new Mr("invalid-default-bucket","Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)",h=new RegExp("^gs://"+i+"(/(.*))?$","i");function w(at){at.path_=decodeURIComponent(at.path)}const A=t.replace(/[.]/g,"\\."),nt=[{regex:h,indices:{bucket:1,path:3},postModify:function a(at){"/"===at.path.charAt(at.path.length-1)&&(at.path_=at.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${A}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:w},{regex:new RegExp(`^https?://${t===IF?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:w}];for(let at=0;at<nt.length;at++){const Dt=nt[at],Lt=Dt.regex.exec(e);if(Lt){let _u=Lt[Dt.indices.path];_u||(_u=""),r=new ws(Lt[Dt.indices.bucket],_u),Dt.postModify(r);break}}if(null==r)throw function Yj(n){return new Mr("invalid-url","Invalid URL '"+n+"'.")}(e);return r}}class nH{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function uS(n){return"string"==typeof n||n instanceof String}function MF(n){return BN()&&n instanceof Blob}function BN(){return typeof Blob<"u"&&!(0,P.UG)()}function jN(n,e,t,r){if(r<e)throw ev(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw ev(`Invalid value for '${n}'. Expected ${t} or less.`)}function ad(n,e,t){let r=e;return null==t&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function xF(n){const e=encodeURIComponent;let t="?";for(const r in n)n.hasOwnProperty(r)&&(t=t+(e(r)+"=")+e(n[r])+"&");return t=t.slice(0,-1),t}var tv=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(tv||{});function RF(n,e){const t=n>=500&&n<600,i=-1!==[408,429].indexOf(n),a=-1!==e.indexOf(n);return t||i||a}class uH{constructor(e,t,r,i,a,l,h,_,w,D,A,O=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=h,this.errorCallback_=_,this.timeout_=w,this.progressCallback_=D,this.connectionFactory_=A,this.retry=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((H,z)=>{this.resolve_=H,this.reject_=z,this.start_()})}start_(){const t=(r,i)=>{const a=this.resolve_,l=this.reject_,h=i.connection;if(i.wasSuccessCode)try{const _=this.callback_(h,h.getResponse());!function sH(n){return void 0!==n}(_)?a():a(_)}catch(_){l(_)}else if(null!==h){const _=UN();_.serverResponse=h.getErrorText(),l(this.errorCallback_?this.errorCallback_(h,_):_)}else l(i.canceled?this.appDelete_?SF():DF():bF())};this.canceled_?t(0,new lS(!1,null,!0)):this.backoffId_=function rH(n,e,t){let r=1,i=null,a=null,l=!1,h=0;function _(){return 2===h}let w=!1;function D(...Te){w||(w=!0,e.apply(null,Te))}function A(Te){i=setTimeout(()=>{i=null,n(H,_())},Te)}function O(){a&&clearTimeout(a)}function H(Te,...ht){if(w)return void O();if(Te)return O(),void D.call(null,Te,...ht);if(_()||l)return O(),void D.call(null,Te,...ht);let nt;r<64&&(r*=2),1===h?(h=2,nt=0):nt=1e3*(r+Math.random()),A(nt)}let z=!1;function ce(Te){z||(z=!0,O(),!w&&(null!==i?(Te||(h=2),clearTimeout(i),A(0)):Te||(h=1)))}return A(0),a=setTimeout(()=>{l=!0,ce(!0)},t),ce}((r,i)=>{if(i)return void r(!1,new lS(!1,null,!0));const a=this.connectionFactory_();this.pendingConnection_=a;const l=h=>{null!==this.progressCallback_&&this.progressCallback_(h.loaded,h.lengthComputable?h.total:-1)};null!==this.progressCallback_&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const h=a.getErrorCode()===tv.NO_ERROR,_=a.getStatus();if(!h||RF(_,this.additionalRetryCodes_)&&this.retry){const D=a.getErrorCode()===tv.ABORT;return void r(!1,new lS(!1,null,D))}const w=-1!==this.successCodes_.indexOf(_);r(!0,new lS(w,a))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function iH(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class lS{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function gH(...n){const e=function pH(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}if(BN())return new Blob(n);throw new Mr("unsupported-environment","This browser doesn't seem to support creating Blobs")}const Bo={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class HN{constructor(e,t){this.data=e,this.contentType=t||null}}function $N(n,e){switch(n){case Bo.RAW:return new HN(NF(e));case Bo.BASE64:case Bo.BASE64URL:return new HN(OF(n,e));case Bo.DATA_URL:return new HN(function vH(n){const e=new PF(n);return e.base64?OF(Bo.BASE64,e.rest):function yH(n){let e;try{e=decodeURIComponent(n)}catch{throw lI(Bo.DATA_URL,"Malformed data URL.")}return NF(e)}(e.rest)}(e),function wH(n){return new PF(n).contentType}(e))}throw UN()}function NF(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(r=65536|(1023&r)<<10|1023&n.charCodeAt(++t),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function OF(n,e){switch(n){case Bo.BASE64:{const i=-1!==e.indexOf("-"),a=-1!==e.indexOf("_");if(i||a)throw lI(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Bo.BASE64URL:{const i=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(i||a)throw lI(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function _H(n){if(typeof atob>"u")throw function tH(n){return new Mr("unsupported-environment",`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(e)}catch(i){throw i.message.includes("polyfill")?i:lI(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class PF{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw lI(Bo.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function EH(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class Tl{constructor(e,t){let r=0,i="";MF(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(MF(this.data_)){const i=function mH(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===i?null:new Tl(i)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new Tl(r,!0)}}static getBlob(...e){if(BN()){const t=e.map(r=>r instanceof Tl?r.data_:r);return new Tl(gH.apply(null,t))}{const t=e.map(l=>uS(l)?$N(Bo.RAW,l).data:l.data_);let r=0;t.forEach(l=>{r+=l.byteLength});const i=new Uint8Array(r);let a=0;return t.forEach(l=>{for(let h=0;h<l.length;h++)i[a++]=l[h]}),new Tl(i,!0)}}uploadData(){return this.data_}}function GN(n){let e;try{e=JSON.parse(n)}catch{return null}return function aH(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function kF(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function bH(n,e){return e}class Hs{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||bH}}let cS=null;function dI(){if(cS)return cS;const n=[];n.push(new Hs("bucket")),n.push(new Hs("generation")),n.push(new Hs("metageneration")),n.push(new Hs("name","fullPath",!0));const t=new Hs("name");t.xform=function e(a,l){return function DH(n){return!uS(n)||n.length<2?n:kF(n)}(l)},n.push(t);const i=new Hs("size");return i.xform=function r(a,l){return void 0!==l?Number(l):l},n.push(i),n.push(new Hs("timeCreated")),n.push(new Hs("updated")),n.push(new Hs("md5Hash",null,!0)),n.push(new Hs("cacheControl",null,!0)),n.push(new Hs("contentDisposition",null,!0)),n.push(new Hs("contentEncoding",null,!0)),n.push(new Hs("contentLanguage",null,!0)),n.push(new Hs("contentType",null,!0)),n.push(new Hs("metadata","customMetadata",!0)),cS=n,cS}function FF(n,e,t){const r=GN(e);return null===r?null:function SH(n,e,t){const r={type:"file"},i=t.length;for(let a=0;a<i;a++){const l=t[a];r[l.local]=l.xform(r,e[l.server])}return function TH(n,e){Object.defineProperty(n,"ref",{get:function t(){const a=new ws(n.bucket,n.fullPath);return e._makeStorageReference(a)}})}(r,n),r}(n,r,t)}function zN(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const a=e[i];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}const LF="prefixes",VF="items";class Sl{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Al(n){if(!n)throw UN()}function dS(n,e){return function t(r,i){const a=FF(n,i,e);return Al(null!==a),a}}function nv(n){return function e(t,r){let i;return i=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function Zj(){return new Mr("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}():function Wj(){return new Mr("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function qj(n){return new Mr("quota-exceeded","Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function Kj(n){return new Mr("unauthorized","User does not have permission to access '"+n+"'.")}(n.path):r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}}function hI(n){const e=nv(n);return function t(r,i){let a=e(r,i);return 404===r.getStatus()&&(a=function zj(n){return new Mr("object-not-found","Object '"+n+"' does not exist.")}(n.path)),a.serverResponse=i.serverResponse,a}}function UF(n,e,t){const i=ad(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,h=new Sl(i,"GET",dS(n,t),l);return h.errorHandler=hI(e),h}function OH(n,e,t,r,i){const a={};a.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(a.delimiter=t),r&&(a.pageToken=r),i&&(a.maxResults=i);const h=ad(e.bucketOnlyServerUrl(),n.host,n._protocol),w=n.maxOperationRetryTime,D=new Sl(h,"GET",function RH(n,e){return function t(r,i){const a=function xH(n,e,t){const r=GN(t);return null===r?null:function MH(n,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[LF])for(const i of t[LF]){const a=i.replace(/\/$/,""),l=n._makeStorageReference(new ws(e,a));r.prefixes.push(l)}if(t[VF])for(const i of t[VF]){const a=n._makeStorageReference(new ws(e,i.name));r.items.push(a)}return r}(n,e,r)}(n,e,i);return Al(null!==a),a}}(n,e.bucket),w);return D.urlParams=a,D.errorHandler=nv(e),D}function jF(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=function LH(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class hS{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function qN(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{Al(!1)}return Al(!!t&&-1!==(e||["active"]).indexOf(t)),t}const jH={STATE_CHANGED:"state_changed"},$s={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function WN(n){switch(n){case"running":case"pausing":case"canceling":return $s.RUNNING;case"paused":return $s.PAUSED;case"success":return $s.SUCCESS;case"canceled":return $s.CANCELED;default:return $s.ERROR}}class HH{constructor(e,t,r){if(function oH(n){return"function"==typeof n}(e)||null!=t||null!=r)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}function rv(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}let GF=null;class $H{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=tv.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=tv.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=tv.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw cI("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw cI("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw cI("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw cI("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw cI("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class GH extends $H{initXhr(){this.xhr_.responseType="text"}}function hu(){return GF?GF():new GH}class zF{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=dI(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals("canceled"))this._needToFetchStatus=!0,this.completeTransitions_();else{const a=this.isExponentialBackoffExpired();if(RF(i.status,[])){if(!a)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();i=bF()}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals("canceled")?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,a)=>{this._resolve=i,this._reject=a,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const r=function VH(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l=jF(e,r,i),h={name:l.fullPath},_=ad(a,n.host,n._protocol),D={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":l.contentType,"Content-Type":"application/json; charset=utf-8"},A=zN(l,t),z=new Sl(_,"POST",function H(ce){let Te;qN(ce);try{Te=ce.getResponseHeader("X-Goog-Upload-URL")}catch{Al(!1)}return Al(uS(Te)),Te},n.maxUploadRetryTime);return z.urlParams=h,z.headers=D,z.body=A,z.errorHandler=nv(e),z}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,hu,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=function UH(n,e,t,r){const _=new Sl(t,"POST",function a(w){const D=qN(w,["active","final"]);let A=null;try{A=w.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Al(!1)}A||Al(!1);const O=Number(A);return Al(!isNaN(O)),new hS(O,r.size(),"final"===D)},n.maxUploadRetryTime);return _.headers={"X-Goog-Upload-Command":"query"},_.errorHandler=nv(e),_}(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(i,hu,t,r);this._request=a,a.getPromise().then(l=>{this._request=void 0,this._updateProgress(l.current),this._needToFetchStatus=!1,l.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new hS(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,a)=>{let l;try{l=function BH(n,e,t,r,i,a,l,h){const _=new hS(0,0);if(l?(_.current=l.current,_.total=l.total):(_.current=0,_.total=r.size()),r.size()!==_.total)throw function Jj(){return new Mr("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}();const w=_.total-_.current;let D=w;i>0&&(D=Math.min(D,i));const A=_.current;let H="";H=0===D?"finalize":w===D?"upload, finalize":"upload";const z={"X-Goog-Upload-Command":H,"X-Goog-Upload-Offset":`${_.current}`},ce=r.slice(A,A+D);if(null===ce)throw TF();const nt=new Sl(t,"POST",function Te(at,Dt){const Lt=qN(at,["active","final"]),Rr=_.current+D,_u=r.size();let iP;return iP="final"===Lt?dS(e,a)(at,Dt):null,new hS(Rr,_u,"final"===Lt,iP)},e.maxUploadRetryTime);return nt.headers=z,nt.body=ce.uploadData(),nt.progressCallback=h||null,nt.errorHandler=nv(n),nt}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(_){return this._error=_,void this._transition("error")}const h=this._ref.storage._makeRequest(l,hu,i,a,!1);this._request=h,h.getPromise().then(_=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(_.current),_.finalized?(this._metadata=_.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=UF(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,hu,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=function HF(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"},_=function h(){let nt="";for(let at=0;at<2;at++)nt+=Math.random().toString().slice(2);return nt}();l["Content-Type"]="multipart/related; boundary="+_;const w=jF(e,r,i),D=zN(w,t),H=Tl.getBlob("--"+_+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+D+"\r\n--"+_+"\r\nContent-Type: "+w.contentType+"\r\n\r\n",r,"\r\n--"+_+"--");if(null===H)throw TF();const z={name:w.fullPath},ce=ad(a,n.host,n._protocol),ht=n.maxUploadRetryTime,yt=new Sl(ce,"POST",dS(n,t),ht);return yt.urlParams=z,yt.headers=l,yt.body=H.uploadData(),yt.errorHandler=nv(e),yt}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,hu,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=DF(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=WN(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const a=new HH(t||void 0,r||void 0,i||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(WN(this._state)){case $s.SUCCESS:rv(this._resolve.bind(null,this.snapshot))();break;case $s.CANCELED:case $s.ERROR:rv(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(WN(this._state)){case $s.RUNNING:case $s.PAUSED:e.next&&rv(e.next.bind(e,this.snapshot))();break;case $s.SUCCESS:e.complete&&rv(e.complete.bind(e))();break;default:e.error&&rv(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class $g{constructor(e,t){this._service=e,this._location=t instanceof ws?t:ws.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new $g(e,t)}get root(){const e=new ws(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return kF(this._location.path)}get storage(){return this._service}get parent(){const e=function IH(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new ws(this._location.bucket,e);return new $g(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw AF(e)}}function WF(n,e,t){return ZN.apply(this,arguments)}function ZN(){return ZN=(0,me.Z)(function*(n,e,t){const i=yield ZF(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield WF(n,e,i.nextPageToken))}),ZN.apply(this,arguments)}function ZF(n,e){null!=e&&"number"==typeof e.maxResults&&jN("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=OH(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,hu)}function n$(n){n._throwIfRoot("getDownloadURL");const e=function PH(n,e,t){const i=ad(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,h=new Sl(i,"GET",function NH(n,e){return function t(r,i){const a=FF(n,i,e);return Al(null!==a),function AH(n,e,t,r){const i=GN(e);if(null===i||!uS(i.downloadTokens))return null;const a=i.downloadTokens;if(0===a.length)return null;const l=encodeURIComponent;return a.split(",").map(w=>{const A=n.fullPath;return ad("/b/"+l(n.bucket)+"/o/"+l(A),t,r)+xF({alt:"media",token:w})})[0]}(a,i,n.host,n._protocol)}}(n,t),l);return h.errorHandler=hI(e),h}(n.storage,n._location,dI());return n.storage.makeRequestWithTokens(e,hu).then(t=>{if(null===t)throw function eH(){return new Mr("no-download-url","The given file does not have any download URLs.")}();return t})}function KF(n,e){const t=function CH(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),r=new ws(n._location.bucket,t);return new $g(n.storage,r)}function YF(n,e){if(n instanceof KN){const t=n;if(null==t._bucket)throw function Xj(){return new Mr("no-default-bucket","No default bucket found. Did you set the '"+CF+"' property when initializing the app?")}();const r=new $g(t,t._bucket);return null!=e?YF(r,e):r}return void 0!==e?KF(n,e):n}function o$(n,e){if(e&&function i$(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof KN)return function s$(n,e){return new $g(n,e)}(n,e);throw ev("To use ref(service, url), the first argument must be a Storage instance.")}return YF(n,e)}function QF(n,e){const t=e?.[CF];return null==t?null:ws.makeFromBucketSpec(t,n)}class KN{constructor(e,t,r,i,a){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=IF,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?ws.makeFromBucketSpec(i,this._host):QF(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?ws.makeFromBucketSpec(this._url,e):QF(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){jN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){jN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,me.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const r=yield t.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,me.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new $g(this,e)}_makeRequest(e,t,r,i,a=!0){if(this._deleted)return new nH(SF());{const l=function fH(n,e,t,r,i,a,l=!0){const h=xF(n.urlParams),_=n.url+h,w=Object.assign({},n.headers);return function dH(n,e){e&&(n["X-Firebase-GMPID"]=e)}(w,e),function lH(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(w,t),function cH(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(w,a),function hH(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(w,r),new uH(_,n.method,w,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,l)}(e,this._appId,r,i,t,this._firebaseVersion,a);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}makeRequestWithTokens(e,t){var r=this;return(0,me.Z)(function*(){const[i,a]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,t,i,a).getPromise()})()}}const XF="@firebase/storage";function tL(n,e){return o$(n=(0,P.m9)(n),e)}function m$(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new KN(t,r,i,e,gs.SDK_VERSION)}!function _$(){(0,gs._registerComponent)(new ko.wA("storage",m$,"PUBLIC").setMultipleInstances(!0)),(0,gs.registerVersion)(XF,"0.10.1",""),(0,gs.registerVersion)(XF,"0.10.1","esm2017")}();class fS{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class rL{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new fS(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new fS(r,this,this._ref))},t)}on(e,t,r,i){let a;return t&&(a="function"==typeof t?l=>t(new fS(l,this,this._ref)):{next:t.next?l=>t.next(new fS(l,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,a,r||void 0,i||void 0)}}class iL{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new ud(e,this._service))}get items(){return this._delegate.items.map(e=>new ud(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class ud{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function g$(n,e){return KF(n,e)}(this._delegate,e);return new ud(t,this.storage)}get root(){return new ud(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new ud(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new rL(function u$(n,e,t){return function QH(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new zF(n,new Tl(e),t)}(n=(0,P.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=Bo.RAW,r){this._throwIfRoot("putString");const i=$N(t,e),a=Object.assign({},r);return null==a.contentType&&null!=i.contentType&&(a.contentType=i.contentType),new rL(new zF(this._delegate,new Tl(i.data,!0),a),this)}listAll(){return function h$(n){return function JH(n){const e={prefixes:[],items:[]};return WF(n,e).then(()=>e)}(n=(0,P.m9)(n))}(this._delegate).then(e=>new iL(e,this.storage))}list(e){return function d$(n,e){return ZF(n=(0,P.m9)(n),e)}(this._delegate,e||void 0).then(t=>new iL(t,this.storage))}getMetadata(){return function l$(n){return function e$(n){n._throwIfRoot("getMetadata");const e=UF(n.storage,n._location,dI());return n.storage.makeRequestWithTokens(e,hu)}(n=(0,P.m9)(n))}(this._delegate)}updateMetadata(e){return function c$(n,e){return function t$(n,e){n._throwIfRoot("updateMetadata");const t=function kH(n,e,t,r){const a=ad(e.fullServerUrl(),n.host,n._protocol),h=zN(t,r),w=n.maxOperationRetryTime,D=new Sl(a,"PATCH",dS(n,r),w);return D.headers={"Content-Type":"application/json; charset=utf-8"},D.body=h,D.errorHandler=hI(e),D}(n.storage,n._location,e,dI());return n.storage.makeRequestWithTokens(t,hu)}(n=(0,P.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function f$(n){return n$(n=(0,P.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function p$(n){return function r$(n){n._throwIfRoot("deleteObject");const e=function FH(n,e){const r=ad(e.fullServerUrl(),n.host,n._protocol),h=new Sl(r,"DELETE",function l(_,w){},n.maxOperationRetryTime);return h.successCodes=[200,204],h.errorHandler=hI(e),h}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,hu)}(n=(0,P.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw AF(e)}}class sL{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(oL(e))throw ev("ref() expected a child path but got a URL, use refFromURL instead.");return new ud(tL(this._delegate,e),this)}refFromURL(e){if(!oL(e))throw ev("refFromURL() expected a full URL but got a child path, use ref() instead.");try{ws.makeFromUrl(e,this._delegate.host)}catch{throw ev("refFromUrl() expected a valid full URL but got an invalid one.")}return new ud(tL(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){!function nL(n,e,t,r={}){!function a$(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken="string"==typeof i?i:(0,P.Sg)(i,n.app.options.projectId))}(n,e,t,r)}(this._delegate,e,t,r)}}function oL(n){return/^[A-Za-z]+:\/\//.test(n)}function E$(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new sL(t,r)}function aL(n){const e=function C$(n){return new Jr.y(e=>{const t=l=>e.next(l);t(n.snapshot);const a=n.on("state_changed",t);return n.then(l=>{t(l),e.complete()},l=>{t(n.snapshot),(l=>{e.error(l)})(l)}),function(){a()}}).pipe(function jj(n,e=n0.z){return(0,dt.e)((t,r)=>{let i=null,a=null,l=null;const h=()=>{if(i){i.unsubscribe(),i=null;const w=a;a=null,r.next(w)}};function _(){const w=l+n,D=e.now();if(D<w)return i=this.schedule(void 0,w-D),void r.add(i);h()}t.subscribe((0,Fr.x)(r,w=>{a=w,l=e.now(),i||(i=e.schedule(_,n),r.add(i))},()=>{h(),r.complete()},void 0,()=>{a=i=null}))})}(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe((0,Tt.U)(t=>t.bytesTransferred/t.totalBytes*100))}}function pS(n){return{getDownloadURL:()=>(0,ct.of)(void 0).pipe(dn.fc,(0,Tn.w)(()=>n.getDownloadURL()),dn.iC),getMetadata:()=>(0,ct.of)(void 0).pipe(dn.fc,(0,Tn.w)(()=>n.getMetadata()),dn.iC),delete:()=>(0,nn.D)(n.delete()),child:e=>pS(n.child(e)),updateMetadata:e=>(0,nn.D)(n.updateMetadata(e)),put:(e,t)=>aL(n.put(e,t)),putString:(e,t,r)=>aL(n.putString(e,t,r)),list:e=>(0,nn.D)(n.list(e)),listAll:()=>(0,nn.D)(n.listAll())}}!function I$(n){const e={TaskState:$s,TaskEvent:jH,StringFormat:Bo,Storage:sL,Reference:ud};n.INTERNAL.registerComponent(new ko.wA("storage-compat",E$,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.2.1")}(F_.Z);const b$=new f.OlP("angularfire2.storageBucket"),D$=new f.OlP("angularfire2.storage.maxUploadRetryTime"),T$=new f.OlP("angularfire2.storage.maxOperationRetryTime"),S$=new f.OlP("angularfire2.storage.use-emulator");let A$=(()=>{class n{constructor(t,r,i,a,l,h,_,w,D,A){const O=(0,Dr.on)(t,l,r);this.storage=(0,Dr.cc)(`${O.name}.storage.${i}`,"AngularFireStorage",O.name,()=>{const H=l.runOutsideAngular(()=>O.storage(i||void 0)),z=D;return z&&H.useEmulator(...z),_&&H.setMaxUploadRetryTime(_),w&&H.setMaxOperationRetryTime(w),H},[_,w])}ref(t){return pS(this.storage.ref(t))}refFromURL(t){return pS(this.storage.refFromURL(t))}upload(t,r,i){return pS(this.storage.ref(t)).put(r,i)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Dr.Dh),f.LFG(Dr.xv,8),f.LFG(b$,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(dn.HU),f.LFG(D$,8),f.LFG(T$,8),f.LFG(S$,8),f.LFG(wp,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),M$=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})(),x$=(()=>{class n{constructor(){y_.Z.registerVersion("angularfire",dn.q4.full,"gcs-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[A$],imports:[M$]}),n})();var R$=k(2420);const uL="@firebase/database";let YN="";function cL(n){YN=n}class P${constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,P.Wl)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,P.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class k${constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,P.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const dL=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new P$(e)}}catch{}return new k$},Gg=dL("localStorage"),QN=dL("sessionStorage"),iv=new Ls.Yd("@firebase/database"),hL=function(){let n=1;return function(){return n++}}(),fL=function(n){const e=(0,P.dS)(n),t=new P.gQ;t.update(e);const r=t.digest();return P.US.encodeByteArray(r)},fI=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=fI.apply(null,r):e+="object"==typeof r?(0,P.Wl)(r):r,e+=" "}return e};let zg=null,pL=!0;const gL=function(n,e){(0,P.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(iv.logLevel=Ls.in.VERBOSE,zg=iv.log.bind(iv),e&&QN.set("logging_enabled",!0)):"function"==typeof n?zg=n:(zg=null,QN.remove("logging_enabled"))},Fi=function(...n){if(!0===pL&&(pL=!1,null===zg&&!0===QN.get("logging_enabled")&&gL(!0)),zg){const e=fI.apply(null,n);zg(e)}},pI=function(n){return function(...e){Fi(n,...e)}},XN=function(...n){const e="FIREBASE INTERNAL ERROR: "+fI(...n);iv.error(e)},Ml=function(...n){const e=`FIREBASE FATAL ERROR: ${fI(...n)}`;throw iv.error(e),new Error(e)},Es=function(...n){const e="FIREBASE WARNING: "+fI(...n);iv.warn(e)},gS=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},cf="[MIN_NAME]",ld="[MAX_NAME]",qg=function(n,e){if(n===e)return 0;if(n===cf||e===ld)return-1;if(e===cf||n===ld)return 1;{const t=yL(n),r=yL(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},V$=function(n,e){return n===e?0:n<e?-1:1},gI=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,P.Wl)(e))},JN=function(n){if("object"!=typeof n||null===n)return(0,P.Wl)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,P.Wl)(e[r]),t+=":",t+=JN(n[e[r]]);return t+="}",t},mL=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function Li(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const _L=function(n){(0,P.hu)(!gS(n),"Invalid JSON number");const r=1023;let i,a,l,h,_;0===n?(a=0,l=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),r),a=h+r,l=Math.round(n*Math.pow(2,52-h)-Math.pow(2,52))):(a=0,l=Math.round(n/Math.pow(2,-1074))));const w=[];for(_=52;_;_-=1)w.push(l%2?1:0),l=Math.floor(l/2);for(_=11;_;_-=1)w.push(a%2?1:0),a=Math.floor(a/2);w.push(i?1:0),w.reverse();const D=w.join("");let A="";for(_=0;_<64;_+=8){let O=parseInt(D.substr(_,8),2).toString(16);1===O.length&&(O="0"+O),A+=O}return A.toLowerCase()},H$=new RegExp("^-?(0*)\\d{1,10}$"),yL=function(n){if(H$.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},sv=function(n){try{n()}catch(e){setTimeout(()=>{throw Es("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},mI=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class q${constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Es(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class W${constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Fi("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Es(e)}}let _I=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const CL=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,TL="websocket",SL="long_polling";class tO{constructor(e,t,r,i,a=!1,l="",h=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=l,this.includeNamespaceInQueryParams=h,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Gg.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Gg.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function AL(n,e,t){let r;if((0,P.hu)("string"==typeof e,"typeof type must == string"),(0,P.hu)("object"==typeof t,"typeof params must == object"),e===TL)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==SL)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function Z$(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return Li(t,(a,l)=>{i.push(a+"="+l)}),r+i.join("&")}class K${constructor(){this.counters_={}}incrementCounter(e,t=1){(0,P.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,P.p$)(this.counters_)}}const nO={},rO={};function iO(n){const e=n.toString();return nO[e]||(nO[e]=new K$),nO[e]}class Q${constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&sv(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class df{constructor(e,t,r,i,a,l,h){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=l,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=pI(e),this.stats_=iO(t),this.urlFn=_=>(this.appCheckToken&&(_.ac=this.appCheckToken),AL(t,SL,_))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Q$(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,P.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new sO((...a)=>{const[l,h,_,w,D]=a;if(this.incrementIncomingBytes_(a),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===l)this.id=h,this.password=_;else{if("close"!==l)throw new Error("Unrecognized command received: "+l);h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_()}},(...a)=>{const[l,h]=a;this.incrementIncomingBytes_(a),this.myPacketOrderer.handleResponse(l,h)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&CL.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){df.forceAllow_=!0}static forceDisallow(){df.forceDisallow_=!0}static isAvailable(){return!((0,P.Yr)()||!df.forceAllow_&&(df.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,P.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,P.h$)(t),i=mL(r,1840);for(let a=0;a<i.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[a]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,P.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,P.Wl)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class sO{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,P.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=hL(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=sO.createIFrame_();let a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(a='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(h){Fi("frame writing exception"),h.stack&&Fi(h.stack),Fi(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Fi("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const l=this.pendingSegs.shift();r=r+"&seg"+i+"="+l.seg+"&ts"+i+"="+l.ts+"&d"+i+"="+l.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,P.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Fi("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let _S=null;typeof MozWebSocket<"u"?_S=MozWebSocket:typeof WebSocket<"u"&&(_S=WebSocket);let ov=(()=>{class n{constructor(t,r,i,a,l,h,_){this.connId=t,this.applicationId=i,this.appCheckToken=a,this.authToken=l,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=pI(this.connId),this.stats_=iO(r),this.connURL=n.connectionURL_(r,h,_,a,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,a,l){const h={v:"5"};return!(0,P.Yr)()&&typeof location<"u"&&location.hostname&&CL.test(location.hostname)&&(h.r="f"),r&&(h.s=r),i&&(h.ls=i),a&&(h.ac=a),l&&(h.p=l),AL(t,TL,h)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Gg.set("previous_websocket_failure",!0);try{let i;if((0,P.Yr)()){i={headers:{"User-Agent":`Firebase/5/${YN}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const l=process.env,h=0===this.connURL.indexOf("wss://")?l.HTTPS_PROXY||l.https_proxy:l.HTTP_PROXY||l.http_proxy;h&&(i.proxy={origin:h})}this.mySock=new _S(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const a=i.message||i.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const a=i.message||i.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==_S&&!n.forceDisallow_}static previouslyFailed(){return Gg.isInMemoryStorage||!0===Gg.get("previous_websocket_failure")}markConnectionHealthy(){Gg.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,P.cI)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,P.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,P.Wl)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=mL(r,16384);i.length>1&&this.sendString_(String(i.length));for(let a=0;a<i.length;a++)this.sendString_(i[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),kL=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[df,ov]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=ov&&ov.isAvailable();let i=r&&!ov.previouslyFailed();if(t.webSocketOnly&&(r||Es("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[ov];else{const a=this.transports_=[];for(const l of n.ALL_TRANSPORTS)l&&l.isAvailable()&&a.push(l);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class HL{constructor(e,t,r,i,a,l,h,_,w,D){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=l,this.onReady_=h,this.onDisconnect_=_,this.onKill_=w,this.lastSessionId=D,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=pI("c:"+this.id+":"),this.transportManager_=new kL(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=mI(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=gI("t",e),r=gI("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=gI("t",e),r=gI("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=gI("t",e);if("d"in e){const r=e.d;if("h"===t)this.onHandshake_(r);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?XN("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):XN("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&Es("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),mI(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):mI(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Gg.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class $L{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class GL{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,P.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let a=0;a<i.length;a++)if(i[a].callback===t&&(!r||r===i[a].context))return void i.splice(a,1)}validateEventType_(e){(0,P.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class yS extends GL{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,P.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new yS}getInitialEvent(e){return(0,P.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class An{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function yn(){return new An("")}function rn(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function hf(n){return n.pieces_.length-n.pieceNum_}function Gn(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new An(n.pieces_,e)}function aO(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function yI(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function WL(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new An(e,0)}function wr(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof An)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new An(t,0)}function sn(n){return n.pieceNum_>=n.pieces_.length}function Gs(n,e){const t=rn(n),r=rn(e);if(null===t)return e;if(t===r)return Gs(Gn(n),Gn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function vG(n,e){const t=yI(n,0),r=yI(e,0);for(let i=0;i<t.length&&i<r.length;i++){const a=qg(t[i],r[i]);if(0!==a)return a}return t.length===r.length?0:t.length<r.length?-1:1}function uO(n,e){if(hf(n)!==hf(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Ea(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(hf(n)>hf(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class wG{constructor(e,t){this.errorPrefix_=t,this.parts_=yI(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,P.ug)(this.parts_[r]);ZL(this)}}function ZL(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Wg(n))}function Wg(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class lO extends GL{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new lO}getInitialEvent(e){return(0,P.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const vI=1e3;let wS,Zg=(()=>{class n extends $L{constructor(t,r,i,a,l,h,_,w){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=a,this.onServerInfoUpdate_=l,this.authTokenProvider_=h,this.appCheckTokenProvider_=_,this.authOverride_=w,this.id=n.nextPersistentConnectionId_++,this.log_=pI("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=vI,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,w&&!(0,P.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");lO.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&yS.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const a=++this.requestNumber_,l={r:a,a:t,b:r};this.log_((0,P.Wl)(l)),(0,P.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(l),i&&(this.requestCBHash_[a]=i)}get(t){this.initConnection_();const r=new P.BH,a={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:h=>{const _=h.d;"ok"===h.s?r.resolve(_):r.reject(_)}};return this.outstandingGets_.push(a),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,a){this.initConnection_();const l=t._queryIdentifier,h=t._path.toString();this.log_("Listen called for "+h+" "+l),this.listens.has(h)||this.listens.set(h,new Map),(0,P.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,P.hu)(!this.listens.get(h).has(l),"listen() called twice for same path/queryId.");const _={onComplete:a,hashFn:r,query:t,tag:i};this.listens.get(h).set(l,_),this.connected_&&this.sendListen_(_)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);const l={p:i};t.tag&&(l.q=r._queryObject,l.t=t.tag),l.h=t.hashFn(),this.sendRequest("q",l,_=>{const w=_.d,D=_.s;n.warnOnListenWarnings_(w,r),(this.listens.get(i)&&this.listens.get(i).get(a))===t&&(this.log_("listen response",_),"ok"!==D&&this.removeListen_(i,a),t.onComplete&&t.onComplete(D,w))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,P.r3)(t,"w")){const i=(0,P.DV)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const a='".indexOn": "'+r._queryParams.getIndex().toString()+'"',l=r._path.toString();Es(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${l} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,P.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,P.w9)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,a=>{const l=a.s,h=a.d||"error";this.authToken_===t&&("ok"===l?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(l,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),a=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+a),(0,P.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,a)&&this.connected_&&this.sendUnlisten_(i,a,t._queryObject,r)}sendUnlisten_(t,r,i,a){this.log_("Unlisten on "+t+" for "+r);const l={p:t};a&&(l.q=i,l.t=a),this.sendRequest("n",l)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,a){const l={p:r,d:i};this.log_("onDisconnect "+t,l),this.sendRequest(t,l,h=>{a&&setTimeout(()=>{a(h.s,h.d)},Math.floor(0))})}put(t,r,i,a){this.putInternal("p",t,r,i,a)}merge(t,r,i,a){this.putInternal("m",t,r,i,a)}putInternal(t,r,i,a,l){this.initConnection_();const h={p:r,d:i};void 0!==l&&(h.h=l),this.outstandingPuts_.push({action:t,request:h,onComplete:a}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,a=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,l=>{this.log_(r+" response",l),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),a&&a(l.s,l.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,P.Wl)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):XN("Unrecognized action received from server: "+(0,P.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,P.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=vI,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=vI,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=vI),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,me.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),a=t.onRealtimeDisconnect_.bind(t),l=t.id+":"+n.nextConnectionId_++,h=t.lastSessionId;let _=!1,w=null;const D=function(){w?w.close():(_=!0,a())};t.realtime_={close:D,sendRequest:function(H){(0,P.hu)(w,"sendRequest call when we're not connected not allowed."),w.sendRequest(H)}};const O=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[H,z]=yield Promise.all([t.authTokenProvider_.getToken(O),t.appCheckTokenProvider_.getToken(O)]);_?Fi("getToken() completed but was canceled"):(Fi("getToken() completed. Creating connection."),t.authToken_=H&&H.accessToken,t.appCheckToken_=z&&z.token,w=new HL(l,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,a,ce=>{Es(ce+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},h))}catch(H){t.log_("Failed to get token: "+H),_||(t.repoInfo_.nodeAdmin&&Es(H),D())}}})()}interrupt(t){Fi("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Fi("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,P.xb)(this.interruptReasons_)&&(this.reconnectDelay_=vI,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(l=>JN(l)).join("$"):"default";const a=this.removeListen_(t,i);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(t,r){const i=new An(t).toString();let a;if(this.listens.has(i)){const l=this.listens.get(i);a=l.get(r),l.delete(r),0===l.size&&this.listens.delete(i)}else a=void 0;return a}onAuthRevoked_(t,r){Fi("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Fi("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,P.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+YN.replace(/\./g,"-")]=1,(0,P.uI)()?t["framework.cordova"]=1:(0,P.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=yS.getInstance().currentlyOnline();return(0,P.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class un{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new un(e,t)}}class vS{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new un(cf,e),i=new un(cf,t);return 0!==this.compare(r,i)}minPost(){return un.MIN}}class QL extends vS{static get __EMPTY_NODE(){return wS}static set __EMPTY_NODE(e){wS=e}compare(e,t){return qg(e.name,t.name)}isDefinedOn(e){throw(0,P.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return un.MIN}maxPost(){return new un(ld,wS)}makePost(e,t){return(0,P.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new un(e,wS)}toString(){return".key"}}const xl=new QL;class ES{constructor(e,t,r,i,a=null){this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,i&&(l*=-1),l<0)e=this.isReverse_?e.left:e.right;else{if(0===l){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let dO,fu=(()=>{class n{constructor(t,r,i,a,l){this.key=t,this.value=r,this.color=i??n.RED,this.left=a??co.EMPTY_NODE,this.right=l??co.EMPTY_NODE}copy(t,r,i,a,l){return new n(t??this.key,r??this.value,i??this.color,a??this.left,l??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let a=this;const l=i(t,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(t,r,i),null):0===l?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(t,r,i)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return co.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,a;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return co.EMPTY_NODE;a=i.right.min_(),i=i.copy(a.key,a.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class co{constructor(e,t=co.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new co(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,fu.BLACK,null,null))}remove(e){return new co(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,fu.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ES(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new ES(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new ES(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new ES(this.root_,null,this.comparator_,!0,e)}}function AG(n,e){return qg(n.name,e.name)}function cO(n,e){return qg(n,e)}co.EMPTY_NODE=new class SG{copy(e,t,r,i,a){return this}insert(e,t,r){return new fu(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const XL=function(n){return"number"==typeof n?"number:"+_L(n):"string:"+n},JL=function(n){if(n.isLeafNode()){const e=n.val();(0,P.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,P.r3)(e,".sv"),"Priority must be a string or number.")}else(0,P.hu)(n===dO||n.isEmpty(),"priority of unexpected type.");(0,P.hu)(n===dO||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let eV,tV,nV,av=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,P.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),JL(this.priorityNode_)}static set __childrenNodeConstructor(t){eV=t}static get __childrenNodeConstructor(){return eV}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return sn(t)?this:".priority"===rn(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=rn(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,P.hu)(".priority"!==i||1===hf(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Gn(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+XL(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?_L(this.value_):this.value_,this.lazyHash_=fL(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,P.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,a=n.VALUE_TYPE_ORDER.indexOf(r),l=n.VALUE_TYPE_ORDER.indexOf(i);return(0,P.hu)(a>=0,"Unknown leaf type: "+r),(0,P.hu)(l>=0,"Unknown leaf type: "+i),a===l?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:l-a}withIndex(){return this}isIndexed(){return!0}equals(t){return t===this||!!t.isLeafNode()&&(this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const Jn=new class NG extends vS{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),a=r.compareTo(i);return 0===a?qg(e.name,t.name):a}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return un.MIN}maxPost(){return new un(ld,new av("[PRIORITY-POST]",nV))}makePost(e,t){const r=tV(e);return new un(t,new av("[PRIORITY-POST]",r))}toString(){return".priority"}},OG=Math.log(2);class PG{constructor(e){this.count=parseInt(Math.log(e+1)/OG,10),this.current_=this.count-1;const i=(a=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const IS=function(n,e,t,r){n.sort(e);const i=function(_,w){const D=w-_;let A,O;if(0===D)return null;if(1===D)return A=n[_],O=t?t(A):A,new fu(O,A.node,fu.BLACK,null,null);{const H=parseInt(D/2,10)+_,z=i(_,H),ce=i(H+1,w);return A=n[H],O=t?t(A):A,new fu(O,A.node,fu.BLACK,z,ce)}},h=function(_){let w=null,D=null,A=n.length;const O=function(z,ce){const Te=A-z,ht=A;A-=z;const yt=i(Te+1,ht),nt=n[Te],at=t?t(nt):nt;H(new fu(at,nt.node,ce,null,yt))},H=function(z){w?(w.left=z,w=z):(D=z,w=z)};for(let z=0;z<_.count;++z){const ce=_.nextBitIsOne(),Te=Math.pow(2,_.count-(z+1));ce?O(Te,fu.BLACK):(O(Te,fu.BLACK),O(Te,fu.RED))}return D}(new PG(n.length));return new co(r||e,h)};let hO;const uv={};class cd{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,P.hu)(uv&&Jn,"ChildrenNode.ts has not been loaded"),hO=hO||new cd({".priority":uv},{".priority":Jn}),hO}get(e){const t=(0,P.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof co?t:null}hasIndex(e){return(0,P.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,P.hu)(e!==xl,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const a=t.getIterator(un.Wrap);let h,l=a.getNext();for(;l;)i=i||e.isDefinedOn(l.node),r.push(l),l=a.getNext();h=i?IS(r,e.getCompare()):uv;const _=e.toString(),w=Object.assign({},this.indexSet_);w[_]=e;const D=Object.assign({},this.indexes_);return D[_]=h,new cd(D,w)}addToIndexes(e,t){const r=(0,P.UI)(this.indexes_,(i,a)=>{const l=(0,P.DV)(this.indexSet_,a);if((0,P.hu)(l,"Missing index implementation for "+a),i===uv){if(l.isDefinedOn(e.node)){const h=[],_=t.getIterator(un.Wrap);let w=_.getNext();for(;w;)w.name!==e.name&&h.push(w),w=_.getNext();return h.push(e),IS(h,l.getCompare())}return uv}{const h=t.get(e.name);let _=i;return h&&(_=_.remove(new un(e.name,h))),_.insert(e,e.node)}});return new cd(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,P.UI)(this.indexes_,i=>{if(i===uv)return i;{const a=t.get(e.name);return a?i.remove(new un(e.name,a)):i}});return new cd(r,this.indexSet_)}}let wI,Wt=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&JL(this.priorityNode_),this.children_.isEmpty()&&(0,P.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return wI||(wI=new n(new co(cO),null,cd.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||wI}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?wI:r}}getChild(t){const r=rn(t);return null===r?this:this.getImmediateChild(r).getChild(Gn(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,P.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new un(t,r);let a,l;r.isEmpty()?(a=this.children_.remove(t),l=this.indexMap_.removeFromIndexes(i,this.children_)):(a=this.children_.insert(t,r),l=this.indexMap_.addToIndexes(i,this.children_));const h=a.isEmpty()?wI:this.priorityNode_;return new n(a,h,l)}}updateChild(t,r){const i=rn(t);if(null===i)return r;{(0,P.hu)(".priority"!==rn(t)||1===hf(t),".priority must be the last token in a path");const a=this.getImmediateChild(i).updateChild(Gn(t),r);return this.updateImmediateChild(i,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,a=0,l=!0;if(this.forEachChild(Jn,(h,_)=>{r[h]=_.val(t),i++,l&&n.INTEGER_REGEXP_.test(h)?a=Math.max(a,Number(h)):l=!1}),!t&&l&&a<2*i){const h=[];for(const _ in r)h[_]=r[_];return h}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+XL(this.getPriority().val())+":"),this.forEachChild(Jn,(r,i)=>{const a=i.hash();""!==a&&(t+=":"+r+":"+a)}),this.lazyHash_=""===t?"":fL(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const a=this.resolveIndex_(i);if(a){const l=a.getPredecessorKey(new un(t,r));return l?l.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new un(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new un(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(a=>r(a.name,a.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,a=>a);{const a=this.children_.getIteratorFrom(t.name,un.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)<0;)a.getNext(),l=a.peek();return a}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,a=>a);{const a=this.children_.getReverseIteratorFrom(t.name,un.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)>0;)a.getNext(),l=a.peek();return a}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===EI?-1:0}withIndex(t){if(t===xl||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===xl||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(Jn),a=r.getIterator(Jn);let l=i.getNext(),h=a.getNext();for(;l&&h;){if(l.name!==h.name||!l.node.equals(h.node))return!1;l=i.getNext(),h=a.getNext()}return null===l&&null===h}return!1}return!1}}resolveIndex_(t){return t===xl?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const EI=new class kG extends Wt{constructor(){super(new co(cO),Wt.EMPTY_NODE,cd.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Wt.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(un,{MIN:{value:new un(cf,Wt.EMPTY_NODE)},MAX:{value:new un(ld,EI)}}),QL.__EMPTY_NODE=Wt.EMPTY_NODE,av.__childrenNodeConstructor=Wt,function MG(n){dO=n}(EI),function RG(n){nV=n}(EI);const FG=!0;function xr(n,e=null){if(null===n)return Wt.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,P.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new av(n,xr(e));if(n instanceof Array||!FG){let t=Wt.EMPTY_NODE;return Li(n,(r,i)=>{if((0,P.r3)(n,r)&&"."!==r.substring(0,1)){const a=xr(i);(a.isLeafNode()||!a.isEmpty())&&(t=t.updateImmediateChild(r,a))}}),t.updatePriority(xr(e))}{const t=[];let r=!1;if(Li(n,(l,h)=>{if("."!==l.substring(0,1)){const _=xr(h);_.isEmpty()||(r=r||!_.getPriority().isEmpty(),t.push(new un(l,_)))}}),0===t.length)return Wt.EMPTY_NODE;const a=IS(t,AG,l=>l.name,cO);if(r){const l=IS(t,Jn.getCompare());return new Wt(a,xr(e),new cd({".priority":l},{".priority":Jn}))}return new Wt(a,xr(e),cd.Default)}}!function xG(n){tV=n}(xr);class fO extends vS{constructor(e){super(),this.indexPath_=e,(0,P.hu)(!sn(e)&&".priority"!==rn(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),a=r.compareTo(i);return 0===a?qg(e.name,t.name):a}makePost(e,t){const r=xr(e),i=Wt.EMPTY_NODE.updateChild(this.indexPath_,r);return new un(t,i)}maxPost(){const e=Wt.EMPTY_NODE.updateChild(this.indexPath_,EI);return new un(ld,e)}toString(){return yI(this.indexPath_,0).join("/")}}const pO=new class LG extends vS{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?qg(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return un.MIN}maxPost(){return un.MAX}makePost(e,t){const r=xr(e);return new un(t,r)}toString(){return".value"}};function rV(n){return{type:"value",snapshotNode:n}}function lv(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function II(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function CI(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class gO{constructor(e){this.index_=e}updateChild(e,t,r,i,a,l){(0,P.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(t);return h.getChild(i).equals(r.getChild(i))&&h.isEmpty()===r.isEmpty()||(null!=l&&(r.isEmpty()?e.hasChild(t)?l.trackChildChange(II(t,h)):(0,P.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?l.trackChildChange(lv(t,r)):l.trackChildChange(CI(t,r,h))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(Jn,(i,a)=>{t.hasChild(i)||r.trackChildChange(II(i,a))}),t.isLeafNode()||t.forEachChild(Jn,(i,a)=>{if(e.hasChild(i)){const l=e.getImmediateChild(i);l.equals(a)||r.trackChildChange(CI(i,a,l))}else r.trackChildChange(lv(i,a))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Wt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class bI{constructor(e){this.indexedFilter_=new gO(e.getIndex()),this.index_=e.getIndex(),this.startPost_=bI.getStartPost_(e),this.endPost_=bI.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,a,l){return this.matches(new un(t,r))||(r=Wt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,a,l)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Wt.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Wt.EMPTY_NODE);const a=this;return t.forEachChild(Jn,(l,h)=>{a.matches(new un(l,h))||(i=i.updateImmediateChild(l,Wt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class UG{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new bI(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,a,l){return this.rangedFilter_.matches(new un(t,r))||(r=Wt.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,a,l):this.fullLimitUpdateChild_(e,t,r,a,l)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=Wt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let a;i=Wt.EMPTY_NODE.withIndex(this.index_),a=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let l=0;for(;a.hasNext()&&l<this.limit_;){const h=a.getNext();if(this.withinDirectionalStart(h)){if(!this.withinDirectionalEnd(h))break;i=i.updateImmediateChild(h.name,h.node),l++}}}else{let a;i=t.withIndex(this.index_),i=i.updatePriority(Wt.EMPTY_NODE),a=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let l=0;for(;a.hasNext();){const h=a.getNext();l<this.limit_&&this.withinDirectionalStart(h)&&this.withinDirectionalEnd(h)?l++:i=i.updateImmediateChild(h.name,Wt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,a){let l;if(this.reverse_){const A=this.index_.getCompare();l=(O,H)=>A(H,O)}else l=this.index_.getCompare();const h=e;(0,P.hu)(h.numChildren()===this.limit_,"");const _=new un(t,r),w=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),D=this.rangedFilter_.matches(_);if(h.hasChild(t)){const A=h.getImmediateChild(t);let O=i.getChildAfterChild(this.index_,w,this.reverse_);for(;null!=O&&(O.name===t||h.hasChild(O.name));)O=i.getChildAfterChild(this.index_,O,this.reverse_);const H=null==O?1:l(O,_);if(D&&!r.isEmpty()&&H>=0)return a?.trackChildChange(CI(t,r,A)),h.updateImmediateChild(t,r);{a?.trackChildChange(II(t,A));const ce=h.updateImmediateChild(t,Wt.EMPTY_NODE);return null!=O&&this.rangedFilter_.matches(O)?(a?.trackChildChange(lv(O.name,O.node)),ce.updateImmediateChild(O.name,O.node)):ce}}return r.isEmpty()?e:D&&l(w,_)>=0?(null!=a&&(a.trackChildChange(II(w.name,w.node)),a.trackChildChange(lv(t,r))),h.updateImmediateChild(t,r).updateImmediateChild(w.name,Wt.EMPTY_NODE)):e}}class CS{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Jn}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,P.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,P.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:cf}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,P.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,P.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ld}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,P.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Jn}copy(){const e=new CS;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function mO(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function _O(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function bS(n,e){const t=n.copy();return t.index_=e,t}function iV(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Jn?t="$priority":n.index_===pO?t="$value":n.index_===xl?t="$key":((0,P.hu)(n.index_ instanceof fO,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,P.Wl)(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=(0,P.Wl)(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+(0,P.Wl)(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=(0,P.Wl)(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+(0,P.Wl)(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function sV(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==Jn&&(e.i=n.index_.toString()),e}class DS extends $L{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=pI("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,P.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);const l=DS.getListenId_(e,r),h={};this.listens_[l]=h;const _=iV(e._queryParams);this.restRequest_(a+".json",_,(w,D)=>{let A=D;if(404===w&&(A=null,w=null),null===w&&this.onDataUpdate_(a,A,!1,r),(0,P.DV)(this.listens_,l)===h){let O;O=w?401===w?"permission_denied":"rest_error:"+w:"ok",i(O,null)}})}unlisten(e,t){const r=DS.getListenId_(e,t);delete this.listens_[r]}get(e){const t=iV(e._queryParams),r=e._path.toString(),i=new P.BH;return this.restRequest_(r+".json",t,(a,l)=>{let h=l;404===a&&(h=null,a=null),null===a?(this.onDataUpdate_(r,h,!1,null),i.resolve(h)):i.reject(new Error(h))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,a])=>{i&&i.accessToken&&(t.auth=i.accessToken),a&&a.token&&(t.ac=a.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,P.xO)(t);this.log_("Sending REST request for "+l);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(r&&4===h.readyState){this.log_("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);let _=null;if(h.status>=200&&h.status<300){try{_=(0,P.cI)(h.responseText)}catch{Es("Failed to parse JSON response for "+l+": "+h.responseText)}r(null,_)}else 401!==h.status&&404!==h.status&&Es("Got unsuccessful REST response for "+l+" Status: "+h.status),r(h.status);r=null}},h.open("GET",l,!0),h.send()})}}class zG{constructor(){this.rootNode_=Wt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function TS(){return{value:null,children:new Map}}function cv(n,e,t){if(sn(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=rn(e);n.children.has(r)||n.children.set(r,TS()),cv(n.children.get(r),e=Gn(e),t)}}function yO(n,e){if(sn(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(Jn,(r,i)=>{cv(n,new An(r),i)}),yO(n,e)}}if(n.children.size>0){const t=rn(e);return e=Gn(e),n.children.has(t)&&yO(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function vO(n,e,t){null!==n.value?t(e,n.value):function qG(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{vO(i,new An(e.toString()+"/"+r),t)})}class WG{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Li(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class YG{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new WG(e);const r=1e4+2e4*Math.random();mI(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Li(e,(i,a)=>{a>0&&(0,P.r3)(this.statsToReport_,i)&&(t[i]=a,r=!0)}),r&&this.server_.reportStats(t),mI(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Rl=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Rl||{});function IO(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class SS{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Rl.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(sn(this.path)){if(null!=this.affectedTree.value)return(0,P.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new An(e));return new SS(yn(),t,this.revert)}}return(0,P.hu)(rn(this.path)===e,"operationForChild called for unrelated child."),new SS(Gn(this.path),this.affectedTree,this.revert)}}class DI{constructor(e,t){this.source=e,this.path=t,this.type=Rl.LISTEN_COMPLETE}operationForChild(e){return sn(this.path)?new DI(this.source,yn()):new DI(this.source,Gn(this.path))}}class Kg{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Rl.OVERWRITE}operationForChild(e){return sn(this.path)?new Kg(this.source,yn(),this.snap.getImmediateChild(e)):new Kg(this.source,Gn(this.path),this.snap)}}class dv{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Rl.MERGE}operationForChild(e){if(sn(this.path)){const t=this.children.subtree(new An(e));return t.isEmpty()?null:t.value?new Kg(this.source,yn(),t.value):new dv(this.source,yn(),t)}return(0,P.hu)(rn(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new dv(this.source,Gn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class ff{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(sn(e))return this.isFullyInitialized()&&!this.filtered_;const t=rn(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class QG{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function TI(n,e,t,r,i,a){const l=r.filter(h=>h.type===t);l.sort((h,_)=>function e3(n,e,t){if(null==e.childName||null==t.childName)throw(0,P.g5)("Should only compare child_ events.");const r=new un(e.childName,e.snapshotNode),i=new un(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,h,_)),l.forEach(h=>{const _=function JG(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,h,a);i.forEach(w=>{w.respondsTo(h.type)&&e.push(w.createEvent(_,n.query_))})})}function AS(n,e){return{eventCache:n,serverCache:e}}function SI(n,e,t,r){return AS(new ff(e,t,r),n.serverCache)}function aV(n,e,t,r){return AS(n.eventCache,new ff(e,t,r))}function MS(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Yg(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let CO;class er{constructor(e,t=(()=>(CO||(CO=new co(V$)),CO))()){this.value=e,this.children=t}static fromObject(e){let t=new er(null);return Li(e,(r,i)=>{t=t.set(new An(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:yn(),value:this.value};if(sn(e))return null;{const r=rn(e),i=this.children.get(r);if(null!==i){const a=i.findRootMostMatchingPathAndValue(Gn(e),t);return null!=a?{path:wr(new An(r),a.path),value:a.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(sn(e))return this;{const t=rn(e),r=this.children.get(t);return null!==r?r.subtree(Gn(e)):new er(null)}}set(e,t){if(sn(e))return new er(t,this.children);{const r=rn(e),a=(this.children.get(r)||new er(null)).set(Gn(e),t),l=this.children.insert(r,a);return new er(this.value,l)}}remove(e){if(sn(e))return this.children.isEmpty()?new er(null):new er(null,this.children);{const t=rn(e),r=this.children.get(t);if(r){const i=r.remove(Gn(e));let a;return a=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&a.isEmpty()?new er(null):new er(this.value,a)}return this}}get(e){if(sn(e))return this.value;{const t=rn(e),r=this.children.get(t);return r?r.get(Gn(e)):null}}setTree(e,t){if(sn(e))return t;{const r=rn(e),a=(this.children.get(r)||new er(null)).setTree(Gn(e),t);let l;return l=a.isEmpty()?this.children.remove(r):this.children.insert(r,a),new er(this.value,l)}}fold(e){return this.fold_(yn(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,a)=>{r[i]=a.fold_(wr(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,yn(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(sn(e))return null;{const a=rn(e),l=this.children.get(a);return l?l.findOnPath_(Gn(e),wr(t,a),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,yn(),t)}foreachOnPath_(e,t,r){if(sn(e))return this;{this.value&&r(t,this.value);const i=rn(e),a=this.children.get(i);return a?a.foreachOnPath_(Gn(e),wr(t,i),r):new er(null)}}foreach(e){this.foreach_(yn(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(wr(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class pu{constructor(e){this.writeTree_=e}static empty(){return new pu(new er(null))}}function AI(n,e,t){if(sn(e))return new pu(new er(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let a=r.value;const l=Gs(i,e);return a=a.updateChild(l,t),new pu(n.writeTree_.set(i,a))}{const i=new er(t),a=n.writeTree_.setTree(e,i);return new pu(a)}}}function bO(n,e,t){let r=n;return Li(t,(i,a)=>{r=AI(r,wr(e,i),a)}),r}function uV(n,e){if(sn(e))return pu.empty();{const t=n.writeTree_.setTree(e,new er(null));return new pu(t)}}function DO(n,e){return null!=Qg(n,e)}function Qg(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(Gs(t.path,e)):null}function lV(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(Jn,(r,i)=>{e.push(new un(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new un(r,i.value))}),e}function pf(n,e){if(sn(e))return n;{const t=Qg(n,e);return new pu(null!=t?new er(t):n.writeTree_.subtree(e))}}function TO(n){return n.writeTree_.isEmpty()}function hv(n,e){return cV(yn(),n.writeTree_,e)}function cV(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,a)=>{".priority"===i?((0,P.hu)(null!==a.value,"Priority writes must always be leaf nodes"),r=a.value):t=cV(wr(n,i),a,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(wr(n,".priority"),r)),t}}function xS(n,e){return gV(e,n)}function o3(n,e){if(n.snap)return Ea(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Ea(wr(n.path,t),e))return!0;return!1}function u3(n){return n.visible}function dV(n,e,t){let r=pu.empty();for(let i=0;i<n.length;++i){const a=n[i];if(e(a)){const l=a.path;let h;if(a.snap)Ea(t,l)?(h=Gs(t,l),r=AI(r,h,a.snap)):Ea(l,t)&&(h=Gs(l,t),r=AI(r,yn(),a.snap.getChild(h)));else{if(!a.children)throw(0,P.g5)("WriteRecord should have .snap or .children");if(Ea(t,l))h=Gs(t,l),r=bO(r,h,a.children);else if(Ea(l,t))if(h=Gs(l,t),sn(h))r=bO(r,yn(),a.children);else{const _=(0,P.DV)(a.children,rn(h));if(_){const w=_.getChild(Gn(h));r=AI(r,yn(),w)}}}}}return r}function hV(n,e,t,r,i){if(r||i){const a=pf(n.visibleWrites,e);return!i&&TO(a)?t:i||null!=t||DO(a,yn())?hv(dV(n.allWrites,function(w){return(w.visible||i)&&(!r||!~r.indexOf(w.writeId))&&(Ea(w.path,e)||Ea(e,w.path))},e),t||Wt.EMPTY_NODE):null}{const a=Qg(n.visibleWrites,e);if(null!=a)return a;{const l=pf(n.visibleWrites,e);return TO(l)?t:null!=t||DO(l,yn())?hv(l,t||Wt.EMPTY_NODE):null}}}function RS(n,e,t,r){return hV(n.writeTree,n.treePath,e,t,r)}function SO(n,e){return function l3(n,e,t){let r=Wt.EMPTY_NODE;const i=Qg(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Jn,(a,l)=>{r=r.updateImmediateChild(a,l)}),r;if(t){const a=pf(n.visibleWrites,e);return t.forEachChild(Jn,(l,h)=>{const _=hv(pf(a,new An(l)),h);r=r.updateImmediateChild(l,_)}),lV(a).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}return lV(pf(n.visibleWrites,e)).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}(n.writeTree,n.treePath,e)}function fV(n,e,t,r){return function c3(n,e,t,r,i){(0,P.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const a=wr(e,t);if(DO(n.visibleWrites,a))return null;{const l=pf(n.visibleWrites,a);return TO(l)?i.getChild(t):hv(l,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function NS(n,e){return function h3(n,e){return Qg(n.visibleWrites,e)}(n.writeTree,wr(n.treePath,e))}function AO(n,e,t){return function d3(n,e,t,r){const i=wr(e,t),a=Qg(n.visibleWrites,i);return null!=a?a:r.isCompleteForChild(t)?hv(pf(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function pV(n,e){return gV(wr(n.treePath,e),n.writeTree)}function gV(n,e){return{treePath:n,writeTree:e}}class m3{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,P.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,P.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const a=i.type;if("child_added"===t&&"child_removed"===a)this.changeMap.set(r,CI(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===a)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===a)this.changeMap.set(r,II(r,i.oldSnap));else if("child_changed"===t&&"child_added"===a)this.changeMap.set(r,lv(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==a)throw(0,P.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,CI(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const mV=new class _3{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class MO{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new ff(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return AO(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Yg(this.viewCache_),a=function g3(n,e,t,r,i,a){return function f3(n,e,t,r,i,a,l){let h;const _=pf(n.visibleWrites,e),w=Qg(_,yn());if(null!=w)h=w;else{if(null==t)return[];h=hv(_,t)}if(h=h.withIndex(l),h.isEmpty()||h.isLeafNode())return[];{const D=[],A=l.getCompare(),O=a?h.getReverseIteratorFrom(r,l):h.getIteratorFrom(r,l);let H=O.getNext();for(;H&&D.length<i;)0!==A(H,r)&&D.push(H),H=O.getNext();return D}}(n.writeTree,n.treePath,e,t,r,i,a)}(this.writes_,i,t,1,r,e);return 0===a.length?null:a[0]}}function _V(n,e,t,r,i,a){const l=e.eventCache;if(null!=NS(r,t))return e;{let h,_;if(sn(t))if((0,P.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const w=Yg(e),A=SO(r,w instanceof Wt?w:Wt.EMPTY_NODE);h=n.filter.updateFullNode(e.eventCache.getNode(),A,a)}else{const w=RS(r,Yg(e));h=n.filter.updateFullNode(e.eventCache.getNode(),w,a)}else{const w=rn(t);if(".priority"===w){(0,P.hu)(1===hf(t),"Can't have a priority with additional path components");const D=l.getNode();_=e.serverCache.getNode();const A=fV(r,t,D,_);h=null!=A?n.filter.updatePriority(D,A):l.getNode()}else{const D=Gn(t);let A;if(l.isCompleteForChild(w)){_=e.serverCache.getNode();const O=fV(r,t,l.getNode(),_);A=null!=O?l.getNode().getImmediateChild(w).updateChild(D,O):l.getNode().getImmediateChild(w)}else A=AO(r,w,e.serverCache);h=null!=A?n.filter.updateChild(l.getNode(),w,A,D,i,a):l.getNode()}}return SI(e,h,l.isFullyInitialized()||sn(t),n.filter.filtersNodes())}}function OS(n,e,t,r,i,a,l,h){const _=e.serverCache;let w;const D=l?n.filter:n.filter.getIndexedFilter();if(sn(t))w=D.updateFullNode(_.getNode(),r,null);else if(D.filtersNodes()&&!_.isFiltered()){const H=_.getNode().updateChild(t,r);w=D.updateFullNode(_.getNode(),H,null)}else{const H=rn(t);if(!_.isCompleteForPath(t)&&hf(t)>1)return e;const z=Gn(t),Te=_.getNode().getImmediateChild(H).updateChild(z,r);w=".priority"===H?D.updatePriority(_.getNode(),Te):D.updateChild(_.getNode(),H,Te,z,mV,null)}const A=aV(e,w,_.isFullyInitialized()||sn(t),D.filtersNodes());return _V(n,A,t,i,new MO(i,A,a),h)}function xO(n,e,t,r,i,a,l){const h=e.eventCache;let _,w;const D=new MO(i,e,a);if(sn(t))w=n.filter.updateFullNode(e.eventCache.getNode(),r,l),_=SI(e,w,!0,n.filter.filtersNodes());else{const A=rn(t);if(".priority"===A)w=n.filter.updatePriority(e.eventCache.getNode(),r),_=SI(e,w,h.isFullyInitialized(),h.isFiltered());else{const O=Gn(t),H=h.getNode().getImmediateChild(A);let z;if(sn(O))z=r;else{const ce=D.getCompleteChild(A);z=null!=ce?".priority"===aO(O)&&ce.getChild(WL(O)).isEmpty()?ce:ce.updateChild(O,r):Wt.EMPTY_NODE}_=H.equals(z)?e:SI(e,n.filter.updateChild(h.getNode(),A,z,O,D,l),h.isFullyInitialized(),n.filter.filtersNodes())}}return _}function yV(n,e){return n.eventCache.isCompleteForChild(e)}function vV(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function RO(n,e,t,r,i,a,l,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let w,_=e;w=sn(t)?r:new er(null).setTree(t,r);const D=e.serverCache.getNode();return w.children.inorderTraversal((A,O)=>{if(D.hasChild(A)){const z=vV(0,e.serverCache.getNode().getImmediateChild(A),O);_=OS(n,_,new An(A),z,i,a,l,h)}}),w.children.inorderTraversal((A,O)=>{const H=!e.serverCache.isCompleteForChild(A)&&null===O.value;if(!D.hasChild(A)&&!H){const ce=vV(0,e.serverCache.getNode().getImmediateChild(A),O);_=OS(n,_,new An(A),ce,i,a,l,h)}}),_}class T3{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new gO(r.getIndex()),a=function BG(n){return n.loadsAllData()?new gO(n.getIndex()):n.hasLimit()?new UG(n):new bI(n)}(r);this.processor_=function y3(n){return{filter:n}}(a);const l=t.serverCache,h=t.eventCache,_=i.updateFullNode(Wt.EMPTY_NODE,l.getNode(),null),w=a.updateFullNode(Wt.EMPTY_NODE,h.getNode(),null),D=new ff(_,l.isFullyInitialized(),i.filtersNodes()),A=new ff(w,h.isFullyInitialized(),a.filtersNodes());this.viewCache_=AS(A,D),this.eventGenerator_=new QG(this.query_)}get query(){return this.query_}}function M3(n,e){const t=Yg(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!sn(e)&&!t.getImmediateChild(rn(e)).isEmpty())?t.getChild(e):null}function wV(n){return 0===n.eventRegistrations_.length}function EV(n,e,t){const r=[];if(t){(0,P.hu)(null==e,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(a=>{const l=a.createCancelEvent(t,i);l&&r.push(l)})}if(e){let i=[];for(let a=0;a<n.eventRegistrations_.length;++a){const l=n.eventRegistrations_[a];if(l.matches(e)){if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(a+1));break}}else i.push(l)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function IV(n,e,t,r){e.type===Rl.MERGE&&null!==e.source.queryId&&((0,P.hu)(Yg(n.viewCache_),"We should always have a full cache before handling merges"),(0,P.hu)(MS(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,a=function w3(n,e,t,r,i){const a=new m3;let l,h;if(t.type===Rl.OVERWRITE){const w=t;w.source.fromUser?l=xO(n,e,w.path,w.snap,r,i,a):((0,P.hu)(w.source.fromServer,"Unknown source."),h=w.source.tagged||e.serverCache.isFiltered()&&!sn(w.path),l=OS(n,e,w.path,w.snap,r,i,h,a))}else if(t.type===Rl.MERGE){const w=t;w.source.fromUser?l=function I3(n,e,t,r,i,a,l){let h=e;return r.foreach((_,w)=>{const D=wr(t,_);yV(e,rn(D))&&(h=xO(n,h,D,w,i,a,l))}),r.foreach((_,w)=>{const D=wr(t,_);yV(e,rn(D))||(h=xO(n,h,D,w,i,a,l))}),h}(n,e,w.path,w.children,r,i,a):((0,P.hu)(w.source.fromServer,"Unknown source."),h=w.source.tagged||e.serverCache.isFiltered(),l=RO(n,e,w.path,w.children,r,i,h,a))}else if(t.type===Rl.ACK_USER_WRITE){const w=t;l=w.revert?function D3(n,e,t,r,i,a){let l;if(null!=NS(r,t))return e;{const h=new MO(r,e,i),_=e.eventCache.getNode();let w;if(sn(t)||".priority"===rn(t)){let D;if(e.serverCache.isFullyInitialized())D=RS(r,Yg(e));else{const A=e.serverCache.getNode();(0,P.hu)(A instanceof Wt,"serverChildren would be complete if leaf node"),D=SO(r,A)}w=n.filter.updateFullNode(_,D,a)}else{const D=rn(t);let A=AO(r,D,e.serverCache);null==A&&e.serverCache.isCompleteForChild(D)&&(A=_.getImmediateChild(D)),w=null!=A?n.filter.updateChild(_,D,A,Gn(t),h,a):e.eventCache.getNode().hasChild(D)?n.filter.updateChild(_,D,Wt.EMPTY_NODE,Gn(t),h,a):_,w.isEmpty()&&e.serverCache.isFullyInitialized()&&(l=RS(r,Yg(e)),l.isLeafNode()&&(w=n.filter.updateFullNode(w,l,a)))}return l=e.serverCache.isFullyInitialized()||null!=NS(r,yn()),SI(e,w,l,n.filter.filtersNodes())}}(n,e,w.path,r,i,a):function C3(n,e,t,r,i,a,l){if(null!=NS(i,t))return e;const h=e.serverCache.isFiltered(),_=e.serverCache;if(null!=r.value){if(sn(t)&&_.isFullyInitialized()||_.isCompleteForPath(t))return OS(n,e,t,_.getNode().getChild(t),i,a,h,l);if(sn(t)){let w=new er(null);return _.getNode().forEachChild(xl,(D,A)=>{w=w.set(new An(D),A)}),RO(n,e,t,w,i,a,h,l)}return e}{let w=new er(null);return r.foreach((D,A)=>{const O=wr(t,D);_.isCompleteForPath(O)&&(w=w.set(D,_.getNode().getChild(O)))}),RO(n,e,t,w,i,a,h,l)}}(n,e,w.path,w.affectedTree,r,i,a)}else{if(t.type!==Rl.LISTEN_COMPLETE)throw(0,P.g5)("Unknown operation type: "+t.type);l=function b3(n,e,t,r,i){const a=e.serverCache;return _V(n,aV(e,a.getNode(),a.isFullyInitialized()||sn(t),a.isFiltered()),t,r,mV,i)}(n,e,t.path,r,a)}const _=a.getChanges();return function E3(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=MS(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&t.push(rV(MS(e)))}}(e,l,_),{viewCache:l,changes:_}}(n.processor_,i,e,t,r);return function v3(n,e){(0,P.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,P.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,a.viewCache),(0,P.hu)(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=a.viewCache,CV(n,a.changes,a.viewCache.eventCache.getNode(),null)}function CV(n,e,t,r){return function XG(n,e,t,r){const i=[],a=[];return e.forEach(l=>{"child_changed"===l.type&&n.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&a.push(function VG(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(l.childName,l.snapshotNode))}),TI(n,i,"child_removed",e,r,t),TI(n,i,"child_added",e,r,t),TI(n,i,"child_moved",a,r,t),TI(n,i,"child_changed",e,r,t),TI(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let PS,FS;class bV{constructor(){this.views=new Map}}function NO(n,e,t,r){const i=e.source.queryId;if(null!==i){const a=n.views.get(i);return(0,P.hu)(null!=a,"SyncTree gave us an op for an invalid query."),IV(a,e,t,r)}{let a=[];for(const l of n.views.values())a=a.concat(IV(l,e,t,r));return a}}function DV(n,e,t,r,i){const l=n.views.get(e._queryIdentifier);if(!l){let h=RS(t,i?r:null),_=!1;h?_=!0:r instanceof Wt?(h=SO(t,r),_=!1):(h=Wt.EMPTY_NODE,_=!1);const w=AS(new ff(h,_,!1),new ff(r,i,!1));return new T3(e,w)}return l}function TV(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function gf(n,e){let t=null;for(const r of n.views.values())t=t||M3(r,e);return t}function SV(n,e){return e._queryParams.loadsAllData()?kS(n):n.views.get(e._queryIdentifier)}function AV(n,e){return null!=SV(n,e)}function mf(n){return null!=kS(n)}function kS(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let U3=1;class MV{constructor(e){this.listenProvider_=e,this.syncPointTree_=new er(null),this.pendingWriteTree_=function p3(){return{visibleWrites:pu.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function OO(n,e,t,r,i){return function n3(n,e,t,r,i){(0,P.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=AI(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?fv(n,new Kg({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function _f(n,e,t=!1){const r=function i3(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function s3(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);(0,P.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,a=!1,l=n.allWrites.length-1;for(;i&&l>=0;){const h=n.allWrites[l];h.visible&&(l>=t&&o3(h,r.path)?i=!1:Ea(r.path,h.path)&&(a=!0)),l--}return!!i&&(a?(function a3(n){n.visibleWrites=dV(n.allWrites,u3,yn()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=uV(n.visibleWrites,r.path):Li(r.children,_=>{n.visibleWrites=uV(n.visibleWrites,wr(r.path,_))}),!0))}(n.pendingWriteTree_,e)){let a=new er(null);return null!=r.snap?a=a.set(yn(),!0):Li(r.children,l=>{a=a.set(new An(l),!0)}),fv(n,new SS(r.path,a,t))}return[]}function MI(n,e,t){return fv(n,new Kg({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function LS(n,e,t,r,i=!1){const a=e._path,l=n.syncPointTree_.get(a);let h=[];if(l&&("default"===e._queryIdentifier||AV(l,e))){const _=function F3(n,e,t,r){const i=e._queryIdentifier,a=[];let l=[];const h=mf(n);if("default"===i)for(const[_,w]of n.views.entries())l=l.concat(EV(w,t,r)),wV(w)&&(n.views.delete(_),w.query._queryParams.loadsAllData()||a.push(w.query));else{const _=n.views.get(i);_&&(l=l.concat(EV(_,t,r)),wV(_)&&(n.views.delete(i),_.query._queryParams.loadsAllData()||a.push(_.query)))}return h&&!mf(n)&&a.push(new(function O3(){return(0,P.hu)(PS,"Reference.ts has not been loaded"),PS}())(e._repo,e._path)),{removed:a,events:l}}(l,e,t,r);(function P3(n){return 0===n.views.size})(l)&&(n.syncPointTree_=n.syncPointTree_.remove(a));const w=_.removed;if(h=_.events,!i){const D=-1!==w.findIndex(O=>O._queryParams.loadsAllData()),A=n.syncPointTree_.findOnPath(a,(O,H)=>mf(H));if(D&&!A){const O=n.syncPointTree_.subtree(a);if(!O.isEmpty()){const H=function q3(n){return n.fold((e,t,r)=>{if(t&&mf(t))return[kS(t)];{let i=[];return t&&(i=TV(t)),Li(r,(a,l)=>{i=i.concat(l)}),i}})}(O);for(let z=0;z<H.length;++z){const ce=H[z],Te=ce.query,ht=OV(n,ce);n.listenProvider_.startListening(RI(Te),xI(n,Te),ht.hashFn,ht.onComplete)}}}!A&&w.length>0&&!r&&(D?n.listenProvider_.stopListening(RI(e),null):w.forEach(O=>{const H=n.queryToTagMap.get(US(O));n.listenProvider_.stopListening(RI(O),H)}))}!function W3(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=US(r),a=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(a)}}}(n,w)}return h}function xV(n,e,t,r){const i=kO(n,r);if(null!=i){const a=FO(i),l=a.path,h=a.queryId,_=Gs(l,e);return LO(n,l,new Kg(IO(h),_,t))}return[]}function PO(n,e,t,r=!1){const i=e._path;let a=null,l=!1;n.syncPointTree_.foreachOnPath(i,(O,H)=>{const z=Gs(O,i);a=a||gf(H,z),l=l||mf(H)});let _,h=n.syncPointTree_.get(i);h?(l=l||mf(h),a=a||gf(h,yn())):(h=new bV,n.syncPointTree_=n.syncPointTree_.set(i,h)),null!=a?_=!0:(_=!1,a=Wt.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((H,z)=>{const ce=gf(z,yn());ce&&(a=a.updateImmediateChild(H,ce))}));const w=AV(h,e);if(!w&&!e._queryParams.loadsAllData()){const O=US(e);(0,P.hu)(!n.queryToTagMap.has(O),"View does not exist, but we have a tag");const H=function Z3(){return U3++}();n.queryToTagMap.set(O,H),n.tagToQueryMap.set(H,O)}let A=function k3(n,e,t,r,i,a){const l=DV(n,e,r,i,a);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,l),function x3(n,e){n.eventRegistrations_.push(e)}(l,t),function R3(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Jn,(a,l)=>{r.push(lv(a,l))}),t.isFullyInitialized()&&r.push(rV(t.getNode())),CV(n,r,t.getNode(),e)}(l,t)}(h,e,t,xS(n.pendingWriteTree_,i),a,_);if(!w&&!l&&!r){const O=SV(h,e);A=A.concat(function K3(n,e,t){const r=e._path,i=xI(n,e),a=OV(n,t),l=n.listenProvider_.startListening(RI(e),i,a.hashFn,a.onComplete),h=n.syncPointTree_.subtree(r);if(i)(0,P.hu)(!mf(h.value),"If we're adding a query, it shouldn't be shadowed");else{const _=h.fold((w,D,A)=>{if(!sn(w)&&D&&mf(D))return[kS(D).query];{let O=[];return D&&(O=O.concat(TV(D).map(H=>H.query))),Li(A,(H,z)=>{O=O.concat(z)}),O}});for(let w=0;w<_.length;++w){const D=_[w];n.listenProvider_.stopListening(RI(D),xI(n,D))}}return l}(n,e,O))}return A}function VS(n,e,t){const i=n.pendingWriteTree_,a=n.syncPointTree_.findOnPath(e,(l,h)=>{const w=gf(h,Gs(l,e));if(w)return w});return hV(i,e,a,t,!0)}function fv(n,e){return RV(e,n.syncPointTree_,null,xS(n.pendingWriteTree_,yn()))}function RV(n,e,t,r){if(sn(n.path))return NV(n,e,t,r);{const i=e.get(yn());null==t&&null!=i&&(t=gf(i,yn()));let a=[];const l=rn(n.path),h=n.operationForChild(l),_=e.children.get(l);if(_&&h){const w=t?t.getImmediateChild(l):null,D=pV(r,l);a=a.concat(RV(h,_,w,D))}return i&&(a=a.concat(NO(i,n,r,t))),a}}function NV(n,e,t,r){const i=e.get(yn());null==t&&null!=i&&(t=gf(i,yn()));let a=[];return e.children.inorderTraversal((l,h)=>{const _=t?t.getImmediateChild(l):null,w=pV(r,l),D=n.operationForChild(l);D&&(a=a.concat(NV(D,h,_,w)))}),i&&(a=a.concat(NO(i,n,r,t))),a}function OV(n,e){const t=e.query,r=xI(n,t);return{hashFn:()=>(function S3(n){return n.viewCache_.serverCache.getNode()}(e)||Wt.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function $3(n,e,t){const r=kO(n,t);if(r){const i=FO(r),a=i.path,l=i.queryId,h=Gs(a,e);return LO(n,a,new DI(IO(l),h))}return[]}(n,t._path,r):function H3(n,e){return fv(n,new DI({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const a=function j$(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(i,t);return LS(n,t,null,a)}}}}function xI(n,e){const t=US(e);return n.queryToTagMap.get(t)}function US(n){return n._path.toString()+"$"+n._queryIdentifier}function kO(n,e){return n.tagToQueryMap.get(e)}function FO(n){const e=n.indexOf("$");return(0,P.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new An(n.substr(0,e))}}function LO(n,e,t){const r=n.syncPointTree_.get(e);return(0,P.hu)(r,"Missing sync point for query tag that we're tracking"),NO(r,t,xS(n.pendingWriteTree_,e),null)}function RI(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function V3(){return(0,P.hu)(FS,"Reference.ts has not been loaded"),FS}())(n._repo,n._path):n}class VO{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new VO(t)}node(){return this.node_}}class UO{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=wr(this.path_,e);return new UO(this.syncTree_,t)}node(){return VS(this.syncTree_,this.path_)}}const Y3=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},PV=function(n,e,t){return n&&"object"==typeof n?((0,P.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?Q3(n[".sv"],e,t):"object"==typeof n[".sv"]?X3(n[".sv"],e):void(0,P.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},Q3=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,P.hu)(!1,"Unexpected server value: "+n)},X3=function(n,e,t){n.hasOwnProperty("increment")||(0,P.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,P.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,P.hu)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const l=i.getValue();return"number"!=typeof l?r:l+r},kV=function(n,e,t,r){return jO(e,new UO(t,n),r)},BO=function(n,e,t){return jO(n,new VO(e),t)};function jO(n,e,t){const r=n.getPriority().val(),i=PV(r,e.getImmediateChild(".priority"),t);let a;if(n.isLeafNode()){const l=n,h=PV(l.getValue(),e,t);return h!==l.getValue()||i!==l.getPriority().val()?new av(h,xr(i)):n}{const l=n;return a=l,i!==l.getPriority().val()&&(a=a.updatePriority(new av(i))),l.forEachChild(Jn,(h,_)=>{const w=jO(_,e.getImmediateChild(h),t);w!==_&&(a=a.updateImmediateChild(h,w))}),a}}class HO{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function BS(n,e){let t=e instanceof An?e:new An(e),r=n,i=rn(t);for(;null!==i;){const a=(0,P.DV)(r.node.children,i)||{children:{},childCount:0};r=new HO(i,r,a),t=Gn(t),i=rn(t)}return r}function Xg(n){return n.node.value}function $O(n,e){n.node.value=e,GO(n)}function FV(n){return n.node.childCount>0}function jS(n,e){Li(n.node.children,(t,r)=>{e(new HO(t,n,r))})}function LV(n,e,t,r){t&&!r&&e(n),jS(n,i=>{LV(i,e,!0,r)}),t&&r&&e(n)}function NI(n){return new An(null===n.parent?n.name:NI(n.parent)+"/"+n.name)}function GO(n){null!==n.parent&&function tz(n,e,t){const r=function J3(n){return void 0===Xg(n)&&!FV(n)}(t),i=(0,P.r3)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,GO(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,GO(n))}(n.parent,n.name,n)}const nz=/[\[\].#$\/\u0000-\u001F\u007F]/,rz=/[\[\].#$\u0000-\u001F\u007F]/,zO=10485760,HS=function(n){return"string"==typeof n&&0!==n.length&&!nz.test(n)},VV=function(n){return"string"==typeof n&&0!==n.length&&!rz.test(n)},OI=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!gS(n)||n&&"object"==typeof n&&(0,P.r3)(n,".sv")},Nl=function(n,e,t,r){r&&void 0===e||PI((0,P.gK)(n,"value"),e,t)},PI=function(n,e,t){const r=t instanceof An?new wG(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+Wg(r));if("function"==typeof e)throw new Error(n+"contains a function "+Wg(r)+" with contents = "+e.toString());if(gS(e))throw new Error(n+"contains "+e.toString()+" "+Wg(r));if("string"==typeof e&&e.length>zO/3&&(0,P.ug)(e)>zO)throw new Error(n+"contains a string greater than "+zO+" utf8 bytes "+Wg(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,a=!1;if(Li(e,(l,h)=>{if(".value"===l)i=!0;else if(".priority"!==l&&".sv"!==l&&(a=!0,!HS(l)))throw new Error(n+" contains an invalid key ("+l+") "+Wg(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function EG(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,P.ug)(e),ZL(n)})(r,l),PI(n,h,r),function IG(n){const e=n.parts_.pop();n.byteLength_-=(0,P.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&a)throw new Error(n+' contains ".value" child '+Wg(r)+" in addition to actual children.")}},UV=function(n,e,t,r){if(r&&void 0===e)return;const i=(0,P.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const a=[];Li(e,(l,h)=>{const _=new An(l);if(PI(i,h,wr(t,_)),".priority"===aO(_)&&!OI(h))throw new Error(i+"contains an invalid value for '"+_.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(_)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const a=yI(r);for(let l=0;l<a.length;l++)if((".priority"!==a[l]||l!==a.length-1)&&!HS(a[l]))throw new Error(n+"contains an invalid key ("+a[l]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(vG);let i=null;for(t=0;t<e.length;t++){if(r=e[t],null!==i&&Ea(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,a)},qO=function(n,e,t){if(!t||void 0!==e){if(gS(e))throw new Error((0,P.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!OI(e))throw new Error((0,P.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},kI=function(n,e,t,r){if(!(r&&void 0===t||HS(t)))throw new Error((0,P.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},FI=function(n,e,t,r){if(!(r&&void 0===t||VV(t)))throw new Error((0,P.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},oz=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),FI(n,e,t,r)},Ia=function(n,e){if(".info"===rn(e))throw new Error(n+" failed = Can't modify data under /.info/")},BV=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!HS(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),VV(n)}(t))throw new Error((0,P.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class az{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function $S(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],a=i.getPath();null!==t&&!uO(a,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:a}),t.events.push(i)}t&&n.eventLists_.push(t)}function jV(n,e,t){$S(n,t),HV(n,r=>uO(r,e))}function jo(n,e,t){$S(n,t),HV(n,r=>Ea(r,e)||Ea(e,r))}function HV(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(uz(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function uz(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();zg&&Fi("event: "+t.toString()),sv(r)}}}const $V="repo_interrupt",lz=25;class cz{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new az,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=TS(),this.transactionQueueTree_=new HO,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function GV(n){const t=n.infoData_.getNode(new An(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function LI(n){return Y3({timestamp:GV(n)})}function zV(n,e,t,r,i){n.dataUpdateCount++;const a=new An(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let l=[];if(i)if(r){const _=(0,P.UI)(t,w=>xr(w));l=function G3(n,e,t,r){const i=kO(n,r);if(i){const a=FO(i),l=a.path,h=a.queryId,_=Gs(l,e),w=er.fromObject(t);return LO(n,l,new dv(IO(h),_,w))}return[]}(n.serverSyncTree_,a,_,i)}else{const _=xr(t);l=xV(n.serverSyncTree_,a,_,i)}else if(r){const _=(0,P.UI)(t,w=>xr(w));l=function j3(n,e,t){const r=er.fromObject(t);return fv(n,new dv({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,a,_)}else{const _=xr(t);l=MI(n.serverSyncTree_,a,_)}let h=a;l.length>0&&(h=gv(n,a)),jo(n.eventQueue_,h,l)}function qV(n,e){WO(n,"connected",e),!1===e&&function gz(n){pv(n,"onDisconnectEvents");const e=LI(n),t=TS();vO(n.onDisconnect_,yn(),(i,a)=>{const l=kV(i,a,n.serverSyncTree_,e);cv(t,i,l)});let r=[];vO(t,yn(),(i,a)=>{r=r.concat(MI(n.serverSyncTree_,i,a));const l=QO(n,i);gv(n,l)}),n.onDisconnect_=TS(),jo(n.eventQueue_,yn(),r)}(n)}function WO(n,e,t){const r=new An("/.info/"+e),i=xr(t);n.infoData_.updateSnapshot(r,i);const a=MI(n.infoSyncTree_,r,i);jo(n.eventQueue_,r,a)}function GS(n){return n.nextWriteId_++}function ZO(n,e,t,r,i){pv(n,"set",{path:e.toString(),value:t,priority:r});const a=LI(n),l=xr(t,r),h=VS(n.serverSyncTree_,e),_=BO(l,h,a),w=GS(n),D=OO(n.serverSyncTree_,e,_,w,!0);$S(n.eventQueue_,D),n.server_.put(e.toString(),l.val(!0),(O,H)=>{const z="ok"===O;z||Es("set at "+e+" failed: "+O);const ce=_f(n.serverSyncTree_,w,!z);jo(n.eventQueue_,e,ce),yf(0,i,O,H)});const A=QO(n,e);gv(n,A),jo(n.eventQueue_,A,[])}function mz(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&yO(n.onDisconnect_,e),yf(0,t,r,i)})}function WV(n,e,t,r){const i=xr(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(a,l)=>{"ok"===a&&cv(n.onDisconnect_,e,i),yf(0,r,a,l)})}function KO(n,e,t){let r;r=".info"===rn(e._path)?LS(n.infoSyncTree_,e,t):LS(n.serverSyncTree_,e,t),jV(n.eventQueue_,e._path,r)}function ZV(n){n.persistentConnection_&&n.persistentConnection_.interrupt($V)}function pv(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Fi(t,...e)}function yf(n,e,t,r){e&&sv(()=>{if("ok"===t)e(null);else{const i=(t||"error").toUpperCase();let a=i;r&&(a+=": "+r);const l=new Error(a);l.code=i,e(l)}})}function YO(n,e,t){return VS(n.serverSyncTree_,e,t)||Wt.EMPTY_NODE}function zS(n,e=n.transactionQueueTree_){if(e||qS(n,e),Xg(e)){const t=YV(n,e);(0,P.hu)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function Iz(n,e,t){const r=t.map(w=>w.currentWriteId),i=YO(n,e,r);let a=i;const l=i.hash();for(let w=0;w<t.length;w++){const D=t[w];(0,P.hu)(0===D.status,"tryToSendTransactionQueue_: items in queue should all be run."),D.status=1,D.retryCount++;const A=Gs(e,D.path);a=a.updateChild(A,D.currentOutputSnapshotRaw)}const h=a.val(!0),_=e;n.server_.put(_.toString(),h,w=>{pv(n,"transaction put response",{path:_.toString(),status:w});let D=[];if("ok"===w){const A=[];for(let O=0;O<t.length;O++)t[O].status=2,D=D.concat(_f(n.serverSyncTree_,t[O].currentWriteId)),t[O].onComplete&&A.push(()=>t[O].onComplete(null,!0,t[O].currentOutputSnapshotResolved)),t[O].unwatcher();qS(n,BS(n.transactionQueueTree_,e)),zS(n,n.transactionQueueTree_),jo(n.eventQueue_,e,D);for(let O=0;O<A.length;O++)sv(A[O])}else{if("datastale"===w)for(let A=0;A<t.length;A++)t[A].status=3===t[A].status?4:0;else{Es("transaction at "+_.toString()+" failed: "+w);for(let A=0;A<t.length;A++)t[A].status=4,t[A].abortReason=w}gv(n,e)}},l)}(n,NI(e),t)}else FV(e)&&jS(e,t=>{zS(n,t)})}function gv(n,e){const t=KV(n,e),r=NI(t);return function Cz(n,e,t){if(0===e.length)return;const r=[];let i=[];const l=e.filter(h=>0===h.status).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const _=e[h],w=Gs(t,_.path);let A,D=!1;if((0,P.hu)(null!==w,"rerunTransactionsUnderNode_: relativePath should not be null."),4===_.status)D=!0,A=_.abortReason,i=i.concat(_f(n.serverSyncTree_,_.currentWriteId,!0));else if(0===_.status)if(_.retryCount>=lz)D=!0,A="maxretry",i=i.concat(_f(n.serverSyncTree_,_.currentWriteId,!0));else{const O=YO(n,_.path,l);_.currentInputSnapshot=O;const H=e[h].update(O.val());if(void 0!==H){PI("transaction failed: Data returned ",H,_.path);let z=xr(H);"object"==typeof H&&null!=H&&(0,P.r3)(H,".priority")||(z=z.updatePriority(O.getPriority()));const Te=_.currentWriteId,ht=LI(n),yt=BO(z,O,ht);_.currentOutputSnapshotRaw=z,_.currentOutputSnapshotResolved=yt,_.currentWriteId=GS(n),l.splice(l.indexOf(Te),1),i=i.concat(OO(n.serverSyncTree_,_.path,yt,_.currentWriteId,_.applyLocally)),i=i.concat(_f(n.serverSyncTree_,Te,!0))}else D=!0,A="nodata",i=i.concat(_f(n.serverSyncTree_,_.currentWriteId,!0))}jo(n.eventQueue_,t,i),i=[],D&&(e[h].status=2,setTimeout(e[h].unwatcher,Math.floor(0)),e[h].onComplete&&r.push("nodata"===A?()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot):()=>e[h].onComplete(new Error(A),!1,null)))}qS(n,n.transactionQueueTree_);for(let h=0;h<r.length;h++)sv(r[h]);zS(n,n.transactionQueueTree_)}(n,YV(n,t),r),r}function KV(n,e){let t,r=n.transactionQueueTree_;for(t=rn(e);null!==t&&void 0===Xg(r);)r=BS(r,t),t=rn(e=Gn(e));return r}function YV(n,e){const t=[];return QV(n,e,t),t.sort((r,i)=>r.order-i.order),t}function QV(n,e,t){const r=Xg(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);jS(e,i=>{QV(n,i,t)})}function qS(n,e){const t=Xg(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,$O(e,t.length>0?t:void 0)}jS(e,r=>{qS(n,r)})}function QO(n,e){const t=NI(KV(n,e)),r=BS(n.transactionQueueTree_,e);return function ez(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{XO(n,i)}),XO(n,r),LV(r,i=>{XO(n,i)}),t}function XO(n,e){const t=Xg(e);if(t){const r=[];let i=[],a=-1;for(let l=0;l<t.length;l++)3===t[l].status||(1===t[l].status?((0,P.hu)(a===l-1,"All SENT items should be at beginning of queue."),a=l,t[l].status=3,t[l].abortReason="set"):((0,P.hu)(0===t[l].status,"Unexpected transaction status in abort"),t[l].unwatcher(),i=i.concat(_f(n.serverSyncTree_,t[l].currentWriteId,!0)),t[l].onComplete&&r.push(t[l].onComplete.bind(null,new Error("set"),!1,null))));-1===a?$O(e,void 0):t.length=a+1,jo(n.eventQueue_,NI(e),i);for(let l=0;l<r.length;l++)sv(r[l])}}const JO=function(n,e){const t=Tz(n),r=t.namespace;return"firebase.com"===t.domain&&Ml(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&Ml("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Es("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new tO(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new An(t.pathString)}},Tz=function(n){let e="",t="",r="",i="",a="",l=!0,h="https",_=443;if("string"==typeof n){let w=n.indexOf("//");w>=0&&(h=n.substring(0,w-1),n=n.substring(w+2));let D=n.indexOf("/");-1===D&&(D=n.length);let A=n.indexOf("?");-1===A&&(A=n.length),e=n.substring(0,Math.min(D,A)),D<A&&(i=function bz(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(n.substring(D,A)));const O=function Dz(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Es(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,A)));w=e.indexOf(":"),w>=0?(l="https"===h||"wss"===h,_=parseInt(e.substring(w+1),10)):w=e.length;const H=e.slice(0,w);if("localhost"===H.toLowerCase())t="localhost";else if(H.split(".").length<=2)t=H;else{const z=e.indexOf(".");r=e.substring(0,z).toLowerCase(),t=e.substring(z+1),a=r}"ns"in O&&(a=O.ns)}return{host:e,port:_,domain:t,subdomain:r,secure:l,scheme:h,pathString:i,namespace:a}},XV="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Sz=function(){let n=0;const e=[];return function(t){const r=t===n;let i;n=t;const a=new Array(8);for(i=7;i>=0;i--)a[i]=XV.charAt(t%64),t=Math.floor(t/64);(0,P.hu)(0===t,"Cannot push at time == 0");let l=a.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)l+=XV.charAt(e[i]);return(0,P.hu)(20===l.length,"nextPushId: Length should be 20."),l}}();class JV{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,P.Wl)(this.snapshot.exportVal())}}class eU{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class eP{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,P.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class tU{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new P.BH;return mz(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Ia("OnDisconnect.remove",this._path);const e=new P.BH;return WV(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Ia("OnDisconnect.set",this._path),Nl("OnDisconnect.set",e,this._path,!1);const t=new P.BH;return WV(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Ia("OnDisconnect.setWithPriority",this._path),Nl("OnDisconnect.setWithPriority",e,this._path,!1),qO("OnDisconnect.setWithPriority",t,!1);const r=new P.BH;return function _z(n,e,t,r,i){const a=xr(t,r);n.server_.onDisconnectPut(e.toString(),a.val(!0),(l,h)=>{"ok"===l&&cv(n.onDisconnect_,e,a),yf(0,i,l,h)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Ia("OnDisconnect.update",this._path),UV("OnDisconnect.update",e,this._path,!1);const t=new P.BH;return function yz(n,e,t,r){if((0,P.xb)(t))return Fi("onDisconnect().update() called with empty data.  Don't do anything."),void yf(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(i,a)=>{"ok"===i&&Li(t,(l,h)=>{const _=xr(h);cv(n.onDisconnect_,wr(e,l),_)}),yf(0,r,i,a)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class ho{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return sn(this._path)?null:aO(this._path)}get ref(){return new Ca(this._repo,this._path)}get _queryIdentifier(){const e=sV(this._queryParams),t=JN(e);return"{}"===t?"default":t}get _queryObject(){return sV(this._queryParams)}isEqual(e){if(!((e=(0,P.m9)(e))instanceof ho))return!1;const t=this._repo===e._repo,r=uO(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function yG(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function WS(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function vf(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===xl){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==cf)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==ld)throw new Error(r);if("string"!=typeof t)throw new Error(i)}}else if(n.getIndex()===Jn){if(null!=e&&!OI(e)||null!=t&&!OI(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,P.hu)(n.getIndex()instanceof fO||n.getIndex()===pO,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function ZS(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Ca extends ho{constructor(e,t){super(e,t,new CS,!1)}get parent(){const e=WL(this._path);return null===e?null:new Ca(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Jg{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new An(e),r=em(this.ref,e);return new Jg(this._node.getChild(t),r,Jn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new Jg(i,em(this.ref,r),Jn)))}hasChild(e){const t=new An(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function nU(n,e){return(n=(0,P.m9)(n))._checkNotDeleted("ref"),void 0!==e?em(n._root,e):n._root}function rU(n,e){(n=(0,P.m9)(n))._checkNotDeleted("refFromURL");const t=JO(e,n._repo.repoInfo_.nodeAdmin);BV("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Ml("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),nU(n,t.path.toString())}function em(n,e){return null===rn((n=(0,P.m9)(n))._path)?oz("child","path",e,!1):FI("child","path",e,!1),new Ca(n._repo,wr(n._path,e))}function tP(n,e){n=(0,P.m9)(n),Ia("set",n._path),Nl("set",e,n._path,!1);const t=new P.BH;return ZO(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function Nz(n,e){UV("update",e,n._path,!1);const t=new P.BH;return function pz(n,e,t,r){pv(n,"update",{path:e.toString(),value:t});let i=!0;const a=LI(n),l={};if(Li(t,(h,_)=>{i=!1,l[h]=kV(wr(e,h),xr(_),n.serverSyncTree_,a)}),i)Fi("update() called with empty data.  Don't do anything."),yf(0,r,"ok",void 0);else{const h=GS(n),_=function B3(n,e,t,r){!function r3(n,e,t,r){(0,P.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=bO(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const i=er.fromObject(t);return fv(n,new dv({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,e,l,h);$S(n.eventQueue_,_),n.server_.merge(e.toString(),t,(w,D)=>{const A="ok"===w;A||Es("update at "+e+" failed: "+w);const O=_f(n.serverSyncTree_,h,!A),H=O.length>0?gv(n,e):e;jo(n.eventQueue_,H,O),yf(0,r,w,D)}),Li(t,w=>{const D=QO(n,wr(e,w));gv(n,D)}),jo(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function Oz(n){n=(0,P.m9)(n);const e=new eP(()=>{}),t=new VI(e);return function fz(n,e,t){const r=function z3(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(w,D)=>{const A=Gs(w,t);r=r||gf(D,A)});let i=n.syncPointTree_.get(t);i?r=r||gf(i,yn()):(i=new bV,n.syncPointTree_=n.syncPointTree_.set(t,i));const a=null!=r,l=a?new ff(r,!0,!1):null;return function A3(n){return MS(n.viewCache_)}(DV(i,e,xS(n.pendingWriteTree_,e._path),a?l.getNode():Wt.EMPTY_NODE,a))}(n.serverSyncTree_,e);return null!=r?Promise.resolve(r):n.server_.get(e).then(i=>{const a=xr(i).withIndex(e._queryParams.getIndex());let l;if(PO(n.serverSyncTree_,e,t,!0),e._queryParams.loadsAllData())l=MI(n.serverSyncTree_,e._path,a);else{const h=xI(n.serverSyncTree_,e);l=xV(n.serverSyncTree_,e._path,a,h)}return jo(n.eventQueue_,e._path,l),LS(n.serverSyncTree_,e,t,null,!0),a},i=>(pv(n,"get for query "+(0,P.Wl)(e)+" failed: "+i),Promise.reject(new Error(i))))}(n._repo,n,t).then(r=>new Jg(r,new Ca(n._repo,n._path),n._queryParams.getIndex()))}class VI{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new JV("value",this,new Jg(e.snapshotNode,new Ca(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new eU(this,e,t):null}matches(e){return e instanceof VI&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class KS{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new eU(this,e,t):null}createEvent(e,t){(0,P.hu)(null!=e.childName,"Child events should have a childName.");const r=em(new Ca(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new JV(e.type,this,new Jg(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof KS&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function UI(n,e,t,r,i){let a;if("object"==typeof r&&(a=void 0,i=r),"function"==typeof r&&(a=r),i&&i.onlyOnce){const _=t,w=(D,A)=>{KO(n._repo,n,h),_(D,A)};w.userCallback=t.userCallback,w.context=t.context,t=w}const l=new eP(t,a||void 0),h="value"===e?new VI(l):new KS(e,l);return function vz(n,e,t){let r;r=".info"===rn(e._path)?PO(n.infoSyncTree_,e,t):PO(n.serverSyncTree_,e,t),jV(n.eventQueue_,e._path,r)}(n._repo,n,h),()=>KO(n._repo,n,h)}function nP(n,e,t,r){return UI(n,"value",e,t,r)}function iU(n,e,t,r){return UI(n,"child_added",e,t,r)}function sU(n,e,t,r){return UI(n,"child_changed",e,t,r)}function oU(n,e,t,r){return UI(n,"child_moved",e,t,r)}function aU(n,e,t,r){return UI(n,"child_removed",e,t,r)}function uU(n,e,t){let r=null;const i=t?new eP(t):null;"value"===e?r=new VI(i):e&&(r=new KS(e,i)),KO(n._repo,n,r)}class gu{}class lU extends gu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Nl("endAt",this._value,e._path,!0);const t=_O(e._queryParams,this._value,this._key);if(ZS(t),vf(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ho(e._repo,e._path,t,e._orderByCalled)}}class kz extends gu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Nl("endBefore",this._value,e._path,!1);const t=function GG(n,e,t){let r;return r=_O(n,e,n.index_===xl||t?t:cf),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(ZS(t),vf(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ho(e._repo,e._path,t,e._orderByCalled)}}class cU extends gu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Nl("startAt",this._value,e._path,!0);const t=mO(e._queryParams,this._value,this._key);if(ZS(t),vf(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new ho(e._repo,e._path,t,e._orderByCalled)}}class Vz extends gu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Nl("startAfter",this._value,e._path,!1);const t=function $G(n,e,t){let r;return r=mO(n,e,n.index_===xl||t?t:ld),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(ZS(t),vf(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new ho(e._repo,e._path,t,e._orderByCalled)}}class Bz extends gu{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new ho(e._repo,e._path,function jG(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class Hz extends gu{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new ho(e._repo,e._path,function HG(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class Gz extends gu{constructor(e){super(),this._path=e}_apply(e){WS(e,"orderByChild");const t=new An(this._path);if(sn(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new fO(t),i=bS(e._queryParams,r);return vf(i),new ho(e._repo,e._path,i,!0)}}class qz extends gu{_apply(e){WS(e,"orderByKey");const t=bS(e._queryParams,xl);return vf(t),new ho(e._repo,e._path,t,!0)}}class Zz extends gu{_apply(e){WS(e,"orderByPriority");const t=bS(e._queryParams,Jn);return vf(t),new ho(e._repo,e._path,t,!0)}}class Yz extends gu{_apply(e){WS(e,"orderByValue");const t=bS(e._queryParams,pO);return vf(t),new ho(e._repo,e._path,t,!0)}}class Xz extends gu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(Nl("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new lU(this._value,this._key)._apply(new cU(this._value,this._key)._apply(e))}}function mu(n,...e){let t=(0,P.m9)(n);for(const r of e)t=r._apply(t);return t}(function N3(n){(0,P.hu)(!PS,"__referenceConstructor has already been defined"),PS=n})(Ca),function L3(n){(0,P.hu)(!FS,"__referenceConstructor has already been defined"),FS=n}(Ca);const rP={};function hU(n,e,t,r,i){let a=r||n.options.databaseURL;void 0===a&&(n.options.projectId||Ml("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Fi("Using default host for project ",n.options.projectId),a=`${n.options.projectId}-default-rtdb.firebaseio.com`);let _,w,l=JO(a,i),h=l.repoInfo;typeof process<"u"&&process.env&&(w=process.env.FIREBASE_DATABASE_EMULATOR_HOST),w?(_=!0,a=`http://${w}?ns=${h.namespace}`,l=JO(a,i),h=l.repoInfo):_=!l.repoInfo.secure;const D=i&&_?new _I(_I.OWNER):new W$(n.name,n.options,e);BV("Invalid Firebase Database URL",l),sn(l.path)||Ml("Database URL must point to the root of a Firebase Database (not including a child path).");const A=function rq(n,e,t,r){let i=rP[e.name];i||(i={},rP[e.name]=i);let a=i[n.toURLString()];return a&&Ml("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new cz(n,false,t,r),i[n.toURLString()]=a,a}(h,n,D,new q$(n.name,t));return new sq(A,n)}class sq{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function dz(n,e,t){if(n.stats_=iO(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new DS(n.repoInfo_,(r,i,a,l)=>{zV(n,r,i,a,l)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>qV(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,P.Wl)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Zg(n.repoInfo_,e,(r,i,a,l)=>{zV(n,r,i,a,l)},r=>{qV(n,r)},r=>{!function hz(n,e){Li(e,(t,r)=>{WO(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function Y$(n,e){const t=n.toString();return rO[t]||(rO[t]=e()),rO[t]}(n.repoInfo_,()=>new YG(n.stats_,n.server_)),n.infoData_=new zG,n.infoSyncTree_=new MV({startListening:(r,i,a,l)=>{let h=[];const _=n.infoData_.getNode(r._path);return _.isEmpty()||(h=MI(n.infoSyncTree_,r._path,_),setTimeout(()=>{l("ok")},0)),h},stopListening:()=>{}}),WO(n,"connected",!1),n.serverSyncTree_=new MV({startListening:(r,i,a,l)=>(n.server_.listen(r,a,i,(h,_)=>{const w=l(h,_);jo(n.eventQueue_,r._path,w)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ca(this._repo,yn())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function nq(n,e){const t=rP[e];(!t||t[n.key]!==n)&&Ml(`Database ${e}(${n.repoInfo_}) has already been deleted.`),ZV(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Ml("Cannot call "+e+" on a deleted database.")}}function fU(){kL.IS_TRANSPORT_INITIALIZED&&Es("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function oq(){fU(),df.forceDisallow()}function aq(){fU(),ov.forceDisallow(),df.forceAllow()}function cq(n,e){gL(n,e)}const hq={".sv":"timestamp"};class gq{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}Zg.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},Zg.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function dq(n){cL(gs.SDK_VERSION),(0,gs._registerComponent)(new ko.wA("database",(e,{instanceIdentifier:t})=>hU(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,gs.registerVersion)(uL,"0.14.1",n),(0,gs.registerVersion)(uL,"0.14.1","esm2017")}();const vq=new Ls.Yd("@firebase/database-compat"),gU=function(n){vq.warn("FIREBASE WARNING: "+n)};class Iq{constructor(e){this._delegate=e}cancel(e){(0,P.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,P.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,P.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,P.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,P.Dv)("OnDisconnect.set",1,2,arguments.length),(0,P.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,P.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,P.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),a=>r(a)),i}update(e,t){if((0,P.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,gU("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,P.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}class Cq{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,P.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class wf{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,P.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,P.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,P.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,P.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,P.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),FI("DataSnapshot.child","path",e,!1),new wf(this._database,this._delegate.child(e))}hasChild(e){return(0,P.Dv)("DataSnapshot.hasChild",1,1,arguments.length),FI("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,P.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,P.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,P.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new wf(this._database,t)))}hasChildren(){return(0,P.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,P.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,P.Dv)("DataSnapshot.ref",0,0,arguments.length),new Ho(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class ts{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var a;(0,P.Dv)("Query.on",2,4,arguments.length),(0,P.Wj)("Query.on","callback",t,!1);const l=ts.getCancelAndContextArgs_("Query.on",r,i),h=(w,D)=>{t.call(l.context,new wf(this.database,w),D)};h.userCallback=t,h.context=l.context;const _=null===(a=l.cancel)||void 0===a?void 0:a.bind(l.context);switch(e){case"value":return nP(this._delegate,h,_),t;case"child_added":return iU(this._delegate,h,_),t;case"child_removed":return aU(this._delegate,h,_),t;case"child_changed":return sU(this._delegate,h,_),t;case"child_moved":return oU(this._delegate,h,_),t;default:throw new Error((0,P.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,P.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,P.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,P.Wj)("Query.off","callback",t,!0),(0,P.lb)("Query.off","context",r,!0),t){const i=()=>{};i.userCallback=t,i.context=r,uU(this._delegate,e,i)}else uU(this._delegate,e)}get(){return Oz(this._delegate).then(e=>new wf(this.database,e))}once(e,t,r,i){(0,P.Dv)("Query.once",1,4,arguments.length),(0,P.Wj)("Query.once","callback",t,!0);const a=ts.getCancelAndContextArgs_("Query.once",r,i),l=new P.BH,h=(w,D)=>{const A=new wf(this.database,w);t&&t.call(a.context,A,D),l.resolve(A)};h.userCallback=t,h.context=a.context;const _=w=>{a.cancel&&a.cancel.call(a.context,w),l.reject(w)};switch(e){case"value":nP(this._delegate,h,_,{onlyOnce:!0});break;case"child_added":iU(this._delegate,h,_,{onlyOnce:!0});break;case"child_removed":aU(this._delegate,h,_,{onlyOnce:!0});break;case"child_changed":sU(this._delegate,h,_,{onlyOnce:!0});break;case"child_moved":oU(this._delegate,h,_,{onlyOnce:!0});break;default:throw new Error((0,P.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return l.promise}limitToFirst(e){return(0,P.Dv)("Query.limitToFirst",1,1,arguments.length),new ts(this.database,mu(this._delegate,function jz(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Bz(n)}(e)))}limitToLast(e){return(0,P.Dv)("Query.limitToLast",1,1,arguments.length),new ts(this.database,mu(this._delegate,function $z(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Hz(n)}(e)))}orderByChild(e){return(0,P.Dv)("Query.orderByChild",1,1,arguments.length),new ts(this.database,mu(this._delegate,function zz(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return FI("orderByChild","path",n,!1),new Gz(n)}(e)))}orderByKey(){return(0,P.Dv)("Query.orderByKey",0,0,arguments.length),new ts(this.database,mu(this._delegate,function Wz(){return new qz}()))}orderByPriority(){return(0,P.Dv)("Query.orderByPriority",0,0,arguments.length),new ts(this.database,mu(this._delegate,function Kz(){return new Zz}()))}orderByValue(){return(0,P.Dv)("Query.orderByValue",0,0,arguments.length),new ts(this.database,mu(this._delegate,function Qz(){return new Yz}()))}startAt(e=null,t){return(0,P.Dv)("Query.startAt",0,2,arguments.length),new ts(this.database,mu(this._delegate,function Lz(n=null,e){return kI("startAt","key",e,!0),new cU(n,e)}(e,t)))}startAfter(e=null,t){return(0,P.Dv)("Query.startAfter",0,2,arguments.length),new ts(this.database,mu(this._delegate,function Uz(n,e){return kI("startAfter","key",e,!0),new Vz(n,e)}(e,t)))}endAt(e=null,t){return(0,P.Dv)("Query.endAt",0,2,arguments.length),new ts(this.database,mu(this._delegate,function Pz(n,e){return kI("endAt","key",e,!0),new lU(n,e)}(e,t)))}endBefore(e=null,t){return(0,P.Dv)("Query.endBefore",0,2,arguments.length),new ts(this.database,mu(this._delegate,function Fz(n,e){return kI("endBefore","key",e,!0),new kz(n,e)}(e,t)))}equalTo(e,t){return(0,P.Dv)("Query.equalTo",1,2,arguments.length),new ts(this.database,mu(this._delegate,function Jz(n,e){return kI("equalTo","key",e,!0),new Xz(n,e)}(e,t)))}toString(){return(0,P.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,P.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,P.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof ts))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,(0,P.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,P.lb)(e,"context",i.context,!0);else if(t)if("object"==typeof t&&null!==t)i.context=t;else{if("function"!=typeof t)throw new Error((0,P.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=t}return i}get ref(){return new Ho(this.database,new Ca(this._delegate._repo,this._delegate._path))}}class Ho extends ts{constructor(e,t){super(e,new ho(t._repo,t._path,new CS,!1)),this.database=e,this._delegate=t}getKey(){return(0,P.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,P.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new Ho(this.database,em(this._delegate,e))}getParent(){(0,P.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Ho(this.database,e):null}getRoot(){return(0,P.Dv)("Reference.root",0,0,arguments.length),new Ho(this.database,this._delegate.root)}set(e,t){(0,P.Dv)("Reference.set",1,2,arguments.length),(0,P.Wj)("Reference.set","onComplete",t,!0);const r=tP(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if((0,P.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,gU("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ia("Reference.update",this._delegate._path),(0,P.Wj)("Reference.update","onComplete",t,!0);const r=Nz(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,P.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,P.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function Rz(n,e,t){if(Ia("setWithPriority",n._path),Nl("setWithPriority",e,n._path,!1),qO("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new P.BH;return ZO(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&i.then(()=>r(null),a=>r(a)),i}remove(e){(0,P.Dv)("Reference.remove",0,1,arguments.length),(0,P.Wj)("Reference.remove","onComplete",e,!0);const t=function Mz(n){return Ia("remove",n._path),tP(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,P.Dv)("Reference.transaction",1,3,arguments.length),(0,P.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,P.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,P.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function mq(n,e,t){var r;if(n=(0,P.m9)(n),Ia("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const i=null===(r=t?.applyLocally)||void 0===r||r,a=new P.BH,h=nP(n,()=>{});return function Ez(n,e,t,r,i,a){pv(n,"transaction on "+e);const l={path:e,update:t,onComplete:r,status:null,order:hL(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=YO(n,e,void 0);l.currentInputSnapshot=h;const _=l.update(h.val());if(void 0===_)l.unwatcher(),l.currentOutputSnapshotRaw=null,l.currentOutputSnapshotResolved=null,l.onComplete&&l.onComplete(null,!1,l.currentInputSnapshot);else{PI("transaction failed: Data returned ",_,l.path),l.status=0;const w=BS(n.transactionQueueTree_,e),D=Xg(w)||[];let A;D.push(l),$O(w,D),"object"==typeof _&&null!==_&&(0,P.r3)(_,".priority")?(A=(0,P.DV)(_,".priority"),(0,P.hu)(OI(A),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):A=(VS(n.serverSyncTree_,e)||Wt.EMPTY_NODE).getPriority().val();const O=LI(n),H=xr(_,A),z=BO(H,h,O);l.currentOutputSnapshotRaw=H,l.currentOutputSnapshotResolved=z,l.currentWriteId=GS(n);const ce=OO(n.serverSyncTree_,e,z,l.currentWriteId,l.applyLocally);jo(n.eventQueue_,e,ce),zS(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(_,w,D)=>{let A=null;_?a.reject(_):(A=new Jg(D,new Ca(n._repo,n._path),Jn),a.resolve(new gq(w,A)))},h,i),a.promise}(this._delegate,e,{applyLocally:r}).then(a=>new Cq(a.committed,new wf(this.database,a.snapshot)));return t&&i.then(a=>t(null,a.committed,a.snapshot),a=>t(a,!1,null)),i}setPriority(e,t){(0,P.Dv)("Reference.setPriority",1,2,arguments.length),(0,P.Wj)("Reference.setPriority","onComplete",t,!0);const r=function xz(n,e){n=(0,P.m9)(n),Ia("setPriority",n._path),qO("setPriority",e,!1);const t=new P.BH;return ZO(n._repo,wr(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){(0,P.Dv)("Reference.push",0,2,arguments.length),(0,P.Wj)("Reference.push","onComplete",t,!0);const r=function Az(n,e){n=(0,P.m9)(n),Ia("push",n._path),Nl("push",e,n._path,!0);const t=GV(n._repo),r=Sz(t),i=em(n,r),a=em(n,r);let l;return l=null!=e?tP(a,e).then(()=>a):Promise.resolve(a),i.then=l.then.bind(l),i.catch=l.then.bind(l,void 0),i}(this._delegate,e),i=r.then(l=>new Ho(this.database,l));t&&i.then(()=>t(null),l=>t(l));const a=new Ho(this.database,r);return a.then=i.then.bind(i),a.catch=i.catch.bind(i,void 0),a}onDisconnect(){return Ia("Reference.onDisconnect",this._delegate._path),new Iq(new tU(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class BI{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:oq,forceLongPolling:aq}}useEmulator(e,t,r={}){!function pU(n,e,t,r={}){(n=(0,P.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Ml("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let a;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Ml('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new _I(_I.OWNER);else if(r.mockUserToken){const l="string"==typeof r.mockUserToken?r.mockUserToken:(0,P.Sg)(r.mockUserToken,n.app.options.projectId);a=new _I(l)}!function tq(n,e,t,r){n.repoInfo_=new tO(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams),r&&(n.authTokenProvider_=r)}(i,e,t,a)}(this._delegate,e,t,r)}ref(e){if((0,P.Dv)("database.ref",0,1,arguments.length),e instanceof Ho){const t=rU(this._delegate,e.toString());return new Ho(this,t)}{const t=nU(this._delegate,e);return new Ho(this,t)}}refFromURL(e){(0,P.Dv)("database.refFromURL",1,1,arguments.length);const r=rU(this._delegate,e);return new Ho(this,r)}goOffline(){return(0,P.Dv)("database.goOffline",0,0,arguments.length),function uq(n){(n=(0,P.m9)(n))._checkNotDeleted("goOffline"),ZV(n._repo)}(this._delegate)}goOnline(){return(0,P.Dv)("database.goOnline",0,0,arguments.length),function lq(n){(n=(0,P.m9)(n))._checkNotDeleted("goOnline"),function wz(n){n.persistentConnection_&&n.persistentConnection_.resume($V)}(n._repo)}(this._delegate)}}BI.ServerValue={TIMESTAMP:function fq(){return hq}(),increment:n=>function pq(n){return{".sv":{increment:n}}}(n)};var Dq=Object.freeze({__proto__:null,initStandalone:function bq({app:n,url:e,version:t,customAuthImpl:r,namespace:i,nodeAdmin:a=!1}){cL(t);const l=new ko.zt("auth-internal",new ko.H0("database-standalone"));return l.setComponent(new ko.wA("auth-internal",()=>r,"PRIVATE")),{instance:new BI(hU(n,l,void 0,e,a),n),namespace:i}}});const Tq=BI.ServerValue;function mU(n){return null==n}function _U(n){return"function"==typeof n.set}function yU(n,e){return _U(e)?e:n.ref(e)}function vU(n,e){if(function Aq(n){return"string"==typeof n}(n))return e.stringCase();if(_U(n))return e.firebaseCase();if(function Mq(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function jI(n,e,t="on",r=n0.z){return new Jr.y(i=>{let a=null;return a=n[t](e,(l,h)=>{r.schedule(()=>{i.next({snapshot:l,prevKey:h})}),"once"===t&&r.schedule(()=>i.complete())},l=>{r.schedule(()=>i.error(l))}),"on"===t?{unsubscribe(){null!=a&&n.off(e,a)}}:{unsubscribe(){}}}).pipe((0,Tt.U)(i=>{const{snapshot:a,prevKey:l}=i;let h=null;return a.exists()&&(h=a.key),{type:e,payload:a,prevKey:l,key:h}}),(0,NA.B)())}function wU(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function Nq(n,e){const{payload:t,prevKey:r,key:i}=e,a=wU(n,i),l=function Rq(n,e){if(mU(e))return 0;{const t=wU(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let h=null;e.payload.forEach(_=>{const w={payload:_,type:"value",prevKey:h,key:_.key};return h=_.key,n=[...n,w],!1})}return n;case"child_added":if(a>-1){const h=n[a-1];(h&&h.key||null)!==r&&(n=n.filter(_=>_.payload.key!==t.key)).splice(l,0,e)}else{if(null==r)return[e,...n];(n=n.slice()).splice(l,0,e)}return n;case"child_removed":return n.filter(h=>h.payload.key!==t.key);case"child_changed":return n.map(h=>h.payload.key===i?e:h);case"child_moved":if(a>-1){const h=n.splice(a,1)[0];return(n=n.slice()).splice(l,0,h),n}return n;default:return n}}function EU(n){return(mU(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function IU(n,e,t){return function xq(n,e,t){return jI(n,"value","once",t).pipe((0,Tn.w)(r=>{const i=[(0,ct.of)(r)];return e.forEach(a=>i.push(jI(n,a,"on",t))),(0,vC.T)(...i).pipe(ks(Nq,[]))}),(0,s0.x)())}(n,e=EU(e),t)}function CU(n,e,t){const r=(e=EU(e)).map(i=>jI(n,i,"on",t));return(0,vC.T)(...r)}function bU(n,e){return function(r,i){return vU(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function Fq(n){return function(t){return t?vU(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function DU(n,e){return function(){return jI(n,"value","on",e)}}!function Sq(n){n.INTERNAL.registerComponent(new ko.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new BI(i,r)},"PUBLIC").setServiceProps({Reference:Ho,Query:ts,Database:BI,DataSnapshot:wf,enableLogging:cq,INTERNAL:Dq,ServerValue:Tq}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","0.3.1")}(F_.Z);const Uq=new f.OlP("angularfire2.realtimeDatabaseURL"),Bq=new f.OlP("angularfire2.database.use-emulator");let jq=(()=>{class n{constructor(t,r,i,a,l,h,_,w,D,A,O,H,z,ce,Te){this.schedulers=h;const ht=_,yt=(0,Dr.on)(t,l,r);w&&w_(yt,l,D,O,H,z,A,ce),this.database=(0,Dr.cc)(`${yt.name}.database.${i}`,"AngularFireDatabase",yt.name,()=>{const nt=l.runOutsideAngular(()=>yt.database(i||void 0));return ht&&nt.useEmulator(...ht),nt},[ht])}list(t,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>yU(this.database,t));let a=i;return r&&(a=r(i)),function Lq(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:bU(r,"update"),set:bU(r,"set"),push:i=>r.push(i),remove:Fq(r),snapshotChanges:i=>IU(n,i,t).pipe(dn.iC),stateChanges:i=>CU(n,i,t).pipe(dn.iC),auditTrail:i=>function Oq(n,e,t){return function kq(n,e,t){return function Pq(n,e){return jI(n,"value","on",e).pipe((0,Tt.U)(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function N$(...n){const e=(0,kr.jO)(n);return(0,dt.e)((t,r)=>{const i=n.length,a=new Array(i);let l=n.map(()=>!1),h=!1;for(let _=0;_<i;_++)(0,ne.Xf)(n[_]).subscribe((0,Fr.x)(r,w=>{a[_]=w,!h&&!l[_]&&(l[_]=!0,(h=l.every(Os.y))&&(l=null))},R$.Z));t.subscribe((0,Fr.x)(r,_=>{if(h){const w=[_,...a];r.next(e?e(...w):w)}}))})}(e),(0,Tt.U)(([i,a])=>{const l=i.lastKeyToLoad,h=a.map(_=>_.key);return{actions:a,lastKeyToLoad:l,loadedKeys:h}}),function O$(n){return(0,dt.e)((e,t)=>{let r=!1,i=0;e.subscribe((0,Fr.x)(t,a=>(r||(r=!n(a,i++)))&&t.next(a)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),(0,Tt.U)(i=>i.actions))}(n,CU(n,e).pipe(ks((i,a)=>[...i,a],[])),t)}(n,i,t).pipe(dn.iC),valueChanges:(i,a)=>IU(n,i,t).pipe((0,Tt.U)(h=>h.map(_=>a&&a.idField?Object.assign(Object.assign({},_.payload.val()),{[a.idField]:_.key}):_.payload.val())),dn.iC)}}(a,this)}object(t){return function Vq(n,e){return{query:n,snapshotChanges:()=>DU(n,e.schedulers.outsideAngular)().pipe(dn.iC),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>DU(n,e.schedulers.outsideAngular)().pipe(dn.iC,(0,Tt.U)(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>yU(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Dr.Dh),f.LFG(Dr.xv,8),f.LFG(Uq,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(dn.HU),f.LFG(Bq,8),f.LFG(wc,8),f.LFG(Ew,8),f.LFG(io,8),f.LFG(Ep,8),f.LFG(Iw,8),f.LFG(v_,8),f.LFG(Cw,8),f.LFG(wp,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),Hq=(()=>{class n{constructor(){y_.Z.registerVersion("angularfire",dn.q4.full,"rtdb-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[jq]}),n})();const $q_firebase={apiKey:"AIzaSyBTbyxtONEqwcJkCV2TVzyyaZLkQrGIf3U",authDomain:"js3-projet.firebaseapp.com",projectId:"js3-projet",storageBucket:"js3-projet.appspot.com",messagingSenderId:"373009894162",appId:"1:373009894162:web:2e4c8d25e5520a256101cb",measurementId:"G-B6H53MH4F9"};let Gq=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n,bootstrap:[Bj]}),n.\u0275inj=f.cJS({imports:[Fu,Vj,Fb,Dr.hO.initializeApp($q_firebase),E_,x$,bj,Hq]}),n})();us().bootstrapModule(Gq).catch(n=>console.error(n))},5619:(lt,Ee,k)=>{k.d(Ee,{X:()=>Q});var f=k(8645);class Q extends f.x{constructor(ee){super(),this._value=ee}get value(){return this.getValue()}_subscribe(ee){const te=super._subscribe(ee);return!te.closed&&ee.next(this._value),te}getValue(){const{hasError:ee,thrownError:te,_value:he}=this;if(ee)throw te;return this._throwIfClosed(),he}next(ee){super.next(this._value=ee)}}},5592:(lt,Ee,k)=>{k.d(Ee,{y:()=>Ce});var f=k(305),Q=k(7394),F=k(4850),ee=k(8407),te=k(2653),he=k(4674),fe=k(1441);let Ce=(()=>{class X{constructor(Se){Se&&(this._subscribe=Se)}lift(Se){const $e=new X;return $e.source=this,$e.operator=Se,$e}subscribe(Se,$e,Ne){const He=function G(X){return X&&X instanceof f.Lv||function U(X){return X&&(0,he.m)(X.next)&&(0,he.m)(X.error)&&(0,he.m)(X.complete)}(X)&&(0,Q.Nn)(X)}(Se)?Se:new f.Hp(Se,$e,Ne);return(0,fe.x)(()=>{const{operator:xe,source:tt}=this;He.add(xe?xe.call(He,tt):tt?this._subscribe(He):this._trySubscribe(He))}),He}_trySubscribe(Se){try{return this._subscribe(Se)}catch($e){Se.error($e)}}forEach(Se,$e){return new($e=ae($e))((Ne,He)=>{const xe=new f.Hp({next:tt=>{try{Se(tt)}catch(ut){He(ut),xe.unsubscribe()}},error:He,complete:Ne});this.subscribe(xe)})}_subscribe(Se){var $e;return null===($e=this.source)||void 0===$e?void 0:$e.subscribe(Se)}[F.L](){return this}pipe(...Se){return(0,ee.U)(Se)(this)}toPromise(Se){return new(Se=ae(Se))(($e,Ne)=>{let He;this.subscribe(xe=>He=xe,xe=>Ne(xe),()=>$e(He))})}}return X.create=Fe=>new X(Fe),X})();function ae(X){var Fe;return null!==(Fe=X??te.config.Promise)&&void 0!==Fe?Fe:Promise}},8645:(lt,Ee,k)=>{k.d(Ee,{x:()=>fe});var f=k(5592),Q=k(7394);const ee=(0,k(2306).d)(ae=>function(){ae(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var te=k(9039),he=k(1441);let fe=(()=>{class ae extends f.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(G){const X=new Ce(this,this);return X.operator=G,X}_throwIfClosed(){if(this.closed)throw new ee}next(G){(0,he.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const X of this.currentObservers)X.next(G)}})}error(G){(0,he.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=G;const{observers:X}=this;for(;X.length;)X.shift().error(G)}})}complete(){(0,he.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:G}=this;for(;G.length;)G.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var G;return(null===(G=this.observers)||void 0===G?void 0:G.length)>0}_trySubscribe(G){return this._throwIfClosed(),super._trySubscribe(G)}_subscribe(G){return this._throwIfClosed(),this._checkFinalizedStatuses(G),this._innerSubscribe(G)}_innerSubscribe(G){const{hasError:X,isStopped:Fe,observers:Se}=this;return X||Fe?Q.Lc:(this.currentObservers=null,Se.push(G),new Q.w0(()=>{this.currentObservers=null,(0,te.P)(Se,G)}))}_checkFinalizedStatuses(G){const{hasError:X,thrownError:Fe,isStopped:Se}=this;X?G.error(Fe):Se&&G.complete()}asObservable(){const G=new f.y;return G.source=this,G}}return ae.create=(U,G)=>new Ce(U,G),ae})();class Ce extends fe{constructor(U,G){super(),this.destination=U,this.source=G}next(U){var G,X;null===(X=null===(G=this.destination)||void 0===G?void 0:G.next)||void 0===X||X.call(G,U)}error(U){var G,X;null===(X=null===(G=this.destination)||void 0===G?void 0:G.error)||void 0===X||X.call(G,U)}complete(){var U,G;null===(G=null===(U=this.destination)||void 0===U?void 0:U.complete)||void 0===G||G.call(U)}_subscribe(U){var G,X;return null!==(X=null===(G=this.source)||void 0===G?void 0:G.subscribe(U))&&void 0!==X?X:Q.Lc}}},305:(lt,Ee,k)=>{k.d(Ee,{Hp:()=>Ne,Lv:()=>X});var f=k(4674),Q=k(7394),F=k(2653),ee=k(3894),te=k(2420);const he=ae("C",void 0,void 0);function ae(J,_e,re){return{kind:J,value:_e,error:re}}var U=k(7599),G=k(1441);class X extends Q.w0{constructor(_e){super(),this.isStopped=!1,_e?(this.destination=_e,(0,Q.Nn)(_e)&&_e.add(this)):this.destination=ut}static create(_e,re,ye){return new Ne(_e,re,ye)}next(_e){this.isStopped?tt(function Ce(J){return ae("N",J,void 0)}(_e),this):this._next(_e)}error(_e){this.isStopped?tt(function fe(J){return ae("E",void 0,J)}(_e),this):(this.isStopped=!0,this._error(_e))}complete(){this.isStopped?tt(he,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(_e){this.destination.next(_e)}_error(_e){try{this.destination.error(_e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Fe=Function.prototype.bind;function Se(J,_e){return Fe.call(J,_e)}class $e{constructor(_e){this.partialObserver=_e}next(_e){const{partialObserver:re}=this;if(re.next)try{re.next(_e)}catch(ye){He(ye)}}error(_e){const{partialObserver:re}=this;if(re.error)try{re.error(_e)}catch(ye){He(ye)}else He(_e)}complete(){const{partialObserver:_e}=this;if(_e.complete)try{_e.complete()}catch(re){He(re)}}}class Ne extends X{constructor(_e,re,ye){let Le;if(super(),(0,f.m)(_e)||!_e)Le={next:_e??void 0,error:re??void 0,complete:ye??void 0};else{let $;this&&F.config.useDeprecatedNextContext?($=Object.create(_e),$.unsubscribe=()=>this.unsubscribe(),Le={next:_e.next&&Se(_e.next,$),error:_e.error&&Se(_e.error,$),complete:_e.complete&&Se(_e.complete,$)}):Le=_e}this.destination=new $e(Le)}}function He(J){F.config.useDeprecatedSynchronousErrorHandling?(0,G.O)(J):(0,ee.h)(J)}function tt(J,_e){const{onStoppedNotification:re}=F.config;re&&U.z.setTimeout(()=>re(J,_e))}const ut={closed:!0,next:te.Z,error:function xe(J){throw J},complete:te.Z}},7394:(lt,Ee,k)=>{k.d(Ee,{Lc:()=>he,w0:()=>te,Nn:()=>fe});var f=k(4674);const F=(0,k(2306).d)(ae=>function(G){ae(this),this.message=G?`${G.length} errors occurred during unsubscription:\n${G.map((X,Fe)=>`${Fe+1}) ${X.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=G});var ee=k(9039);class te{constructor(U){this.initialTeardown=U,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let U;if(!this.closed){this.closed=!0;const{_parentage:G}=this;if(G)if(this._parentage=null,Array.isArray(G))for(const Se of G)Se.remove(this);else G.remove(this);const{initialTeardown:X}=this;if((0,f.m)(X))try{X()}catch(Se){U=Se instanceof F?Se.errors:[Se]}const{_finalizers:Fe}=this;if(Fe){this._finalizers=null;for(const Se of Fe)try{Ce(Se)}catch($e){U=U??[],$e instanceof F?U=[...U,...$e.errors]:U.push($e)}}if(U)throw new F(U)}}add(U){var G;if(U&&U!==this)if(this.closed)Ce(U);else{if(U instanceof te){if(U.closed||U._hasParent(this))return;U._addParent(this)}(this._finalizers=null!==(G=this._finalizers)&&void 0!==G?G:[]).push(U)}}_hasParent(U){const{_parentage:G}=this;return G===U||Array.isArray(G)&&G.includes(U)}_addParent(U){const{_parentage:G}=this;this._parentage=Array.isArray(G)?(G.push(U),G):G?[G,U]:U}_removeParent(U){const{_parentage:G}=this;G===U?this._parentage=null:Array.isArray(G)&&(0,ee.P)(G,U)}remove(U){const{_finalizers:G}=this;G&&(0,ee.P)(G,U),U instanceof te&&U._removeParent(this)}}te.EMPTY=(()=>{const ae=new te;return ae.closed=!0,ae})();const he=te.EMPTY;function fe(ae){return ae instanceof te||ae&&"closed"in ae&&(0,f.m)(ae.remove)&&(0,f.m)(ae.add)&&(0,f.m)(ae.unsubscribe)}function Ce(ae){(0,f.m)(ae)?ae():ae.unsubscribe()}},2653:(lt,Ee,k)=>{k.d(Ee,{config:()=>f});const f={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},6232:(lt,Ee,k)=>{k.d(Ee,{E:()=>Q});const Q=new(k(5592).y)(te=>te.complete())},2459:(lt,Ee,k)=>{k.d(Ee,{D:()=>_e});var f=k(4829),Q=k(3093),F=k(5137),he=k(5592),Ce=k(4971),ae=k(4674),U=k(7103);function X(re,ye){if(!re)throw new Error("Iterable cannot be null");return new he.y(Le=>{(0,U.f)(Le,ye,()=>{const $=re[Symbol.asyncIterator]();(0,U.f)(Le,ye,()=>{$.next().then(be=>{be.done?Le.complete():Le.next(be.value)})},0,!0)})})}var Fe=k(8382),Se=k(4026),$e=k(4266),Ne=k(3664),He=k(5726),xe=k(9853),tt=k(541);function _e(re,ye){return ye?function J(re,ye){if(null!=re){if((0,Fe.c)(re))return function ee(re,ye){return(0,f.Xf)(re).pipe((0,F.R)(ye),(0,Q.Q)(ye))}(re,ye);if((0,$e.z)(re))return function fe(re,ye){return new he.y(Le=>{let $=0;return ye.schedule(function(){$===re.length?Le.complete():(Le.next(re[$++]),Le.closed||this.schedule())})})}(re,ye);if((0,Se.t)(re))return function te(re,ye){return(0,f.Xf)(re).pipe((0,F.R)(ye),(0,Q.Q)(ye))}(re,ye);if((0,He.D)(re))return X(re,ye);if((0,Ne.T)(re))return function G(re,ye){return new he.y(Le=>{let $;return(0,U.f)(Le,ye,()=>{$=re[Ce.h](),(0,U.f)(Le,ye,()=>{let be,Ue;try{({value:be,done:Ue}=$.next())}catch(At){return void Le.error(At)}Ue?Le.complete():Le.next(be)},0,!0)}),()=>(0,ae.m)($?.return)&&$.return()})}(re,ye);if((0,tt.L)(re))return function ut(re,ye){return X((0,tt.Q)(re),ye)}(re,ye)}throw(0,xe.z)(re)}(re,ye):(0,f.Xf)(re)}},4829:(lt,Ee,k)=>{k.d(Ee,{Xf:()=>Fe});var f=k(7582),Q=k(4266),F=k(4026),ee=k(5592),te=k(8382),he=k(5726),fe=k(9853),Ce=k(3664),ae=k(541),U=k(4674),G=k(3894),X=k(4850);function Fe(J){if(J instanceof ee.y)return J;if(null!=J){if((0,te.c)(J))return function Se(J){return new ee.y(_e=>{const re=J[X.L]();if((0,U.m)(re.subscribe))return re.subscribe(_e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(J);if((0,Q.z)(J))return function $e(J){return new ee.y(_e=>{for(let re=0;re<J.length&&!_e.closed;re++)_e.next(J[re]);_e.complete()})}(J);if((0,F.t)(J))return function Ne(J){return new ee.y(_e=>{J.then(re=>{_e.closed||(_e.next(re),_e.complete())},re=>_e.error(re)).then(null,G.h)})}(J);if((0,he.D)(J))return xe(J);if((0,Ce.T)(J))return function He(J){return new ee.y(_e=>{for(const re of J)if(_e.next(re),_e.closed)return;_e.complete()})}(J);if((0,ae.L)(J))return function tt(J){return xe((0,ae.Q)(J))}(J)}throw(0,fe.z)(J)}function xe(J){return new ee.y(_e=>{(function ut(J,_e){var re,ye,Le,$;return(0,f.mG)(this,void 0,void 0,function*(){try{for(re=(0,f.KL)(J);!(ye=yield re.next()).done;)if(_e.next(ye.value),_e.closed)return}catch(be){Le={error:be}}finally{try{ye&&!ye.done&&($=re.return)&&(yield $.call(re))}finally{if(Le)throw Le.error}}_e.complete()})})(J,_e).catch(re=>_e.error(re))})}},3019:(lt,Ee,k)=>{k.d(Ee,{T:()=>he});var f=k(7537),Q=k(4829),F=k(6232),ee=k(4564),te=k(2459);function he(...fe){const Ce=(0,ee.yG)(fe),ae=(0,ee._6)(fe,1/0),U=fe;return U.length?1===U.length?(0,Q.Xf)(U[0]):(0,f.J)(ae)((0,te.D)(U,Ce)):F.E}},2096:(lt,Ee,k)=>{k.d(Ee,{of:()=>F});var f=k(4564),Q=k(2459);function F(...ee){const te=(0,f.yG)(ee);return(0,Q.D)(ee,te)}},8251:(lt,Ee,k)=>{k.d(Ee,{x:()=>Q});var f=k(305);function Q(ee,te,he,fe,Ce){return new F(ee,te,he,fe,Ce)}class F extends f.Lv{constructor(te,he,fe,Ce,ae,U){super(te),this.onFinalize=ae,this.shouldUnsubscribe=U,this._next=he?function(G){try{he(G)}catch(X){te.error(X)}}:super._next,this._error=Ce?function(G){try{Ce(G)}catch(X){te.error(X)}finally{this.unsubscribe()}}:super._error,this._complete=fe?function(){try{fe()}catch(G){te.error(G)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var te;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:he}=this;super.unsubscribe(),!he&&(null===(te=this.onFinalize)||void 0===te||te.call(this))}}}},3997:(lt,Ee,k)=>{k.d(Ee,{x:()=>ee});var f=k(2737),Q=k(9360),F=k(8251);function ee(he,fe=f.y){return he=he??te,(0,Q.e)((Ce,ae)=>{let U,G=!0;Ce.subscribe((0,F.x)(ae,X=>{const Fe=fe(X);(G||!he(U,Fe))&&(G=!1,U=Fe,ae.next(X))}))})}function te(he,fe){return he===fe}},7398:(lt,Ee,k)=>{k.d(Ee,{U:()=>F});var f=k(9360),Q=k(8251);function F(ee,te){return(0,f.e)((he,fe)=>{let Ce=0;he.subscribe((0,Q.x)(fe,ae=>{fe.next(ee.call(te,ae,Ce++))}))})}},7537:(lt,Ee,k)=>{k.d(Ee,{J:()=>F});var f=k(1631),Q=k(2737);function F(ee=1/0){return(0,f.z)(Q.y,ee)}},1631:(lt,Ee,k)=>{k.d(Ee,{z:()=>Ce});var f=k(7398),Q=k(4829),F=k(9360),ee=k(7103),te=k(8251),fe=k(4674);function Ce(ae,U,G=1/0){return(0,fe.m)(U)?Ce((X,Fe)=>(0,f.U)((Se,$e)=>U(X,Se,Fe,$e))((0,Q.Xf)(ae(X,Fe))),G):("number"==typeof U&&(G=U),(0,F.e)((X,Fe)=>function he(ae,U,G,X,Fe,Se,$e,Ne){const He=[];let xe=0,tt=0,ut=!1;const J=()=>{ut&&!He.length&&!xe&&U.complete()},_e=ye=>xe<X?re(ye):He.push(ye),re=ye=>{Se&&U.next(ye),xe++;let Le=!1;(0,Q.Xf)(G(ye,tt++)).subscribe((0,te.x)(U,$=>{Fe?.($),Se?_e($):U.next($)},()=>{Le=!0},void 0,()=>{if(Le)try{for(xe--;He.length&&xe<X;){const $=He.shift();$e?(0,ee.f)(U,$e,()=>re($)):re($)}J()}catch($){U.error($)}}))};return ae.subscribe((0,te.x)(U,_e,()=>{ut=!0,J()})),()=>{Ne?.()}}(X,Fe,ae,G)))}},3093:(lt,Ee,k)=>{k.d(Ee,{Q:()=>ee});var f=k(7103),Q=k(9360),F=k(8251);function ee(te,he=0){return(0,Q.e)((fe,Ce)=>{fe.subscribe((0,F.x)(Ce,ae=>(0,f.f)(Ce,te,()=>Ce.next(ae),he),()=>(0,f.f)(Ce,te,()=>Ce.complete(),he),ae=>(0,f.f)(Ce,te,()=>Ce.error(ae),he)))})}},3020:(lt,Ee,k)=>{k.d(Ee,{B:()=>te});var f=k(4829),Q=k(8645),F=k(305),ee=k(9360);function te(fe={}){const{connector:Ce=(()=>new Q.x),resetOnError:ae=!0,resetOnComplete:U=!0,resetOnRefCountZero:G=!0}=fe;return X=>{let Fe,Se,$e,Ne=0,He=!1,xe=!1;const tt=()=>{Se?.unsubscribe(),Se=void 0},ut=()=>{tt(),Fe=$e=void 0,He=xe=!1},J=()=>{const _e=Fe;ut(),_e?.unsubscribe()};return(0,ee.e)((_e,re)=>{Ne++,!xe&&!He&&tt();const ye=$e=$e??Ce();re.add(()=>{Ne--,0===Ne&&!xe&&!He&&(Se=he(J,G))}),ye.subscribe(re),!Fe&&Ne>0&&(Fe=new F.Hp({next:Le=>ye.next(Le),error:Le=>{xe=!0,tt(),Se=he(ut,ae,Le),ye.error(Le)},complete:()=>{He=!0,tt(),Se=he(ut,U),ye.complete()}}),(0,f.Xf)(_e).subscribe(Fe))})(X)}}function he(fe,Ce,...ae){if(!0===Ce)return void fe();if(!1===Ce)return;const U=new F.Hp({next:()=>{U.unsubscribe(),fe()}});return(0,f.Xf)(Ce(...ae)).subscribe(U)}},5137:(lt,Ee,k)=>{k.d(Ee,{R:()=>Q});var f=k(9360);function Q(F,ee=0){return(0,f.e)((te,he)=>{he.add(F.schedule(()=>te.subscribe(he),ee))})}},4664:(lt,Ee,k)=>{k.d(Ee,{w:()=>ee});var f=k(4829),Q=k(9360),F=k(8251);function ee(te,he){return(0,Q.e)((fe,Ce)=>{let ae=null,U=0,G=!1;const X=()=>G&&!ae&&Ce.complete();fe.subscribe((0,F.x)(Ce,Fe=>{ae?.unsubscribe();let Se=0;const $e=U++;(0,f.Xf)(te(Fe,$e)).subscribe(ae=(0,F.x)(Ce,Ne=>Ce.next(he?he(Fe,Ne,$e,Se++):Ne),()=>{ae=null,X()}))},()=>{G=!0,X()}))})}},9397:(lt,Ee,k)=>{k.d(Ee,{b:()=>te});var f=k(4674),Q=k(9360),F=k(8251),ee=k(2737);function te(he,fe,Ce){const ae=(0,f.m)(he)||fe||Ce?{next:he,error:fe,complete:Ce}:he;return ae?(0,Q.e)((U,G)=>{var X;null===(X=ae.subscribe)||void 0===X||X.call(ae);let Fe=!0;U.subscribe((0,F.x)(G,Se=>{var $e;null===($e=ae.next)||void 0===$e||$e.call(ae,Se),G.next(Se)},()=>{var Se;Fe=!1,null===(Se=ae.complete)||void 0===Se||Se.call(ae),G.complete()},Se=>{var $e;Fe=!1,null===($e=ae.error)||void 0===$e||$e.call(ae,Se),G.error(Se)},()=>{var Se,$e;Fe&&(null===(Se=ae.unsubscribe)||void 0===Se||Se.call(ae)),null===($e=ae.finalize)||void 0===$e||$e.call(ae)}))}):ee.y}},1954:(lt,Ee,k)=>{k.d(Ee,{o:()=>te});var f=k(7394);class Q extends f.w0{constructor(fe,Ce){super()}schedule(fe,Ce=0){return this}}const F={setInterval(he,fe,...Ce){const{delegate:ae}=F;return ae?.setInterval?ae.setInterval(he,fe,...Ce):setInterval(he,fe,...Ce)},clearInterval(he){const{delegate:fe}=F;return(fe?.clearInterval||clearInterval)(he)},delegate:void 0};var ee=k(9039);class te extends Q{constructor(fe,Ce){super(fe,Ce),this.scheduler=fe,this.work=Ce,this.pending=!1}schedule(fe,Ce=0){var ae;if(this.closed)return this;this.state=fe;const U=this.id,G=this.scheduler;return null!=U&&(this.id=this.recycleAsyncId(G,U,Ce)),this.pending=!0,this.delay=Ce,this.id=null!==(ae=this.id)&&void 0!==ae?ae:this.requestAsyncId(G,this.id,Ce),this}requestAsyncId(fe,Ce,ae=0){return F.setInterval(fe.flush.bind(fe,this),ae)}recycleAsyncId(fe,Ce,ae=0){if(null!=ae&&this.delay===ae&&!1===this.pending)return Ce;null!=Ce&&F.clearInterval(Ce)}execute(fe,Ce){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const ae=this._execute(fe,Ce);if(ae)return ae;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(fe,Ce){let U,ae=!1;try{this.work(fe)}catch(G){ae=!0,U=G||new Error("Scheduled action threw falsy error")}if(ae)return this.unsubscribe(),U}unsubscribe(){if(!this.closed){const{id:fe,scheduler:Ce}=this,{actions:ae}=Ce;this.work=this.state=this.scheduler=null,this.pending=!1,(0,ee.P)(ae,this),null!=fe&&(this.id=this.recycleAsyncId(Ce,fe,null)),this.delay=null,super.unsubscribe()}}}},2631:(lt,Ee,k)=>{k.d(Ee,{v:()=>F});var f=k(4552);class Q{constructor(te,he=Q.now){this.schedulerActionCtor=te,this.now=he}schedule(te,he=0,fe){return new this.schedulerActionCtor(this,te).schedule(fe,he)}}Q.now=f.l.now;class F extends Q{constructor(te,he=Q.now){super(te,he),this.actions=[],this._active=!1}flush(te){const{actions:he}=this;if(this._active)return void he.push(te);let fe;this._active=!0;do{if(fe=te.execute(te.state,te.delay))break}while(te=he.shift());if(this._active=!1,fe){for(;te=he.shift();)te.unsubscribe();throw fe}}}},6321:(lt,Ee,k)=>{k.d(Ee,{z:()=>F});var f=k(1954);const F=new(k(2631).v)(f.o)},4552:(lt,Ee,k)=>{k.d(Ee,{l:()=>f});const f={now:()=>(f.delegate||Date).now(),delegate:void 0}},7599:(lt,Ee,k)=>{k.d(Ee,{z:()=>f});const f={setTimeout(Q,F,...ee){const{delegate:te}=f;return te?.setTimeout?te.setTimeout(Q,F,...ee):setTimeout(Q,F,...ee)},clearTimeout(Q){const{delegate:F}=f;return(F?.clearTimeout||clearTimeout)(Q)},delegate:void 0}},4971:(lt,Ee,k)=>{k.d(Ee,{h:()=>Q});const Q=function f(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(lt,Ee,k)=>{k.d(Ee,{L:()=>f});const f="function"==typeof Symbol&&Symbol.observable||"@@observable"},4564:(lt,Ee,k)=>{k.d(Ee,{_6:()=>he,jO:()=>ee,yG:()=>te});var f=k(4674);function F(fe){return fe[fe.length-1]}function ee(fe){return(0,f.m)(F(fe))?fe.pop():void 0}function te(fe){return function Q(fe){return fe&&(0,f.m)(fe.schedule)}(F(fe))?fe.pop():void 0}function he(fe,Ce){return"number"==typeof F(fe)?fe.pop():Ce}},9039:(lt,Ee,k)=>{function f(Q,F){if(Q){const ee=Q.indexOf(F);0<=ee&&Q.splice(ee,1)}}k.d(Ee,{P:()=>f})},2306:(lt,Ee,k)=>{function f(Q){const ee=Q(te=>{Error.call(te),te.stack=(new Error).stack});return ee.prototype=Object.create(Error.prototype),ee.prototype.constructor=ee,ee}k.d(Ee,{d:()=>f})},1441:(lt,Ee,k)=>{k.d(Ee,{O:()=>ee,x:()=>F});var f=k(2653);let Q=null;function F(te){if(f.config.useDeprecatedSynchronousErrorHandling){const he=!Q;if(he&&(Q={errorThrown:!1,error:null}),te(),he){const{errorThrown:fe,error:Ce}=Q;if(Q=null,fe)throw Ce}}else te()}function ee(te){f.config.useDeprecatedSynchronousErrorHandling&&Q&&(Q.errorThrown=!0,Q.error=te)}},7103:(lt,Ee,k)=>{function f(Q,F,ee,te=0,he=!1){const fe=F.schedule(function(){ee(),he?Q.add(this.schedule(null,te)):this.unsubscribe()},te);if(Q.add(fe),!he)return fe}k.d(Ee,{f:()=>f})},2737:(lt,Ee,k)=>{function f(Q){return Q}k.d(Ee,{y:()=>f})},4266:(lt,Ee,k)=>{k.d(Ee,{z:()=>f});const f=Q=>Q&&"number"==typeof Q.length&&"function"!=typeof Q},5726:(lt,Ee,k)=>{k.d(Ee,{D:()=>Q});var f=k(4674);function Q(F){return Symbol.asyncIterator&&(0,f.m)(F?.[Symbol.asyncIterator])}},4674:(lt,Ee,k)=>{function f(Q){return"function"==typeof Q}k.d(Ee,{m:()=>f})},8382:(lt,Ee,k)=>{k.d(Ee,{c:()=>F});var f=k(4850),Q=k(4674);function F(ee){return(0,Q.m)(ee[f.L])}},3664:(lt,Ee,k)=>{k.d(Ee,{T:()=>F});var f=k(4971),Q=k(4674);function F(ee){return(0,Q.m)(ee?.[f.h])}},4026:(lt,Ee,k)=>{k.d(Ee,{t:()=>Q});var f=k(4674);function Q(F){return(0,f.m)(F?.then)}},541:(lt,Ee,k)=>{k.d(Ee,{L:()=>ee,Q:()=>F});var f=k(7582),Q=k(4674);function F(te){return(0,f.FC)(this,arguments,function*(){const fe=te.getReader();try{for(;;){const{value:Ce,done:ae}=yield(0,f.qq)(fe.read());if(ae)return yield(0,f.qq)(void 0);yield yield(0,f.qq)(Ce)}}finally{fe.releaseLock()}})}function ee(te){return(0,Q.m)(te?.getReader)}},9360:(lt,Ee,k)=>{k.d(Ee,{A:()=>Q,e:()=>F});var f=k(4674);function Q(ee){return(0,f.m)(ee?.lift)}function F(ee){return te=>{if(Q(te))return te.lift(function(he){try{return ee(he,this)}catch(fe){this.error(fe)}});throw new TypeError("Unable to lift unknown Observable type")}}},2420:(lt,Ee,k)=>{function f(){}k.d(Ee,{Z:()=>f})},8407:(lt,Ee,k)=>{k.d(Ee,{U:()=>F,z:()=>Q});var f=k(2737);function Q(...ee){return F(ee)}function F(ee){return 0===ee.length?f.y:1===ee.length?ee[0]:function(he){return ee.reduce((fe,Ce)=>Ce(fe),he)}}},3894:(lt,Ee,k)=>{k.d(Ee,{h:()=>F});var f=k(2653),Q=k(7599);function F(ee){Q.z.setTimeout(()=>{const{onUnhandledError:te}=f.config;if(!te)throw ee;te(ee)})}},9853:(lt,Ee,k)=>{function f(Q){return new TypeError(`You provided ${null!==Q&&"object"==typeof Q?"an invalid object":`'${Q}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}k.d(Ee,{z:()=>f})},5879:(lt,Ee,k)=>{k.d(Ee,{$8M:()=>hs,$WT:()=>Ks,$Z:()=>_p,AFp:()=>AA,ALo:()=>RD,AaK:()=>X,CHM:()=>Ou,CRH:()=>ys,EJc:()=>bx,EpF:()=>bb,F4k:()=>Db,FYo:()=>Ai,FiY:()=>oc,GfV:()=>fp,Gpc:()=>$e,HDt:()=>XD,JOm:()=>eh,KtG:()=>Ba,LFG:()=>mt,Lbi:()=>yC,Lck:()=>sx,MAs:()=>Gw,MMx:()=>q0,NdJ:()=>Up,Ojb:()=>xA,OlP:()=>gn,Oqu:()=>l0,P3R:()=>EA,PXZ:()=>rT,Q6J:()=>zw,QGY:()=>R_,Qsj:()=>a_,R0b:()=>Yt,RDi:()=>hh,Rgc:()=>Pe,SBq:()=>hp,Sil:()=>Kh,Suo:()=>dE,TTD:()=>xd,TgZ:()=>Fp,VKq:()=>fy,VuI:()=>ST,W1O:()=>oe,X6Q:()=>Fx,XFs:()=>_t,Xpm:()=>qo,Xq5:()=>cM,Xts:()=>Xm,Y36:()=>Ch,YKP:()=>jh,YNc:()=>Ac,Yjl:()=>Df,Yz7:()=>Ct,Z0I:()=>ln,ZZ4:()=>VE,_Bn:()=>G0,_UZ:()=>qw,_c5:()=>ET,_uU:()=>jp,aQg:()=>Cl,c2e:()=>DE,cJS:()=>Bn,cg1:()=>Mh,dDg:()=>ME,dqk:()=>en,eFA:()=>mg,eJc:()=>vy,ekj:()=>pt,eoX:()=>gg,f3M:()=>j,g9A:()=>MA,h0i:()=>fa,hGG:()=>bg,hij:()=>uu,iGM:()=>zh,ifc:()=>pn,ip1:()=>bE,jDz:()=>W0,kL8:()=>Qb,lG2:()=>Vl,lcZ:()=>OD,lqb:()=>mc,lri:()=>Kc,n5z:()=>ur,oAB:()=>Ll,oxw:()=>N_,q4F:()=>u_,qFp:()=>Wx,qLn:()=>wh,qOj:()=>la,qZA:()=>Lp,rWj:()=>AE,rg0:()=>Nf,sBO:()=>du,s_b:()=>my,soG:()=>Dy,tb:()=>Yc,tp0:()=>Kd,uIk:()=>Bw,vHH:()=>J,vpe:()=>_i,wAp:()=>xh,xp6:()=>h_,z2F:()=>Jc,zSh:()=>pC,zs3:()=>rl});var f=k(8645),Q=k(7394),F=k(5619),ee=k(5592),te=k(3019),he=k(2096),fe=k(3020),Ce=k(4664),ae=k(3997);function U(s){for(let o in s)if(s[o]===U)return o;throw Error("Could not find renamed property on target object.")}function G(s,o){for(const u in o)o.hasOwnProperty(u)&&!s.hasOwnProperty(u)&&(s[u]=o[u])}function X(s){if("string"==typeof s)return s;if(Array.isArray(s))return"["+s.map(X).join(", ")+"]";if(null==s)return""+s;if(s.overriddenName)return`${s.overriddenName}`;if(s.name)return`${s.name}`;const o=s.toString();if(null==o)return""+o;const u=o.indexOf("\n");return-1===u?o:o.substring(0,u)}function Fe(s,o){return null==s||""===s?null===o?"":o:null==o||""===o?s:s+" "+o}const Se=U({__forward_ref__:U});function $e(s){return s.__forward_ref__=$e,s.toString=function(){return X(this())},s}function Ne(s){return He(s)?s():s}function He(s){return"function"==typeof s&&s.hasOwnProperty(Se)&&s.__forward_ref__===$e}function xe(s){return s&&!!s.\u0275providers}const ut="https://g.co/ng/security#xss";class J extends Error{constructor(o,u){super(function _e(s,o){return`NG0${Math.abs(s)}${o?": "+o:""}`}(o,u)),this.code=o}}function re(s){return"string"==typeof s?s:null==s?"":String(s)}function Ue(s,o){throw new J(-201,!1)}function rt(s,o){null==s&&function je(s,o,u,c){throw new Error(`ASSERTION ERROR: ${s}`+(null==c?"":` [Expected=> ${u} ${c} ${o} <=Actual]`))}(o,s,null,"!=")}function Ct(s){return{token:s.token,providedIn:s.providedIn||null,factory:s.factory,value:void 0}}function Bn(s){return{providers:s.providers||[],imports:s.imports||[]}}function pr(s){return Pn(s,Qr)||Pn(s,wi)}function ln(s){return null!==pr(s)}function Pn(s,o){return s.hasOwnProperty(o)?s[o]:null}function Yr(s){return s&&(s.hasOwnProperty(ns)||s.hasOwnProperty(Vi))?s[ns]:null}const Qr=U({\u0275prov:U}),ns=U({\u0275inj:U}),wi=U({ngInjectableDef:U}),Vi=U({ngInjectorDef:U});var _t=function(s){return s[s.Default=0]="Default",s[s.Host=1]="Host",s[s.Self=2]="Self",s[s.SkipSelf=4]="SkipSelf",s[s.Optional=8]="Optional",s}(_t||{});let Pt;function jn(s){const o=Pt;return Pt=s,o}function rs(s,o,u){const c=pr(s);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:u&_t.Optional?null:void 0!==o?o:void Ue(X(s))}const en=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),is={},tn="__NG_DI_FLAG__",oi="ngTempTokenPath",yu=/\n/gm,qs="__source";let Ye;function ze(s){const o=Ye;return Ye=s,o}function St(s,o=_t.Default){if(void 0===Ye)throw new J(-203,!1);return null===Ye?rs(s,void 0,o):Ye.get(s,o&_t.Optional?null:void 0,o)}function mt(s,o=_t.Default){return(function Vt(){return Pt}()||St)(Ne(s),o)}function j(s,o=_t.Default){return mt(s,B(o))}function B(s){return typeof s>"u"||"number"==typeof s?s:0|(s.optional&&8)|(s.host&&1)|(s.self&&2)|(s.skipSelf&&4)}function Z(s){const o=[];for(let u=0;u<s.length;u++){const c=Ne(s[u]);if(Array.isArray(c)){if(0===c.length)throw new J(900,!1);let d,g=_t.Default;for(let y=0;y<c.length;y++){const I=c[y],C=se(I);"number"==typeof C?-1===C?d=I.token:g|=C:d=I}o.push(mt(d,g))}else o.push(mt(c))}return o}function ve(s,o){return s[tn]=o,s.prototype[tn]=o,s}function se(s){return s[tn]}function Gt(s){return{toString:s}.toString()}var Hn=function(s){return s[s.OnPush=0]="OnPush",s[s.Default=1]="Default",s}(Hn||{}),pn=function(s){return s[s.Emulated=0]="Emulated",s[s.None=2]="None",s[s.ShadowDom=3]="ShadowDom",s}(pn||{});const zn={},Je=[],qn=U({\u0275cmp:U}),fo=U({\u0275dir:U}),Is=U({\u0275pipe:U}),Ef=U({\u0275mod:U}),Cs=U({\u0275fac:U}),ba=U({__NG_ELEMENT_ID__:U}),po=U({__NG_ENV_ID__:U});function Ol(s,o,u){let c=s.length;for(;;){const d=s.indexOf(o,u);if(-1===d)return d;if(0===d||s.charCodeAt(d-1)<=32){const g=o.length;if(d+g===c||s.charCodeAt(d+g)<=32)return d}u=d+1}}function Pl(s,o,u){let c=0;for(;c<u.length;){const d=u[c];if("number"==typeof d){if(0!==d)break;c++;const g=u[c++],y=u[c++],I=u[c++];s.setAttribute(o,y,I,g)}else{const g=d,y=u[++c];Da(g)?s.setProperty(o,g,y):s.setAttribute(o,g,y),c++}}return c}function tr(s){return 3===s||4===s||6===s}function Da(s){return 64===s.charCodeAt(0)}function Ws(s,o){if(null!==o&&0!==o.length)if(null===s||0===s.length)s=o.slice();else{let u=-1;for(let c=0;c<o.length;c++){const d=o[c];"number"==typeof d?u=d:0===u||$o(s,u,d,null,-1===u||2===u?o[++c]:null)}}return s}function $o(s,o,u,c,d){let g=0,y=s.length;if(-1===o)y=-1;else for(;g<s.length;){const I=s[g++];if("number"==typeof I){if(I===o){y=-1;break}if(I>o){y=g-1;break}}}for(;g<s.length;){const I=s[g];if("number"==typeof I)break;if(I===u){if(null===c)return void(null!==d&&(s[g+1]=d));if(c===s[g+1])return void(s[g+2]=d)}g++,null!==c&&g++,null!==d&&g++}-1!==y&&(s.splice(y,0,o),g=y+1),s.splice(g++,0,u),null!==c&&s.splice(g++,0,c),null!==d&&s.splice(g++,0,d)}const kl="ng-template";function If(s,o,u){let c=0,d=!0;for(;c<s.length;){let g=s[c++];if("string"==typeof g&&d){const y=s[c++];if(u&&"class"===g&&-1!==Ol(y.toLowerCase(),o,0))return!0}else{if(1===g){for(;c<s.length&&"string"==typeof(g=s[c++]);)if(g.toLowerCase()===o)return!0;return!1}"number"==typeof g&&(d=!1)}}return!1}function Fl(s){return 4===s.type&&s.value!==kl}function Zs(s,o,u){return o===(4!==s.type||u?s.value:kl)}function Nr(s,o,u){let c=4;const d=s.attrs||[],g=function Go(s){for(let o=0;o<s.length;o++)if(tr(s[o]))return o;return s.length}(d);let y=!1;for(let I=0;I<o.length;I++){const C=o[I];if("number"!=typeof C){if(!y)if(4&c){if(c=2|1&c,""!==C&&!Zs(s,C,u)||""===C&&1===o.length){if(ui(c))return!1;y=!0}}else{const S=8&c?C:o[++I];if(8&c&&null!==s.attrs){if(!If(s.attrs,S,u)){if(ui(c))return!1;y=!0}continue}const L=dd(8&c?"class":C,d,Fl(s),u);if(-1===L){if(ui(c))return!1;y=!0;continue}if(""!==S){let W;W=L>g?"":d[L+1].toLowerCase();const Y=8&c?W:null;if(Y&&-1!==Ol(Y,S,0)||2&c&&S!==W){if(ui(c))return!1;y=!0}}}}else{if(!y&&!ui(c)&&!ui(C))return!1;if(y&&ui(C))continue;y=!1,c=C|1&c}}return ui(c)||y}function ui(s){return 0==(1&s)}function dd(s,o,u,c){if(null===o)return-1;let d=0;if(c||!u){let g=!1;for(;d<o.length;){const y=o[d];if(y===s)return d;if(3===y||6===y)g=!0;else{if(1===y||2===y){let I=o[++d];for(;"string"==typeof I;)I=o[++d];continue}if(4===y)break;if(0===y){d+=4;continue}}d+=g?1:2}return-1}return function vu(s,o){let u=s.indexOf(4);if(u>-1)for(u++;u<s.length;){const c=s[u];if("number"==typeof c)return-1;if(c===o)return u;u++}return-1}(o,s)}function Ta(s,o,u=!1){for(let c=0;c<o.length;c++)if(Nr(s,o[c],u))return!0;return!1}function zo(s,o){return s?":not("+o.trim()+")":o}function Sa(s){let o=s[0],u=1,c=2,d="",g=!1;for(;u<s.length;){let y=s[u];if("string"==typeof y)if(2&c){const I=s[++u];d+="["+y+(I.length>0?'="'+I+'"':"")+"]"}else 8&c?d+="."+y:4&c&&(d+=" "+y);else""!==d&&!ui(y)&&(o+=zo(g,d),d=""),c=y,g=g||!ui(c);u++}return""!==d&&(o+=zo(g,d)),o}function qo(s){return Gt(()=>{const o=ci(s),u={...o,decls:s.decls,vars:s.vars,template:s.template,consts:s.consts||null,ngContentSelectors:s.ngContentSelectors,onPush:s.changeDetection===Hn.OnPush,directiveDefs:null,pipeDefs:null,dependencies:o.standalone&&s.dependencies||null,getStandaloneInjector:null,signals:s.signals??!1,data:s.data||{},encapsulation:s.encapsulation||pn.Emulated,styles:s.styles||Je,_:null,schemas:s.schemas||null,tView:null,id:""};gd(u);const c=s.dependencies;return u.directiveDefs=Wo(c,!1),u.pipeDefs=Wo(c,!0),u.id=function bs(s){let o=0;const u=[s.selectors,s.ngContentSelectors,s.hostVars,s.hostAttrs,s.consts,s.vars,s.decls,s.encapsulation,s.standalone,s.signals,s.exportAs,JSON.stringify(s.inputs),JSON.stringify(s.outputs),Object.getOwnPropertyNames(s.type.prototype),!!s.contentQueries,!!s.viewQuery].join("|");for(const d of u)o=Math.imul(31,o)+d.charCodeAt(0)<<0;return o+=2147483648,"c"+o}(u),u})}function tm(s){return Nt(s)||Wn(s)}function bf(s){return null!==s}function Ll(s){return Gt(()=>({type:s.type,bootstrap:s.bootstrap||Je,declarations:s.declarations||Je,imports:s.imports||Je,exports:s.exports||Je,transitiveCompileScopes:null,schemas:s.schemas||null,id:s.id||null}))}function nm(s,o){if(null==s)return zn;const u={};for(const c in s)if(s.hasOwnProperty(c)){let d=s[c],g=d;Array.isArray(d)&&(g=d[1],d=d[0]),u[d]=c,o&&(o[d]=g)}return u}function Vl(s){return Gt(()=>{const o=ci(s);return gd(o),o})}function Df(s){return{type:s.type,name:s.name,factory:null,pure:!1!==s.pure,standalone:!0===s.standalone,onDestroy:s.type.prototype.ngOnDestroy||null}}function Nt(s){return s[qn]||null}function Wn(s){return s[fo]||null}function kn(s){return s[Is]||null}function Ks(s){const o=Nt(s)||Wn(s)||kn(s);return null!==o&&o.standalone}function li(s,o){const u=s[Ef]||null;if(!u&&!0===o)throw new Error(`Type ${X(s)} does not have '\u0275mod' property.`);return u}function ci(s){const o={};return{type:s.type,providersResolver:null,factory:null,hostBindings:s.hostBindings||null,hostVars:s.hostVars||0,hostAttrs:s.hostAttrs||null,contentQueries:s.contentQueries||null,declaredInputs:o,inputTransforms:null,inputConfig:s.inputs||zn,exportAs:s.exportAs||null,standalone:!0===s.standalone,signals:!0===s.signals,selectors:s.selectors||Je,viewQuery:s.viewQuery||null,features:s.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:nm(s.inputs,o),outputs:nm(s.outputs)}}function gd(s){s.features?.forEach(o=>o(s))}function Wo(s,o){if(!s)return null;const u=o?kn:tm;return()=>("function"==typeof s?s():s).map(c=>u(c)).filter(bf)}const nr=0,Ke=1,Mt=2,Rn=3,di=4,Ui=5,Br=6,Ys=7,vn=8,go=9,ss=10,Et=11,Bi=12,mo=13,os=14,bn=15,xa=16,Ra=17,jr=18,Ds=19,hi=20,Ts=21,Ci=22,Na=23,rr=24,zt=25,Eu=1,Oa=2,ji=7,Qs=9,ir=11;function Zn(s){return Array.isArray(s)&&"object"==typeof s[Eu]}function Ir(s){return Array.isArray(s)&&!0===s[Eu]}function Iu(s){return 0!=(4&s.flags)}function Hi(s){return s.componentOffset>-1}function _o(s){return 1==(1&s.flags)}function Or(s){return!!s.template}function Fn(s){return 0!=(512&s[Mt])}function yo(s,o){return s.hasOwnProperty(Cs)?s[Cs]:null}let rm=en.WeakRef??class Td{constructor(o){this.ref=o}deref(){return this.ref}},ka=0,Di=null,Zo=!1;function Vn(s){const o=Di;return Di=s,o}class Js{constructor(){this.id=ka++,this.ref=function Tu(s){return new rm(s)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[o,u]of this.producers){const c=u.producerNode.deref();if(null!=c&&u.atTrackingVersion===this.trackingVersion){if(c.producerPollStatus(u.seenValueVersion))return!0}else this.producers.delete(o),c?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const o=Zo;Zo=!0;try{for(const[u,c]of this.consumers){const d=c.consumerNode.deref();null!=d&&d.trackingVersion===c.atTrackingVersion?d.onConsumerDependencyMayHaveChanged():(this.consumers.delete(u),d?.producers.delete(this.id))}}finally{Zo=o}}producerAccessed(){if(Zo)throw new Error("");if(null===Di)return;let o=Di.producers.get(this.id);void 0===o?(o={consumerNode:Di.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:Di.trackingVersion},Di.producers.set(this.id,o),this.consumers.set(Di.id,o)):(o.seenValueVersion=this.valueVersion,o.atTrackingVersion=Di.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==Di?.consumerAllowSignalWrites}producerPollStatus(o){return this.valueVersion!==o||(this.onProducerUpdateValueVersion(),this.valueVersion!==o)}}let Ad=null;function Nf(s){const o=Vn(null);try{return s()}finally{Vn(o)}}const Wl=()=>{};class om extends Js{constructor(o,u,c){super(),this.watch=o,this.schedule=u,this.dirty=!1,this.cleanupFn=Wl,this.registerOnCleanup=d=>{this.cleanupFn=d},this.consumerAllowSignalWrites=c}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const o=Vn(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=Wl,this.watch(this.registerOnCleanup)}finally{Vn(o)}}cleanup(){this.cleanupFn()}}class Zl{constructor(o,u,c){this.previousValue=o,this.currentValue=u,this.firstChange=c}isFirstChange(){return this.firstChange}}function xd(){return am}function am(s){return s.type.prototype.ngOnChanges&&(s.setInput=Rd),um}function um(){const s=vv(this),o=s?.current;if(o){const u=s.previous;if(u===zn)s.previous=o;else for(let c in o)u[c]=o[c];s.current=null,this.ngOnChanges(o)}}function Rd(s,o,u,c){const d=this.declaredInputs[u],g=vv(s)||function Nd(s,o){return s[yv]=o}(s,{previous:zn,current:null}),y=g.current||(g.current={}),I=g.previous,C=I[d];y[d]=new Zl(C&&C.currentValue,o,I===zn),s[c]=o}xd.ngInherit=!0;const yv="__ngSimpleChanges__";function vv(s){return s[yv]||null}const $i=function(s,o,u){};function Ut(s){for(;Array.isArray(s);)s=s[nr];return s}function Mu(s,o){return Ut(o[s])}function Pr(s,o){return Ut(o[s.index])}function Xo(s,o){return s.data[o]}function Ss(s,o){return s[o]}function gr(s,o){const u=o[s];return Zn(u)?u:u[nr]}function As(s,o){return null==o?null:s[o]}function Xr(s){s[Ra]=0}function Jo(s){1024&s[Mt]||(s[Mt]|=1024,Gi(s,1))}function Pd(s){1024&s[Mt]&&(s[Mt]&=-1025,Gi(s,-1))}function Gi(s,o){let u=s[Rn];if(null===u)return;u[Ui]+=o;let c=u;for(u=u[Rn];null!==u&&(1===o&&1===c[Ui]||-1===o&&0===c[Ui]);)u[Ui]+=o,c=u,u=u[Rn]}const It={lFrame:Ud(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Ua(){return It.bindingsEnabled}function Ie(){return It.lFrame.lView}function Ht(){return It.lFrame.tView}function Ou(s){return It.lFrame.contextLView=s,s[vn]}function Ba(s){return It.lFrame.contextLView=null,s}function Kn(){let s=Pu();for(;null!==s&&64===s.type;)s=s.parent;return s}function Pu(){return It.lFrame.currentTNode}function fi(s,o){const u=It.lFrame;u.currentTNode=s,u.isParent=o}function ku(){return It.lFrame.isParent}function Cr(){const s=It.lFrame;let o=s.bindingRootIndex;return-1===o&&(o=s.bindingRootIndex=s.tView.bindingStartIndex),o}function Ms(){return It.lFrame.bindingIndex++}function Ff(s,o){const u=It.lFrame;u.bindingIndex=u.bindingRootIndex=s,To(o)}function To(s){It.lFrame.currentDirectiveIndex=s}function Jl(){return It.lFrame.currentQueryIndex}function Lu(s){It.lFrame.currentQueryIndex=s}function Rs(s){const o=s[Ke];return 2===o.type?o.declTNode:1===o.type?s[Br]:null}function Vd(s,o,u){if(u&_t.SkipSelf){let d=o,g=s;for(;!(d=d.parent,null!==d||u&_t.Host||(d=Rs(g),null===d||(g=g[os],10&d.type))););if(null===d)return!1;o=d,s=g}const c=It.lFrame=ta();return c.currentTNode=o,c.lView=s,!0}function ec(s){const o=ta(),u=s[Ke];It.lFrame=o,o.currentTNode=u.firstChild,o.lView=s,o.tView=u,o.contextLView=s,o.bindingIndex=u.bindingStartIndex,o.inI18n=!1}function ta(){const s=It.lFrame,o=null===s?null:s.child;return null===o?Ud(s):o}function Ud(s){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:s,child:null,inI18n:!1};return null!==s&&(s.child=o),o}function dm(){const s=It.lFrame;return It.lFrame=s.parent,s.currentTNode=null,s.lView=null,s}const Lf=dm;function Vf(){const s=dm();s.isParent=!0,s.tView=null,s.selectedIndex=-1,s.contextLView=null,s.elementDepthCount=0,s.currentDirectiveIndex=-1,s.currentNamespace=null,s.bindingRootIndex=-1,s.bindingIndex=-1,s.currentQueryIndex=0}function Hr(){return It.lFrame.selectedIndex}function So(s){It.lFrame.selectedIndex=s}function wn(){const s=It.lFrame;return Xo(s.tView,s.selectedIndex)}let $a=!0;function Hd(){return $a}function Ns(s){$a=s}function ls(s,o){for(let u=o.directiveStart,c=o.directiveEnd;u<c;u++){const g=s.data[u].type.prototype,{ngAfterContentInit:y,ngAfterContentChecked:I,ngAfterViewInit:C,ngAfterViewChecked:S,ngOnDestroy:R}=g;y&&(s.contentHooks??=[]).push(-u,y),I&&((s.contentHooks??=[]).push(u,I),(s.contentCheckHooks??=[]).push(u,I)),C&&(s.viewHooks??=[]).push(-u,C),S&&((s.viewHooks??=[]).push(u,S),(s.viewCheckHooks??=[]).push(u,S)),null!=R&&(s.destroyHooks??=[]).push(u,R)}}function Ga(s,o,u){Jr(s,o,3,u)}function tc(s,o,u,c){(3&s[Mt])===u&&Jr(s,o,u,c)}function Uu(s,o){let u=s[Mt];(3&u)===o&&(u&=8191,u+=1,s[Mt]=u)}function Jr(s,o,u,c){const g=c??-1,y=o.length-1;let I=0;for(let C=void 0!==c?65535&s[Ra]:0;C<y;C++)if("number"==typeof o[C+1]){if(I=o[C],null!=c&&I>=c)break}else o[C]<0&&(s[Ra]+=65536),(I<g||-1==g)&&(Bu(s,u,o,C),s[Ra]=(4294901760&s[Ra])+C+2),C++}function cs(s,o){$i(4,s,o);const u=Vn(null);try{o.call(s)}finally{Vn(u),$i(5,s,o)}}function Bu(s,o,u,c){const d=u[c]<0,g=u[c+1],I=s[d?-u[c]:u[c]];d?s[Mt]>>13<s[Ra]>>16&&(3&s[Mt])===o&&(s[Mt]+=8192,cs(I,g)):cs(I,g)}const nn=-1;class ct{constructor(o,u,c){this.factory=o,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=c}}function Tt(s){return s!==nn}function $u(s){return 32767&s}function Ao(s,o){let u=function Ps(s){return s>>16}(s),c=o;for(;u>0;)c=c[os],u--;return c}let kr=!0;function qa(s){const o=kr;return kr=s,o}const Gu=255,Wa=5;let Uf=0;const ds={};function T(s,o){const u=V(s,o);if(-1!==u)return u;const c=o[Ke];c.firstCreatePass&&(s.injectorIndex=o.length,x(c.data,s),x(o,null),x(c.blueprint,null));const d=K(s,o),g=s.injectorIndex;if(Tt(d)){const y=$u(d),I=Ao(d,o),C=I[Ke].data;for(let S=0;S<8;S++)o[g+S]=I[y+S]|C[y+S]}return o[g+8]=d,g}function x(s,o){s.push(0,0,0,0,0,0,0,0,o)}function V(s,o){return-1===s.injectorIndex||s.parent&&s.parent.injectorIndex===s.injectorIndex||null===o[s.injectorIndex+8]?-1:s.injectorIndex}function K(s,o){if(s.parent&&-1!==s.parent.injectorIndex)return s.parent.injectorIndex;let u=0,c=null,d=o;for(;null!==d;){if(c=_m(d),null===c)return nn;if(u++,d=d[os],-1!==c.injectorIndex)return c.injectorIndex|u<<16}return nn}function ne(s,o,u){!function b(s,o,u){let c;"string"==typeof u?c=u.charCodeAt(0)||0:u.hasOwnProperty(ba)&&(c=u[ba]),null==c&&(c=u[ba]=Uf++);const d=c&Gu;o.data[s+(d>>Wa)]|=1<<d}(s,o,u)}function et(s,o,u){if(u&_t.Optional||void 0!==s)return s;Ue()}function st(s,o,u,c){if(u&_t.Optional&&void 0===c&&(c=null),!(u&(_t.Self|_t.Host))){const d=s[go],g=jn(void 0);try{return d?d.get(o,c,u&_t.Optional):rs(o,c,u&_t.Optional)}finally{jn(g)}}return et(c,0,u)}function ot(s,o,u,c=_t.Default,d){if(null!==s){if(2048&o[Mt]&&!(c&_t.Self)){const y=function mm(s,o,u,c,d){let g=s,y=o;for(;null!==g&&null!==y&&2048&y[Mt]&&!(512&y[Mt]);){const I=Bt(g,y,u,c|_t.Self,ds);if(I!==ds)return I;let C=g.parent;if(!C){const S=y[hi];if(S){const R=S.get(u,ds,c);if(R!==ds)return R}C=_m(y),y=y[os]}g=C}return d}(s,o,u,c,ds);if(y!==ds)return y}const g=Bt(s,o,u,c,ds);if(g!==ds)return g}return st(o,u,c,d)}function Bt(s,o,u,c,d){const g=function qi(s){if("string"==typeof s)return s.charCodeAt(0)||0;const o=s.hasOwnProperty(ba)?s[ba]:void 0;return"number"==typeof o?o>=0?o&Gu:ar:o}(u);if("function"==typeof g){if(!Vd(o,s,c))return c&_t.Host?et(d,0,c):st(o,u,c,d);try{const y=g(c);if(null!=y||c&_t.Optional)return y;Ue()}finally{Lf()}}else if("number"==typeof g){let y=null,I=V(s,o),C=nn,S=c&_t.Host?o[bn][Br]:null;for((-1===I||c&_t.SkipSelf)&&(C=-1===I?K(s,o):o[I+8],C!==nn&&Ti(c,!1)?(y=o[Ke],I=$u(C),o=Ao(C,o)):I=-1);-1!==I;){const R=o[Ke];if(Tn(g,I,R.data)){const L=dt(I,o,u,y,c,S);if(L!==ds)return L}C=o[I+8],C!==nn&&Ti(c,o[Ke].data[I+8]===S)&&Tn(g,I,o)?(y=R,I=$u(C),o=Ao(C,o)):I=-1}}return d}function dt(s,o,u,c,d,g){const y=o[Ke],I=y.data[s+8],R=sr(I,y,u,null==c?Hi(I)&&kr:c!=y&&0!=(3&I.type),d&_t.Host&&g===I);return null!==R?Dn(o,y,R,I):ds}function sr(s,o,u,c,d){const g=s.providerIndexes,y=o.data,I=1048575&g,C=s.directiveStart,R=g>>20,W=d?I+R:s.directiveEnd;for(let Y=c?I:I+R;Y<W;Y++){const we=y[Y];if(Y<C&&u===we||Y>=C&&we.type===u)return Y}if(d){const Y=y[C];if(Y&&Or(Y)&&Y.type===u)return C}return null}function Dn(s,o,u,c){let d=s[u];const g=o.data;if(function $r(s){return s instanceof ct}(d)){const y=d;y.resolving&&function Le(s,o){const u=o?`. Dependency path: ${o.join(" > ")} > ${s}`:"";throw new J(-200,`Circular dependency in DI detected for ${s}${u}`)}(function ye(s){return"function"==typeof s?s.name||s.toString():"object"==typeof s&&null!=s&&"function"==typeof s.type?s.type.name||s.type.toString():re(s)}(g[u]));const I=qa(y.canSeeViewProviders);y.resolving=!0;const C=y.injectImpl?jn(y.injectImpl):null;Vd(s,c,_t.Default);try{d=s[u]=y.factory(void 0,g,s,c),o.firstCreatePass&&u>=c.directiveStart&&function Vu(s,o,u){const{ngOnChanges:c,ngOnInit:d,ngDoCheck:g}=o.type.prototype;if(c){const y=am(o);(u.preOrderHooks??=[]).push(s,y),(u.preOrderCheckHooks??=[]).push(s,y)}d&&(u.preOrderHooks??=[]).push(0-s,d),g&&((u.preOrderHooks??=[]).push(s,g),(u.preOrderCheckHooks??=[]).push(s,g))}(u,g[u],o)}finally{null!==C&&jn(C),qa(I),y.resolving=!1,Lf()}}return d}function Tn(s,o,u){return!!(u[o+(s>>Wa)]&1<<s)}function Ti(s,o){return!(s&_t.Self||s&_t.Host&&o)}class or{constructor(o,u){this._tNode=o,this._lView=u}get(o,u,c){return ot(this._tNode,this._lView,o,B(c),u)}}function ar(){return new or(Kn(),Ie())}function ur(s){return Gt(()=>{const o=s.prototype.constructor,u=o[Cs]||zu(o),c=Object.prototype;let d=Object.getPrototypeOf(s.prototype).constructor;for(;d&&d!==c;){const g=d[Cs]||zu(d);if(g&&g!==u)return g;d=Object.getPrototypeOf(d)}return g=>new g})}function zu(s){return He(s)?()=>{const o=zu(Ne(s));return o&&o()}:yo(s)}function _m(s){const o=s[Ke],u=o.type;return 2===u?o.declTNode:1===u?s[Br]:null}function hs(s){return function Me(s,o){if("class"===o)return s.classes;if("style"===o)return s.styles;const u=s.attrs;if(u){const c=u.length;let d=0;for(;d<c;){const g=u[d];if(tr(g))break;if(0===g)d+=2;else if("number"==typeof g)for(d++;d<c&&"string"==typeof u[d];)d++;else{if(g===o)return u[d+1];d+=2}}}return null}(Kn(),s)}const _r="__parameters__";function na(s,o,u){return Gt(()=>{const c=function ks(s){return function(...u){if(s){const c=s(...u);for(const d in c)this[d]=c[d]}}}(o);function d(...g){if(this instanceof d)return c.apply(this,g),this;const y=new d(...g);return I.annotation=y,I;function I(C,S,R){const L=C.hasOwnProperty(_r)?C[_r]:Object.defineProperty(C,_r,{value:[]})[_r];for(;L.length<=R;)L.push(null);return(L[R]=L[R]||[]).push(y),C}}return u&&(d.prototype=Object.create(u.prototype)),d.prototype.ngMetadataName=s,d.annotationCls=d,d})}function ic(s,o){s.forEach(u=>Array.isArray(u)?ic(u,o):o(u))}function Bf(s,o,u){o>=s.length?s.push(u):s.splice(o,0,u)}function Zu(s,o){return o>=s.length-1?s.pop():s.splice(o,1)[0]}function br(s,o,u){let c=Ki(s,o);return c>=0?s[1|c]=u:(c=~c,function Za(s,o,u,c){let d=s.length;if(d==o)s.push(u,c);else if(1===d)s.push(c,s[0]),s[0]=u;else{for(d--,s.push(s[d-1],s[d]);d>o;)s[d]=s[d-2],d--;s[o]=u,s[o+1]=c}}(s,c,o,u)),c}function Hf(s,o){const u=Ki(s,o);if(u>=0)return s[1|u]}function Ki(s,o){return function Yu(s,o,u){let c=0,d=s.length>>u;for(;d!==c;){const g=c+(d-c>>1),y=s[g<<u];if(o===y)return g<<u;y>o?d=g:c=g+1}return~(d<<u)}(s,o,1)}const oc=ve(na("Optional"),8),Kd=ve(na("SkipSelf"),4);function oa(s){return 128==(128&s.flags)}var eh=function(s){return s[s.Important=1]="Important",s[s.DashCase=2]="DashCase",s}(eh||{});const ep=new Map;let xo=0;const nh="__ngContext__";function Nn(s,o){Zn(o)?(s[nh]=o[Ds],function Vv(s){ep.set(s[Ds],s)}(o)):s[nh]=o}let m;function E(s,o){return m(s,o)}function N(s){const o=s[Rn];return Ir(o)?o[Rn]:o}function Be(s){return bt(s[Bi])}function Qe(s){return bt(s[di])}function bt(s){for(;null!==s&&!Ir(s);)s=s[di];return s}function ft(s,o,u,c,d){if(null!=c){let g,y=!1;Ir(c)?g=c:Zn(c)&&(y=!0,c=c[nr]);const I=Ut(c);0===s&&null!==u?null==d?Gv(o,u,I):dc(o,u,I,d||null,!0):1===s&&null!==u?dc(o,u,I,d||null,!0):2===s?function Um(s,o,u){const c=tu(s,o);c&&function YS(s,o,u,c){s.removeChild(o,u,c)}(s,c,o,u)}(o,I,y):3===s&&o.destroyNode(I),null!=g&&function XS(s,o,u,c,d){const g=u[ji];g!==Ut(u)&&ft(o,s,c,g,d);for(let I=ir;I<u.length;I++){const C=u[I];ch(C[Ke],C,s,o,c,g)}}(o,s,g,u,d)}}function cc(s,o,u){return s.createElement(o,u)}function oh(s,o){const u=s[Qs],c=u.indexOf(o);Pd(o),u.splice(c,1)}function ah(s,o){if(s.length<=ir)return;const u=ir+o,c=s[u];if(c){const d=c[xa];null!==d&&d!==s&&oh(d,c),o>0&&(s[u-1][di]=c[di]);const g=Zu(s,ir+o);!function km(s,o){ch(s,o,o[Et],2,null,null),o[nr]=null,o[Br]=null}(c[Ke],c);const y=g[jr];null!==y&&y.detachView(g[Ke]),c[Rn]=null,c[di]=null,c[Mt]&=-129}return c}function uh(s,o){if(!(256&o[Mt])){const u=o[Et];o[Na]?.destroy(),o[rr]?.destroy(),u.destroyNode&&ch(s,o,u,3,null,null),function Fm(s){let o=s[Bi];if(!o)return pi(s[Ke],s);for(;o;){let u=null;if(Zn(o))u=o[Bi];else{const c=o[ir];c&&(u=c)}if(!u){for(;o&&!o[di]&&o!==s;)Zn(o)&&pi(o[Ke],o),o=o[Rn];null===o&&(o=s),Zn(o)&&pi(o[Ke],o),u=o&&o[di]}o=u}}(o)}}function pi(s,o){if(!(256&o[Mt])){o[Mt]&=-129,o[Mt]|=256,function tp(s,o){let u;if(null!=s&&null!=(u=s.destroyHooks))for(let c=0;c<u.length;c+=2){const d=o[u[c]];if(!(d instanceof ct)){const g=u[c+1];if(Array.isArray(g))for(let y=0;y<g.length;y+=2){const I=d[g[y]],C=g[y+1];$i(4,I,C);try{C.call(I)}finally{$i(5,I,C)}}else{$i(4,d,g);try{g.call(d)}finally{$i(5,d,g)}}}}}(s,o),function $v(s,o){const u=s.cleanup,c=o[Ys];if(null!==u)for(let g=0;g<u.length-1;g+=2)if("string"==typeof u[g]){const y=u[g+3];y>=0?c[y]():c[-y].unsubscribe(),g+=2}else u[g].call(c[u[g+1]]);null!==c&&(o[Ys]=null);const d=o[Ts];if(null!==d){o[Ts]=null;for(let g=0;g<d.length;g++)(0,d[g])()}}(s,o),1===o[Ke].type&&o[Et].destroy();const u=o[xa];if(null!==u&&Ir(o[Rn])){u!==o[Rn]&&oh(u,o);const c=o[jr];null!==c&&c.detachView(s)}!function Nm(s){ep.delete(s[Ds])}(o)}}function GI(s,o,u){return function zI(s,o,u){let c=o;for(;null!==c&&40&c.type;)c=(o=c).parent;if(null===c)return u[nr];{const{componentOffset:d}=c;if(d>-1){const{encapsulation:g}=s.data[c.directiveStart+d];if(g===pn.None||g===pn.Emulated)return null}return Pr(c,u)}}(s,o.parent,u)}function dc(s,o,u,c,d){s.insertBefore(o,u,c,d)}function Gv(s,o,u){s.appendChild(o,u)}function np(s,o,u,c,d){null!==c?dc(s,o,u,c,d):Gv(s,o,u)}function tu(s,o){return s.parentNode(o)}let hc,$m,Gm,lh=function WI(s,o,u){return 40&s.type?Pr(s,u):null};function Vm(s,o,u,c){const d=GI(s,c,o),g=o[Et],I=function qI(s,o,u){return lh(s,o,u)}(c.parent||o[Br],c,o);if(null!=d)if(Array.isArray(u))for(let C=0;C<u.length;C++)np(g,d,u[C],I,!1);else np(g,d,u,I,!1);void 0!==hc&&hc(g,c,o,u,d)}function ip(s,o){if(null!==o){const u=o.type;if(3&u)return Pr(o,s);if(4&u)return zv(-1,s[o.index]);if(8&u){const c=o.child;if(null!==c)return ip(s,c);{const d=s[o.index];return Ir(d)?zv(-1,d):Ut(d)}}if(32&u)return E(o,s)()||Ut(s[o.index]);{const c=KI(s,o);return null!==c?Array.isArray(c)?c[0]:ip(N(s[bn]),c):ip(s,o.next)}}return null}function KI(s,o){return null!==o?s[bn][Br].projection[o.projection]:null}function zv(s,o){const u=ir+s+1;if(u<o.length){const c=o[u],d=c[Ke].firstChild;if(null!==d)return ip(c,d)}return o[ji]}function qv(s,o,u,c,d,g,y){for(;null!=u;){const I=c[u.index],C=u.type;if(y&&0===o&&(I&&Nn(Ut(I),c),u.flags|=2),32!=(32&u.flags))if(8&C)qv(s,o,u.child,c,d,g,!1),ft(o,s,d,I,g);else if(32&C){const S=E(u,c);let R;for(;R=S();)ft(o,s,d,R,g);ft(o,s,d,I,g)}else 16&C?fc(s,o,c,u,d,g):ft(o,s,d,I,g);u=y?u.projectionNext:u.next}}function ch(s,o,u,c,d,g){qv(u,c,s.firstChild,o,d,g,!1)}function fc(s,o,u,c,d,g){const y=u[bn],C=y[Br].projection[c.projection];if(Array.isArray(C))for(let S=0;S<C.length;S++)ft(o,s,d,C[S],g);else{let S=C;const R=y[Rn];oa(c)&&(S.flags|=128),qv(s,o,S,R,d,g,!0)}}function YI(s,o,u){""===u?s.removeAttribute(o,"class"):s.setAttribute(o,"class",u)}function QI(s,o,u){const{mergedAttrs:c,classes:d,styles:g}=u;null!==c&&Pl(s,o,c),null!==d&&YI(s,o,d),null!==g&&function eA(s,o,u){s.setAttribute(o,"style",u)}(s,o,g)}function hh(s){$m=s}function eC(s){return function Zv(){if(void 0===Gm&&(Gm=null,en.trustedTypes))try{Gm=en.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:s=>s,createScript:s=>s,createScriptURL:s=>s})}catch{}return Gm}()?.createScriptURL(s)||s}class qm{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ut})`}}function Po(s){return s instanceof qm?s.changingThisBreaksApplicationSecurity:s}function sp(s,o){const u=function oA(s){return s instanceof qm&&s.getTypeName()||null}(s);if(null!=u&&u!==o){if("ResourceURL"===u&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${u} (see ${ut})`)}return u===o}const cA=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var gh=function(s){return s[s.NONE=0]="NONE",s[s.HTML=1]="HTML",s[s.STYLE=2]="STYLE",s[s.SCRIPT=3]="SCRIPT",s[s.URL=4]="URL",s[s.RESOURCE_URL=5]="RESOURCE_URL",s}(gh||{});function Fs(s){const o=gc();return o?o.sanitize(gh.URL,s)||"":sp(s,"URL")?Po(s):function Kv(s){return(s=String(s)).match(cA)?s:"unsafe:"+s}(re(s))}function uC(s){const o=gc();if(o)return eC(o.sanitize(gh.RESOURCE_URL,s)||"");if(sp(s,"ResourceURL"))return eC(Po(s));throw new J(904,!1)}function EA(s,o,u){return function lC(s,o){return"src"===o&&("embed"===s||"frame"===s||"iframe"===s||"media"===s||"script"===s)||"href"===o&&("base"===s||"link"===s)?uC:Fs}(o,u)(s)}function gc(){const s=Ie();return s&&s[ss].sanitizer}class gn{constructor(o,u){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=Ct({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Xm=new gn("ENVIRONMENT_INITIALIZER"),Qv=new gn("INJECTOR",-1),aa=new gn("INJECTOR_DEF_TYPES");class cC{get(o,u=is){if(u===is){const c=new Error(`NullInjectorError: No provider for ${X(o)}!`);throw c.name="NullInjectorError",c}return u}}function fP(...s){return{\u0275providers:CA(0,s),\u0275fromNgModule:!0}}function CA(s,...o){const u=[],c=new Set;let d;return ic(o,g=>{const y=g;Jm(y,u,[],c)&&(d||=[],d.push(y))}),void 0!==d&&Xv(d,u),u}function Xv(s,o){for(let u=0;u<s.length;u++){const{providers:d}=s[u];Jv(d,g=>{o.push(g)})}}function Jm(s,o,u,c){if(!(s=Ne(s)))return!1;let d=null,g=Yr(s);const y=!g&&Nt(s);if(g||y){if(y&&!y.standalone)return!1;d=s}else{const C=s.ngModule;if(g=Yr(C),!g)return!1;d=C}const I=c.has(d);if(y){if(I)return!1;if(c.add(d),y.dependencies){const C="function"==typeof y.dependencies?y.dependencies():y.dependencies;for(const S of C)Jm(S,o,u,c)}}else{if(!g)return!1;{if(null!=g.imports&&!I){let S;c.add(d);try{ic(g.imports,R=>{Jm(R,o,u,c)&&(S||=[],S.push(R))})}finally{}void 0!==S&&Xv(S,o)}if(!I){const S=yo(d)||(()=>new d);o.push({provide:d,useFactory:S,deps:Je},{provide:aa,useValue:d,multi:!0},{provide:Xm,useValue:()=>mt(d),multi:!0})}const C=g.providers;null==C||I||Jv(C,R=>{o.push(R)})}}return d!==s&&void 0!==s.providers}function Jv(s,o){for(let u of s)xe(u)&&(u=u.\u0275providers),Array.isArray(u)?Jv(u,o):o(u)}const bA=U({provide:String,useValue:U});function hC(s){return null!==s&&"object"==typeof s&&bA in s}function mh(s){return"function"==typeof s}const pC=new gn("Set Injector scope."),e_={},gP={};let t_;function n_(){return void 0===t_&&(t_=new cC),t_}class mc{}class r_ extends mc{get destroyed(){return this._destroyed}constructor(o,u,c,d){super(),this.parent=u,this.source=c,this.scopes=d,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,_C(o,y=>this.processProvider(y)),this.records.set(Qv,_h(void 0,this)),d.has("environment")&&this.records.set(mc,_h(void 0,this));const g=this.records.get(pC);null!=g&&"string"==typeof g.value&&this.scopes.add(g.value),this.injectorDefTypes=new Set(this.get(aa.multi,Je,_t.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const u of this._ngOnDestroyHooks)u.ngOnDestroy();const o=this._onDestroyHooks;this._onDestroyHooks=[];for(const u of o)u()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(o){return this.assertNotDestroyed(),this._onDestroyHooks.push(o),()=>this.removeOnDestroy(o)}runInContext(o){this.assertNotDestroyed();const u=ze(this),c=jn(void 0);try{return o()}finally{ze(u),jn(c)}}get(o,u=is,c=_t.Default){if(this.assertNotDestroyed(),o.hasOwnProperty(po))return o[po](this);c=B(c);const d=ze(this),g=jn(void 0);try{if(!(c&_t.SkipSelf)){let I=this.records.get(o);if(void 0===I){const C=function mP(s){return"function"==typeof s||"object"==typeof s&&s instanceof gn}(o)&&pr(o);I=C&&this.injectableDefInScope(C)?_h(tw(o),e_):null,this.records.set(o,I)}if(null!=I)return this.hydrate(o,I)}return(c&_t.Self?n_():this.parent).get(o,u=c&_t.Optional&&u===is?null:u)}catch(y){if("NullInjectorError"===y.name){if((y[oi]=y[oi]||[]).unshift(X(o)),d)throw y;return function it(s,o,u,c){const d=s[oi];throw o[qs]&&d.unshift(o[qs]),s.message=function Rt(s,o,u,c=null){s=s&&"\n"===s.charAt(0)&&"\u0275"==s.charAt(1)?s.slice(2):s;let d=X(o);if(Array.isArray(o))d=o.map(X).join(" -> ");else if("object"==typeof o){let g=[];for(let y in o)if(o.hasOwnProperty(y)){let I=o[y];g.push(y+":"+("string"==typeof I?JSON.stringify(I):X(I)))}d=`{${g.join(", ")}}`}return`${u}${c?"("+c+")":""}[${d}]: ${s.replace(yu,"\n  ")}`}("\n"+s.message,d,u,c),s.ngTokenPath=d,s[oi]=null,s}(y,o,"R3InjectorError",this.source)}throw y}finally{jn(g),ze(d)}}resolveInjectorInitializers(){const o=ze(this),u=jn(void 0);try{const c=this.get(Xm.multi,Je,_t.Self);for(const d of c)d()}finally{ze(o),jn(u)}}toString(){const o=[],u=this.records;for(const c of u.keys())o.push(X(c));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new J(205,!1)}processProvider(o){let u=mh(o=Ne(o))?o:Ne(o&&o.provide);const c=function TA(s){return hC(s)?_h(void 0,s.useValue):_h(gC(s),e_)}(o);if(mh(o)||!0!==o.multi)this.records.get(u);else{let d=this.records.get(u);d||(d=_h(void 0,e_,!0),d.factory=()=>Z(d.multi),this.records.set(u,d)),u=o,d.multi.push(o)}this.records.set(u,c)}hydrate(o,u){return u.value===e_&&(u.value=gP,u.value=u.factory()),"object"==typeof u.value&&u.value&&function SA(s){return null!==s&&"object"==typeof s&&"function"==typeof s.ngOnDestroy}(u.value)&&this._ngOnDestroyHooks.add(u.value),u.value}injectableDefInScope(o){if(!o.providedIn)return!1;const u=Ne(o.providedIn);return"string"==typeof u?"any"===u||this.scopes.has(u):this.injectorDefTypes.has(u)}removeOnDestroy(o){const u=this._onDestroyHooks.indexOf(o);-1!==u&&this._onDestroyHooks.splice(u,1)}}function tw(s){const o=pr(s),u=null!==o?o.factory:yo(s);if(null!==u)return u;if(s instanceof gn)throw new J(204,!1);if(s instanceof Function)return function DA(s){const o=s.length;if(o>0)throw function Ku(s,o){const u=[];for(let c=0;c<s;c++)u.push(o);return u}(o,"?"),new J(204,!1);const u=function si(s){return s&&(s[Qr]||s[wi])||null}(s);return null!==u?()=>u.factory(s):()=>new s}(s);throw new J(204,!1)}function gC(s,o,u){let c;if(mh(s)){const d=Ne(s);return yo(d)||tw(d)}if(hC(s))c=()=>Ne(s.useValue);else if(function fC(s){return!(!s||!s.useFactory)}(s))c=()=>s.useFactory(...Z(s.deps||[]));else if(function ew(s){return!(!s||!s.useExisting)}(s))c=()=>mt(Ne(s.useExisting));else{const d=Ne(s&&(s.useClass||s.provide));if(!function mC(s){return!!s.deps}(s))return yo(d)||tw(d);c=()=>new d(...Z(s.deps))}return c}function _h(s,o,u=!1){return{factory:s,value:o,multi:u?[]:void 0}}function _C(s,o){for(const u of s)Array.isArray(u)?_C(u,o):u&&xe(u)?_C(u.\u0275providers,o):o(u)}const AA=new gn("AppId",{providedIn:"root",factory:()=>_P}),_P="ng",MA=new gn("Platform Initializer"),yC=new gn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),xA=new gn("CSP nonce",{providedIn:"root",factory:()=>function fh(){if(void 0!==$m)return $m;if(typeof document<"u")return document;throw new J(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let kA=(s,o)=>null;function FA(s,o){return kA(s,o)}class VA{}class cp{}class UA{resolveComponentFactory(o){throw function uw(s){const o=Error(`No component factory found for ${X(s)}.`);return o.ngComponent=s,o}(o)}}let dp=(()=>{class s{}return s.NULL=new UA,s})();function BA(){return vh(Kn(),Ie())}function vh(s,o){return new hp(Pr(s,o))}let hp=(()=>{class s{constructor(u){this.nativeElement=u}}return s.__NG_ELEMENT_ID__=BA,s})();function jA(s){return s instanceof hp?s.nativeElement:s}class Ai{}let a_=(()=>{class s{constructor(){this.destroyNode=null}}return s.__NG_ELEMENT_ID__=()=>function bC(){const s=Ie(),u=gr(Kn().index,s);return(Zn(u)?u:s)[Et]}(),s})(),lw=(()=>{class s{}return s.\u0275prov=Ct({token:s,providedIn:"root",factory:()=>null}),s})();class fp{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const u_=new fp("16.1.8"),pp={};function gp(s){for(;s;){s[Mt]|=64;const o=N(s);if(Fn(s)&&!o)return s;s=o}return null}function cw(s){return s.ngOriginalError}class wh{constructor(){this._console=console}handleError(o){const u=this._findOriginalError(o);this._console.error("ERROR",o),u&&this._console.error("ORIGINAL ERROR",u)}_findOriginalError(o){let u=o&&cw(o);for(;u&&cw(u);)u=cw(u);return u||null}}const mp=new gn("",{providedIn:"root",factory:()=>!1});function Fo(s){return s instanceof Function?s():s}class fw extends Js{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(o){this._lView=o}onConsumerDependencyMayHaveChanged(){gp(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(o,u,c){const d=Vn(this);this.trackingVersion++;try{o(u,c)}finally{Vn(d)}}destroy(){this.trackingVersion++}}let Eh=null;function RC(){return Eh??=new fw,Eh}function NC(s,o){return s[o]??RC()}function OC(s,o){const u=RC();u.hasReadASignal&&(s[o]=Eh,u.lView=s,Eh=new fw)}const Ot={};function h_(s){f_(Ht(),Ie(),Hr()+s,!1)}function f_(s,o,u,c){if(!c)if(3==(3&o[Mt])){const g=s.preOrderCheckHooks;null!==g&&Ga(o,g,u)}else{const g=s.preOrderHooks;null!==g&&tc(o,g,0,u)}So(u)}function UC(s,o=null,u=null,c){const d=BC(s,o,u,c);return d.resolveInjectorInitializers(),d}function BC(s,o=null,u=null,c,d=new Set){const g=[u||Je,fP(s)];return c=c||("object"==typeof s?void 0:X(s)),new r_(g,o||n_(),c||null,d)}let rl=(()=>{class s{static create(u,c){if(Array.isArray(u))return UC({name:""},c,u,"");{const d=u.name??"";return UC({name:d},u.parent,u.providers,d)}}}return s.THROW_IF_NOT_FOUND=is,s.NULL=new cC,s.\u0275prov=Ct({token:s,providedIn:"any",factory:()=>mt(Qv)}),s.__NG_ELEMENT_ID__=-1,s})();function Ch(s,o=_t.Default){const u=Ie();return null===u?mt(s,o):ot(Kn(),u,Ne(s),o)}function _p(){throw new Error("invalid")}function yp(s,o,u,c,d,g,y,I,C,S,R){const L=o.blueprint.slice();return L[nr]=d,L[Mt]=140|c,(null!==S||s&&2048&s[Mt])&&(L[Mt]|=2048),Xr(L),L[Rn]=L[os]=s,L[vn]=u,L[ss]=y||s&&s[ss],L[Et]=I||s&&s[Et],L[go]=C||s&&s[go]||null,L[Br]=g,L[Ds]=function Lv(){return xo++}(),L[Ci]=R,L[hi]=S,L[bn]=2==o.type?s[bn]:L,L}function il(s,o,u,c,d){let g=s.data[o];if(null===g)g=function gw(s,o,u,c,d){const g=Pu(),y=ku(),C=s.data[o]=function $C(s,o,u,c,d,g){let y=o?o.injectorIndex:-1,I=0;return function Io(){return null!==It.skipHydrationRootTNode}()&&(I|=128),{type:u,index:c,insertBeforeIndex:null,injectorIndex:y,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:I,providerIndexes:0,value:d,attrs:g,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,y?g:g&&g.parent,u,o,c,d);return null===s.firstChild&&(s.firstChild=C),null!==g&&(y?null==g.child&&null!==C.parent&&(g.child=C):null===g.next&&(g.next=C,C.prev=g)),C}(s,o,u,c,d),function ea(){return It.lFrame.inI18n}()&&(g.flags|=32);else if(64&g.type){g.type=u,g.value=c,g.attrs=d;const y=function bo(){const s=It.lFrame,o=s.currentTNode;return s.isParent?o:o.parent}();g.injectorIndex=null===y?-1:y.injectorIndex}return fi(g,!0),g}function vp(s,o,u,c){if(0===u)return-1;const d=o.length;for(let g=0;g<u;g++)o.push(c),s.blueprint.push(c),s.data.push(null);return d}function HC(s,o,u,c,d){const g=NC(o,Na),y=Hr(),I=2&c;try{if(So(-1),I&&o.length>zt&&f_(s,o,zt,!1),$i(I?2:0,d),I)g.runInContext(u,c,d);else{const S=Vn(null);try{u(c,d)}finally{Vn(S)}}}finally{I&&null===o[Na]&&OC(o,Na),So(y),$i(I?3:1,d)}}function p_(s,o,u){if(Iu(o)){const c=Vn(null);try{const g=o.directiveEnd;for(let y=o.directiveStart;y<g;y++){const I=s.data[y];I.contentQueries&&I.contentQueries(1,u[y],y)}}finally{Vn(c)}}}function g_(s,o,u){Ua()&&(function RP(s,o,u,c){const d=u.directiveStart,g=u.directiveEnd;Hi(u)&&function Ew(s,o,u){const c=Pr(o,s),d=mw(u);let y=16;u.signals?y=4096:u.onPush&&(y=64);const I=E_(s,yp(s,d,null,y,c,o,null,s[ss].rendererFactory.createRenderer(c,u),null,null,null));s[o.index]=I}(o,u,s.data[d+u.componentOffset]),s.firstCreatePass||T(u,o),Nn(c,o);const y=u.initialInputs;for(let I=d;I<g;I++){const C=s.data[I],S=Dn(o,s,I,u);Nn(S,o),null!==y&&Iw(0,I-d,S,C,0,y),Or(C)&&(gr(u.index,o)[vn]=Dn(o,s,I,u))}}(s,o,u,Pr(u,o)),64==(64&u.flags)&&WC(s,o,u))}function m_(s,o,u=Pr){const c=o.localNames;if(null!==c){let d=o.index+1;for(let g=0;g<c.length;g+=2){const y=c[g+1],I=-1===y?u(o,s):s[y];s[d++]=I}}}function mw(s){const o=s.tView;return null===o||o.incompleteFirstPass?s.tView=__(1,null,s.template,s.decls,s.vars,s.directiveDefs,s.pipeDefs,s.viewQuery,s.schemas,s.consts,s.id):o}function __(s,o,u,c,d,g,y,I,C,S,R){const L=zt+c,W=L+d,Y=function DP(s,o){const u=[];for(let c=0;c<o;c++)u.push(c<s?null:Ot);return u}(L,W),we="function"==typeof S?S():S;return Y[Ke]={type:s,blueprint:Y,template:u,queries:null,viewQuery:I,declTNode:o,data:Y.slice().fill(null,L),bindingStartIndex:L,expandoStartIndex:W,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof g?g():g,pipeRegistry:"function"==typeof y?y():y,firstChild:null,schemas:C,consts:we,incompleteFirstPass:!1,ssrId:R}}let XA=s=>null;function GC(s,o,u,c){for(let d in s)if(s.hasOwnProperty(d)){u=null===u?{}:u;const g=s[d];null===c?yw(u,o,d,g):c.hasOwnProperty(d)&&yw(u,o,c[d],g)}return u}function yw(s,o,u,c){s.hasOwnProperty(u)?s[u].push(o,c):s[u]=[o,c]}function zC(s,o,u,c){if(Ua()){const d=null===c?null:{"":-1},g=function OP(s,o){const u=s.directiveRegistry;let c=null,d=null;if(u)for(let g=0;g<u.length;g++){const y=u[g];if(Ta(o,y.selectors,!1))if(c||(c=[]),Or(y))if(null!==y.findHostDirectiveDefs){const I=[];d=d||new Map,y.findHostDirectiveDefs(y,I,d),c.unshift(...I,y),ZC(s,o,I.length)}else c.unshift(y),ZC(s,o,0);else d=d||new Map,y.findHostDirectiveDefs?.(y,c,d),c.push(y)}return null===c?null:[c,d]}(s,u);let y,I;null===g?y=I=null:[y,I]=g,null!==y&&qC(s,o,u,y,d,I),d&&function PP(s,o,u){if(o){const c=s.localNames=[];for(let d=0;d<o.length;d+=2){const g=u[o[d+1]];if(null==g)throw new J(-301,!1);c.push(o[d],g)}}}(u,c,d)}u.mergedAttrs=Ws(u.mergedAttrs,u.attrs)}function qC(s,o,u,c,d,g){for(let S=0;S<c.length;S++)ne(T(u,o),s,c[S].type);!function y_(s,o,u){s.flags|=1,s.directiveStart=o,s.directiveEnd=o+u,s.providerIndexes=o}(u,s.data.length,c.length);for(let S=0;S<c.length;S++){const R=c[S];R.providersResolver&&R.providersResolver(R)}let y=!1,I=!1,C=vp(s,o,c.length,null);for(let S=0;S<c.length;S++){const R=c[S];u.mergedAttrs=Ws(u.mergedAttrs,R.hostAttrs),tM(s,u,o,C,R),kP(C,R,d),null!==R.contentQueries&&(u.flags|=4),(null!==R.hostBindings||null!==R.hostAttrs||0!==R.hostVars)&&(u.flags|=64);const L=R.type.prototype;!y&&(L.ngOnChanges||L.ngOnInit||L.ngDoCheck)&&((s.preOrderHooks??=[]).push(u.index),y=!0),!I&&(L.ngOnChanges||L.ngDoCheck)&&((s.preOrderCheckHooks??=[]).push(u.index),I=!0),C++}!function vw(s,o,u){const d=o.directiveEnd,g=s.data,y=o.attrs,I=[];let C=null,S=null;for(let R=o.directiveStart;R<d;R++){const L=g[R],W=u?u.get(L):null,we=W?W.outputs:null;C=GC(L.inputs,R,C,W?W.inputs:null),S=GC(L.outputs,R,S,we);const ke=null===C||null===y||Fl(o)?null:Cw(C,R,y);I.push(ke)}null!==C&&(C.hasOwnProperty("class")&&(o.flags|=8),C.hasOwnProperty("style")&&(o.flags|=16)),o.initialInputs=I,o.inputs=C,o.outputs=S}(s,u,g)}function WC(s,o,u){const c=u.directiveStart,d=u.directiveEnd,g=u.index,y=function xs(){return It.lFrame.currentDirectiveIndex}();try{So(g);for(let I=c;I<d;I++){const C=s.data[I],S=o[I];To(I),(null!==C.hostBindings||0!==C.hostVars||null!==C.hostAttrs)&&NP(C,S)}}finally{So(-1),To(y)}}function NP(s,o){null!==s.hostBindings&&s.hostBindings(1,o)}function ZC(s,o,u){o.componentOffset=u,(s.components??=[]).push(o.index)}function kP(s,o,u){if(u){if(o.exportAs)for(let c=0;c<o.exportAs.length;c++)u[o.exportAs[c]]=s;Or(o)&&(u[""]=s)}}function tM(s,o,u,c,d){s.data[c]=d;const g=d.factory||(d.factory=yo(d.type)),y=new ct(g,Or(d),Ch);s.blueprint[c]=y,u[c]=y,function eM(s,o,u,c,d){const g=d.hostBindings;if(g){let y=s.hostBindingOpCodes;null===y&&(y=s.hostBindingOpCodes=[]);const I=~o.index;(function xP(s){let o=s.length;for(;o>0;){const u=s[--o];if("number"==typeof u&&u<0)return u}return 0})(y)!=I&&y.push(I),y.push(u,c,g)}}(s,o,c,vp(s,u,d.hostVars,Ot),d)}function io(s,o,u,c,d,g){const y=Pr(s,o);!function Ep(s,o,u,c,d,g,y){if(null==g)s.removeAttribute(o,d,u);else{const I=null==y?re(g):y(g,c||"",d);s.setAttribute(o,d,I,u)}}(o[Et],y,g,s.value,u,c,d)}function Iw(s,o,u,c,d,g){const y=g[o];if(null!==y)for(let I=0;I<y.length;)v_(c,u,y[I++],y[I++],y[I++])}function v_(s,o,u,c,d){const g=Vn(null);try{const y=s.inputTransforms;null!==y&&y.hasOwnProperty(c)&&(d=y[c].call(o,d)),null!==s.setInput?s.setInput(o,d,u,c):o[c]=d}finally{Vn(g)}}function Cw(s,o,u){let c=null,d=0;for(;d<u.length;){const g=u[d];if(0!==g)if(5!==g){if("number"==typeof g)break;if(s.hasOwnProperty(g)){null===c&&(c=[]);const y=s[g];for(let I=0;I<y.length;I+=2)if(y[I]===o){c.push(g,y[I+1],u[d+1]);break}}d+=2}else d+=2;else d+=4}return c}function w_(s,o,u,c){return[s,!0,!1,o,null,0,c,u,null,null,null]}function wc(s,o){const u=s.contentQueries;if(null!==u)for(let c=0;c<u.length;c+=2){const g=u[c+1];if(-1!==g){const y=s.data[g];Lu(u[c]),y.contentQueries(2,o[g],g)}}}function E_(s,o){return s[Bi]?s[mo][di]=o:s[Bi]=o,s[mo]=o,o}function bw(s,o,u){Lu(0);const c=Vn(null);try{o(s,u)}finally{Vn(c)}}function sl(s){return s[Ys]||(s[Ys]=[])}function Lo(s){return s.cleanup||(s.cleanup=[])}function Dw(s,o){const u=s[go],c=u?u.get(wh,null):null;c&&c.handleError(o)}function Tw(s,o,u,c,d){for(let g=0;g<u.length;){const y=u[g++],I=u[g++];v_(s.data[y],o[y],c,I,d)}}function rM(s,o){const u=gr(o,s),c=u[Ke];!function Ec(s,o){for(let u=o.length;u<s.blueprint.length;u++)o.push(s.blueprint[u])}(c,u);const d=u[nr];null!==d&&null===u[Ci]&&(u[Ci]=FA(d,u[go])),ua(c,u,u[vn])}function ua(s,o,u){ec(o);try{const c=s.viewQuery;null!==c&&bw(1,c,u);const d=s.template;null!==d&&HC(s,o,d,1,u),s.firstCreatePass&&(s.firstCreatePass=!1),s.staticContentQueries&&wc(s,o),s.staticViewQueries&&bw(2,s.viewQuery,u);const g=s.components;null!==g&&function YC(s,o){for(let u=0;u<o.length;u++)rM(s,o[u])}(o,g)}catch(c){throw s.firstCreatePass&&(s.incompleteFirstPass=!0,s.firstCreatePass=!1),c}finally{o[Mt]&=-5,Vf()}}let iM=(()=>{class s{constructor(){this.all=new Set,this.queue=new Map}create(u,c,d){const g=typeof Zone>"u"?null:Zone.current,y=new om(u,S=>{this.all.has(S)&&this.queue.set(S,g)},d);let I;this.all.add(y),y.notify();const C=()=>{y.cleanup(),I?.(),this.all.delete(y),this.queue.delete(y)};return I=c?.onDestroy(C),{destroy:C}}flush(){if(0!==this.queue.size)for(const[u,c]of this.queue)this.queue.delete(u),c?c.run(()=>u.run()):u.run()}get isQueueEmpty(){return 0===this.queue.size}}return s.\u0275prov=Ct({token:s,providedIn:"root",factory:()=>new s}),s})();function Ip(s,o,u){let c=u?s.styles:null,d=u?s.classes:null,g=0;if(null!==o)for(let y=0;y<o.length;y++){const I=o[y];"number"==typeof I?g=I:1==g?d=Fe(d,I):2==g&&(c=Fe(c,I+": "+o[++y]+";"))}u?s.styles=c:s.stylesWithoutHost=c,u?s.classes=d:s.classesWithoutHost=d}function bh(s,o,u,c,d=!1){for(;null!==u;){const g=o[u.index];if(null!==g&&c.push(Ut(g)),Ir(g)){for(let I=ir;I<g.length;I++){const C=g[I],S=C[Ke].firstChild;null!==S&&bh(C[Ke],C,S,c)}g[ji]!==g[nr]&&c.push(g[ji])}const y=u.type;if(8&y)bh(s,o,u.child,c);else if(32&y){const I=E(u,o);let C;for(;C=I();)c.push(C)}else if(16&y){const I=KI(o,u);if(Array.isArray(I))c.push(...I);else{const C=N(o[bn]);bh(C[Ke],C,I,c,!0)}}u=d?u.projectionNext:u.next}return c}function Cp(s,o,u,c=!0){const d=o[ss].rendererFactory;d.begin&&d.begin();try{Sw(s,o,s.template,u)}catch(y){throw c&&Dw(o,y),y}finally{d.end&&d.end(),o[ss].effectManager?.flush()}}function Sw(s,o,u,c){const d=o[Mt];if(256!=(256&d)){o[ss].effectManager?.flush(),ec(o);try{Xr(o),function us(s){return It.lFrame.bindingIndex=s}(s.bindingStartIndex),null!==u&&HC(s,o,u,2,c);const y=3==(3&d);if(y){const S=s.preOrderCheckHooks;null!==S&&Ga(o,S,null)}else{const S=s.preOrderHooks;null!==S&&tc(o,S,0,null),Uu(o,0)}if(function I_(s){for(let o=Be(s);null!==o;o=Qe(o)){if(!o[Oa])continue;const u=o[Qs];for(let c=0;c<u.length;c++){Jo(u[c])}}}(o),Aw(o,2),null!==s.contentQueries&&wc(s,o),y){const S=s.contentCheckHooks;null!==S&&Ga(o,S)}else{const S=s.contentHooks;null!==S&&tc(o,S,1),Uu(o,1)}!function jC(s,o){const u=s.hostBindingOpCodes;if(null===u)return;const c=NC(o,rr);try{for(let d=0;d<u.length;d++){const g=u[d];if(g<0)So(~g);else{const y=g,I=u[++d],C=u[++d];Ff(I,y),c.runInContext(C,2,o[y])}}}finally{null===o[rr]&&OC(o,rr),So(-1)}}(s,o);const I=s.components;null!==I&&xw(o,I,0);const C=s.viewQuery;if(null!==C&&bw(2,C,c),y){const S=s.viewCheckHooks;null!==S&&Ga(o,S)}else{const S=s.viewHooks;null!==S&&tc(o,S,2),Uu(o,2)}!0===s.firstUpdatePass&&(s.firstUpdatePass=!1),o[Mt]&=-73,Pd(o)}finally{Vf()}}}function Aw(s,o){for(let u=Be(s);null!==u;u=Qe(u))for(let c=ir;c<u.length;c++)Mw(u[c],o)}function JC(s,o,u){Mw(gr(o,s),u)}function Mw(s,o){if(!function Pf(s){return 128==(128&s[Mt])}(s))return;const u=s[Ke];if(80&s[Mt]&&0===o||1024&s[Mt]||2===o)Sw(u,s,u.template,s[vn]);else if(s[Ui]>0){Aw(s,1);const d=s[Ke].components;null!==d&&xw(s,d,1)}}function xw(s,o,u){for(let c=0;c<o.length;c++)JC(s,o[c],u)}class Dh{get rootNodes(){const o=this._lView,u=o[Ke];return bh(u,o,u.firstChild,[])}constructor(o,u){this._lView=o,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[vn]}set context(o){this._lView[vn]=o}get destroyed(){return 256==(256&this._lView[Mt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[Rn];if(Ir(o)){const u=o[8],c=u?u.indexOf(this):-1;c>-1&&(ah(o,c),Zu(u,c))}this._attachedToViewContainer=!1}uh(this._lView[Ke],this._lView)}onDestroy(o){!function Va(s,o){if(256==(256&s[Mt]))throw new J(911,!1);null===s[Ts]&&(s[Ts]=[]),s[Ts].push(o)}(this._lView,o)}markForCheck(){gp(this._cdRefInjectingView||this._lView)}detach(){this._lView[Mt]&=-129}reattach(){this._lView[Mt]|=128}detectChanges(){Cp(this._lView[Ke],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new J(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function jv(s,o){ch(s,o,o[Et],2,null,null)}(this._lView[Ke],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new J(902,!1);this._appRef=o}}class oM extends Dh{constructor(o){super(o),this._view=o}detectChanges(){const o=this._view;Cp(o[Ke],o,o[vn],!1)}checkNoChanges(){}get context(){return null}}class Rw extends dp{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const u=Nt(o);return new Ic(u,this.ngModule)}}function Nw(s){const o=[];for(let u in s)s.hasOwnProperty(u)&&o.push({propName:s[u],templateName:u});return o}class eb{constructor(o,u){this.injector=o,this.parentInjector=u}get(o,u,c){c=B(c);const d=this.injector.get(o,pp,c);return d!==pp||u===pp?d:this.parentInjector.get(o,u,c)}}class Ic extends cp{get inputs(){const o=this.componentDef,u=o.inputTransforms,c=Nw(o.inputs);if(null!==u)for(const d of c)u.hasOwnProperty(d.propName)&&(d.transform=u[d.propName]);return c}get outputs(){return Nw(this.componentDef.outputs)}constructor(o,u){super(),this.componentDef=o,this.ngModule=u,this.componentType=o.type,this.selector=function fd(s){return s.map(Sa).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!u}create(o,u,c,d){let g=(d=d||this.ngModule)instanceof mc?d:d?.injector;g&&null!==this.componentDef.getStandaloneInjector&&(g=this.componentDef.getStandaloneInjector(g)||g);const y=g?new eb(o,g):o,I=y.get(Ai,null);if(null===I)throw new J(407,!1);const R={rendererFactory:I,sanitizer:y.get(lw,null),effectManager:y.get(iM,null)},L=I.createRenderer(null,this.componentDef),W=this.componentDef.selectors[0][0]||"div",Y=c?function QA(s,o,u,c){const g=c.get(mp,!1)||u===pn.ShadowDom,y=s.selectRootElement(o,g);return function TP(s){XA(s)}(y),y}(L,c,this.componentDef.encapsulation,y):cc(L,W,function Ow(s){const o=s.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(W)),qe=this.componentDef.signals?4608:this.componentDef.onPush?576:528,We=__(0,null,null,1,0,null,null,null,null,null,null),De=yp(null,We,null,qe,null,null,R,L,y,null,null);let xt,Qt;ec(De);try{const $t=this.componentDef;let vi,Ly=null;$t.findHostDirectiveDefs?(vi=[],Ly=new Map,$t.findHostDirectiveDefs($t,vi,Ly),vi.push($t)):vi=[$t];const AT=function nb(s,o){const u=s[Ke],c=zt;return s[c]=o,il(u,c,2,"#host",null)}(De,Y),Vy=function rb(s,o,u,c,d,g,y){const I=d[Ke];!function Pw(s,o,u,c){for(const d of s)o.mergedAttrs=Ws(o.mergedAttrs,d.hostAttrs);null!==o.mergedAttrs&&(Ip(o,o.mergedAttrs,!0),null!==u&&QI(c,u,o))}(c,s,o,y);let C=null;null!==o&&(C=FA(o,d[go]));const S=g.rendererFactory.createRenderer(o,u);let R=16;u.signals?R=4096:u.onPush&&(R=64);const L=yp(d,mw(u),null,R,d[s.index],s,g,S,null,null,C);return I.firstCreatePass&&ZC(I,s,c.length-1),E_(d,L),d[s.index]=L}(AT,Y,$t,vi,De,R,L);Qt=Xo(We,zt),Y&&function ib(s,o,u,c){if(c)Pl(s,u,["ng-version",u_.full]);else{const{attrs:d,classes:g}=function Aa(s){const o=[],u=[];let c=1,d=2;for(;c<s.length;){let g=s[c];if("string"==typeof g)2===d?""!==g&&o.push(g,s[++c]):8===d&&u.push(g);else{if(!ui(d))break;d=g}c++}return{attrs:o,classes:u}}(o.selectors[0]);d&&Pl(s,u,d),g&&g.length>0&&YI(s,u,g.join(" "))}}(L,$t,Y,c),void 0!==u&&function sb(s,o,u){const c=s.projection=[];for(let d=0;d<o.length;d++){const g=u[d];c.push(null!=g?Array.from(g):null)}}(Qt,this.ngContentSelectors,u),xt=function C_(s,o,u,c,d,g){const y=Kn(),I=d[Ke],C=Pr(y,d);qC(I,d,y,u,null,c);for(let R=0;R<u.length;R++)Nn(Dn(d,I,y.directiveStart+R,y),d);WC(I,d,y),C&&Nn(C,d);const S=Dn(d,I,y.directiveStart+y.componentOffset,y);if(s[vn]=d[vn]=S,null!==g)for(const R of g)R(S,o);return p_(I,y,s),S}(Vy,$t,vi,Ly,De,[ob]),ua(We,De,null)}finally{Vf()}return new tb(this.componentType,xt,vh(Qt,De),De,Qt)}}class tb extends VA{constructor(o,u,c,d,g){super(),this.location=c,this._rootLView=d,this._tNode=g,this.previousInputValues=null,this.instance=u,this.hostView=this.changeDetectorRef=new oM(d),this.componentType=o}setInput(o,u){const c=this._tNode.inputs;let d;if(null!==c&&(d=c[o])){if(this.previousInputValues??=new Map,this.previousInputValues.has(o)&&Object.is(this.previousInputValues.get(o),u))return;const g=this._rootLView;Tw(g[Ke],g,d,o,u),this.previousInputValues.set(o,u),gp(gr(this._tNode.index,g))}}get injector(){return new or(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function ob(){const s=Kn();ls(Ie()[Ke],s)}function la(s){let o=function xi(s){return Object.getPrototypeOf(s.prototype).constructor}(s.type),u=!0;const c=[s];for(;o;){let d;if(Or(s))d=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new J(903,!1);d=o.\u0275dir}if(d){if(u){c.push(d);const y=s;y.inputs=kw(s.inputs),y.inputTransforms=kw(s.inputTransforms),y.declaredInputs=kw(s.declaredInputs),y.outputs=kw(s.outputs);const I=d.hostBindings;I&&Fw(s,I);const C=d.viewQuery,S=d.contentQueries;if(C&&LP(s,C),S&&bp(s,S),G(s.inputs,d.inputs),G(s.declaredInputs,d.declaredInputs),G(s.outputs,d.outputs),null!==d.inputTransforms&&(null===y.inputTransforms&&(y.inputTransforms={}),G(y.inputTransforms,d.inputTransforms)),Or(d)&&d.data.animation){const R=s.data;R.animation=(R.animation||[]).concat(d.data.animation)}}const g=d.features;if(g)for(let y=0;y<g.length;y++){const I=g[y];I&&I.ngInherit&&I(s),I===la&&(u=!1)}}o=Object.getPrototypeOf(o)}!function ab(s){let o=0,u=null;for(let c=s.length-1;c>=0;c--){const d=s[c];d.hostVars=o+=d.hostVars,d.hostAttrs=Ws(d.hostAttrs,u=Ws(u,d.hostAttrs))}}(c)}function kw(s){return s===zn?{}:s===Je?[]:s}function LP(s,o){const u=s.viewQuery;s.viewQuery=u?(c,d)=>{o(c,d),u(c,d)}:o}function bp(s,o){const u=s.contentQueries;s.contentQueries=u?(c,d,g)=>{o(c,d,g),u(c,d,g)}:o}function Fw(s,o){const u=s.hostBindings;s.hostBindings=u?(c,d)=>{o(c,d),u(c,d)}:o}function cM(s){const o=s.inputConfig,u={};for(const c in o)if(o.hasOwnProperty(c)){const d=o[c];Array.isArray(d)&&d[2]&&(u[c]=d[2])}s.inputTransforms=u}function Uw(s){return!!cb(s)&&(Array.isArray(s)||!(s instanceof Map)&&Symbol.iterator in s)}function cb(s){return null!==s&&("function"==typeof s||"object"==typeof s)}function Gr(s,o,u){return!Object.is(s[o],u)&&(s[o]=u,!0)}function Bw(s,o,u,c){const d=Ie();return Gr(d,Ms(),o)&&(Ht(),io(wn(),d,s,o,u,c)),Bw}function Ac(s,o,u,c,d,g,y,I){const C=Ie(),S=Ht(),R=s+zt,L=S.firstCreatePass?function wb(s,o,u,c,d,g,y,I,C){const S=o.consts,R=il(o,s,4,y||null,As(S,I));zC(o,u,R,As(S,C)),ls(o,R);const L=R.tView=__(2,R,c,d,g,o.directiveRegistry,o.pipeRegistry,null,o.schemas,S,null);return null!==o.queries&&(o.queries.template(o,R),L.queries=o.queries.embeddedTView(R)),R}(R,S,C,o,u,c,d,g,y):S.data[R];fi(L,!1);const W=A_(S,C,L,s);Hd()&&Vm(S,C,W,L),Nn(W,C),E_(C,C[R]=w_(W,C,W,L)),_o(L)&&g_(S,C,L),null!=y&&m_(C,L,I)}let A_=function Eb(s,o,u,c){return Ns(!0),o[Et].createComment("")};function Gw(s){return Ss(function cm(){return It.lFrame.contextLView}(),zt+s)}function zw(s,o,u){const c=Ie();return Gr(c,Ms(),o)&&function ro(s,o,u,c,d,g,y,I){const C=Pr(o,u);let R,S=o.inputs;!I&&null!=S&&(R=S[c])?(Tw(s,u,R,c,d),Hi(o)&&function ww(s,o){const u=gr(o,s);16&u[Mt]||(u[Mt]|=64)}(u,o.index)):3&o.type&&(c=function wp(s){return"class"===s?"className":"for"===s?"htmlFor":"formaction"===s?"formAction":"innerHtml"===s?"innerHTML":"readonly"===s?"readOnly":"tabindex"===s?"tabIndex":s}(c),d=null!=y?y(d,o.value||"",c):d,g.setProperty(C,c,d))}(Ht(),wn(),c,s,o,c[Et],u,!1),zw}function M_(s,o,u,c,d){const y=d?"class":"style";Tw(s,u,o.inputs[y],y,c)}function Fp(s,o,u,c){const d=Ie(),g=Ht(),y=zt+s,I=d[Et],C=g.firstCreatePass?function IM(s,o,u,c,d,g){const y=o.consts,C=il(o,s,2,c,As(y,d));return zC(o,u,C,As(y,g)),null!==C.attrs&&Ip(C,C.attrs,!1),null!==C.mergedAttrs&&Ip(C,C.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,C),C}(y,g,d,o,u,c):g.data[y],S=Ww(g,d,C,I,o,s);d[y]=S;const R=_o(C);return fi(C,!0),QI(I,S,C),32!=(32&C.flags)&&Hd()&&Vm(g,d,S,C),0===function Yl(){return It.lFrame.elementDepthCount}()&&Nn(S,d),function Ru(){It.lFrame.elementDepthCount++}(),R&&(g_(g,d,C),p_(g,C,d)),null!==c&&m_(d,C),Fp}function Lp(){let s=Kn();ku()?function ja(){It.lFrame.isParent=!1}():(s=s.parent,fi(s,!1));const o=s;(function Xl(s){return It.skipHydrationRootTNode===s})(o)&&function Fd(){It.skipHydrationRootTNode=null}(),function Ql(){It.lFrame.elementDepthCount--}();const u=Ht();return u.firstCreatePass&&(ls(u,s),Iu(s)&&u.queries.elementEnd(s)),null!=o.classesWithoutHost&&function nc(s){return 0!=(8&s.flags)}(o)&&M_(u,o,Ie(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function Hu(s){return 0!=(16&s.flags)}(o)&&M_(u,o,Ie(),o.stylesWithoutHost,!1),Lp}function qw(s,o,u,c){return Fp(s,o,u,c),Lp(),qw}let Ww=(s,o,u,c,d,g)=>(Ns(!0),cc(c,d,function Ha(){return It.lFrame.currentNamespace}()));function bb(){return Ie()}function R_(s){return!!s&&"function"==typeof s.then}function Db(s){return!!s&&"function"==typeof s.subscribe}function Up(s,o,u,c){const d=Ie(),g=Ht(),y=Kn();return function Qw(s,o,u,c,d,g,y){const I=_o(c),S=s.firstCreatePass&&Lo(s),R=o[vn],L=sl(o);let W=!0;if(3&c.type||y){const ke=Pr(c,o),qe=y?y(ke):ke,We=L.length,De=y?Qt=>y(Ut(Qt[c.index])):c.index;let xt=null;if(!y&&I&&(xt=function TM(s,o,u,c){const d=s.cleanup;if(null!=d)for(let g=0;g<d.length-1;g+=2){const y=d[g];if(y===u&&d[g+1]===c){const I=o[Ys],C=d[g+2];return I.length>C?I[C]:null}"string"==typeof y&&(g+=2)}return null}(s,o,d,c.index)),null!==xt)(xt.__ngLastListenerFn__||xt).__ngNextListenerFn__=g,xt.__ngLastListenerFn__=g,W=!1;else{g=SM(c,o,R,g,!1);const Qt=u.listen(qe,d,g);L.push(g,Qt),S&&S.push(d,De,We,We+1)}}else g=SM(c,o,R,g,!1);const Y=c.outputs;let we;if(W&&null!==Y&&(we=Y[d])){const ke=we.length;if(ke)for(let qe=0;qe<ke;qe+=2){const $t=o[we[qe]][we[qe+1]].subscribe(g),vi=L.length;L.push(g,$t),S&&S.push(d,c.index,vi,-(vi+1))}}}(g,d,d[Et],y,s,o,c),Up}function Sb(s,o,u,c){try{return $i(6,o,u),!1!==u(c)}catch(d){return Dw(s,d),!1}finally{$i(7,o,u)}}function SM(s,o,u,c,d){return function g(y){if(y===Function)return c;gp(s.componentOffset>-1?gr(s.index,o):o);let C=Sb(o,u,c,y),S=g.__ngNextListenerFn__;for(;S;)C=Sb(o,u,S,y)&&C,S=S.__ngNextListenerFn__;return d&&!1===C&&y.preventDefault(),C}}function N_(s=1){return function hm(s){return(It.lFrame.contextLView=function fm(s,o){for(;s>0;)o=o[os],s--;return o}(s,It.lFrame.contextLView))[vn]}(s)}function Bp(s,o){return s<<17|o<<2}function dl(s){return s>>17&32767}function P_(s){return 2|s}function Mc(s){return(131068&s)>>2}function k_(s,o){return-131069&s|o<<2}function kb(s){return 1|s}function RM(s,o,u,c,d){const g=s[u+1],y=null===o;let I=c?dl(g):Mc(g),C=!1;for(;0!==I&&(!1===C||y);){const R=s[I+1];KP(s[I],o)&&(C=!0,s[I+1]=c?kb(R):P_(R)),I=c?dl(R):Mc(R)}C&&(s[u+1]=c?P_(g):kb(g))}function KP(s,o){return null===s||null==o||(Array.isArray(s)?s[1]:s)===o||!(!Array.isArray(s)||"string"!=typeof o)&&Ki(s,o)>=0}function pt(s,o){return function Xi(s,o,u,c){const d=Ie(),g=Ht(),y=function zi(s){const o=It.lFrame,u=o.bindingIndex;return o.bindingIndex=o.bindingIndex+s,u}(2);g.firstUpdatePass&&function Ub(s,o,u,c){const d=s.data;if(null===d[u+1]){const g=d[Hr()],y=function V_(s,o){return o>=s.expandoStartIndex}(s,u);(function B_(s,o){return 0!=(s.flags&(o?8:16))})(g,c)&&null===o&&!y&&(o=!1),o=function OM(s,o,u,c){const d=function Ld(s){const o=It.lFrame.currentDirectiveIndex;return-1===o?null:s[o]}(s);let g=c?o.residualClasses:o.residualStyles;if(null===d)0===(c?o.classBindings:o.styleBindings)&&(u=ao(u=zr(null,s,o,u,c),o.attrs,c),g=null);else{const y=o.directiveStylingLast;if(-1===y||s[y]!==d)if(u=zr(d,s,o,u,c),null===g){let C=function PM(s,o,u){const c=u?o.classBindings:o.styleBindings;if(0!==Mc(c))return s[dl(c)]}(s,o,c);void 0!==C&&Array.isArray(C)&&(C=zr(null,s,o,C[1],c),C=ao(C,o.attrs,c),function Ri(s,o,u,c){s[dl(u?o.classBindings:o.styleBindings)]=c}(s,o,c,C))}else g=function U_(s,o,u){let c;const d=o.directiveEnd;for(let g=1+o.directiveStylingLast;g<d;g++)c=ao(c,s[g].hostAttrs,u);return ao(c,o.attrs,u)}(s,o,c)}return void 0!==g&&(c?o.residualClasses=g:o.residualStyles=g),u}(d,g,o,c),function xM(s,o,u,c,d,g){let y=g?o.classBindings:o.styleBindings,I=dl(y),C=Mc(y);s[c]=u;let R,S=!1;if(Array.isArray(u)?(R=u[1],(null===R||Ki(u,R)>0)&&(S=!0)):R=u,d)if(0!==C){const W=dl(s[I+1]);s[c+1]=Bp(W,I),0!==W&&(s[W+1]=k_(s[W+1],c)),s[I+1]=function MM(s,o){return 131071&s|o<<17}(s[I+1],c)}else s[c+1]=Bp(I,0),0!==I&&(s[I+1]=k_(s[I+1],c)),I=c;else s[c+1]=Bp(C,0),0===I?I=c:s[C+1]=k_(s[C+1],c),C=c;S&&(s[c+1]=P_(s[c+1])),RM(s,R,c,!0),RM(s,R,c,!1),function ZP(s,o,u,c,d){const g=d?s.residualClasses:s.residualStyles;null!=g&&"string"==typeof o&&Ki(g,o)>=0&&(u[c+1]=kb(u[c+1]))}(o,R,s,c,g),y=Bp(I,C),g?o.classBindings=y:o.styleBindings=y}(d,g,o,u,y,c)}}(g,s,y,c),o!==Ot&&Gr(d,y,o)&&function gi(s,o,u,c,d,g,y,I){if(!(3&o.type))return;const C=s.data,S=C[I+1],R=function qP(s){return 1==(1&s)}(S)?jb(C,o,u,d,Mc(S),y):void 0;xc(R)||(xc(g)||function Pb(s){return 2==(2&s)}(S)&&(g=jb(C,null,u,d,I,y)),function JS(s,o,u,c,d){if(o)d?s.addClass(u,c):s.removeClass(u,c);else{let g=-1===c.indexOf("-")?void 0:eh.DashCase;null==d?s.removeStyle(u,c,g):("string"==typeof d&&d.endsWith("!important")&&(d=d.slice(0,-10),g|=eh.Important),s.setStyle(u,c,d,g))}}(c,y,Mu(Hr(),u),d,g))}(g,g.data[Hr()],d,d[Et],s,d[y+1]=function Hb(s,o){return null==s||""===s||("string"==typeof o?s+=o:"object"==typeof s&&(s=X(Po(s)))),s}(o,u),c,y)}(s,o,null,!0),pt}function zr(s,o,u,c,d){let g=null;const y=u.directiveEnd;let I=u.directiveStylingLast;for(-1===I?I=u.directiveStart:I++;I<y&&(g=o[I],c=ao(c,g.hostAttrs,d),g!==s);)I++;return null!==s&&(u.directiveStylingLast=I),c}function ao(s,o,u){const c=u?1:2;let d=-1;if(null!==o)for(let g=0;g<o.length;g++){const y=o[g];"number"==typeof y?d=y:d===c&&(Array.isArray(s)||(s=void 0===s?[]:["",s]),br(s,y,!!u||o[++g]))}return void 0===s?null:s}function jb(s,o,u,c,d,g){const y=null===o;let I;for(;d>0;){const C=s[d],S=Array.isArray(C),R=S?C[1]:C,L=null===R;let W=u[d+1];W===Ot&&(W=L?Je:void 0);let Y=L?Hf(W,c):R===c?W:void 0;if(S&&!xc(Y)&&(Y=Hf(C,c)),xc(Y)&&(I=Y,y))return I;const we=s[d+1];d=y?dl(we):Mc(we)}if(null!==o){let C=g?o.residualClasses:o.residualStyles;null!=C&&(I=Hf(C,c))}return I}function xc(s){return void 0!==s}function jp(s,o=""){const u=Ie(),c=Ht(),d=s+zt,g=c.firstCreatePass?il(c,d,1,o,null):c.data[d],y=Uo(c,u,g,o,s);u[d]=y,Hd()&&Vm(c,u,y,g),fi(g,!1)}let Uo=(s,o,u,c,d)=>(Ns(!0),function $n(s,o){return s.createText(o)}(o[Et],c));function l0(s){return uu("",s,""),l0}function uu(s,o,u){const c=Ie(),d=function Th(s,o,u,c){return Gr(s,Ms(),u)?o+re(u)+c:Ot}(c,s,o,u);return d!==Ot&&function ru(s,o,u){const c=Mu(o,s);!function Qi(s,o,u){s.setValue(o,u)}(s[Et],c,u)}(c,Hr(),d),uu}const lu=void 0;var C0=["en",[["a","p"],["AM","PM"],lu],[["AM","PM"],lu,lu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],lu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],lu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",lu,"{1} 'at' {0}",lu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function I0(s){const u=Math.floor(Math.abs(s)),c=s.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===c?1:5}];let lr={};function Mh(s){const o=function GM(s){return s.toLowerCase().replace(/_/g,"-")}(s);let u=Xb(o);if(u)return u;const c=o.split("-")[0];if(u=Xb(c),u)return u;if("en"===c)return C0;throw new J(701,!1)}function Qb(s){return Mh(s)[xh.PluralCase]}function Xb(s){return s in lr||(lr[s]=en.ng&&en.ng.common&&en.ng.common.locales&&en.ng.common.locales[s]),lr[s]}var xh=function(s){return s[s.LocaleId=0]="LocaleId",s[s.DayPeriodsFormat=1]="DayPeriodsFormat",s[s.DayPeriodsStandalone=2]="DayPeriodsStandalone",s[s.DaysFormat=3]="DaysFormat",s[s.DaysStandalone=4]="DaysStandalone",s[s.MonthsFormat=5]="MonthsFormat",s[s.MonthsStandalone=6]="MonthsStandalone",s[s.Eras=7]="Eras",s[s.FirstDayOfWeek=8]="FirstDayOfWeek",s[s.WeekendRange=9]="WeekendRange",s[s.DateFormat=10]="DateFormat",s[s.TimeFormat=11]="TimeFormat",s[s.DateTimeFormat=12]="DateTimeFormat",s[s.NumberSymbols=13]="NumberSymbols",s[s.NumberFormats=14]="NumberFormats",s[s.CurrencyCode=15]="CurrencyCode",s[s.CurrencySymbol=16]="CurrencySymbol",s[s.CurrencyName=17]="CurrencyName",s[s.Currencies=18]="Currencies",s[s.Directionality=19]="Directionality",s[s.PluralCase=20]="PluralCase",s[s.ExtraData=21]="ExtraData",s}(xh||{});const Rh="en-US";let Q_=Rh;function Jp(s,o,u,c,d){if(s=Ne(s),Array.isArray(s))for(let g=0;g<s.length;g++)Jp(s[g],o,u,c,d);else{const g=Ht(),y=Ie();let I=mh(s)?s:Ne(s.provide),C=gC(s);const S=Kn(),R=1048575&S.providerIndexes,L=S.directiveStart,W=S.providerIndexes>>20;if(mh(s)||!s.multi){const Y=new ct(C,d,Ch),we=H0(I,o,d?R:R+W,L);-1===we?(ne(T(S,y),g,I),j0(g,s,o.length),o.push(I),S.directiveStart++,S.directiveEnd++,d&&(S.providerIndexes+=1048576),u.push(Y),y.push(Y)):(u[we]=Y,y[we]=Y)}else{const Y=H0(I,o,R+W,L),we=H0(I,o,R,R+W),qe=we>=0&&u[we];if(d&&!qe||!d&&!(Y>=0&&u[Y])){ne(T(S,y),g,I);const We=function $0(s,o,u,c,d){const g=new ct(s,u,Ch);return g.multi=[],g.index=o,g.componentProviders=0,yD(g,d,c&&!u),g}(d?eg:cy,u.length,d,c,C);!d&&qe&&(u[we].providerFactory=We),j0(g,s,o.length,0),o.push(I),S.directiveStart++,S.directiveEnd++,d&&(S.providerIndexes+=1048576),u.push(We),y.push(We)}else j0(g,s,Y>-1?Y:we,yD(u[d?we:Y],C,!d&&c));!d&&c&&qe&&u[we].componentProviders++}}}function j0(s,o,u,c){const d=mh(o),g=function pP(s){return!!s.useClass}(o);if(d||g){const C=(g?Ne(o.useClass):o).prototype.ngOnDestroy;if(C){const S=s.destroyHooks||(s.destroyHooks=[]);if(!d&&o.multi){const R=S.indexOf(u);-1===R?S.push(u,[c,C]):S[R+1].push(c,C)}else S.push(u,C)}}}function yD(s,o,u){return u&&s.componentProviders++,s.multi.push(o)-1}function H0(s,o,u,c){for(let d=u;d<c;d++)if(o[d]===s)return d;return-1}function cy(s,o,u,c){return Bh(this.multi,[])}function eg(s,o,u,c){const d=this.multi;let g;if(this.providerFactory){const y=this.providerFactory.componentProviders,I=Dn(u,u[Ke],this.providerFactory.index,c);g=I.slice(0,y),Bh(d,g);for(let C=y;C<I.length;C++)g.push(I[C])}else g=[],Bh(d,g);return g}function Bh(s,o){for(let u=0;u<s.length;u++)o.push((0,s[u])());return o}function G0(s,o=[]){return u=>{u.providersResolver=(c,d)=>function _D(s,o,u){const c=Ht();if(c.firstCreatePass){const d=Or(s);Jp(u,c.data,c.blueprint,d,!0),Jp(o,c.data,c.blueprint,d,!1)}}(c,d?d(s):s,o)}}class fa{}class jh{}function sx(s,o){return new dy(s,o??null,[])}class dy extends fa{constructor(o,u,c){super(),this._parent=u,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Rw(this);const d=li(o);this._bootstrapComponents=Fo(d.bootstrap),this._r3Injector=BC(o,u,[{provide:fa,useValue:this},{provide:dp,useValue:this.componentFactoryResolver},...c],X(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(o)}get injector(){return this._r3Injector}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class z0 extends jh{constructor(o){super(),this.moduleType=o}create(o){return new dy(this.moduleType,o,[])}}class vD extends fa{constructor(o){super(),this.componentFactoryResolver=new Rw(this),this.instance=null;const u=new r_([...o.providers,{provide:fa,useValue:this},{provide:dp,useValue:this.componentFactoryResolver}],o.parent||n_(),o.debugName,new Set(["environment"]));this.injector=u,o.runEnvironmentInitializers&&u.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function q0(s,o,u=null){return new vD({providers:s,parent:o,debugName:u,runEnvironmentInitializers:!0}).injector}let wD=(()=>{class s{constructor(u){this._injector=u,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(u){if(!u.standalone)return null;if(!this.cachedInjectors.has(u)){const c=CA(0,u.type),d=c.length>0?q0([c],this._injector,`Standalone[${u.type.name}]`):null;this.cachedInjectors.set(u,d)}return this.cachedInjectors.get(u)}ngOnDestroy(){try{for(const u of this.cachedInjectors.values())null!==u&&u.destroy()}finally{this.cachedInjectors.clear()}}}return s.\u0275prov=Ct({token:s,providedIn:"environment",factory:()=>new s(mt(mc))}),s})();function W0(s){s.getStandaloneInjector=o=>o.get(wD).getOrCreateStandaloneInjector(s)}function fy(s,o,u,c){return ig(Ie(),Cr(),s,o,u,c)}function ig(s,o,u,c,d,g){const y=o+u;return Gr(s,y,d)?function iu(s,o,u){return s[o]=u}(s,y+1,g?c.call(g,d):c(d)):function $h(s,o){const u=s[o];return u===Ot?void 0:u}(s,y+1)}function RD(s,o){const u=Ht();let c;const d=s+zt;u.firstCreatePass?(c=function lx(s,o){if(o)for(let u=o.length-1;u>=0;u--){const c=o[u];if(s===c.name)return c}}(o,u.pipeRegistry),u.data[d]=c,c.onDestroy&&(u.destroyHooks??=[]).push(d,c.onDestroy)):c=u.data[d];const g=c.factory||(c.factory=yo(c.type)),y=jn(Ch);try{const I=qa(!1),C=g();return qa(I),function zP(s,o,u,c){u>=s.data.length&&(s.data[u]=null,s.blueprint[u]=null),o[u]=c}(u,Ie(),d,C),C}finally{jn(y)}}function OD(s,o,u){const c=s+zt,d=Ie(),g=Ss(d,c);return function Gh(s,o){return s[Ke].data[o].pure}(d,c)?ig(d,Cr(),o,g.transform,u,g):g.transform(u)}function fl(s){return o=>{setTimeout(s,void 0,o)}}const _i=class ti extends f.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,u,c){let d=o,g=u||(()=>null),y=c;if(o&&"object"==typeof o){const C=o;d=C.next?.bind(C),g=C.error?.bind(C),y=C.complete?.bind(C)}this.__isAsync&&(g=fl(g),d&&(d=fl(d)),y&&(y=fl(y)));const I=super.subscribe({next:d,error:g,complete:y});return o instanceof Q.w0&&o.add(I),I}};function nE(){return this._results[Symbol.iterator]()}class rE{get changes(){return this._changes||(this._changes=new _i)}constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=rE.prototype;u[Symbol.iterator]||(u[Symbol.iterator]=nE)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,u){return this._results.reduce(o,u)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,u){const c=this;c.dirty=!1;const d=function Zi(s){return s.flat(Number.POSITIVE_INFINITY)}(o);(this._changesDetected=!function Im(s,o,u){if(s.length!==o.length)return!1;for(let c=0;c<s.length;c++){let d=s[c],g=o[c];if(u&&(d=u(d),g=u(g)),g!==d)return!1}return!0}(c._results,d,u))&&(c._results=d,c.length=d.length,c.last=d[this.length-1],c.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Pe=(()=>{class s{}return s.__NG_ELEMENT_ID__=iE,s})();const Sr=Pe,Lc=class extends Sr{constructor(o,u,c){super(),this._declarationLView=o,this._declarationTContainer=u,this.elementRef=c}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(o,u){return this.createEmbeddedViewImpl(o,u,null)}createEmbeddedViewImpl(o,u,c){const y=this._declarationTContainer.tView,I=yp(this._declarationLView,y,o,4096&this._declarationLView[Mt]?4096:16,null,y.declTNode,null,null,null,u||null,c||null);I[xa]=this._declarationLView[this._declarationTContainer.index];const S=this._declarationLView[jr];return null!==S&&(I[jr]=S.createEmbeddedView(y)),ua(y,I,o),new Dh(I)}};function iE(){return Xe(Kn(),Ie())}function Xe(s,o){return 4&s.type?new Lc(o,s,vh(s,o)):null}let my=(()=>{class s{}return s.__NG_ELEMENT_ID__=gx,s})();function gx(){return aE(Kn(),Ie())}const FD=my,LD=class extends FD{constructor(o,u,c){super(),this._lContainer=o,this._hostTNode=u,this._hostLView=c}get element(){return vh(this._hostTNode,this._hostLView)}get injector(){return new or(this._hostTNode,this._hostLView)}get parentInjector(){const o=K(this._hostTNode,this._hostLView);if(Tt(o)){const u=Ao(o,this._hostLView),c=$u(o);return new or(u[Ke].data[c+8],u)}return new or(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const u=mx(this._lContainer);return null!==u&&u[o]||null}get length(){return this._lContainer.length-ir}createEmbeddedView(o,u,c){let d,g;"number"==typeof c?d=c:null!=c&&(d=c.index,g=c.injector);const I=o.createEmbeddedViewImpl(u||{},g,null);return this.insertImpl(I,d,false),I}createComponent(o,u,c,d,g){const y=o&&!function Wu(s){return"function"==typeof s}(o);let I;if(y)I=u;else{const ke=u||{};I=ke.index,c=ke.injector,d=ke.projectableNodes,g=ke.environmentInjector||ke.ngModuleRef}const C=y?o:new Ic(Nt(o)),S=c||this.parentInjector;if(!g&&null==C.ngModule){const qe=(y?S:this.parentInjector).get(mc,null);qe&&(g=qe)}Nt(C.componentType??{});const Y=C.create(S,d,null,g);return this.insertImpl(Y.hostView,I,false),Y}insert(o,u){return this.insertImpl(o,u,!1)}insertImpl(o,u,c){const d=o._lView,g=d[Ke];if(function Kl(s){return Ir(s[Rn])}(d)){const C=this.indexOf(o);if(-1!==C)this.detach(C);else{const S=d[Rn],R=new LD(S,S[Br],S[Rn]);R.detach(R.indexOf(o))}}const y=this._adjustIndex(u),I=this._lContainer;if(function Lm(s,o,u,c){const d=ir+c,g=u.length;c>0&&(u[d-1][di]=o),c<g-ir?(o[di]=u[d],Bf(u,ir+c,o)):(u.push(o),o[di]=null),o[Rn]=u;const y=o[xa];null!==y&&u!==y&&function Hv(s,o){const u=s[Qs];o[bn]!==o[Rn][Rn][bn]&&(s[Oa]=!0),null===u?s[Qs]=[o]:u.push(o)}(y,o);const I=o[jr];null!==I&&I.insertView(s),o[Mt]|=128}(g,d,I,y),!c){const C=zv(y,I),S=d[Et],R=tu(S,I[ji]);null!==R&&function Bv(s,o,u,c,d,g){c[nr]=d,c[Br]=o,ch(s,c,u,1,d,g)}(g,I[Br],S,d,R,C)}return o.attachToViewContainerRef(),Bf(oE(I),y,o),o}move(o,u){return this.insert(o,u)}indexOf(o){const u=mx(this._lContainer);return null!==u?u.indexOf(o):-1}remove(o){const u=this._adjustIndex(o,-1),c=ah(this._lContainer,u);c&&(Zu(oE(this._lContainer),u),uh(c[Ke],c))}detach(o){const u=this._adjustIndex(o,-1),c=ah(this._lContainer,u);return c&&null!=Zu(oE(this._lContainer),u)?new Dh(c):null}_adjustIndex(o,u=0){return o??this.length+u}};function mx(s){return s[8]}function oE(s){return s[8]||(s[8]=[])}function aE(s,o){let u;const c=o[s.index];return Ir(c)?u=c:(u=w_(c,o,null,s),o[s.index]=u,E_(o,u)),Vc(u,o,s,c),new LD(u,s,o)}let Vc=function uE(s,o,u,c){if(s[ji])return;let d;d=8&u.type?Ut(c):function Ft(s,o){const u=s[Et],c=u.createComment(""),d=Pr(o,s);return dc(u,tu(u,d),c,function rp(s,o){return s.nextSibling(o)}(u,d),!1),c}(o,u),s[ji]=d};class Uc{constructor(o){this.queryList=o,this.matches=null}clone(){return new Uc(this.queryList)}setDirty(){this.queryList.setDirty()}}class an{constructor(o=[]){this.queries=o}createEmbeddedView(o){const u=o.queries;if(null!==u){const c=null!==o.contentQueries?o.contentQueries[0]:u.length,d=[];for(let g=0;g<c;g++){const y=u.getByIndex(g);d.push(this.queries[y.indexInDeclarationView].clone())}return new an(d)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let u=0;u<this.queries.length;u++)null!==yy(o,u).matches&&this.queries[u].setDirty()}}class VD{constructor(o,u,c=null){this.predicate=o,this.flags=u,this.read=c}}class Qn{constructor(o=[]){this.queries=o}elementStart(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(o,u)}elementEnd(o){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(o)}embeddedTView(o){let u=null;for(let c=0;c<this.length;c++){const d=null!==u?u.length:0,g=this.getByIndex(c).embeddedTView(o,d);g&&(g.indexInDeclarationView=c,null!==u?u.push(g):u=[g])}return null!==u?new Qn(u):null}template(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].template(o,u)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class Ge{constructor(o,u=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(o,u){this.isApplyingToNode(u)&&this.matchTNode(o,u)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,u){this.elementStart(o,u)}embeddedTView(o,u){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,u),new Ge(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let c=o.parent;for(;null!==c&&8&c.type&&c.index!==u;)c=c.parent;return u===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(o,u){const c=this.metadata.predicate;if(Array.isArray(c))for(let d=0;d<c.length;d++){const g=c[d];this.matchTNodeWithReadOption(o,u,_y(u,g)),this.matchTNodeWithReadOption(o,u,sr(u,o,g,!1,!1))}else c===Pe?4&u.type&&this.matchTNodeWithReadOption(o,u,-1):this.matchTNodeWithReadOption(o,u,sr(u,o,c,!1,!1))}matchTNodeWithReadOption(o,u,c){if(null!==c){const d=this.metadata.read;if(null!==d)if(d===hp||d===my||d===Pe&&4&u.type)this.addMatch(u.index,-2);else{const g=sr(u,o,d,!1,!1);null!==g&&this.addMatch(u.index,g)}else this.addMatch(u.index,c)}}addMatch(o,u){null===this.matches?this.matches=[o,u]:this.matches.push(o,u)}}function _y(s,o){const u=s.localNames;if(null!==u)for(let c=0;c<u.length;c+=2)if(u[c]===o)return u[c+1];return null}function Bc(s,o,u,c){return-1===u?function lE(s,o){return 11&s.type?vh(s,o):4&s.type?Xe(s,o):null}(o,s):-2===u?function _x(s,o,u){return u===hp?vh(o,s):u===Pe?Xe(o,s):u===my?aE(o,s):void 0}(s,o,c):Dn(s,s[Ke],u,o)}function sg(s,o,u,c){const d=o[jr].queries[c];if(null===d.matches){const g=s.data,y=u.matches,I=[];for(let C=0;C<y.length;C+=2){const S=y[C];I.push(S<0?null:Bc(o,g[S],y[C+1],u.metadata.read))}d.matches=I}return d.matches}function cE(s,o,u,c){const d=s.queries.getByIndex(u),g=d.matches;if(null!==g){const y=sg(s,o,d,u);for(let I=0;I<g.length;I+=2){const C=g[I];if(C>0)c.push(y[I/2]);else{const S=g[I+1],R=o[-C];for(let L=ir;L<R.length;L++){const W=R[L];W[xa]===W[Rn]&&cE(W[Ke],W,S,c)}if(null!==R[Qs]){const L=R[Qs];for(let W=0;W<L.length;W++){const Y=L[W];cE(Y[Ke],Y,S,c)}}}}}return c}function zh(s){const o=Ie(),u=Ht(),c=Jl();Lu(c+1);const d=yy(u,c);if(s.dirty&&function Od(s){return 4==(4&s[Mt])}(o)===(2==(2&d.metadata.flags))){if(null===d.matches)s.reset([]);else{const g=d.crossesNgTemplate?cE(u,o,c,[]):sg(u,o,d,c);s.reset(g,jA),s.notifyOnChanges()}return!0}return!1}function dE(s,o,u,c){const d=Ht();if(d.firstCreatePass){const g=Kn();(function pE(s,o,u){null===s.queries&&(s.queries=new Qn),s.queries.track(new Ge(o,u))})(d,new VD(o,u,c),g.index),function pl(s,o){const u=s.contentQueries||(s.contentQueries=[]);o!==(u.length?u[u.length-1]:-1)&&u.push(s.queries.length-1,o)}(d,s),2==(2&u)&&(d.staticContentQueries=!0)}!function fE(s,o,u){const c=new rE(4==(4&u));(function JA(s,o,u,c){const d=sl(o);d.push(u),s.firstCreatePass&&Lo(s).push(c,d.length-1)})(s,o,c,c.destroy),null===o[jr]&&(o[jr]=new an),o[jr].queries.push(new Uc(c))}(d,Ie(),u)}function ys(){return function hE(s,o){return s[jr].queries[o].queryList}(Ie(),Jl())}function yy(s,o){return s.queries.getByIndex(o)}function oe(s,o){return Xe(s,o)}function vy(s){return!!li(s)}const bE=new gn("Application Initializer");let by=(()=>{class s{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((u,c)=>{this.resolve=u,this.reject=c}),this.appInits=j(bE,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const u=[];for(const d of this.appInits){const g=d();if(R_(g))u.push(g);else if(Db(g)){const y=new Promise((I,C)=>{g.subscribe({complete:I,error:C})});u.push(y)}}const c=()=>{this.done=!0,this.resolve()};Promise.all(u).then(()=>{c()}).catch(d=>{this.reject(d)}),0===u.length&&c(),this.initialized=!0}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=Ct({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),DE=(()=>{class s{log(u){console.log(u)}warn(u){console.warn(u)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=Ct({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const Dy=new gn("LocaleId",{providedIn:"root",factory:()=>j(Dy,_t.Optional|_t.SkipSelf)||function Cx(){return typeof $localize<"u"&&$localize.locale||Rh}()}),bx=new gn("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});let XD=(()=>{class s{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new F.X(!1)}add(){this.hasPendingTasks.next(!0);const u=this.taskId++;return this.pendingTasks.add(u),u}remove(u){this.pendingTasks.delete(u),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=Ct({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();class Tx{constructor(o,u){this.ngModuleFactory=o,this.componentFactories=u}}let Kh=(()=>{class s{compileModuleSync(u){return new z0(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const c=this.compileModuleSync(u),g=Fo(li(u).declarations).reduce((y,I)=>{const C=Nt(I);return C&&y.push(new Ic(C)),y},[]);return new Tx(c,g)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=Ct({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function Ji(...s){}class Yt{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new _i(!1),this.onMicrotaskEmpty=new _i(!1),this.onStable=new _i(!1),this.onError=new _i(!1),typeof Zone>"u")throw new J(908,!1);Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!c&&u,d.shouldCoalesceRunChangeDetection=c,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function yi(){const s="function"==typeof en.requestAnimationFrame;let o=en[s?"requestAnimationFrame":"setTimeout"],u=en[s?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&o&&u){const c=o[Zone.__symbol__("OriginalDelegate")];c&&(o=c);const d=u[Zone.__symbol__("OriginalDelegate")];d&&(u=d)}return{nativeRequestAnimationFrame:o,nativeCancelAnimationFrame:u}}().nativeRequestAnimationFrame,function fg(s){const o=()=>{!function Zc(s){s.isCheckStableRunning||-1!==s.lastRequestAnimationFrameId||(s.lastRequestAnimationFrameId=s.nativeRequestAnimationFrame.call(en,()=>{s.fakeTopEventTask||(s.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{s.lastRequestAnimationFrameId=-1,Yh(s),s.isCheckStableRunning=!0,hg(s),s.isCheckStableRunning=!1},void 0,()=>{},()=>{})),s.fakeTopEventTask.invoke()}),Yh(s))}(s)};s._inner=s._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,c,d,g,y,I)=>{try{return pg(s),u.invokeTask(d,g,y,I)}finally{(s.shouldCoalesceEventChangeDetection&&"eventTask"===g.type||s.shouldCoalesceRunChangeDetection)&&o(),TE(s)}},onInvoke:(u,c,d,g,y,I,C)=>{try{return pg(s),u.invoke(d,g,y,I,C)}finally{s.shouldCoalesceRunChangeDetection&&o(),TE(s)}},onHasTask:(u,c,d,g)=>{u.hasTask(d,g),c===d&&("microTask"==g.change?(s._hasPendingMicrotasks=g.microTask,Yh(s),hg(s)):"macroTask"==g.change&&(s.hasPendingMacrotasks=g.macroTask))},onHandleError:(u,c,d,g)=>(u.handleError(d,g),s.runOutsideAngular(()=>s.onError.emit(g)),!1)})}(d)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Yt.isInAngularZone())throw new J(909,!1)}static assertNotInAngularZone(){if(Yt.isInAngularZone())throw new J(909,!1)}run(o,u,c){return this._inner.run(o,u,c)}runTask(o,u,c,d){const g=this._inner,y=g.scheduleEventTask("NgZoneEvent: "+d,o,xx,Ji,Ji);try{return g.runTask(y,u,c)}finally{g.cancelTask(y)}}runGuarded(o,u,c){return this._inner.runGuarded(o,u,c)}runOutsideAngular(o){return this._outer.run(o)}}const xx={};function hg(s){if(0==s._nesting&&!s.hasPendingMicrotasks&&!s.isStable)try{s._nesting++,s.onMicrotaskEmpty.emit(null)}finally{if(s._nesting--,!s.hasPendingMicrotasks)try{s.runOutsideAngular(()=>s.onStable.emit(null))}finally{s.isStable=!0}}}function Yh(s){s.hasPendingMicrotasks=!!(s._hasPendingMicrotasks||(s.shouldCoalesceEventChangeDetection||s.shouldCoalesceRunChangeDetection)&&-1!==s.lastRequestAnimationFrameId)}function pg(s){s._nesting++,s.isStable&&(s.isStable=!1,s.onUnstable.emit(null))}function TE(s){s._nesting--,hg(s)}class JD{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new _i,this.onMicrotaskEmpty=new _i,this.onStable=new _i,this.onError=new _i}run(o,u,c){return o.apply(u,c)}runGuarded(o,u,c){return o.apply(u,c)}runOutsideAngular(o){return o()}runTask(o,u,c,d){return o.apply(u,c)}}const ma=new gn("",{providedIn:"root",factory:SE});function SE(){const s=j(Yt);let o=!0;const u=new ee.y(d=>{o=s.isStable&&!s.hasPendingMacrotasks&&!s.hasPendingMicrotasks,s.runOutsideAngular(()=>{d.next(o),d.complete()})}),c=new ee.y(d=>{let g;s.runOutsideAngular(()=>{g=s.onStable.subscribe(()=>{Yt.assertNotInAngularZone(),queueMicrotask(()=>{!o&&!s.hasPendingMacrotasks&&!s.hasPendingMicrotasks&&(o=!0,d.next(!0))})})});const y=s.onUnstable.subscribe(()=>{Yt.assertInAngularZone(),o&&(o=!1,s.runOutsideAngular(()=>{d.next(!1)}))});return()=>{g.unsubscribe(),y.unsubscribe()}});return(0,te.T)(u,c.pipe((0,fe.B)()))}const Kc=new gn(""),AE=new gn("");let cu,ME=(()=>{class s{constructor(u,c,d){this._ngZone=u,this.registry=c,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,cu||(function xE(s){cu=s}(d),d.addToWindow(c)),this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Yt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(u)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,c,d){let g=-1;c&&c>0&&(g=setTimeout(()=>{this._callbacks=this._callbacks.filter(y=>y.timeoutId!==g),u(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:u,timeoutId:g,updateCb:d})}whenStable(u,c,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,c,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(u){this.registry.registerApplication(u,this)}unregisterApplication(u){this.registry.unregisterApplication(u)}findProviders(u,c,d){return[]}}return s.\u0275fac=function(u){return new(u||s)(mt(Yt),mt(gg),mt(AE))},s.\u0275prov=Ct({token:s,factory:s.\u0275fac}),s})(),gg=(()=>{class s{constructor(){this._applications=new Map}registerApplication(u,c){this._applications.set(u,c)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,c=!0){return cu?.findTestabilityInTree(this,u,c)??null}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=Ct({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})(),vr=null;const Sy=new gn("AllowMultipleToken"),Qh=new gn("PlatformDestroyListeners"),Yc=new gn("appBootstrapListener");class rT{constructor(o,u){this.name=o,this.token=u}}function mg(s,o,u=[]){const c=`Platform: ${o}`,d=new gn(c);return(g=[])=>{let y=wl();if(!y||y.injector.get(Sy,!1)){const I=[...u,...g,{provide:d,useValue:!0}];s?s(I):function Rx(s){if(vr&&!vr.get(Sy,!1))throw new J(400,!1);(function Ay(){!function Md(s){Ad=s}(()=>{throw new J(600,!1)})})(),vr=s;const o=s.get(El);(function RE(s){s.get(MA,null)?.forEach(u=>u())})(s)}(function sT(s=[],o){return rl.create({name:o,providers:[{provide:pC,useValue:"platform"},{provide:Qh,useValue:new Set([()=>vr=null])},...s]})}(I,c))}return function Ox(s){const o=wl();if(!o)throw new J(401,!1);return o}()}}function wl(){return vr?.get(El)??null}let El=(()=>{class s{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,c){const d=function Qc(s="zone.js",o){return"noop"===s?new JD:"zone.js"===s?new Yt(o):s}(c?.ngZone,function NE(s){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:s?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:s?.runCoalescing??!1}}({eventCoalescing:c?.ngZoneEventCoalescing,runCoalescing:c?.ngZoneRunCoalescing}));return d.run(()=>{const g=function ox(s,o,u){return new dy(s,o,u)}(u.moduleType,this.injector,function yg(s){return[{provide:Yt,useFactory:s},{provide:Xm,multi:!0,useFactory:()=>{const o=j(Xn,{optional:!0});return()=>o.initialize()}},{provide:oT,useFactory:kx},{provide:ma,useFactory:SE}]}(()=>d)),y=g.injector.get(wh,null);return d.runOutsideAngular(()=>{const I=d.onError.subscribe({next:C=>{y.handleError(C)}});g.onDestroy(()=>{_g(this._modules,g),I.unsubscribe()})}),function OE(s,o,u){try{const c=u();return R_(c)?c.catch(d=>{throw o.runOutsideAngular(()=>s.handleError(d)),d}):c}catch(c){throw o.runOutsideAngular(()=>s.handleError(c)),c}}(y,d,()=>{const I=g.injector.get(by);return I.runInitializers(),I.donePromise.then(()=>(function T0(s){rt(s,"Expected localeId to be defined"),"string"==typeof s&&(Q_=s.toLowerCase().replace(/_/g,"-"))}(g.injector.get(Dy,Rh)||Rh),this._moduleDoBootstrap(g),g))})})}bootstrapModule(u,c=[]){const d=Xc({},c);return function eT(s,o,u){const c=new z0(u);return Promise.resolve(c)}(0,0,u).then(g=>this.bootstrapModuleFactory(g,d))}_moduleDoBootstrap(u){const c=u.injector.get(Jc);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(d=>c.bootstrap(d));else{if(!u.instance.ngDoBootstrap)throw new J(-403,!1);u.instance.ngDoBootstrap(c)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new J(404,!1);this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const u=this._injector.get(Qh,null);u&&(u.forEach(c=>c()),u.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return s.\u0275fac=function(u){return new(u||s)(mt(rl))},s.\u0275prov=Ct({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();function Xc(s,o){return Array.isArray(o)?o.reduce(Xc,s):{...s,...o}}let Jc=(()=>{class s{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=j(oT),this.zoneIsStable=j(ma),this.componentTypes=[],this.components=[],this.isStable=j(XD).hasPendingTasks.pipe((0,Ce.w)(u=>u?(0,he.of)(!1):this.zoneIsStable),(0,ae.x)(),(0,fe.B)()),this._injector=j(mc)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(u,c){const d=u instanceof cp;if(!this._injector.get(by).done)throw!d&&Ks(u),new J(405,!1);let y;y=d?u:this._injector.get(dp).resolveComponentFactory(u),this.componentTypes.push(y.componentType);const I=function nT(s){return s.isBoundToModule}(y)?void 0:this._injector.get(fa),S=y.create(rl.NULL,[],c||y.selector,I),R=S.location.nativeElement,L=S.injector.get(Kc,null);return L?.registerApplication(R),S.onDestroy(()=>{this.detachView(S.hostView),_g(this.components,S),L?.unregisterApplication(R)}),this._loadComponent(S),S}tick(){if(this._runningTick)throw new J(101,!1);try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this.internalErrorHandler(u)}finally{this._runningTick=!1}}attachView(u){const c=u;this._views.push(c),c.attachToAppRef(this)}detachView(u){const c=u;_g(this._views,c),c.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u);const c=this._injector.get(Yc,[]);c.push(...this._bootstrapListeners),c.forEach(d=>d(u))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(u=>u()),this._views.slice().forEach(u=>u.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(u){return this._destroyListeners.push(u),()=>_g(this._destroyListeners,u)}destroy(){if(this._destroyed)throw new J(406,!1);const u=this._injector;u.destroy&&!u.destroyed&&u.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=Ct({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function _g(s,o){const u=s.indexOf(o);u>-1&&s.splice(u,1)}const oT=new gn("",{providedIn:"root",factory:()=>j(wh).handleError.bind(void 0)});function kx(){const s=j(Yt),o=j(wh);return u=>s.runOutsideAngular(()=>o.handleError(u))}let Xn=(()=>{class s{constructor(){this.zone=j(Yt),this.applicationRef=j(Jc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=Ct({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function Fx(){return!1}let du=(()=>{class s{}return s.__NG_ELEMENT_ID__=uT,s})();function uT(s){return function lT(s,o,u){if(Hi(s)&&!u){const c=gr(s.index,o);return new Dh(c,c)}return 47&s.type?new Dh(o[bn],o):null}(Kn(),Ie(),16==(16&s))}class Eg{constructor(){}supports(o){return Uw(o)}create(o){return new Cg(o)}}const Ig=(s,o)=>o;class Cg{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||Ig}forEachItem(o){let u;for(u=this._itHead;null!==u;u=u._next)o(u)}forEachOperation(o){let u=this._itHead,c=this._removalsHead,d=0,g=null;for(;u||c;){const y=!c||u&&u.currentIndex<LE(c,d,g)?u:c,I=LE(y,d,g),C=y.currentIndex;if(y===c)d--,c=c._nextRemoved;else if(u=u._next,null==y.previousIndex)d++;else{g||(g=[]);const S=I-d,R=C-d;if(S!=R){for(let W=0;W<S;W++){const Y=W<g.length?g[W]:g[W]=0,we=Y+W;R<=we&&we<S&&(g[W]=Y+1)}g[y.previousIndex]=R-S}}I!==C&&o(y,I,C)}}forEachPreviousItem(o){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachMovedItem(o){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}forEachIdentityChange(o){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)o(u)}diff(o){if(null==o&&(o=[]),!Uw(o))throw new J(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let d,g,y,u=this._itHead,c=!1;if(Array.isArray(o)){this.length=o.length;for(let I=0;I<this.length;I++)g=o[I],y=this._trackByFn(I,g),null!==u&&Object.is(u.trackById,y)?(c&&(u=this._verifyReinsertion(u,g,y,I)),Object.is(u.item,g)||this._addIdentityChange(u,g)):(u=this._mismatch(u,g,y,I),c=!0),u=u._next}else d=0,function lb(s,o){if(Array.isArray(s))for(let u=0;u<s.length;u++)o(s[u]);else{const u=s[Symbol.iterator]();let c;for(;!(c=u.next()).done;)o(c.value)}}(o,I=>{y=this._trackByFn(d,I),null!==u&&Object.is(u.trackById,y)?(c&&(u=this._verifyReinsertion(u,I,y,d)),Object.is(u.item,I)||this._addIdentityChange(u,I)):(u=this._mismatch(u,I,y,d),c=!0),u=u._next,d++}),this.length=d;return this._truncate(u),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,u,c,d){let g;return null===o?g=this._itTail:(g=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._reinsertAfter(o,g,d)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(c,d))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._moveAfter(o,g,d)):o=this._addAfter(new Oy(u,c),g,d),o}_verifyReinsertion(o,u,c,d){let g=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==g?o=this._reinsertAfter(g,o._prev,d):o.currentIndex!=d&&(o.currentIndex=d,this._addToMoves(o,d)),o}_truncate(o){for(;null!==o;){const u=o._next;this._addToRemovals(this._unlink(o)),o=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,u,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const d=o._prevRemoved,g=o._nextRemoved;return null===d?this._removalsHead=g:d._nextRemoved=g,null===g?this._removalsTail=d:g._prevRemoved=d,this._insertAfter(o,u,c),this._addToMoves(o,c),o}_moveAfter(o,u,c){return this._unlink(o),this._insertAfter(o,u,c),this._addToMoves(o,c),o}_addAfter(o,u,c){return this._insertAfter(o,u,c),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,u,c){const d=null===u?this._itHead:u._next;return o._next=d,o._prev=u,null===d?this._itTail=o:d._prev=o,null===u?this._itHead=o:u._next=o,null===this._linkedRecords&&(this._linkedRecords=new FE),this._linkedRecords.put(o),o.currentIndex=c,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const u=o._prev,c=o._next;return null===u?this._itHead=c:u._next=c,null===c?this._itTail=u:c._prev=u,o}_addToMoves(o,u){return o.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new FE),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,u){return o.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class Oy{constructor(o,u){this.item=o,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class fT{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,u){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===u||u<=c.currentIndex)&&Object.is(c.trackById,o))return c;return null}remove(o){const u=o._prevDup,c=o._nextDup;return null===u?this._head=c:u._nextDup=c,null===c?this._tail=u:c._prevDup=u,null===this._head}}class FE{constructor(){this.map=new Map}put(o){const u=o.trackById;let c=this.map.get(u);c||(c=new fT,this.map.set(u,c)),c.add(o)}get(o,u){const d=this.map.get(o);return d?d.get(o,u):null}remove(o){const u=o.trackById;return this.map.get(u).remove(o)&&this.map.delete(u),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function LE(s,o,u){const c=s.previousIndex;if(null===c)return c;let d=0;return u&&c<u.length&&(d=u[c]),c+o+d}class pT{constructor(){}supports(o){return o instanceof Map||cb(o)}create(){return new gT}}class gT{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let u;for(u=this._mapHead;null!==u;u=u._next)o(u)}forEachPreviousItem(o){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)o(u)}forEachChangedItem(o){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}diff(o){if(o){if(!(o instanceof Map||cb(o)))throw new J(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(o,(c,d)=>{if(u&&u.key===d)this._maybeAddToChanges(u,c),this._appendAfter=u,u=u._next;else{const g=this._getOrCreateRecordForKey(d,c);u=this._insertBeforeOrAppend(u,g)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let c=u;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,u){if(o){const c=o._prev;return u._next=o,u._prev=c,o._prev=u,c&&(c._next=u),o===this._mapHead&&(this._mapHead=u),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(o,u){if(this._records.has(o)){const d=this._records.get(o);this._maybeAddToChanges(d,u);const g=d._prev,y=d._next;return g&&(g._next=y),y&&(y._prev=g),d._next=null,d._prev=null,d}const c=new mT(o);return this._records.set(o,c),c.currentValue=u,this._addToAdditions(c),c}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,u){Object.is(u,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=u,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,u){o instanceof Map?o.forEach(u):Object.keys(o).forEach(c=>u(o[c],c))}}class mT{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function _T(){return new VE([new Eg])}let VE=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(null!=c){const d=c.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||_T()),deps:[[s,new Kd,new oc]]}}find(u){const c=this.factories.find(d=>d.supports(u));if(null!=c)return c;throw new J(901,!1)}}return s.\u0275prov=Ct({token:s,providedIn:"root",factory:_T}),s})();function yT(){return new Cl([new pT])}let Cl=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(c){const d=c.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||yT()),deps:[[s,new Kd,new oc]]}}find(u){const c=this.factories.find(d=>d.supports(u));if(c)return c;throw new J(901,!1)}}return s.\u0275prov=Ct({token:s,providedIn:"root",factory:yT}),s})();const ET=mg(null,"core",[]);let bg=(()=>{class s{constructor(u){}}return s.\u0275fac=function(u){return new(u||s)(mt(Jc))},s.\u0275mod=Ll({type:s}),s.\u0275inj=Bn({}),s})();function ST(s){return"boolean"==typeof s?s:null!=s&&"false"!==s}function Wx(s){const o=Nt(s);if(!o)return null;const u=new Ic(o);return{get selector(){return u.selector},get type(){return u.componentType},get inputs(){return u.inputs},get outputs(){return u.outputs},get ngContentSelectors(){return u.ngContentSelectors},get isStandalone(){return o.standalone},get isSignal(){return o.signals}}}},3106:(lt,Ee,k)=>{k.d(Ee,{Z:()=>$e});var f=k(9058),Q=k(4537),F=k(4303),ee=k(7879);class te{constructor(He,xe){this._delegate=He,this.firebase=xe,(0,F._addComponent)(He,new Q.wA("app-compat",()=>this,"PUBLIC")),this.container=He.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(He){this._delegate.automaticDataCollectionEnabled=He}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(He=>{this._delegate.checkDestroyed(),He()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,F.deleteApp)(this._delegate)))}_getService(He,xe=F._DEFAULT_ENTRY_NAME){var tt;this._delegate.checkDestroyed();const ut=this._delegate.container.getProvider(He);return!ut.isInitialized()&&"EXPLICIT"===(null===(tt=ut.getComponent())||void 0===tt?void 0:tt.instantiationMode)&&ut.initialize(),ut.getImmediate({identifier:xe})}_removeServiceInstance(He,xe=F._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(He).clearInstance(xe)}_addComponent(He){(0,F._addComponent)(this._delegate,He)}_addOrOverwriteComponent(He){(0,F._addOrOverwriteComponent)(this._delegate,He)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const fe=new f.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),U=function ae(){const Ne=function Ce(Ne){const He={},xe={__esModule:!0,initializeApp:function J(Le,$={}){const be=F.initializeApp(Le,$);if((0,f.r3)(He,be.name))return He[be.name];const Ue=new Ne(be,xe);return He[be.name]=Ue,Ue},app:ut,registerVersion:F.registerVersion,setLogLevel:F.setLogLevel,onLog:F.onLog,apps:null,SDK_VERSION:F.SDK_VERSION,INTERNAL:{registerComponent:function re(Le){const $=Le.name,be=$.replace("-compat","");if(F._registerComponent(Le)&&"PUBLIC"===Le.type){const Ue=(At=ut())=>{if("function"!=typeof At[be])throw fe.create("invalid-app-argument",{appName:$});return At[be]()};void 0!==Le.serviceProps&&(0,f.ZB)(Ue,Le.serviceProps),xe[be]=Ue,Ne.prototype[be]=function(...At){return this._getService.bind(this,$).apply(this,Le.multipleInstances?At:[])}}return"PUBLIC"===Le.type?xe[be]:null},removeApp:function tt(Le){delete He[Le]},useAsService:function ye(Le,$){return"serverAuth"===$?null:$},modularAPIs:F}};function ut(Le){if(!(0,f.r3)(He,Le=Le||F._DEFAULT_ENTRY_NAME))throw fe.create("no-app",{appName:Le});return He[Le]}return xe.default=xe,Object.defineProperty(xe,"apps",{get:function _e(){return Object.keys(He).map(Le=>He[Le])}}),ut.App=Ne,xe}(te);return Ne.INTERNAL=Object.assign(Object.assign({},Ne.INTERNAL),{createFirebaseNamespace:ae,extendNamespace:function He(xe){(0,f.ZB)(Ne,xe)},createSubscribe:f.ne,ErrorFactory:f.LL,deepExtend:f.ZB}),Ne}(),G=new ee.Yd("@firebase/app-compat");if((0,f.jU)()&&void 0!==self.firebase){G.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Ne=self.firebase.SDK_VERSION;Ne&&Ne.indexOf("LITE")>=0&&G.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const $e=U;!function Se(Ne){(0,F.registerVersion)("@firebase/app-compat","0.2.1",Ne)}()},4303:(lt,Ee,k)=>{k.r(Ee),k.d(Ee,{FirebaseError:()=>ee.ZR,SDK_VERSION:()=>Bn,_DEFAULT_ENTRY_NAME:()=>ie,_addComponent:()=>Oe,_addOrOverwriteComponent:()=>Ve,_apps:()=>pe,_clearComponents:()=>wt,_components:()=>de,_getProvider:()=>je,_registerComponent:()=>rt,_removeServiceInstance:()=>Xt,deleteApp:()=>si,getApp:()=>ln,getApps:()=>Pn,initializeApp:()=>pr,onLog:()=>ns,registerVersion:()=>Qr,setLogLevel:()=>wi});var f=k(5861),Q=k(4537),F=k(7879),ee=k(9058),te=k(1878);class he{constructor(Ae){this.container=Ae}getPlatformInfoString(){return this.container.getProviders().map(ze=>{if(function fe(Ye){const Ae=Ye.getComponent();return"VERSION"===Ae?.type}(ze)){const St=ze.getImmediate();return`${St.library}/${St.version}`}return null}).filter(ze=>ze).join(" ")}}const Ce="@firebase/app",U=new F.Yd("@firebase/app"),ie="[DEFAULT]",le={[Ce]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},pe=new Map,de=new Map;function Oe(Ye,Ae){try{Ye.container.addComponent(Ae)}catch(ze){U.debug(`Component ${Ae.name} failed to register with FirebaseApp ${Ye.name}`,ze)}}function Ve(Ye,Ae){Ye.container.addOrOverwriteComponent(Ae)}function rt(Ye){const Ae=Ye.name;if(de.has(Ae))return U.debug(`There were multiple attempts to register component ${Ae}.`),!1;de.set(Ae,Ye);for(const ze of pe.values())Oe(ze,Ye);return!0}function je(Ye,Ae){const ze=Ye.container.getProvider("heartbeat").getImmediate({optional:!0});return ze&&ze.triggerHeartbeat(),Ye.container.getProvider(Ae)}function Xt(Ye,Ae,ze=ie){je(Ye,Ae).clearInstance(ze)}function wt(){de.clear()}const Ct=new ee.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Jt{constructor(Ae,ze,St){this._isDeleted=!1,this._options=Object.assign({},Ae),this._config=Object.assign({},ze),this._name=ze.name,this._automaticDataCollectionEnabled=ze.automaticDataCollectionEnabled,this._container=St,this.container.addComponent(new Q.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Ae){this.checkDestroyed(),this._automaticDataCollectionEnabled=Ae}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Ae){this._isDeleted=Ae}checkDestroyed(){if(this.isDeleted)throw Ct.create("app-deleted",{appName:this._name})}}const Bn="9.16.0";function pr(Ye,Ae={}){let ze=Ye;"object"!=typeof Ae&&(Ae={name:Ae});const St=Object.assign({name:ie,automaticDataCollectionEnabled:!1},Ae),mt=St.name;if("string"!=typeof mt||!mt)throw Ct.create("bad-app-name",{appName:String(mt)});if(ze||(ze=(0,ee.aH)()),!ze)throw Ct.create("no-options");const Zt=pe.get(mt);if(Zt){if((0,ee.vZ)(ze,Zt.options)&&(0,ee.vZ)(St,Zt.config))return Zt;throw Ct.create("duplicate-app",{appName:mt})}const j=new Q.H0(mt);for(const Z of de.values())j.addComponent(Z);const B=new Jt(ze,St,j);return pe.set(mt,B),B}function ln(Ye=ie){const Ae=pe.get(Ye);if(!Ae&&Ye===ie)return pr();if(!Ae)throw Ct.create("no-app",{appName:Ye});return Ae}function Pn(){return Array.from(pe.values())}function si(Ye){return Yr.apply(this,arguments)}function Yr(){return(Yr=(0,f.Z)(function*(Ye){const Ae=Ye.name;pe.has(Ae)&&(pe.delete(Ae),yield Promise.all(Ye.container.getProviders().map(ze=>ze.delete())),Ye.isDeleted=!0)})).apply(this,arguments)}function Qr(Ye,Ae,ze){var St;let mt=null!==(St=le[Ye])&&void 0!==St?St:Ye;ze&&(mt+=`-${ze}`);const Zt=mt.match(/\s|\//),j=Ae.match(/\s|\//);if(Zt||j){const B=[`Unable to register library "${mt}" with version "${Ae}":`];return Zt&&B.push(`library name "${mt}" contains illegal characters (whitespace or "/")`),Zt&&j&&B.push("and"),j&&B.push(`version name "${Ae}" contains illegal characters (whitespace or "/")`),void U.warn(B.join(" "))}rt(new Q.wA(`${mt}-version`,()=>({library:mt,version:Ae}),"VERSION"))}function ns(Ye,Ae){if(null!==Ye&&"function"!=typeof Ye)throw Ct.create("invalid-log-argument");(0,F.Am)(Ye,Ae)}function wi(Ye){(0,F.Ub)(Ye)}const Vi="firebase-heartbeat-database",_t=1,Pt="firebase-heartbeat-store";let Vt=null;function jn(){return Vt||(Vt=(0,te.X3)(Vi,_t,{upgrade:(Ye,Ae)=>{0===Ae&&Ye.createObjectStore(Pt)}}).catch(Ye=>{throw Ct.create("idb-open",{originalErrorMessage:Ye.message})})),Vt}function Er(){return(Er=(0,f.Z)(function*(Ye){try{return(yield jn()).transaction(Pt).objectStore(Pt).get(Ei(Ye))}catch(Ae){if(Ae instanceof ee.ZR)U.warn(Ae.message);else{const ze=Ct.create("idb-get",{originalErrorMessage:Ae?.message});U.warn(ze.message)}}})).apply(this,arguments)}function en(Ye,Ae){return Cn.apply(this,arguments)}function Cn(){return(Cn=(0,f.Z)(function*(Ye,Ae){try{const St=(yield jn()).transaction(Pt,"readwrite");return yield St.objectStore(Pt).put(Ae,Ei(Ye)),St.done}catch(ze){if(ze instanceof ee.ZR)U.warn(ze.message);else{const St=Ct.create("idb-set",{originalErrorMessage:ze?.message});U.warn(St.message)}}})).apply(this,arguments)}function Ei(Ye){return`${Ye.name}!${Ye.options.appId}`}class tn{constructor(Ae){this.container=Ae,this._heartbeatsCache=null;const ze=this.container.getProvider("app").getImmediate();this._storage=new yu(ze),this._heartbeatsCachePromise=this._storage.read().then(St=>(this._heartbeatsCache=St,St))}triggerHeartbeat(){var Ae=this;return(0,f.Z)(function*(){const St=Ae.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),mt=oi();if(null===Ae._heartbeatsCache&&(Ae._heartbeatsCache=yield Ae._heartbeatsCachePromise),Ae._heartbeatsCache.lastSentHeartbeatDate!==mt&&!Ae._heartbeatsCache.heartbeats.some(Zt=>Zt.date===mt))return Ae._heartbeatsCache.heartbeats.push({date:mt,agent:St}),Ae._heartbeatsCache.heartbeats=Ae._heartbeatsCache.heartbeats.filter(Zt=>{const j=new Date(Zt.date).valueOf();return Date.now()-j<=2592e6}),Ae._storage.overwrite(Ae._heartbeatsCache)})()}getHeartbeatsHeader(){var Ae=this;return(0,f.Z)(function*(){if(null===Ae._heartbeatsCache&&(yield Ae._heartbeatsCachePromise),null===Ae._heartbeatsCache||0===Ae._heartbeatsCache.heartbeats.length)return"";const ze=oi(),{heartbeatsToSend:St,unsentEntries:mt}=function Ii(Ye,Ae=1024){const ze=[];let St=Ye.slice();for(const mt of Ye){const Zt=ze.find(j=>j.agent===mt.agent);if(Zt){if(Zt.dates.push(mt.date),ai(ze)>Ae){Zt.dates.pop();break}}else if(ze.push({agent:mt.agent,dates:[mt.date]}),ai(ze)>Ae){ze.pop();break}St=St.slice(1)}return{heartbeatsToSend:ze,unsentEntries:St}}(Ae._heartbeatsCache.heartbeats),Zt=(0,ee.L)(JSON.stringify({version:2,heartbeats:St}));return Ae._heartbeatsCache.lastSentHeartbeatDate=ze,mt.length>0?(Ae._heartbeatsCache.heartbeats=mt,yield Ae._storage.overwrite(Ae._heartbeatsCache)):(Ae._heartbeatsCache.heartbeats=[],Ae._storage.overwrite(Ae._heartbeatsCache)),Zt})()}}function oi(){return(new Date).toISOString().substring(0,10)}class yu{constructor(Ae){this.app=Ae,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,f.Z)(function*(){return!!(0,ee.hl)()&&(0,ee.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Ae=this;return(0,f.Z)(function*(){return(yield Ae._canUseIndexedDBPromise)&&(yield function rs(Ye){return Er.apply(this,arguments)}(Ae.app))||{heartbeats:[]}})()}overwrite(Ae){var ze=this;return(0,f.Z)(function*(){var St;if(yield ze._canUseIndexedDBPromise){const Zt=yield ze.read();return en(ze.app,{lastSentHeartbeatDate:null!==(St=Ae.lastSentHeartbeatDate)&&void 0!==St?St:Zt.lastSentHeartbeatDate,heartbeats:Ae.heartbeats})}})()}add(Ae){var ze=this;return(0,f.Z)(function*(){var St;if(yield ze._canUseIndexedDBPromise){const Zt=yield ze.read();return en(ze.app,{lastSentHeartbeatDate:null!==(St=Ae.lastSentHeartbeatDate)&&void 0!==St?St:Zt.lastSentHeartbeatDate,heartbeats:[...Zt.heartbeats,...Ae.heartbeats]})}})()}}function ai(Ye){return(0,ee.L)(JSON.stringify({version:2,heartbeats:Ye})).length}!function qs(Ye){rt(new Q.wA("platform-logger",Ae=>new he(Ae),"PRIVATE")),rt(new Q.wA("heartbeat",Ae=>new tn(Ae),"PRIVATE")),Qr(Ce,"0.9.1",Ye),Qr(Ce,"0.9.1","esm2017"),Qr("fire-js","")}("")},4537:(lt,Ee,k)=>{k.d(Ee,{H0:()=>Ce,wA:()=>F,zt:()=>te});var f=k(5861),Q=k(9058);class F{constructor(U,G,X){this.name=U,this.instanceFactory=G,this.type=X,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(U){return this.instantiationMode=U,this}setMultipleInstances(U){return this.multipleInstances=U,this}setServiceProps(U){return this.serviceProps=U,this}setInstanceCreatedCallback(U){return this.onInstanceCreated=U,this}}const ee="[DEFAULT]";class te{constructor(U,G){this.name=U,this.container=G,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(U){const G=this.normalizeInstanceIdentifier(U);if(!this.instancesDeferred.has(G)){const X=new Q.BH;if(this.instancesDeferred.set(G,X),this.isInitialized(G)||this.shouldAutoInitialize())try{const Fe=this.getOrInitializeService({instanceIdentifier:G});Fe&&X.resolve(Fe)}catch{}}return this.instancesDeferred.get(G).promise}getImmediate(U){var G;const X=this.normalizeInstanceIdentifier(U?.identifier),Fe=null!==(G=U?.optional)&&void 0!==G&&G;if(!this.isInitialized(X)&&!this.shouldAutoInitialize()){if(Fe)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:X})}catch(Se){if(Fe)return null;throw Se}}getComponent(){return this.component}setComponent(U){if(U.name!==this.name)throw Error(`Mismatching Component ${U.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=U,this.shouldAutoInitialize()){if(function fe(ae){return"EAGER"===ae.instantiationMode}(U))try{this.getOrInitializeService({instanceIdentifier:ee})}catch{}for(const[G,X]of this.instancesDeferred.entries()){const Fe=this.normalizeInstanceIdentifier(G);try{const Se=this.getOrInitializeService({instanceIdentifier:Fe});X.resolve(Se)}catch{}}}}clearInstance(U=ee){this.instancesDeferred.delete(U),this.instancesOptions.delete(U),this.instances.delete(U)}delete(){var U=this;return(0,f.Z)(function*(){const G=Array.from(U.instances.values());yield Promise.all([...G.filter(X=>"INTERNAL"in X).map(X=>X.INTERNAL.delete()),...G.filter(X=>"_delete"in X).map(X=>X._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(U=ee){return this.instances.has(U)}getOptions(U=ee){return this.instancesOptions.get(U)||{}}initialize(U={}){const{options:G={}}=U,X=this.normalizeInstanceIdentifier(U.instanceIdentifier);if(this.isInitialized(X))throw Error(`${this.name}(${X}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Fe=this.getOrInitializeService({instanceIdentifier:X,options:G});for(const[Se,$e]of this.instancesDeferred.entries())X===this.normalizeInstanceIdentifier(Se)&&$e.resolve(Fe);return Fe}onInit(U,G){var X;const Fe=this.normalizeInstanceIdentifier(G),Se=null!==(X=this.onInitCallbacks.get(Fe))&&void 0!==X?X:new Set;Se.add(U),this.onInitCallbacks.set(Fe,Se);const $e=this.instances.get(Fe);return $e&&U($e,Fe),()=>{Se.delete(U)}}invokeOnInitCallbacks(U,G){const X=this.onInitCallbacks.get(G);if(X)for(const Fe of X)try{Fe(U,G)}catch{}}getOrInitializeService({instanceIdentifier:U,options:G={}}){let X=this.instances.get(U);if(!X&&this.component&&(X=this.component.instanceFactory(this.container,{instanceIdentifier:(ae=U,ae===ee?void 0:ae),options:G}),this.instances.set(U,X),this.instancesOptions.set(U,G),this.invokeOnInitCallbacks(X,U),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,U,X)}catch{}var ae;return X||null}normalizeInstanceIdentifier(U=ee){return this.component?this.component.multipleInstances?U:ee:U}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Ce{constructor(U){this.name=U,this.providers=new Map}addComponent(U){const G=this.getProvider(U.name);if(G.isComponentSet())throw new Error(`Component ${U.name} has already been registered with ${this.name}`);G.setComponent(U)}addOrOverwriteComponent(U){this.getProvider(U.name).isComponentSet()&&this.providers.delete(U.name),this.addComponent(U)}getProvider(U){if(this.providers.has(U))return this.providers.get(U);const G=new te(U,this);return this.providers.set(U,G),G}getProviders(){return Array.from(this.providers.values())}}},7879:(lt,Ee,k)=>{k.d(Ee,{Am:()=>ae,Ub:()=>Ce,Yd:()=>fe,in:()=>Q});const f=[];var Q=function(U){return U[U.DEBUG=0]="DEBUG",U[U.VERBOSE=1]="VERBOSE",U[U.INFO=2]="INFO",U[U.WARN=3]="WARN",U[U.ERROR=4]="ERROR",U[U.SILENT=5]="SILENT",U}(Q||{});const F={debug:Q.DEBUG,verbose:Q.VERBOSE,info:Q.INFO,warn:Q.WARN,error:Q.ERROR,silent:Q.SILENT},ee=Q.INFO,te={[Q.DEBUG]:"log",[Q.VERBOSE]:"log",[Q.INFO]:"info",[Q.WARN]:"warn",[Q.ERROR]:"error"},he=(U,G,...X)=>{if(G<U.logLevel)return;const Fe=(new Date).toISOString(),Se=te[G];if(!Se)throw new Error(`Attempted to log a message with an invalid logType (value: ${G})`);console[Se](`[${Fe}]  ${U.name}:`,...X)};class fe{constructor(G){this.name=G,this._logLevel=ee,this._logHandler=he,this._userLogHandler=null,f.push(this)}get logLevel(){return this._logLevel}set logLevel(G){if(!(G in Q))throw new TypeError(`Invalid value "${G}" assigned to \`logLevel\``);this._logLevel=G}setLogLevel(G){this._logLevel="string"==typeof G?F[G]:G}get logHandler(){return this._logHandler}set logHandler(G){if("function"!=typeof G)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=G}get userLogHandler(){return this._userLogHandler}set userLogHandler(G){this._userLogHandler=G}debug(...G){this._userLogHandler&&this._userLogHandler(this,Q.DEBUG,...G),this._logHandler(this,Q.DEBUG,...G)}log(...G){this._userLogHandler&&this._userLogHandler(this,Q.VERBOSE,...G),this._logHandler(this,Q.VERBOSE,...G)}info(...G){this._userLogHandler&&this._userLogHandler(this,Q.INFO,...G),this._logHandler(this,Q.INFO,...G)}warn(...G){this._userLogHandler&&this._userLogHandler(this,Q.WARN,...G),this._logHandler(this,Q.WARN,...G)}error(...G){this._userLogHandler&&this._userLogHandler(this,Q.ERROR,...G),this._logHandler(this,Q.ERROR,...G)}}function Ce(U){f.forEach(G=>{G.setLogLevel(U)})}function ae(U,G){for(const X of f){let Fe=null;G&&G.level&&(Fe=F[G.level]),X.userLogHandler=null===U?null:(Se,$e,...Ne)=>{const He=Ne.map(xe=>{if(null==xe)return null;if("string"==typeof xe)return xe;if("number"==typeof xe||"boolean"==typeof xe)return xe.toString();if(xe instanceof Error)return xe.message;try{return JSON.stringify(xe)}catch{return null}}).filter(xe=>xe).join(" ");$e>=(Fe??Se.logLevel)&&U({level:Q[$e].toLowerCase(),message:He,args:Ne,type:Se.name})}}}},3182:(lt,Ee,k)=>{k.d(Ee,{C6:()=>f.getApps,Mq:()=>f.getApp});var f=k(4303);(0,f.registerVersion)("firebase","9.16.0","app")},7142:(lt,Ee,k)=>{k.d(Ee,{Z:()=>f.Z});var f=k(3106);f.Z.registerVersion("firebase","9.16.0","app-compat")},8443:(lt,Ee,k)=>{k.r(Ee);var f=k(5861),Q=k(3106),F=k(9058),ee=k(4303),te=k(7879),he=k(7582),fe=k(4537);const ae={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};const $e=function Fe(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},Ne=function Se(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},He=new F.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),tt=new te.Yd("@firebase/auth");function ut(v,...p){tt.logLevel<=te.in.ERROR&&tt.error(`Auth (${ee.SDK_VERSION}): ${v}`,...p)}function J(v,...p){throw Le(v,...p)}function _e(v,...p){return Le(v,...p)}function re(v,p,m){const E=Object.assign(Object.assign({},Ne()),{[p]:m});return new F.LL("auth","Firebase",E).create(p,{appName:v.name})}function ye(v,p,m){if(!(p instanceof m))throw m.name!==p.constructor.name&&J(v,"argument-error"),re(v,"argument-error",`Type of ${p.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Le(v,...p){if("string"!=typeof v){const m=p[0],E=[...p.slice(1)];return E[0]&&(E[0].appName=v.name),v._errorFactory.create(m,...E)}return He.create(v,...p)}function $(v,p,...m){if(!v)throw Le(p,...m)}function be(v){const p="INTERNAL ASSERTION FAILED: "+v;throw ut(p),new Error(p)}function Ue(v,p){v||be(p)}const At=new Map;function Kt(v){Ue(v instanceof Function,"Expected a class definition");let p=At.get(v);return p?(Ue(p instanceof v,"Instance stored in cache mismatched with class"),p):(p=new v,At.set(v,p),p)}function In(){var v;return typeof self<"u"&&(null===(v=self.location)||void 0===v?void 0:v.href)||""}function fr(){return"http:"===zs()||"https:"===zs()}function zs(){var v;return typeof self<"u"&&(null===(v=self.location)||void 0===v?void 0:v.protocol)||null}class pe{constructor(p,m){this.shortDelay=p,this.longDelay=m,Ue(m>p,"Short delay should be less than long delay!"),this.isMobile=(0,F.uI)()||(0,F.b$)()}get(){return function ie(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(fr()||(0,F.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function de(v,p){Ue(v.emulator,"Emulator should always be set here");const{url:m}=v.emulator;return p?`${m}${p.startsWith("/")?p.slice(1):p}`:m}class Oe{static initialize(p,m,E){this.fetchImpl=p,m&&(this.headersImpl=m),E&&(this.responseImpl=E)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void be("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void be("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void be("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ve={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},rt=new pe(3e4,6e4);function je(v,p){return v.tenantId&&!p.tenantId?Object.assign(Object.assign({},p),{tenantId:v.tenantId}):p}function Xt(v,p,m,E){return wt.apply(this,arguments)}function wt(){return(wt=(0,f.Z)(function*(v,p,m,E,M={}){return on(v,M,(0,f.Z)(function*(){let N={},q={};E&&("GET"===p?q=E:N={body:JSON.stringify(E)});const ge=(0,F.xO)(Object.assign({key:v.config.apiKey},q)).slice(1),Be=yield v._getAdditionalHeaders();return Be["Content-Type"]="application/json",v.languageCode&&(Be["X-Firebase-Locale"]=v.languageCode),Oe.fetch()(pr(v,v.config.apiHost,m,ge),Object.assign({method:p,headers:Be,referrerPolicy:"no-referrer"},N))}))})).apply(this,arguments)}function on(v,p,m){return Ct.apply(this,arguments)}function Ct(){return(Ct=(0,f.Z)(function*(v,p,m){v._canInitEmulator=!1;const E=Object.assign(Object.assign({},Ve),p);try{const M=new ln(v),N=yield Promise.race([m(),M.promise]);M.clearNetworkTimeout();const q=yield N.json();if("needConfirmation"in q)throw Pn(v,"account-exists-with-different-credential",q);if(N.ok&&!("errorMessage"in q))return q;{const ge=N.ok?q.errorMessage:q.error.message,[Be,Qe]=ge.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===Be)throw Pn(v,"credential-already-in-use",q);if("EMAIL_EXISTS"===Be)throw Pn(v,"email-already-in-use",q);if("USER_DISABLED"===Be)throw Pn(v,"user-disabled",q);const bt=E[Be]||Be.toLowerCase().replace(/[_\s]+/g,"-");if(Qe)throw re(v,bt,Qe);J(v,bt)}}catch(M){if(M instanceof F.ZR)throw M;J(v,"network-request-failed")}})).apply(this,arguments)}function Jt(v,p,m,E){return Bn.apply(this,arguments)}function Bn(){return(Bn=(0,f.Z)(function*(v,p,m,E,M={}){const N=yield Xt(v,p,m,E,M);return"mfaPendingCredential"in N&&J(v,"multi-factor-auth-required",{_serverResponse:N}),N})).apply(this,arguments)}function pr(v,p,m,E){const M=`${p}${m}?${E}`;return v.config.emulator?de(v.config,M):`${v.config.apiScheme}://${M}`}class ln{constructor(p){this.auth=p,this.timer=null,this.promise=new Promise((m,E)=>{this.timer=setTimeout(()=>E(_e(this.auth,"network-request-failed")),rt.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Pn(v,p,m){const E={appName:v.name};m.email&&(E.email=m.email),m.phoneNumber&&(E.phoneNumber=m.phoneNumber);const M=_e(v,p,E);return M.customData._tokenResponse=m,M}function Yr(){return(Yr=(0,f.Z)(function*(v,p){return Xt(v,"POST","/v1/accounts:delete",p)})).apply(this,arguments)}function ns(){return(ns=(0,f.Z)(function*(v,p){return Xt(v,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function Vi(){return(Vi=(0,f.Z)(function*(v,p){return Xt(v,"POST","/v1/accounts:lookup",p)})).apply(this,arguments)}function _t(v){if(v)try{const p=new Date(Number(v));if(!isNaN(p.getTime()))return p.toUTCString()}catch{}}function jn(){return(jn=(0,f.Z)(function*(v,p=!1){const m=(0,F.m9)(v),E=yield m.getIdToken(p),M=Er(E);$(M&&M.exp&&M.auth_time&&M.iat,m.auth,"internal-error");const N="object"==typeof M.firebase?M.firebase:void 0,q=N?.sign_in_provider;return{claims:M,token:E,authTime:_t(rs(M.auth_time)),issuedAtTime:_t(rs(M.iat)),expirationTime:_t(rs(M.exp)),signInProvider:q||null,signInSecondFactor:N?.sign_in_second_factor||null}})).apply(this,arguments)}function rs(v){return 1e3*Number(v)}function Er(v){const[p,m,E]=v.split(".");if(void 0===p||void 0===m||void 0===E)return ut("JWT malformed, contained fewer than 3 sections"),null;try{const M=(0,F.tV)(m);return M?JSON.parse(M):(ut("Failed to decode base64 JWT payload"),null)}catch(M){return ut("Caught error parsing JWT payload as JSON",M?.toString()),null}}function Cn(v,p){return Ei.apply(this,arguments)}function Ei(){return(Ei=(0,f.Z)(function*(v,p,m=!1){if(m)return p;try{return yield p}catch(E){throw E instanceof F.ZR&&function xn({code:v}){return"auth/user-disabled"===v||"auth/user-token-expired"===v}(E)&&v.auth.currentUser===v&&(yield v.auth.signOut()),E}})).apply(this,arguments)}class is{constructor(p){this.user=p,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(p){var m;if(p){const E=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),E}{this.errorBackoff=3e4;const M=(null!==(m=this.user.stsTokenManager.expirationTime)&&void 0!==m?m:0)-Date.now()-3e5;return Math.max(0,M)}}schedule(p=!1){var m=this;if(!this.isRunning)return;const E=this.getInterval(p);this.timerId=setTimeout((0,f.Z)(function*(){yield m.iteration()}),E)}iteration(){var p=this;return(0,f.Z)(function*(){try{yield p.user.getIdToken(!0)}catch(m){return void("auth/network-request-failed"===m?.code&&p.schedule(!0))}p.schedule()})()}}class tn{constructor(p,m){this.createdAt=p,this.lastLoginAt=m,this._initializeTime()}_initializeTime(){this.lastSignInTime=_t(this.lastLoginAt),this.creationTime=_t(this.createdAt)}_copy(p){this.createdAt=p.createdAt,this.lastLoginAt=p.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function oi(v){return Ii.apply(this,arguments)}function Ii(){return Ii=(0,f.Z)(function*(v){var p;const m=v.auth,E=yield v.getIdToken(),M=yield Cn(v,function wi(v,p){return Vi.apply(this,arguments)}(m,{idToken:E}));$(M?.users.length,m,"internal-error");const N=M.users[0];v._notifyReloadListener(N);const q=null!==(p=N.providerUserInfo)&&void 0!==p&&p.length?function Ye(v){return v.map(p=>{var{providerId:m}=p,E=(0,he._T)(p,["providerId"]);return{providerId:m,uid:E.rawId||"",displayName:E.displayName||null,email:E.email||null,phoneNumber:E.phoneNumber||null,photoURL:E.photoUrl||null}})}(N.providerUserInfo):[],ge=function qs(v,p){return[...v.filter(E=>!p.some(M=>M.providerId===E.providerId)),...p]}(v.providerData,q),bt=!!v.isAnonymous&&!(v.email&&N.passwordHash||ge?.length),ft={uid:N.localId,displayName:N.displayName||null,photoURL:N.photoUrl||null,email:N.email||null,emailVerified:N.emailVerified||!1,phoneNumber:N.phoneNumber||null,tenantId:N.tenantId||null,providerData:ge,metadata:new tn(N.createdAt,N.lastLoginAt),isAnonymous:bt};Object.assign(v,ft)}),Ii.apply(this,arguments)}function ai(){return(ai=(0,f.Z)(function*(v){const p=(0,F.m9)(v);yield oi(p),yield p.auth._persistUserIfCurrent(p),p.auth._notifyListenersIfCurrent(p)})).apply(this,arguments)}function ze(){return(ze=(0,f.Z)(function*(v,p){const m=yield on(v,{},(0,f.Z)(function*(){const E=(0,F.xO)({grant_type:"refresh_token",refresh_token:p}).slice(1),{tokenApiHost:M,apiKey:N}=v.config,q=pr(v,M,"/v1/token",`key=${N}`),ge=yield v._getAdditionalHeaders();return ge["Content-Type"]="application/x-www-form-urlencoded",Oe.fetch()(q,{method:"POST",headers:ge,body:E})}));return{accessToken:m.access_token,expiresIn:m.expires_in,refreshToken:m.refresh_token}})).apply(this,arguments)}class St{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(p){$(p.idToken,"internal-error"),$(typeof p.idToken<"u","internal-error"),$(typeof p.refreshToken<"u","internal-error");const m="expiresIn"in p&&typeof p.expiresIn<"u"?Number(p.expiresIn):function en(v){const p=Er(v);return $(p,"internal-error"),$(typeof p.exp<"u","internal-error"),$(typeof p.iat<"u","internal-error"),Number(p.exp)-Number(p.iat)}(p.idToken);this.updateTokensAndExpiration(p.idToken,p.refreshToken,m)}getToken(p,m=!1){var E=this;return(0,f.Z)(function*(){return $(!E.accessToken||E.refreshToken,p,"user-token-expired"),m||!E.accessToken||E.isExpired?E.refreshToken?(yield E.refresh(p,E.refreshToken),E.accessToken):null:E.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(p,m){var E=this;return(0,f.Z)(function*(){const{accessToken:M,refreshToken:N,expiresIn:q}=yield function Ae(v,p){return ze.apply(this,arguments)}(p,m);E.updateTokensAndExpiration(M,N,Number(q))})()}updateTokensAndExpiration(p,m,E){this.refreshToken=m||null,this.accessToken=p||null,this.expirationTime=Date.now()+1e3*E}static fromJSON(p,m){const{refreshToken:E,accessToken:M,expirationTime:N}=m,q=new St;return E&&($("string"==typeof E,"internal-error",{appName:p}),q.refreshToken=E),M&&($("string"==typeof M,"internal-error",{appName:p}),q.accessToken=M),N&&($("number"==typeof N,"internal-error",{appName:p}),q.expirationTime=N),q}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(p){this.accessToken=p.accessToken,this.refreshToken=p.refreshToken,this.expirationTime=p.expirationTime}_clone(){return Object.assign(new St,this.toJSON())}_performRefresh(){return be("not implemented")}}function mt(v,p){$("string"==typeof v||typeof v>"u","internal-error",{appName:p})}class Zt{constructor(p){var{uid:m,auth:E,stsTokenManager:M}=p,N=(0,he._T)(p,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new is(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=m,this.auth=E,this.stsTokenManager=M,this.accessToken=M.accessToken,this.displayName=N.displayName||null,this.email=N.email||null,this.emailVerified=N.emailVerified||!1,this.phoneNumber=N.phoneNumber||null,this.photoURL=N.photoURL||null,this.isAnonymous=N.isAnonymous||!1,this.tenantId=N.tenantId||null,this.providerData=N.providerData?[...N.providerData]:[],this.metadata=new tn(N.createdAt||void 0,N.lastLoginAt||void 0)}getIdToken(p){var m=this;return(0,f.Z)(function*(){const E=yield Cn(m,m.stsTokenManager.getToken(m.auth,p));return $(E,m.auth,"internal-error"),m.accessToken!==E&&(m.accessToken=E,yield m.auth._persistUserIfCurrent(m),m.auth._notifyListenersIfCurrent(m)),E})()}getIdTokenResult(p){return function Vt(v){return jn.apply(this,arguments)}(this,p)}reload(){return function yu(v){return ai.apply(this,arguments)}(this)}_assign(p){this!==p&&($(this.uid===p.uid,this.auth,"internal-error"),this.displayName=p.displayName,this.photoURL=p.photoURL,this.email=p.email,this.emailVerified=p.emailVerified,this.phoneNumber=p.phoneNumber,this.isAnonymous=p.isAnonymous,this.tenantId=p.tenantId,this.providerData=p.providerData.map(m=>Object.assign({},m)),this.metadata._copy(p.metadata),this.stsTokenManager._assign(p.stsTokenManager))}_clone(p){return new Zt(Object.assign(Object.assign({},this),{auth:p,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(p){$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=p,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(p){this.reloadListener?this.reloadListener(p):this.reloadUserInfo=p}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(p,m=!1){var E=this;return(0,f.Z)(function*(){let M=!1;p.idToken&&p.idToken!==E.stsTokenManager.accessToken&&(E.stsTokenManager.updateFromServerResponse(p),M=!0),m&&(yield oi(E)),yield E.auth._persistUserIfCurrent(E),M&&E.auth._notifyListenersIfCurrent(E)})()}delete(){var p=this;return(0,f.Z)(function*(){const m=yield p.getIdToken();return yield Cn(p,function si(v,p){return Yr.apply(this,arguments)}(p.auth,{idToken:m})),p.stsTokenManager.clearRefreshToken(),p.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(p=>Object.assign({},p)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(p,m){var E,M,N,q,ge,Be,Qe,bt;const ft=null!==(E=m.displayName)&&void 0!==E?E:void 0,$n=null!==(M=m.email)&&void 0!==M?M:void 0,Qi=null!==(N=m.phoneNumber)&&void 0!==N?N:void 0,eu=null!==(q=m.photoURL)&&void 0!==q?q:void 0,cc=null!==(ge=m.tenantId)&&void 0!==ge?ge:void 0,km=null!==(Be=m._redirectEventId)&&void 0!==Be?Be:void 0,Bv=null!==(Qe=m.createdAt)&&void 0!==Qe?Qe:void 0,jv=null!==(bt=m.lastLoginAt)&&void 0!==bt?bt:void 0,{uid:Fm,emailVerified:Lm,isAnonymous:Hv,providerData:oh,stsTokenManager:ah}=m;$(Fm&&ah,p,"internal-error");const uh=St.fromJSON(this.name,ah);$("string"==typeof Fm,p,"internal-error"),mt(ft,p.name),mt($n,p.name),$("boolean"==typeof Lm,p,"internal-error"),$("boolean"==typeof Hv,p,"internal-error"),mt(Qi,p.name),mt(eu,p.name),mt(cc,p.name),mt(km,p.name),mt(Bv,p.name),mt(jv,p.name);const pi=new Zt({uid:Fm,auth:p,email:$n,emailVerified:Lm,displayName:ft,isAnonymous:Hv,photoURL:eu,phoneNumber:Qi,tenantId:cc,stsTokenManager:uh,createdAt:Bv,lastLoginAt:jv});return oh&&Array.isArray(oh)&&(pi.providerData=oh.map($v=>Object.assign({},$v))),km&&(pi._redirectEventId=km),pi}static _fromIdTokenResponse(p,m,E=!1){return(0,f.Z)(function*(){const M=new St;M.updateFromServerResponse(m);const N=new Zt({uid:m.localId,auth:p,stsTokenManager:M,isAnonymous:E});return yield oi(N),N})()}}const B=(()=>{class v{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,f.Z)(function*(){return!0})()}_set(m,E){var M=this;return(0,f.Z)(function*(){M.storage[m]=E})()}_get(m){var E=this;return(0,f.Z)(function*(){const M=E.storage[m];return void 0===M?null:M})()}_remove(m){var E=this;return(0,f.Z)(function*(){delete E.storage[m]})()}_addListener(m,E){}_removeListener(m,E){}}return v.type="NONE",v})();function Z(v,p,m){return`firebase:${v}:${p}:${m}`}class ve{constructor(p,m,E){this.persistence=p,this.auth=m,this.userKey=E;const{config:M,name:N}=this.auth;this.fullUserKey=Z(this.userKey,M.apiKey,N),this.fullPersistenceKey=Z("persistence",M.apiKey,N),this.boundEventHandler=m._onStorageEvent.bind(m),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(p){return this.persistence._set(this.fullUserKey,p.toJSON())}getCurrentUser(){var p=this;return(0,f.Z)(function*(){const m=yield p.persistence._get(p.fullUserKey);return m?Zt._fromJSON(p.auth,m):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(p){var m=this;return(0,f.Z)(function*(){if(m.persistence===p)return;const E=yield m.getCurrentUser();return yield m.removeCurrentUser(),m.persistence=p,E?m.setCurrentUser(E):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(p,m,E="authUser"){return(0,f.Z)(function*(){if(!m.length)return new ve(Kt(B),p,E);const M=(yield Promise.all(m.map(function(){var Qe=(0,f.Z)(function*(bt){if(yield bt._isAvailable())return bt});return function(bt){return Qe.apply(this,arguments)}}()))).filter(Qe=>Qe);let N=M[0]||Kt(B);const q=Z(E,p.config.apiKey,p.name);let ge=null;for(const Qe of m)try{const bt=yield Qe._get(q);if(bt){const ft=Zt._fromJSON(p,bt);Qe!==N&&(ge=ft),N=Qe;break}}catch{}const Be=M.filter(Qe=>Qe._shouldAllowMigration);return N._shouldAllowMigration&&Be.length?(N=Be[0],ge&&(yield N._set(q,ge.toJSON())),yield Promise.all(m.map(function(){var Qe=(0,f.Z)(function*(bt){if(bt!==N)try{yield bt._remove(q)}catch{}});return function(bt){return Qe.apply(this,arguments)}}())),new ve(N,p,E)):new ve(N,p,E)})()}}function se(v){const p=v.toLowerCase();if(p.includes("opera/")||p.includes("opr/")||p.includes("opios/"))return"Opera";if(Hn(p))return"IEMobile";if(p.includes("msie")||p.includes("trident/"))return"IE";if(p.includes("edge/"))return"Edge";if(it(p))return"Firefox";if(p.includes("silk/"))return"Silk";if(zn(p))return"Blackberry";if(Je(p))return"Webos";if(Rt(p))return"Safari";if((p.includes("chrome/")||Gt(p))&&!p.includes("edge/"))return"Chrome";if(pn(p))return"Android";{const E=v.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===E?.length)return E[1]}return"Other"}function it(v=(0,F.z$)()){return/firefox\//i.test(v)}function Rt(v=(0,F.z$)()){const p=v.toLowerCase();return p.includes("safari/")&&!p.includes("chrome/")&&!p.includes("crios/")&&!p.includes("android")}function Gt(v=(0,F.z$)()){return/crios\//i.test(v)}function Hn(v=(0,F.z$)()){return/iemobile/i.test(v)}function pn(v=(0,F.z$)()){return/android/i.test(v)}function zn(v=(0,F.z$)()){return/blackberry/i.test(v)}function Je(v=(0,F.z$)()){return/webos/i.test(v)}function qn(v=(0,F.z$)()){return/iphone|ipad|ipod/i.test(v)||/macintosh/i.test(v)&&/mobile/i.test(v)}function Cs(v=(0,F.z$)()){return qn(v)||pn(v)||Je(v)||zn(v)||/windows phone/i.test(v)||Hn(v)}function po(v,p=[]){let m;switch(v){case"Browser":m=se((0,F.z$)());break;case"Worker":m=`${se((0,F.z$)())}-${v}`;break;default:m=v}const E=p.length?p.join(","):"FirebaseCore-web";return`${m}/JsCore/${ee.SDK_VERSION}/${E}`}class Ol{constructor(p){this.auth=p,this.queue=[]}pushCallback(p,m){const E=N=>new Promise((q,ge)=>{try{q(p(N))}catch(Be){ge(Be)}});E.onAbort=m,this.queue.push(E);const M=this.queue.length-1;return()=>{this.queue[M]=()=>Promise.resolve()}}runMiddleware(p){var m=this;return(0,f.Z)(function*(){if(m.auth.currentUser===p)return;const E=[];try{for(const M of m.queue)yield M(p),M.onAbort&&E.push(M.onAbort)}catch(M){E.reverse();for(const N of E)try{N()}catch{}throw m.auth._errorFactory.create("login-blocked",{originalMessage:M?.message})}})()}}class Pl{constructor(p,m,E){this.app=p,this.heartbeatServiceProvider=m,this.config=E,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Da(this),this.idTokenSubscription=new Da(this),this.beforeStateQueue=new Ol(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=He,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=p.name,this.clientVersion=E.sdkClientVersion}_initializeWithPersistence(p,m){var E=this;return m&&(this._popupRedirectResolver=Kt(m)),this._initializationPromise=this.queue((0,f.Z)(function*(){var M,N;if(!E._deleted&&(E.persistenceManager=yield ve.create(E,p),!E._deleted)){if(null!==(M=E._popupRedirectResolver)&&void 0!==M&&M._shouldInitProactively)try{yield E._popupRedirectResolver._initialize(E)}catch{}yield E.initializeCurrentUser(m),E.lastNotifiedUid=(null===(N=E.currentUser)||void 0===N?void 0:N.uid)||null,!E._deleted&&(E._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var p=this;return(0,f.Z)(function*(){if(p._deleted)return;const m=yield p.assertedPersistence.getCurrentUser();if(p.currentUser||m){if(p.currentUser&&m&&p.currentUser.uid===m.uid)return p._currentUser._assign(m),void(yield p.currentUser.getIdToken());yield p._updateCurrentUser(m,!0)}})()}initializeCurrentUser(p){var m=this;return(0,f.Z)(function*(){var E;const M=yield m.assertedPersistence.getCurrentUser();let N=M,q=!1;if(p&&m.config.authDomain){yield m.getOrInitRedirectPersistenceManager();const ge=null===(E=m.redirectUser)||void 0===E?void 0:E._redirectEventId,Be=N?._redirectEventId,Qe=yield m.tryRedirectSignIn(p);(!ge||ge===Be)&&Qe?.user&&(N=Qe.user,q=!0)}if(!N)return m.directlySetCurrentUser(null);if(!N._redirectEventId){if(q)try{yield m.beforeStateQueue.runMiddleware(N)}catch(ge){N=M,m._popupRedirectResolver._overrideRedirectResult(m,()=>Promise.reject(ge))}return N?m.reloadAndSetCurrentUserOrClear(N):m.directlySetCurrentUser(null)}return $(m._popupRedirectResolver,m,"argument-error"),yield m.getOrInitRedirectPersistenceManager(),m.redirectUser&&m.redirectUser._redirectEventId===N._redirectEventId?m.directlySetCurrentUser(N):m.reloadAndSetCurrentUserOrClear(N)})()}tryRedirectSignIn(p){var m=this;return(0,f.Z)(function*(){let E=null;try{E=yield m._popupRedirectResolver._completeRedirectFn(m,p,!0)}catch{yield m._setRedirectUser(null)}return E})()}reloadAndSetCurrentUserOrClear(p){var m=this;return(0,f.Z)(function*(){try{yield oi(p)}catch(E){if("auth/network-request-failed"!==E?.code)return m.directlySetCurrentUser(null)}return m.directlySetCurrentUser(p)})()}useDeviceLanguage(){this.languageCode=function le(){if(typeof navigator>"u")return null;const v=navigator;return v.languages&&v.languages[0]||v.language||null}()}_delete(){var p=this;return(0,f.Z)(function*(){p._deleted=!0})()}updateCurrentUser(p){var m=this;return(0,f.Z)(function*(){const E=p?(0,F.m9)(p):null;return E&&$(E.auth.config.apiKey===m.config.apiKey,m,"invalid-user-token"),m._updateCurrentUser(E&&E._clone(m))})()}_updateCurrentUser(p,m=!1){var E=this;return(0,f.Z)(function*(){if(!E._deleted)return p&&$(E.tenantId===p.tenantId,E,"tenant-id-mismatch"),m||(yield E.beforeStateQueue.runMiddleware(p)),E.queue((0,f.Z)(function*(){yield E.directlySetCurrentUser(p),E.notifyAuthListeners()}))})()}signOut(){var p=this;return(0,f.Z)(function*(){return yield p.beforeStateQueue.runMiddleware(null),(p.redirectPersistenceManager||p._popupRedirectResolver)&&(yield p._setRedirectUser(null)),p._updateCurrentUser(null,!0)})()}setPersistence(p){var m=this;return this.queue((0,f.Z)(function*(){yield m.assertedPersistence.setPersistence(Kt(p))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(p){this._errorFactory=new F.LL("auth","Firebase",p())}onAuthStateChanged(p,m,E){return this.registerStateListener(this.authStateSubscription,p,m,E)}beforeAuthStateChanged(p,m){return this.beforeStateQueue.pushCallback(p,m)}onIdTokenChanged(p,m,E){return this.registerStateListener(this.idTokenSubscription,p,m,E)}toJSON(){var p;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(p=this._currentUser)||void 0===p?void 0:p.toJSON()}}_setRedirectUser(p,m){var E=this;return(0,f.Z)(function*(){const M=yield E.getOrInitRedirectPersistenceManager(m);return null===p?M.removeCurrentUser():M.setCurrentUser(p)})()}getOrInitRedirectPersistenceManager(p){var m=this;return(0,f.Z)(function*(){if(!m.redirectPersistenceManager){const E=p&&Kt(p)||m._popupRedirectResolver;$(E,m,"argument-error"),m.redirectPersistenceManager=yield ve.create(m,[Kt(E._redirectPersistence)],"redirectUser"),m.redirectUser=yield m.redirectPersistenceManager.getCurrentUser()}return m.redirectPersistenceManager})()}_redirectUserForId(p){var m=this;return(0,f.Z)(function*(){var E,M;return m._isInitialized&&(yield m.queue((0,f.Z)(function*(){}))),(null===(E=m._currentUser)||void 0===E?void 0:E._redirectEventId)===p?m._currentUser:(null===(M=m.redirectUser)||void 0===M?void 0:M._redirectEventId)===p?m.redirectUser:null})()}_persistUserIfCurrent(p){var m=this;return(0,f.Z)(function*(){if(p===m.currentUser)return m.queue((0,f.Z)(function*(){return m.directlySetCurrentUser(p)}))})()}_notifyListenersIfCurrent(p){p===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var p,m;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const E=null!==(m=null===(p=this.currentUser)||void 0===p?void 0:p.uid)&&void 0!==m?m:null;this.lastNotifiedUid!==E&&(this.lastNotifiedUid=E,this.authStateSubscription.next(this.currentUser))}registerStateListener(p,m,E,M){if(this._deleted)return()=>{};const N="function"==typeof m?m:m.next.bind(m),q=this._isInitialized?Promise.resolve():this._initializationPromise;return $(q,this,"internal-error"),q.then(()=>N(this.currentUser)),"function"==typeof m?p.addObserver(m,E,M):p.addObserver(m)}directlySetCurrentUser(p){var m=this;return(0,f.Z)(function*(){m.currentUser&&m.currentUser!==p&&m._currentUser._stopProactiveRefresh(),p&&m.isProactiveRefreshEnabled&&p._startProactiveRefresh(),m.currentUser=p,p?yield m.assertedPersistence.setCurrentUser(p):yield m.assertedPersistence.removeCurrentUser()})()}queue(p){return this.operations=this.operations.then(p,p),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(p){!p||this.frameworks.includes(p)||(this.frameworks.push(p),this.frameworks.sort(),this.clientVersion=po(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var p=this;return(0,f.Z)(function*(){var m;const E={"X-Client-Version":p.clientVersion};p.app.options.appId&&(E["X-Firebase-gmpid"]=p.app.options.appId);const M=yield null===(m=p.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===m?void 0:m.getHeartbeatsHeader();return M&&(E["X-Firebase-Client"]=M),E})()}}function tr(v){return(0,F.m9)(v)}class Da{constructor(p){this.auth=p,this.observer=null,this.addObserver=(0,F.ne)(m=>this.observer=m)}get next(){return $(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function $o(v){const p=v.indexOf(":");return p<0?"":v.substr(0,p+1)}function If(v){if(!v)return null;const p=Number(v);return isNaN(p)?null:p}class Zs{constructor(p,m){this.providerId=p,this.signInMethod=m}toJSON(){return be("not implemented")}_getIdTokenResponse(p){return be("not implemented")}_linkToIdToken(p,m){return be("not implemented")}_getReauthenticationResolver(p){return be("not implemented")}}function Nr(v,p){return ui.apply(this,arguments)}function ui(){return(ui=(0,f.Z)(function*(v,p){return Xt(v,"POST","/v1/accounts:resetPassword",je(v,p))})).apply(this,arguments)}function dd(v,p){return Ta.apply(this,arguments)}function Ta(){return(Ta=(0,f.Z)(function*(v,p){return Xt(v,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function Go(){return(Go=(0,f.Z)(function*(v,p){return Xt(v,"POST","/v1/accounts:update",je(v,p))})).apply(this,arguments)}function Cf(){return(Cf=(0,f.Z)(function*(v,p){return Jt(v,"POST","/v1/accounts:signInWithPassword",je(v,p))})).apply(this,arguments)}function zo(v,p){return Sa.apply(this,arguments)}function Sa(){return(Sa=(0,f.Z)(function*(v,p){return Xt(v,"POST","/v1/accounts:sendOobCode",je(v,p))})).apply(this,arguments)}function Aa(){return(Aa=(0,f.Z)(function*(v,p){return zo(v,p)})).apply(this,arguments)}function pd(){return(pd=(0,f.Z)(function*(v,p){return zo(v,p)})).apply(this,arguments)}function bf(){return(bf=(0,f.Z)(function*(v,p){return zo(v,p)})).apply(this,arguments)}function Ma(){return(Ma=(0,f.Z)(function*(v,p){return zo(v,p)})).apply(this,arguments)}function Vl(){return(Vl=(0,f.Z)(function*(v,p){return Jt(v,"POST","/v1/accounts:signInWithEmailLink",je(v,p))})).apply(this,arguments)}function Nt(){return(Nt=(0,f.Z)(function*(v,p){return Jt(v,"POST","/v1/accounts:signInWithEmailLink",je(v,p))})).apply(this,arguments)}class Wn extends Zs{constructor(p,m,E,M=null){super("password",E),this._email=p,this._password=m,this._tenantId=M}static _fromEmailAndPassword(p,m){return new Wn(p,m,"password")}static _fromEmailAndCode(p,m,E=null){return new Wn(p,m,"emailLink",E)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(p){const m="string"==typeof p?JSON.parse(p):p;if(m?.email&&m?.password){if("password"===m.signInMethod)return this._fromEmailAndPassword(m.email,m.password);if("emailLink"===m.signInMethod)return this._fromEmailAndCode(m.email,m.password,m.tenantId)}return null}_getIdTokenResponse(p){var m=this;return(0,f.Z)(function*(){switch(m.signInMethod){case"password":return function vu(v,p){return Cf.apply(this,arguments)}(p,{returnSecureToken:!0,email:m._email,password:m._password});case"emailLink":return function nm(v,p){return Vl.apply(this,arguments)}(p,{email:m._email,oobCode:m._password});default:J(p,"internal-error")}})()}_linkToIdToken(p,m){var E=this;return(0,f.Z)(function*(){switch(E.signInMethod){case"password":return dd(p,{idToken:m,returnSecureToken:!0,email:E._email,password:E._password});case"emailLink":return function Df(v,p){return Nt.apply(this,arguments)}(p,{idToken:m,email:E._email,oobCode:E._password});default:J(p,"internal-error")}})()}_getReauthenticationResolver(p){return this._getIdTokenResponse(p)}}function kn(v,p){return Ks.apply(this,arguments)}function Ks(){return(Ks=(0,f.Z)(function*(v,p){return Jt(v,"POST","/v1/accounts:signInWithIdp",je(v,p))})).apply(this,arguments)}class ci extends Zs{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(p){const m=new ci(p.providerId,p.signInMethod);return p.idToken||p.accessToken?(p.idToken&&(m.idToken=p.idToken),p.accessToken&&(m.accessToken=p.accessToken),p.nonce&&!p.pendingToken&&(m.nonce=p.nonce),p.pendingToken&&(m.pendingToken=p.pendingToken)):p.oauthToken&&p.oauthTokenSecret?(m.accessToken=p.oauthToken,m.secret=p.oauthTokenSecret):J("argument-error"),m}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(p){const m="string"==typeof p?JSON.parse(p):p,{providerId:E,signInMethod:M}=m,N=(0,he._T)(m,["providerId","signInMethod"]);if(!E||!M)return null;const q=new ci(E,M);return q.idToken=N.idToken||void 0,q.accessToken=N.accessToken||void 0,q.secret=N.secret,q.nonce=N.nonce,q.pendingToken=N.pendingToken||null,q}_getIdTokenResponse(p){return kn(p,this.buildRequest())}_linkToIdToken(p,m){const E=this.buildRequest();return E.idToken=m,kn(p,E)}_getReauthenticationResolver(p){const m=this.buildRequest();return m.autoCreate=!1,kn(p,m)}buildRequest(){const p={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)p.pendingToken=this.pendingToken;else{const m={};this.idToken&&(m.id_token=this.idToken),this.accessToken&&(m.access_token=this.accessToken),this.secret&&(m.oauth_token_secret=this.secret),m.providerId=this.providerId,this.nonce&&!this.pendingToken&&(m.nonce=this.nonce),p.postBody=(0,F.xO)(m)}return p}}function Wo(){return(Wo=(0,f.Z)(function*(v,p){return Xt(v,"POST","/v1/accounts:sendVerificationCode",je(v,p))})).apply(this,arguments)}function bs(){return(bs=(0,f.Z)(function*(v,p){return Jt(v,"POST","/v1/accounts:signInWithPhoneNumber",je(v,p))})).apply(this,arguments)}function Ke(){return(Ke=(0,f.Z)(function*(v,p){const m=yield Jt(v,"POST","/v1/accounts:signInWithPhoneNumber",je(v,p));if(m.temporaryProof)throw Pn(v,"account-exists-with-different-credential",m);return m})).apply(this,arguments)}const Mt={USER_NOT_FOUND:"user-not-found"};function di(){return(di=(0,f.Z)(function*(v,p){return Jt(v,"POST","/v1/accounts:signInWithPhoneNumber",je(v,Object.assign(Object.assign({},p),{operation:"REAUTH"})),Mt)})).apply(this,arguments)}class Ui extends Zs{constructor(p){super("phone","phone"),this.params=p}static _fromVerification(p,m){return new Ui({verificationId:p,verificationCode:m})}static _fromTokenResponse(p,m){return new Ui({phoneNumber:p,temporaryProof:m})}_getIdTokenResponse(p){return function wu(v,p){return bs.apply(this,arguments)}(p,this._makeVerificationRequest())}_linkToIdToken(p,m){return function nr(v,p){return Ke.apply(this,arguments)}(p,Object.assign({idToken:m},this._makeVerificationRequest()))}_getReauthenticationResolver(p){return function Rn(v,p){return di.apply(this,arguments)}(p,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:p,phoneNumber:m,verificationId:E,verificationCode:M}=this.params;return p&&m?{temporaryProof:p,phoneNumber:m}:{sessionInfo:E,code:M}}toJSON(){const p={providerId:this.providerId};return this.params.phoneNumber&&(p.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(p.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(p.verificationCode=this.params.verificationCode),this.params.verificationId&&(p.verificationId=this.params.verificationId),p}static fromJSON(p){"string"==typeof p&&(p=JSON.parse(p));const{verificationId:m,verificationCode:E,phoneNumber:M,temporaryProof:N}=p;return E||m||M||N?new Ui({verificationId:m,verificationCode:E,phoneNumber:M,temporaryProof:N}):null}}class vn{constructor(p){var m,E,M,N,q,ge;const Be=(0,F.zd)((0,F.pd)(p)),Qe=null!==(m=Be.apiKey)&&void 0!==m?m:null,bt=null!==(E=Be.oobCode)&&void 0!==E?E:null,ft=function Br(v){switch(v){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(M=Be.mode)&&void 0!==M?M:null);$(Qe&&bt&&ft,"argument-error"),this.apiKey=Qe,this.operation=ft,this.code=bt,this.continueUrl=null!==(N=Be.continueUrl)&&void 0!==N?N:null,this.languageCode=null!==(q=Be.languageCode)&&void 0!==q?q:null,this.tenantId=null!==(ge=Be.tenantId)&&void 0!==ge?ge:null}static parseLink(p){const m=function Ys(v){const p=(0,F.zd)((0,F.pd)(v)).link,m=p?(0,F.zd)((0,F.pd)(p)).deep_link_id:null,E=(0,F.zd)((0,F.pd)(v)).deep_link_id;return(E?(0,F.zd)((0,F.pd)(E)).link:null)||E||m||p||v}(p);try{return new vn(m)}catch{return null}}}let ss=(()=>{class v{constructor(){this.providerId=v.PROVIDER_ID}static credential(m,E){return Wn._fromEmailAndPassword(m,E)}static credentialWithLink(m,E){const M=vn.parseLink(E);return $(M,"argument-error"),Wn._fromEmailAndCode(m,M.code,M.tenantId)}}return v.PROVIDER_ID="password",v.EMAIL_PASSWORD_SIGN_IN_METHOD="password",v.EMAIL_LINK_SIGN_IN_METHOD="emailLink",v})();class Et{constructor(p){this.providerId=p,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(p){this.defaultLanguageCode=p}setCustomParameters(p){return this.customParameters=p,this}getCustomParameters(){return this.customParameters}}class Bi extends Et{constructor(){super(...arguments),this.scopes=[]}addScope(p){return this.scopes.includes(p)||this.scopes.push(p),this}getScopes(){return[...this.scopes]}}class mo extends Bi{static credentialFromJSON(p){const m="string"==typeof p?JSON.parse(p):p;return $("providerId"in m&&"signInMethod"in m,"argument-error"),ci._fromParams(m)}credential(p){return this._credential(Object.assign(Object.assign({},p),{nonce:p.rawNonce}))}_credential(p){return $(p.idToken||p.accessToken,"argument-error"),ci._fromParams(Object.assign(Object.assign({},p),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(p){return mo.oauthCredentialFromTaggedObject(p)}static credentialFromError(p){return mo.oauthCredentialFromTaggedObject(p.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{oauthIdToken:m,oauthAccessToken:E,oauthTokenSecret:M,pendingToken:N,nonce:q,providerId:ge}=p;if(!E&&!M&&!m&&!N||!ge)return null;try{return new mo(ge)._credential({idToken:m,accessToken:E,nonce:q,pendingToken:N})}catch{return null}}}let os=(()=>{class v extends Bi{constructor(){super("facebook.com")}static credential(m){return ci._fromParams({providerId:v.PROVIDER_ID,signInMethod:v.FACEBOOK_SIGN_IN_METHOD,accessToken:m})}static credentialFromResult(m){return v.credentialFromTaggedObject(m)}static credentialFromError(m){return v.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m||!("oauthAccessToken"in m)||!m.oauthAccessToken)return null;try{return v.credential(m.oauthAccessToken)}catch{return null}}}return v.FACEBOOK_SIGN_IN_METHOD="facebook.com",v.PROVIDER_ID="facebook.com",v})(),bn=(()=>{class v extends Bi{constructor(){super("google.com"),this.addScope("profile")}static credential(m,E){return ci._fromParams({providerId:v.PROVIDER_ID,signInMethod:v.GOOGLE_SIGN_IN_METHOD,idToken:m,accessToken:E})}static credentialFromResult(m){return v.credentialFromTaggedObject(m)}static credentialFromError(m){return v.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{oauthIdToken:E,oauthAccessToken:M}=m;if(!E&&!M)return null;try{return v.credential(E,M)}catch{return null}}}return v.GOOGLE_SIGN_IN_METHOD="google.com",v.PROVIDER_ID="google.com",v})(),xa=(()=>{class v extends Bi{constructor(){super("github.com")}static credential(m){return ci._fromParams({providerId:v.PROVIDER_ID,signInMethod:v.GITHUB_SIGN_IN_METHOD,accessToken:m})}static credentialFromResult(m){return v.credentialFromTaggedObject(m)}static credentialFromError(m){return v.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m||!("oauthAccessToken"in m)||!m.oauthAccessToken)return null;try{return v.credential(m.oauthAccessToken)}catch{return null}}}return v.GITHUB_SIGN_IN_METHOD="github.com",v.PROVIDER_ID="github.com",v})();class jr extends Zs{constructor(p,m){super(p,p),this.pendingToken=m}_getIdTokenResponse(p){return kn(p,this.buildRequest())}_linkToIdToken(p,m){const E=this.buildRequest();return E.idToken=m,kn(p,E)}_getReauthenticationResolver(p){const m=this.buildRequest();return m.autoCreate=!1,kn(p,m)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(p){const m="string"==typeof p?JSON.parse(p):p,{providerId:E,signInMethod:M,pendingToken:N}=m;return E&&M&&N&&E===M?new jr(E,N):null}static _create(p,m){return new jr(p,m)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class hi extends Et{constructor(p){$(p.startsWith("saml."),"argument-error"),super(p)}static credentialFromResult(p){return hi.samlCredentialFromTaggedObject(p)}static credentialFromError(p){return hi.samlCredentialFromTaggedObject(p.customData||{})}static credentialFromJSON(p){const m=jr.fromJSON(p);return $(m,"argument-error"),m}static samlCredentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{pendingToken:m,providerId:E}=p;if(!m||!E)return null;try{return jr._create(E,m)}catch{return null}}}let Ts=(()=>{class v extends Bi{constructor(){super("twitter.com")}static credential(m,E){return ci._fromParams({providerId:v.PROVIDER_ID,signInMethod:v.TWITTER_SIGN_IN_METHOD,oauthToken:m,oauthTokenSecret:E})}static credentialFromResult(m){return v.credentialFromTaggedObject(m)}static credentialFromError(m){return v.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{oauthAccessToken:E,oauthTokenSecret:M}=m;if(!E||!M)return null;try{return v.credential(E,M)}catch{return null}}}return v.TWITTER_SIGN_IN_METHOD="twitter.com",v.PROVIDER_ID="twitter.com",v})();function Ci(v,p){return Na.apply(this,arguments)}function Na(){return(Na=(0,f.Z)(function*(v,p){return Jt(v,"POST","/v1/accounts:signUp",je(v,p))})).apply(this,arguments)}class rr{constructor(p){this.user=p.user,this.providerId=p.providerId,this._tokenResponse=p._tokenResponse,this.operationType=p.operationType}static _fromIdTokenResponse(p,m,E,M=!1){return(0,f.Z)(function*(){const N=yield Zt._fromIdTokenResponse(p,E,M),q=zt(E);return new rr({user:N,providerId:q,_tokenResponse:E,operationType:m})})()}static _forOperation(p,m,E){return(0,f.Z)(function*(){yield p._updateTokensIfNecessary(E,!0);const M=zt(E);return new rr({user:p,providerId:M,_tokenResponse:E,operationType:m})})()}}function zt(v){return v.providerId?v.providerId:"phoneNumber"in v?"phone":null}function Eu(){return(Eu=(0,f.Z)(function*(v){var p;const m=tr(v);if(yield m._initializationPromise,null!==(p=m.currentUser)&&void 0!==p&&p.isAnonymous)return new rr({user:m.currentUser,providerId:null,operationType:"signIn"});const E=yield Ci(m,{returnSecureToken:!0}),M=yield rr._fromIdTokenResponse(m,"signIn",E,!0);return yield m._updateCurrentUser(M.user),M})).apply(this,arguments)}class Oa extends F.ZR{constructor(p,m,E,M){var N;super(m.code,m.message),this.operationType=E,this.user=M,Object.setPrototypeOf(this,Oa.prototype),this.customData={appName:p.name,tenantId:null!==(N=p.tenantId)&&void 0!==N?N:void 0,_serverResponse:m.customData._serverResponse,operationType:E}}static _fromErrorAndOperation(p,m,E,M){return new Oa(p,m,E,M)}}function ji(v,p,m,E){return("reauthenticate"===p?m._getReauthenticationResolver(v):m._getIdTokenResponse(v)).catch(N=>{throw"auth/multi-factor-auth-required"===N.code?Oa._fromErrorAndOperation(v,N,p,E):N})}function bi(v){return new Set(v.map(({providerId:p})=>p).filter(p=>!!p))}function Xs(){return Xs=(0,f.Z)(function*(v,p){const m=(0,F.m9)(v);yield Zn(!0,m,p);const{providerUserInfo:E}=yield function Qr(v,p){return ns.apply(this,arguments)}(m.auth,{idToken:yield m.getIdToken(),deleteProvider:[p]}),M=bi(E||[]);return m.providerData=m.providerData.filter(N=>M.has(N.providerId)),M.has("phone")||(m.phoneNumber=null),yield m.auth._persistUserIfCurrent(m),m}),Xs.apply(this,arguments)}function ir(v,p){return Ul.apply(this,arguments)}function Ul(){return(Ul=(0,f.Z)(function*(v,p,m=!1){const E=yield Cn(v,p._linkToIdToken(v.auth,yield v.getIdToken()),m);return rr._forOperation(v,"link",E)})).apply(this,arguments)}function Zn(v,p,m){return Ir.apply(this,arguments)}function Ir(){return(Ir=(0,f.Z)(function*(v,p,m){yield oi(p);const M=!1===v?"provider-already-linked":"no-such-provider";$(bi(p.providerData).has(m)===v,p.auth,M)})).apply(this,arguments)}function Iu(v,p){return Hi.apply(this,arguments)}function Hi(){return(Hi=(0,f.Z)(function*(v,p,m=!1){const{auth:E}=v,M="reauthenticate";try{const N=yield Cn(v,ji(E,M,p,v),m);$(N.idToken,E,"internal-error");const q=Er(N.idToken);$(q,E,"internal-error");const{sub:ge}=q;return $(v.uid===ge,E,"user-mismatch"),rr._forOperation(v,M,N)}catch(N){throw"auth/user-not-found"===N?.code&&J(E,"user-mismatch"),N}})).apply(this,arguments)}function _o(v,p){return Or.apply(this,arguments)}function Or(){return(Or=(0,f.Z)(function*(v,p,m=!1){const E="signIn",M=yield ji(v,E,p),N=yield rr._fromIdTokenResponse(v,E,M);return m||(yield v._updateCurrentUser(N.user)),N})).apply(this,arguments)}function Fn(v,p){return md.apply(this,arguments)}function md(){return(md=(0,f.Z)(function*(v,p){return _o(tr(v),p)})).apply(this,arguments)}function Cu(v,p){return _d.apply(this,arguments)}function _d(){return(_d=(0,f.Z)(function*(v,p){const m=(0,F.m9)(v);return yield Zn(!1,m,p.providerId),ir(m,p)})).apply(this,arguments)}function Bl(v,p){return jl.apply(this,arguments)}function jl(){return(jl=(0,f.Z)(function*(v,p){return Iu((0,F.m9)(v),p)})).apply(this,arguments)}function bu(){return(bu=(0,f.Z)(function*(v,p){return Jt(v,"POST","/v1/accounts:signInWithCustomToken",je(v,p))})).apply(this,arguments)}function Hl(){return Hl=(0,f.Z)(function*(v,p){const m=tr(v),E=yield function yd(v,p){return bu.apply(this,arguments)}(m,{token:p,returnSecureToken:!0}),M=yield rr._fromIdTokenResponse(m,"signIn",E);return yield m._updateCurrentUser(M.user),M}),Hl.apply(this,arguments)}class $l{constructor(p,m){this.factorId=p,this.uid=m.mfaEnrollmentId,this.enrollmentTime=new Date(m.enrolledAt).toUTCString(),this.displayName=m.displayName}static _fromServerResponse(p,m){return"phoneInfo"in m?wd._fromServerResponse(p,m):J(p,"internal-error")}}class wd extends $l{constructor(p){super("phone",p),this.phoneNumber=p.phoneInfo}static _fromServerResponse(p,m){return new wd(m)}}function Gl(v,p,m){var E;$((null===(E=m.url)||void 0===E?void 0:E.length)>0,v,"invalid-continue-uri"),$(typeof m.dynamicLinkDomain>"u"||m.dynamicLinkDomain.length>0,v,"invalid-dynamic-link-domain"),p.continueUrl=m.url,p.dynamicLinkDomain=m.dynamicLinkDomain,p.canHandleCodeInApp=m.handleCodeInApp,m.iOS&&($(m.iOS.bundleId.length>0,v,"missing-ios-bundle-id"),p.iOSBundleId=m.iOS.bundleId),m.android&&($(m.android.packageName.length>0,v,"missing-android-pkg-name"),p.androidInstallApp=m.android.installApp,p.androidMinimumVersionCode=m.android.minimumVersion,p.androidPackageName=m.android.packageName)}function Id(){return Id=(0,f.Z)(function*(v,p,m){const E=(0,F.m9)(v),M={requestType:"PASSWORD_RESET",email:p};m&&Gl(E,M,m),yield function qo(v,p){return pd.apply(this,arguments)}(E,M)}),Id.apply(this,arguments)}function Cd(){return(Cd=(0,f.Z)(function*(v,p,m){yield Nr((0,F.m9)(v),{oobCode:p,newPassword:m})})).apply(this,arguments)}function Pa(){return Pa=(0,f.Z)(function*(v,p){yield function hd(v,p){return Go.apply(this,arguments)}((0,F.m9)(v),{oobCode:p})}),Pa.apply(this,arguments)}function Du(v,p){return Af.apply(this,arguments)}function Af(){return(Af=(0,f.Z)(function*(v,p){const m=(0,F.m9)(v),E=yield Nr(m,{oobCode:p}),M=E.requestType;switch($(M,m,"internal-error"),M){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":$(E.newEmail,m,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":$(E.mfaInfo,m,"internal-error");default:$(E.email,m,"internal-error")}let N=null;return E.mfaInfo&&(N=$l._fromServerResponse(tr(m),E.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===E.requestType?E.newEmail:E.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===E.requestType?E.email:E.newEmail)||null,multiFactorInfo:N},operation:M}})).apply(this,arguments)}function Mf(){return(Mf=(0,f.Z)(function*(v,p){const{data:m}=yield Du((0,F.m9)(v),p);return m.email})).apply(this,arguments)}function zl(){return(zl=(0,f.Z)(function*(v,p,m){const E=tr(v),M=yield Ci(E,{returnSecureToken:!0,email:p,password:m}),N=yield rr._fromIdTokenResponse(E,"signIn",M);return yield E._updateCurrentUser(N.user),N})).apply(this,arguments)}function ql(){return ql=(0,f.Z)(function*(v,p,m){const E=(0,F.m9)(v),M={requestType:"EMAIL_SIGNIN",email:p};$(m.handleCodeInApp,E,"argument-error"),m&&Gl(E,M,m),yield function tm(v,p){return bf.apply(this,arguments)}(E,M)}),ql.apply(this,arguments)}function Tu(){return(Tu=(0,f.Z)(function*(v,p,m){const E=(0,F.m9)(v),M=ss.credentialWithLink(p,m||In());return $(M._tenantId===(E.tenantId||null),E,"tenant-id-mismatch"),Fn(E,M)})).apply(this,arguments)}function ka(){return(ka=(0,f.Z)(function*(v,p){return Xt(v,"POST","/v1/accounts:createAuthUri",je(v,p))})).apply(this,arguments)}function Zo(){return Zo=(0,f.Z)(function*(v,p){const E={identifier:p,continueUri:fr()?In():"http://localhost"},{signinMethods:M}=yield function _v(v,p){return ka.apply(this,arguments)}((0,F.m9)(v),E);return M||[]}),Zo.apply(this,arguments)}function Js(){return Js=(0,f.Z)(function*(v,p){const m=(0,F.m9)(v),M={requestType:"VERIFY_EMAIL",idToken:yield v.getIdToken()};p&&Gl(m.auth,M,p);const{email:N}=yield function fd(v,p){return Aa.apply(this,arguments)}(m.auth,M);N!==v.email&&(yield v.reload())}),Js.apply(this,arguments)}function Fa(){return Fa=(0,f.Z)(function*(v,p,m){const E=(0,F.m9)(v),N={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield v.getIdToken(),newEmail:p};m&&Gl(E.auth,N,m);const{email:q}=yield function Ll(v,p){return Ma.apply(this,arguments)}(E.auth,N);q!==v.email&&(yield v.reload())}),Fa.apply(this,arguments)}function vo(){return(vo=(0,f.Z)(function*(v,p){return Xt(v,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function Rf(){return Rf=(0,f.Z)(function*(v,{displayName:p,photoURL:m}){if(void 0===p&&void 0===m)return;const E=(0,F.m9)(v),N={idToken:yield E.getIdToken(),displayName:p,photoUrl:m,returnSecureToken:!0},q=yield Cn(E,function Ko(v,p){return vo.apply(this,arguments)}(E.auth,N));E.displayName=q.displayName||null,E.photoURL=q.photoUrl||null;const ge=E.providerData.find(({providerId:Be})=>"password"===Be);ge&&(ge.displayName=E.displayName,ge.photoURL=E.photoURL),yield E._updateTokensIfNecessary(q)}),Rf.apply(this,arguments)}function Md(v,p,m){return Qo.apply(this,arguments)}function Qo(){return(Qo=(0,f.Z)(function*(v,p,m){const{auth:E}=v,N={idToken:yield v.getIdToken(),returnSecureToken:!0};p&&(N.email=p),m&&(N.password=m);const q=yield Cn(v,dd(E,N));yield v._updateTokensIfNecessary(q,!0)})).apply(this,arguments)}class Su{constructor(p,m,E={}){this.isNewUser=p,this.providerId=m,this.profile=E}}class sm extends Su{constructor(p,m,E,M){super(p,m,E),this.username=M}}class Nf extends Su{constructor(p,m){super(p,"facebook.com",m)}}class Wl extends sm{constructor(p,m){super(p,"github.com",m,"string"==typeof m?.login?m?.login:null)}}class om extends Su{constructor(p,m){super(p,"google.com",m)}}class Zl extends sm{constructor(p,m,E){super(p,"twitter.com",m,E)}}function xd(v){const{user:p,_tokenResponse:m}=v;return p.isAnonymous&&!m?{providerId:null,isNewUser:!1,profile:null}:function im(v){var p,m;if(!v)return null;const{providerId:E}=v,M=v.rawUserInfo?JSON.parse(v.rawUserInfo):{},N=v.isNewUser||"identitytoolkit#SignupNewUserResponse"===v.kind;if(!E&&v?.idToken){const q=null===(m=null===(p=Er(v.idToken))||void 0===p?void 0:p.firebase)||void 0===m?void 0:m.sign_in_provider;if(q)return new Su(N,"anonymous"!==q&&"custom"!==q?q:null)}if(!E)return null;switch(E){case"facebook.com":return new Nf(N,M);case"github.com":return new Wl(N,M);case"google.com":return new om(N,M);case"twitter.com":return new Zl(N,M,v.screenName||null);case"custom":case"anonymous":return new Su(N,null);default:return new Su(N,E,M)}}(m)}class wo{constructor(p,m,E){this.type=p,this.credential=m,this.auth=E}static _fromIdtoken(p,m){return new wo("enroll",p,m)}static _fromMfaPendingCredential(p){return new wo("signin",p)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(p){var m,E;if(p?.multiFactorSession){if(null!==(m=p.multiFactorSession)&&void 0!==m&&m.pendingCredential)return wo._fromMfaPendingCredential(p.multiFactorSession.pendingCredential);if(null!==(E=p.multiFactorSession)&&void 0!==E&&E.idToken)return wo._fromIdtoken(p.multiFactorSession.idToken)}return null}}class Au{constructor(p,m,E){this.session=p,this.hints=m,this.signInResolver=E}static _fromError(p,m){const E=tr(p),M=m.customData._serverResponse,N=(M.mfaInfo||[]).map(ge=>$l._fromServerResponse(E,ge));$(M.mfaPendingCredential,E,"internal-error");const q=wo._fromMfaPendingCredential(M.mfaPendingCredential);return new Au(q,N,function(){var ge=(0,f.Z)(function*(Be){const Qe=yield Be._process(E,q);delete M.mfaInfo,delete M.mfaPendingCredential;const bt=Object.assign(Object.assign({},M),{idToken:Qe.idToken,refreshToken:Qe.refreshToken});switch(m.operationType){case"signIn":const ft=yield rr._fromIdTokenResponse(E,m.operationType,bt);return yield E._updateCurrentUser(ft.user),ft;case"reauthenticate":return $(m.user,E,"internal-error"),rr._forOperation(m.user,m.operationType,bt);default:J(E,"internal-error")}});return function(Be){return ge.apply(this,arguments)}}())}resolveSignIn(p){var m=this;return(0,f.Z)(function*(){return m.signInResolver(p)})()}}class Eo{constructor(p){this.user=p,this.enrolledFactors=[],p._onReload(m=>{m.mfaInfo&&(this.enrolledFactors=m.mfaInfo.map(E=>$l._fromServerResponse(p.auth,E)))})}static _fromUser(p){return new Eo(p)}getSession(){var p=this;return(0,f.Z)(function*(){return wo._fromIdtoken(yield p.user.getIdToken(),p.user.auth)})()}enroll(p,m){var E=this;return(0,f.Z)(function*(){const M=p,N=yield E.getSession(),q=yield Cn(E.user,M._process(E.user.auth,N,m));return yield E.user._updateTokensIfNecessary(q),E.user.reload()})()}unenroll(p){var m=this;return(0,f.Z)(function*(){const E="string"==typeof p?p:p.uid,M=yield m.user.getIdToken(),N=yield Cn(m.user,function Pr(v,p){return Xt(v,"POST","/v2/accounts/mfaEnrollment:withdraw",je(v,p))}(m.user.auth,{idToken:M,mfaEnrollmentId:E}));m.enrolledFactors=m.enrolledFactors.filter(({uid:q})=>q!==E),yield m.user._updateTokensIfNecessary(N);try{yield m.user.reload()}catch(q){if("auth/user-token-expired"!==q?.code)throw q}})()}}const Xo=new WeakMap,gr="__sak";class Od{constructor(p,m){this.storageRetriever=p,this.type=m}_isAvailable(){try{return this.storage?(this.storage.setItem(gr,"1"),this.storage.removeItem(gr),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(p,m){return this.storage.setItem(p,JSON.stringify(m)),Promise.resolve()}_get(p){const m=this.storage.getItem(p);return Promise.resolve(m?JSON.parse(m):null)}_remove(p){return this.storage.removeItem(p),Promise.resolve()}get storage(){return this.storageRetriever()}}const Jo=(()=>{class v extends Od{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(m,E)=>this.onStorageEvent(m,E),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Pf(){const v=(0,F.z$)();return Rt(v)||qn(v)}()&&function ba(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Cs(),this._shouldAllowMigration=!0}forAllChangedKeys(m){for(const E of Object.keys(this.listeners)){const M=this.storage.getItem(E),N=this.localCache[E];M!==N&&m(E,N,M)}}onStorageEvent(m,E=!1){if(!m.key)return void this.forAllChangedKeys((ge,Be,Qe)=>{this.notifyListeners(ge,Qe)});const M=m.key;if(E?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const ge=this.storage.getItem(M);if(m.newValue!==ge)null!==m.newValue?this.storage.setItem(M,m.newValue):this.storage.removeItem(M);else if(this.localCache[M]===m.newValue&&!E)return}const N=()=>{const ge=this.storage.getItem(M);!E&&this.localCache[M]===ge||this.notifyListeners(M,ge)},q=this.storage.getItem(M);!function Ef(){return(0,F.w1)()&&10===document.documentMode}()||q===m.newValue||m.newValue===m.oldValue?N():setTimeout(N,10)}notifyListeners(m,E){this.localCache[m]=E;const M=this.listeners[m];if(M)for(const N of Array.from(M))N(E&&JSON.parse(E))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((m,E,M)=>{this.onStorageEvent(new StorageEvent("storage",{key:m,oldValue:E,newValue:M}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(m,E){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[m]||(this.listeners[m]=new Set,this.localCache[m]=this.storage.getItem(m)),this.listeners[m].add(E)}_removeListener(m,E){this.listeners[m]&&(this.listeners[m].delete(E),0===this.listeners[m].size&&delete this.listeners[m]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(m,E){var M=()=>super._set,N=this;return(0,f.Z)(function*(){yield M().call(N,m,E),N.localCache[m]=JSON.stringify(E)})()}_get(m){var E=()=>super._get,M=this;return(0,f.Z)(function*(){const N=yield E().call(M,m);return M.localCache[m]=JSON.stringify(N),N})()}_remove(m){var E=()=>super._remove,M=this;return(0,f.Z)(function*(){yield E().call(M,m),delete M.localCache[m]})()}}return v.type="LOCAL",v})(),Gi=(()=>{class v extends Od{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(m,E){}_removeListener(m,E){}}return v.type="SESSION",v})();let kd=(()=>{class v{constructor(m){this.eventTarget=m,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(m){const E=this.receivers.find(N=>N.isListeningto(m));if(E)return E;const M=new v(m);return this.receivers.push(M),M}isListeningto(m){return this.eventTarget===m}handleEvent(m){var E=this;return(0,f.Z)(function*(){const M=m,{eventId:N,eventType:q,data:ge}=M.data,Be=E.handlersMap[q];if(!Be?.size)return;M.ports[0].postMessage({status:"ack",eventId:N,eventType:q});const Qe=Array.from(Be).map(function(){var ft=(0,f.Z)(function*($n){return $n(M.origin,ge)});return function($n){return ft.apply(this,arguments)}}()),bt=yield function Va(v){return Promise.all(v.map(function(){var p=(0,f.Z)(function*(m){try{return{fulfilled:!0,value:yield m}}catch(E){return{fulfilled:!1,reason:E}}});return function(m){return p.apply(this,arguments)}}()))}(Qe);M.ports[0].postMessage({status:"done",eventId:N,eventType:q,response:bt})})()}_subscribe(m,E){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[m]||(this.handlersMap[m]=new Set),this.handlersMap[m].add(E)}_unsubscribe(m,E){this.handlersMap[m]&&E&&this.handlersMap[m].delete(E),(!E||0===this.handlersMap[m].size)&&delete this.handlersMap[m],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return v.receivers=[],v})();function It(v="",p=10){let m="";for(let E=0;E<p;E++)m+=Math.floor(10*Math.random());return v+m}class xu{constructor(p){this.target=p,this.handlers=new Set}removeMessageHandler(p){p.messageChannel&&(p.messageChannel.port1.removeEventListener("message",p.onMessage),p.messageChannel.port1.close()),this.handlers.delete(p)}_send(p,m,E=50){var M=this;return(0,f.Z)(function*(){const N=typeof MessageChannel<"u"?new MessageChannel:null;if(!N)throw new Error("connection_unavailable");let q,ge;return new Promise((Be,Qe)=>{const bt=It("",20);N.port1.start();const ft=setTimeout(()=>{Qe(new Error("unsupported_event"))},E);ge={messageChannel:N,onMessage($n){const Qi=$n;if(Qi.data.eventId===bt)switch(Qi.data.status){case"ack":clearTimeout(ft),q=setTimeout(()=>{Qe(new Error("timeout"))},3e3);break;case"done":clearTimeout(q),Be(Qi.data.response);break;default:clearTimeout(ft),clearTimeout(q),Qe(new Error("invalid_response"))}}},M.handlers.add(ge),N.port1.addEventListener("message",ge.onMessage),M.target.postMessage({eventType:p,eventId:bt,data:m},[N.port2])}).finally(()=>{ge&&M.removeMessageHandler(ge)})})()}}function mr(){return window}function Ru(){return typeof mr().WorkerGlobalScope<"u"&&"function"==typeof mr().importScripts}function Ua(){return(Ua=(0,f.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Nu="firebaseLocalStorageDb",Co="firebaseLocalStorage",Fd="fbase_key";class Ie{constructor(p){this.request=p}toPromise(){return new Promise((p,m)=>{this.request.addEventListener("success",()=>{p(this.request.result)}),this.request.addEventListener("error",()=>{m(this.request.error)})})}}function Ht(v,p){return v.transaction([Co],p?"readwrite":"readonly").objectStore(Co)}function Ba(){const v=indexedDB.open(Nu,1);return new Promise((p,m)=>{v.addEventListener("error",()=>{m(v.error)}),v.addEventListener("upgradeneeded",()=>{const E=v.result;try{E.createObjectStore(Co,{keyPath:Fd})}catch(M){m(M)}}),v.addEventListener("success",(0,f.Z)(function*(){const E=v.result;E.objectStoreNames.contains(Co)?p(E):(E.close(),yield function Ou(){const v=indexedDB.deleteDatabase(Nu);return new Ie(v).toPromise()}(),p(yield Ba()))}))})}function Kn(v,p,m){return Pu.apply(this,arguments)}function Pu(){return(Pu=(0,f.Z)(function*(v,p,m){const E=Ht(v,!0).put({[Fd]:p,value:m});return new Ie(E).toPromise()})).apply(this,arguments)}function fi(){return(fi=(0,f.Z)(function*(v,p){const m=Ht(v,!1).get(p),E=yield new Ie(m).toPromise();return void 0===E?null:E.value})).apply(this,arguments)}function ku(v,p){const m=Ht(v,!0).delete(p);return new Ie(m).toPromise()}const Do=(()=>{class v{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var m=this;return(0,f.Z)(function*(){return m.db||(m.db=yield Ba()),m.db})()}_withRetries(m){var E=this;return(0,f.Z)(function*(){let M=0;for(;;)try{const N=yield E._openDb();return yield m(N)}catch(N){if(M++>3)throw N;E.db&&(E.db.close(),E.db=void 0)}})()}initializeServiceWorkerMessaging(){var m=this;return(0,f.Z)(function*(){return Ru()?m.initializeReceiver():m.initializeSender()})()}initializeReceiver(){var m=this;return(0,f.Z)(function*(){m.receiver=kd._getInstance(function Xl(){return Ru()?self:null}()),m.receiver._subscribe("keyChanged",function(){var E=(0,f.Z)(function*(M,N){return{keyProcessed:(yield m._poll()).includes(N.key)}});return function(M,N){return E.apply(this,arguments)}}()),m.receiver._subscribe("ping",function(){var E=(0,f.Z)(function*(M,N){return["keyChanged"]});return function(M,N){return E.apply(this,arguments)}}())})()}initializeSender(){var m=this;return(0,f.Z)(function*(){var E,M;if(m.activeServiceWorker=yield function Ql(){return Ua.apply(this,arguments)}(),!m.activeServiceWorker)return;m.sender=new xu(m.activeServiceWorker);const N=yield m.sender._send("ping",{},800);N&&null!==(E=N[0])&&void 0!==E&&E.fulfilled&&null!==(M=N[0])&&void 0!==M&&M.value.includes("keyChanged")&&(m.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(m){var E=this;return(0,f.Z)(function*(){if(E.sender&&E.activeServiceWorker&&function Io(){var v;return(null===(v=navigator?.serviceWorker)||void 0===v?void 0:v.controller)||null}()===E.activeServiceWorker)try{yield E.sender._send("keyChanged",{key:m},E.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,f.Z)(function*(){try{if(!indexedDB)return!1;const m=yield Ba();return yield Kn(m,gr,"1"),yield ku(m,gr),!0}catch{}return!1})()}_withPendingWrite(m){var E=this;return(0,f.Z)(function*(){E.pendingWrites++;try{yield m()}finally{E.pendingWrites--}})()}_set(m,E){var M=this;return(0,f.Z)(function*(){return M._withPendingWrite((0,f.Z)(function*(){return yield M._withRetries(N=>Kn(N,m,E)),M.localCache[m]=E,M.notifyServiceWorker(m)}))})()}_get(m){var E=this;return(0,f.Z)(function*(){const M=yield E._withRetries(N=>function bo(v,p){return fi.apply(this,arguments)}(N,m));return E.localCache[m]=M,M})()}_remove(m){var E=this;return(0,f.Z)(function*(){return E._withPendingWrite((0,f.Z)(function*(){return yield E._withRetries(M=>ku(M,m)),delete E.localCache[m],E.notifyServiceWorker(m)}))})()}_poll(){var m=this;return(0,f.Z)(function*(){const E=yield m._withRetries(q=>{const ge=Ht(q,!1).getAll();return new Ie(ge).toPromise()});if(!E)return[];if(0!==m.pendingWrites)return[];const M=[],N=new Set;for(const{fbase_key:q,value:ge}of E)N.add(q),JSON.stringify(m.localCache[q])!==JSON.stringify(ge)&&(m.notifyListeners(q,ge),M.push(q));for(const q of Object.keys(m.localCache))m.localCache[q]&&!N.has(q)&&(m.notifyListeners(q,null),M.push(q));return M})()}notifyListeners(m,E){this.localCache[m]=E;const M=this.listeners[m];if(M)for(const N of Array.from(M))N(E)}startPolling(){var m=this;this.stopPolling(),this.pollTimer=setInterval((0,f.Z)(function*(){return m._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(m,E){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[m]||(this.listeners[m]=new Set,this._get(m)),this.listeners[m].add(E)}_removeListener(m,E){this.listeners[m]&&(this.listeners[m].delete(E),0===this.listeners[m].size&&delete this.listeners[m]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return v.type="LOCAL",v})();function Ms(){return(Ms=(0,f.Z)(function*(v){return(yield Xt(v,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function ea(v){return new Promise((p,m)=>{const E=document.createElement("script");E.setAttribute("src",v),E.onload=p,E.onerror=M=>{const N=_e("internal-error");N.customData=M,m(N)},E.type="text/javascript",E.charset="UTF-8",function zi(){var v,p;return null!==(p=null===(v=document.getElementsByTagName("head"))||void 0===v?void 0:v[0])&&void 0!==p?p:document}().appendChild(E)})}function Fu(v){return`__${v}${Math.floor(1e6*Math.random())}`}const To=1e12;class Ld{constructor(p){this.auth=p,this.counter=To,this._widgets=new Map}render(p,m){const E=this.counter;return this._widgets.set(E,new Jl(p,this.auth.name,m||{})),this.counter++,E}reset(p){var m;const E=p||To;null===(m=this._widgets.get(E))||void 0===m||m.delete(),this._widgets.delete(E)}getResponse(p){var m;return(null===(m=this._widgets.get(p||To))||void 0===m?void 0:m.getResponse())||""}execute(p){var m=this;return(0,f.Z)(function*(){var E;return null===(E=m._widgets.get(p||To))||void 0===E||E.execute(),""})()}}class Jl{constructor(p,m,E){this.params=E,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const M="string"==typeof p?document.getElementById(p):p;$(M,"argument-error",{appName:m}),this.container=M,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Lu(v){const p=[],m="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let E=0;E<v;E++)p.push(m.charAt(Math.floor(62*Math.random())));return p.join("")}(50);const{callback:p,"expired-callback":m}=this.params;if(p)try{p(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,m)try{m()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Rs=Fu("rcb"),Vd=new pe(3e4,6e4);class ta{constructor(){var p;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(p=mr().grecaptcha)||void 0===p||!p.render)}load(p,m=""){return $(function Ud(v){return v.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(v)}(m),p,"argument-error"),this.shouldResolveImmediately(m)?Promise.resolve(mr().grecaptcha):new Promise((E,M)=>{const N=mr().setTimeout(()=>{M(_e(p,"network-request-failed"))},Vd.get());mr()[Rs]=()=>{mr().clearTimeout(N),delete mr()[Rs];const ge=mr().grecaptcha;if(!ge)return void M(_e(p,"internal-error"));const Be=ge.render;ge.render=(Qe,bt)=>{const ft=Be(Qe,bt);return this.counter++,ft},this.hostLanguage=m,E(ge)},ea(`https://www.google.com/recaptcha/api.js??${(0,F.xO)({onload:Rs,render:"explicit",hl:m})}`).catch(()=>{clearTimeout(N),M(_e(p,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(p){var m;return!(null===(m=mr().grecaptcha)||void 0===m||!m.render)&&(p===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class dm{load(p){return(0,f.Z)(function*(){return new Ld(p)})()}clearedOneInstance(){}}const Lf="recaptcha",Vf={theme:"light",type:"image"};class hm{constructor(p,m=Object.assign({},Vf),E){this.parameters=m,this.type=Lf,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=tr(E),this.isInvisible="invisible"===this.parameters.size,$(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const M="string"==typeof p?document.getElementById(p):p;$(M,this.auth,"argument-error"),this.container=M,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new dm:new ta,this.validateStartingState()}verify(){var p=this;return(0,f.Z)(function*(){p.assertNotDestroyed();const m=yield p.render(),E=p.getAssertedRecaptcha();return E.getResponse(m)||new Promise(N=>{const q=ge=>{ge&&(p.tokenChangeListeners.delete(q),N(ge))};p.tokenChangeListeners.add(q),p.isInvisible&&E.execute(m)})})()}render(){try{this.assertNotDestroyed()}catch(p){return Promise.reject(p)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(p=>{throw this.renderPromise=null,p})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(p=>{this.container.removeChild(p)})}validateStartingState(){$(!this.parameters.sitekey,this.auth,"argument-error"),$(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),$(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(p){return m=>{if(this.tokenChangeListeners.forEach(E=>E(m)),"function"==typeof p)p(m);else if("string"==typeof p){const E=mr()[p];"function"==typeof E&&E(m)}}}assertNotDestroyed(){$(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var p=this;return(0,f.Z)(function*(){if(yield p.init(),!p.widgetId){let m=p.container;if(!p.isInvisible){const E=document.createElement("div");m.appendChild(E),m=E}p.widgetId=p.getAssertedRecaptcha().render(m,p.parameters)}return p.widgetId})()}init(){var p=this;return(0,f.Z)(function*(){$(fr()&&!Ru(),p.auth,"internal-error"),yield function fm(){let v=null;return new Promise(p=>{"complete"!==document.readyState?(v=()=>p(),window.addEventListener("load",v)):p()}).catch(p=>{throw v&&window.removeEventListener("load",v),p})}(),p.recaptcha=yield p._recaptchaLoader.load(p.auth,p.auth.languageCode||void 0);const m=yield function us(v){return Ms.apply(this,arguments)}(p.auth);$(m,p.auth,"internal-error"),p.parameters.sitekey=m})()}getAssertedRecaptcha(){return $(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Hr{constructor(p,m){this.verificationId=p,this.onConfirmation=m}confirm(p){const m=Ui._fromVerification(this.verificationId,p);return this.onConfirmation(m)}}function wn(){return(wn=(0,f.Z)(function*(v,p,m){const E=tr(v),M=yield Ha(E,p,(0,F.m9)(m));return new Hr(M,N=>Fn(E,N))})).apply(this,arguments)}function Bd(){return(Bd=(0,f.Z)(function*(v,p,m){const E=(0,F.m9)(v);yield Zn(!1,E,"phone");const M=yield Ha(E.auth,p,(0,F.m9)(m));return new Hr(M,N=>Cu(E,N))})).apply(this,arguments)}function jd(){return(jd=(0,f.Z)(function*(v,p,m){const E=(0,F.m9)(v),M=yield Ha(E.auth,p,(0,F.m9)(m));return new Hr(M,N=>Bl(E,N))})).apply(this,arguments)}function Ha(v,p,m){return $a.apply(this,arguments)}function $a(){return $a=(0,f.Z)(function*(v,p,m){var E;const M=yield m.verify();try{let N;if($("string"==typeof M,v,"argument-error"),$(m.type===Lf,v,"argument-error"),N="string"==typeof p?{phoneNumber:p}:p,"session"in N){const q=N.session;if("phoneNumber"in N)return $("enroll"===q.type,v,"internal-error"),(yield function La(v,p){return Xt(v,"POST","/v2/accounts/mfaEnrollment:start",je(v,p))}(v,{idToken:q.credential,phoneEnrollmentInfo:{phoneNumber:N.phoneNumber,recaptchaToken:M}})).phoneSessionInfo.sessionInfo;{$("signin"===q.type,v,"internal-error");const ge=(null===(E=N.multiFactorHint)||void 0===E?void 0:E.uid)||N.multiFactorUid;return $(ge,v,"missing-multi-factor-info"),(yield function Cr(v,p){return Xt(v,"POST","/v2/accounts/mfaSignIn:start",je(v,p))}(v,{mfaPendingCredential:q.credential,mfaEnrollmentId:ge,phoneSignInInfo:{recaptchaToken:M}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:q}=yield function gd(v,p){return Wo.apply(this,arguments)}(v,{phoneNumber:N.phoneNumber,recaptchaToken:M});return q}}finally{m._reset()}}),$a.apply(this,arguments)}function Ns(){return(Ns=(0,f.Z)(function*(v,p){yield ir((0,F.m9)(v),p)})).apply(this,arguments)}let Vu=(()=>{class v{constructor(m){this.providerId=v.PROVIDER_ID,this.auth=tr(m)}verifyPhoneNumber(m,E){return Ha(this.auth,m,(0,F.m9)(E))}static credential(m,E){return Ui._fromVerification(m,E)}static credentialFromResult(m){return v.credentialFromTaggedObject(m)}static credentialFromError(m){return v.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{phoneNumber:E,temporaryProof:M}=m;return E&&M?Ui._fromTokenResponse(E,M):null}}return v.PROVIDER_ID="phone",v.PHONE_SIGN_IN_METHOD="phone",v})();function ls(v,p){return p?Kt(p):($(v._popupRedirectResolver,v,"argument-error"),v._popupRedirectResolver)}class Ga extends Zs{constructor(p){super("custom","custom"),this.params=p}_getIdTokenResponse(p){return kn(p,this._buildIdpRequest())}_linkToIdToken(p,m){return kn(p,this._buildIdpRequest(m))}_getReauthenticationResolver(p){return kn(p,this._buildIdpRequest())}_buildIdpRequest(p){const m={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return p&&(m.idToken=p),m}}function tc(v){return _o(v.auth,new Ga(v),v.bypassAuthState)}function Uu(v){const{auth:p,user:m}=v;return $(m,p,"internal-error"),Iu(m,new Ga(v),v.bypassAuthState)}function Jr(v){return cs.apply(this,arguments)}function cs(){return(cs=(0,f.Z)(function*(v){const{auth:p,user:m}=v;return $(m,p,"internal-error"),ir(m,new Ga(v),v.bypassAuthState)})).apply(this,arguments)}class Bu{constructor(p,m,E,M,N=!1){this.auth=p,this.resolver=E,this.user=M,this.bypassAuthState=N,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(m)?m:[m]}execute(){var p=this;return new Promise(function(){var m=(0,f.Z)(function*(E,M){p.pendingPromise={resolve:E,reject:M};try{p.eventManager=yield p.resolver._initialize(p.auth),yield p.onExecution(),p.eventManager.registerConsumer(p)}catch(N){p.reject(N)}});return function(E,M){return m.apply(this,arguments)}}())}onAuthEvent(p){var m=this;return(0,f.Z)(function*(){const{urlResponse:E,sessionId:M,postBody:N,tenantId:q,error:ge,type:Be}=p;if(ge)return void m.reject(ge);const Qe={auth:m.auth,requestUri:E,sessionId:M,tenantId:q||void 0,postBody:N||void 0,user:m.user,bypassAuthState:m.bypassAuthState};try{m.resolve(yield m.getIdpTask(Be)(Qe))}catch(bt){m.reject(bt)}})()}onError(p){this.reject(p)}getIdpTask(p){switch(p){case"signInViaPopup":case"signInViaRedirect":return tc;case"linkViaPopup":case"linkViaRedirect":return Jr;case"reauthViaPopup":case"reauthViaRedirect":return Uu;default:J(this.auth,"internal-error")}}resolve(p){Ue(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(p),this.unregisterAndCleanUp()}reject(p){Ue(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(p),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const nn=new pe(2e3,1e4);function $r(){return($r=(0,f.Z)(function*(v,p,m){const E=tr(v);ye(v,p,Et);const M=ls(E,m);return new Hu(E,"signInViaPopup",p,M).executeNotNull()})).apply(this,arguments)}function ju(){return(ju=(0,f.Z)(function*(v,p,m){const E=(0,F.m9)(v);ye(E.auth,p,Et);const M=ls(E.auth,m);return new Hu(E.auth,"reauthViaPopup",p,M,E).executeNotNull()})).apply(this,arguments)}function nc(){return(nc=(0,f.Z)(function*(v,p,m){const E=(0,F.m9)(v);ye(E.auth,p,Et);const M=ls(E.auth,m);return new Hu(E.auth,"linkViaPopup",p,M,E).executeNotNull()})).apply(this,arguments)}let Hu=(()=>{class v extends Bu{constructor(m,E,M,N,q){super(m,E,N,q),this.provider=M,this.authWindow=null,this.pollId=null,v.currentPopupAction&&v.currentPopupAction.cancel(),v.currentPopupAction=this}executeNotNull(){var m=this;return(0,f.Z)(function*(){const E=yield m.execute();return $(E,m.auth,"internal-error"),E})()}onExecution(){var m=this;return(0,f.Z)(function*(){Ue(1===m.filter.length,"Popup operations only handle one event");const E=It();m.authWindow=yield m.resolver._openPopup(m.auth,m.provider,m.filter[0],E),m.authWindow.associatedEvent=E,m.resolver._originValidation(m.auth).catch(M=>{m.reject(M)}),m.resolver._isIframeWebStorageSupported(m.auth,M=>{M||m.reject(_e(m.auth,"web-storage-unsupported"))}),m.pollUserCancellation()})()}get eventId(){var m;return(null===(m=this.authWindow)||void 0===m?void 0:m.associatedEvent)||null}cancel(){this.reject(_e(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,v.currentPopupAction=null}pollUserCancellation(){const m=()=>{var E,M;this.pollId=null!==(M=null===(E=this.authWindow)||void 0===E?void 0:E.window)&&void 0!==M&&M.closed?window.setTimeout(()=>{this.pollId=null,this.reject(_e(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(m,nn.get())};m()}}return v.currentPopupAction=null,v})();const za="pendingRedirect",Os=new Map;class Tt extends Bu{constructor(p,m,E=!1){super(p,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],m,void 0,E),this.eventId=null}execute(){var p=()=>super.execute,m=this;return(0,f.Z)(function*(){let E=Os.get(m.auth._key());if(!E){try{const N=(yield function $u(v,p){return Ps.apply(this,arguments)}(m.resolver,m.auth))?yield p().call(m):null;E=()=>Promise.resolve(N)}catch(M){E=()=>Promise.reject(M)}Os.set(m.auth._key(),E)}return m.bypassAuthState||Os.set(m.auth._key(),()=>Promise.resolve(null)),E()})()}onAuthEvent(p){var m=()=>super.onAuthEvent,E=this;return(0,f.Z)(function*(){if("signInViaRedirect"===p.type)return m().call(E,p);if("unknown"!==p.type){if(p.eventId){const M=yield E.auth._redirectUserForId(p.eventId);if(M)return E.user=M,m().call(E,p);E.resolve(null)}}else E.resolve(null)})()}onExecution(){return(0,f.Z)(function*(){})()}cleanUp(){}}function Ps(){return(Ps=(0,f.Z)(function*(v,p){const m=Wa(p),E=Gu(v);if(!(yield E._isAvailable()))return!1;const M="true"===(yield E._get(m));return yield E._remove(m),M})).apply(this,arguments)}function Ao(v,p){return kr.apply(this,arguments)}function kr(){return(kr=(0,f.Z)(function*(v,p){return Gu(v)._set(Wa(p),"true")})).apply(this,arguments)}function Fr(v,p){Os.set(v._key(),p)}function Gu(v){return Kt(v._redirectPersistence)}function Wa(v){return Z(za,v.config.apiKey,v.name)}function Uf(v,p,m){return function ds(v,p,m){return b.apply(this,arguments)}(v,p,m)}function b(){return(b=(0,f.Z)(function*(v,p,m){const E=tr(v);ye(v,p,Et),yield E._initializationPromise;const M=ls(E,m);return yield Ao(M,E),M._openRedirect(E,p,"signInViaRedirect")})).apply(this,arguments)}function T(v,p,m){return function x(v,p,m){return V.apply(this,arguments)}(v,p,m)}function V(){return(V=(0,f.Z)(function*(v,p,m){const E=(0,F.m9)(v);ye(E.auth,p,Et),yield E.auth._initializationPromise;const M=ls(E.auth,m);yield Ao(M,E.auth);const N=yield dt(E);return M._openRedirect(E.auth,p,"reauthViaRedirect",N)})).apply(this,arguments)}function K(v,p,m){return function ne(v,p,m){return Me.apply(this,arguments)}(v,p,m)}function Me(){return(Me=(0,f.Z)(function*(v,p,m){const E=(0,F.m9)(v);ye(E.auth,p,Et),yield E.auth._initializationPromise;const M=ls(E.auth,m);yield Zn(!1,E,p.providerId),yield Ao(M,E.auth);const N=yield dt(E);return M._openRedirect(E.auth,p,"linkViaRedirect",N)})).apply(this,arguments)}function st(){return(st=(0,f.Z)(function*(v,p){return yield tr(v)._initializationPromise,ot(v,p,!1)})).apply(this,arguments)}function ot(v,p){return Bt.apply(this,arguments)}function Bt(){return(Bt=(0,f.Z)(function*(v,p,m=!1){const E=tr(v),M=ls(E,p),q=yield new Tt(E,M,m).execute();return q&&!m&&(delete q.user._redirectEventId,yield E._persistUserIfCurrent(q.user),yield E._setRedirectUser(null,p)),q})).apply(this,arguments)}function dt(v){return sr.apply(this,arguments)}function sr(){return(sr=(0,f.Z)(function*(v){const p=It(`${v.uid}:::`);return v._redirectEventId=p,yield v.auth._setRedirectUser(v),yield v.auth._persistUserIfCurrent(v),p})).apply(this,arguments)}class qi{constructor(p){this.auth=p,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(p){this.consumers.add(p),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,p)&&(this.sendToConsumer(this.queuedRedirectEvent,p),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(p){this.consumers.delete(p)}onEvent(p){if(this.hasEventBeenHandled(p))return!1;let m=!1;return this.consumers.forEach(E=>{this.isEventForConsumer(p,E)&&(m=!0,this.sendToConsumer(p,E),this.saveEventToCache(p))}),this.hasHandledPotentialRedirect||!function or(v){switch(v.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ti(v);default:return!1}}(p)||(this.hasHandledPotentialRedirect=!0,m||(this.queuedRedirectEvent=p,m=!0)),m}sendToConsumer(p,m){var E;if(p.error&&!Ti(p)){const M=(null===(E=p.error.code)||void 0===E?void 0:E.split("auth/")[1])||"internal-error";m.onError(_e(this.auth,M))}else m.onAuthEvent(p)}isEventForConsumer(p,m){const E=null===m.eventId||!!p.eventId&&p.eventId===m.eventId;return m.filter.includes(p.type)&&E}hasEventBeenHandled(p){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Tn(p))}saveEventToCache(p){this.cachedEventUids.add(Tn(p)),this.lastProcessedEventTime=Date.now()}}function Tn(v){return[v.type,v.eventId,v.sessionId,v.tenantId].filter(p=>p).join("-")}function Ti({type:v,error:p}){return"unknown"===v&&"auth/no-auth-event"===p?.code}function ar(v){return ur.apply(this,arguments)}function ur(){return(ur=(0,f.Z)(function*(v,p={}){return Xt(v,"GET","/v1/projects",p)})).apply(this,arguments)}const zu=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,mm=/^https?/;function hs(){return(hs=(0,f.Z)(function*(v){if(v.config.emulator)return;const{authorizedDomains:p}=yield ar(v);for(const m of p)try{if(eo(m))return}catch{}J(v,"unauthorized-domain")})).apply(this,arguments)}function eo(v){const p=In(),{protocol:m,hostname:E}=new URL(p);if(v.startsWith("chrome-extension://")){const q=new URL(v);return""===q.hostname&&""===E?"chrome-extension:"===m&&v.replace("chrome-extension://","")===p.replace("chrome-extension://",""):"chrome-extension:"===m&&q.hostname===E}if(!mm.test(m))return!1;if(zu.test(v))return E===v;const M=v.replace(/\./g,"\\.");return new RegExp("^(.+\\."+M+"|"+M+")$","i").test(E)}const _r=new pe(3e4,6e4);function Wi(){const v=mr().___jsl;if(v?.H)for(const p of Object.keys(v.H))if(v.H[p].r=v.H[p].r||[],v.H[p].L=v.H[p].L||[],v.H[p].r=[...v.H[p].L],v.CP)for(let m=0;m<v.CP.length;m++)v.CP[m]=null}let ks=null;const HI=new pe(5e3,15e3),Cv="__/auth/iframe",vm="emulator/auth/iframe",jt={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$d=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function $I(v){const p=v.config;$(p.authDomain,v,"auth-domain-config-required");const m=p.emulator?de(p,vm):`https://${v.config.authDomain}/${Cv}`,E={apiKey:p.apiKey,appName:v.name,v:ee.SDK_VERSION},M=$d.get(v.config.apiHost);M&&(E.eid=M);const N=v._getFrameworks();return N.length&&(E.fw=N.join(",")),`${m}?${(0,F.xO)(E).slice(1)}`}function wm(){return wm=(0,f.Z)(function*(v){const p=yield function na(v){return ks=ks||function ym(v){return new Promise((p,m)=>{var E,M,N;function q(){Wi(),gapi.load("gapi.iframes",{callback:()=>{p(gapi.iframes.getContext())},ontimeout:()=>{Wi(),m(_e(v,"network-request-failed"))},timeout:_r.get()})}if(null!==(M=null===(E=mr().gapi)||void 0===E?void 0:E.iframes)&&void 0!==M&&M.Iframe)p(gapi.iframes.getContext());else{if(null===(N=mr().gapi)||void 0===N||!N.load){const ge=Fu("iframefcb");return mr()[ge]=()=>{gapi.load?q():m(_e(v,"network-request-failed"))},ea(`https://apis.google.com/js/api.js?onload=${ge}`).catch(Be=>m(Be))}q()}}).catch(p=>{throw ks=null,p})}(v),ks}(v),m=mr().gapi;return $(m,v,"internal-error"),p.open({where:document.body,url:$I(v),messageHandlersFilter:m.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:jt,dontclear:!0},E=>new Promise(function(){var M=(0,f.Z)(function*(N,q){yield E.restyle({setHideOnLeave:!1});const ge=_e(v,"network-request-failed"),Be=mr().setTimeout(()=>{q(ge)},HI.get());function Qe(){mr().clearTimeout(Be),N(E)}E.ping(Qe).then(Qe,()=>{q(ge)})});return function(N,q){return M.apply(this,arguments)}}()))}),wm.apply(this,arguments)}const qu={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Wu{constructor(p){this.window=p,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const ic="__/auth/handler",Bf="emulator/auth/handler";function Zu(v,p,m,E,M,N){$(v.config.authDomain,v,"auth-domain-config-required"),$(v.config.apiKey,v,"invalid-api-key");const q={apiKey:v.config.apiKey,appName:v.name,authType:m,redirectUrl:E,v:ee.SDK_VERSION,eventId:M};if(p instanceof Et){p.setDefaultLanguage(v.languageCode),q.providerId=p.providerId||"",(0,F.xb)(p.getCustomParameters())||(q.customParameters=JSON.stringify(p.getCustomParameters()));for(const[Be,Qe]of Object.entries(N||{}))q[Be]=Qe}if(p instanceof Bi){const Be=p.getScopes().filter(Qe=>""!==Qe);Be.length>0&&(q.scopes=Be.join(","))}v.tenantId&&(q.tid=v.tenantId);const ge=q;for(const Be of Object.keys(ge))void 0===ge[Be]&&delete ge[Be];return`${function Ku({config:v}){return v.emulator?de(v,Bf):`https://${v.authDomain}/${ic}`}(v)}?${(0,F.xO)(ge).slice(1)}`}const Gd="webStorageSupport",Za=class jf{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Gi,this._completeRedirectFn=ot,this._overrideRedirectResult=Fr}_openPopup(p,m,E,M){var N=this;return(0,f.Z)(function*(){var q;Ue(null===(q=N.eventManagers[p._key()])||void 0===q?void 0:q.manager,"_initialize() not called before _openPopup()");const ge=Zu(p,m,E,In(),M);return function Im(v,p,m,E=500,M=600){const N=Math.max((window.screen.availHeight-M)/2,0).toString(),q=Math.max((window.screen.availWidth-E)/2,0).toString();let ge="";const Be=Object.assign(Object.assign({},qu),{width:E.toString(),height:M.toString(),top:N,left:q}),Qe=(0,F.z$)().toLowerCase();m&&(ge=Gt(Qe)?"_blank":m),it(Qe)&&(p=p||"http://localhost",Be.scrollbars="yes");const bt=Object.entries(Be).reduce(($n,[Qi,eu])=>`${$n}${Qi}=${eu},`,"");if(function Is(v=(0,F.z$)()){var p;return qn(v)&&!(null===(p=window.navigator)||void 0===p||!p.standalone)}(Qe)&&"_self"!==ge)return function Zi(v,p){const m=document.createElement("a");m.href=v,m.target=p;const E=document.createEvent("MouseEvent");E.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),m.dispatchEvent(E)}(p||"",ge),new Wu(null);const ft=window.open(p||"",ge,bt);$(ft,v,"popup-blocked");try{ft.focus()}catch{}return new Wu(ft)}(p,ge,It())})()}_openRedirect(p,m,E,M){var N=this;return(0,f.Z)(function*(){return yield N._originValidation(p),function Yl(v){mr().location.href=v}(Zu(p,m,E,In(),M)),new Promise(()=>{})})()}_initialize(p){const m=p._key();if(this.eventManagers[m]){const{manager:M,promise:N}=this.eventManagers[m];return M?Promise.resolve(M):(Ue(N,"If manager is not set, promise should be"),N)}const E=this.initAndGetManager(p);return this.eventManagers[m]={promise:E},E.catch(()=>{delete this.eventManagers[m]}),E}initAndGetManager(p){var m=this;return(0,f.Z)(function*(){const E=yield function rc(v){return wm.apply(this,arguments)}(p),M=new qi(p);return E.register("authEvent",N=>($(N?.authEvent,p,"invalid-auth-event"),{status:M.onEvent(N.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),m.eventManagers[p._key()]={manager:M},m.iframes[p._key()]=E,M})()}_isIframeWebStorageSupported(p,m){this.iframes[p._key()].send(Gd,{type:Gd},M=>{var N;const q=null===(N=M?.[0])||void 0===N?void 0:N[Gd];void 0!==q&&m(!!q),J(p,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(p){const m=p._key();return this.originValidationPromises[m]||(this.originValidationPromises[m]=function _m(v){return hs.apply(this,arguments)}(p)),this.originValidationPromises[m]}get _shouldInitProactively(){return Cs()||Rt()||qn()}};class _n{constructor(p){this.factorId=p}_process(p,m,E){switch(m.type){case"enroll":return this._finalizeEnroll(p,m.credential,E);case"signin":return this._finalizeSignIn(p,m.credential);default:return be("unexpected MultiFactorSessionType")}}}class br extends _n{constructor(p){super("phone"),this.credential=p}static _fromCredential(p){return new br(p)}_finalizeEnroll(p,m,E){return function Mu(v,p){return Xt(v,"POST","/v2/accounts/mfaEnrollment:finalize",je(v,p))}(p,{idToken:m,displayName:E,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(p,m){return function as(v,p){return Xt(v,"POST","/v2/accounts/mfaSignIn:finalize",je(v,p))}(p,{mfaPendingCredential:m,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Hf=(()=>{class v{constructor(){}static assertion(m){return br._fromCredential(m)}}return v.FACTOR_ID="phone",v})();var Ki="@firebase/auth";class Yu{constructor(p){this.auth=p,this.internalListeners=new Map}getUid(){var p;return this.assertAuthConfigured(),(null===(p=this.auth.currentUser)||void 0===p?void 0:p.uid)||null}getToken(p){var m=this;return(0,f.Z)(function*(){return m.assertAuthConfigured(),yield m.auth._initializationPromise,m.auth.currentUser?{accessToken:yield m.auth.currentUser.getIdToken(p)}:null})()}addAuthTokenListener(p){if(this.assertAuthConfigured(),this.internalListeners.has(p))return;const m=this.auth.onIdTokenChanged(E=>{p(E?.stsTokenManager.accessToken||null)});this.internalListeners.set(p,m),this.updateProactiveRefresh()}removeAuthTokenListener(p){this.assertAuthConfigured();const m=this.internalListeners.get(p);m&&(this.internalListeners.delete(p),m(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function fs(){return window}(0,F.Pz)("authIdTokenMaxAge"),function Dv(v){(0,ee._registerComponent)(new fe.wA("auth",(p,{options:m})=>{const E=p.getProvider("app").getImmediate(),M=p.getProvider("heartbeat"),{apiKey:N,authDomain:q}=E.options;return((ge,Be)=>{$(N&&!N.includes(":"),"invalid-api-key",{appName:ge.name}),$(!q?.includes(":"),"argument-error",{appName:ge.name});const Qe={apiKey:N,authDomain:q,clientPlatform:v,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:po(v)},bt=new Pl(ge,Be,Qe);return function Mn(v,p){const m=p?.persistence||[],E=(Array.isArray(m)?m:[m]).map(Kt);p?.errorMap&&v._updateErrorMap(p.errorMap),v._initializeWithPersistence(E,p?.popupRedirectResolver)}(bt,m),bt})(E,M)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((p,m,E)=>{p.getProvider("auth-internal").initialize()})),(0,ee._registerComponent)(new fe.wA("auth-internal",p=>{const m=tr(p.getProvider("auth").getImmediate());return new Yu(m)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,ee.registerVersion)(Ki,"0.21.1",function $f(v){switch(v){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(v)),(0,ee.registerVersion)(Ki,"0.21.1","esm2017")}("Browser");function Zd(){return Zd=(0,f.Z)(function*(v,p,m){var E;const{BuildInfo:M}=fs();Ue(p.sessionId,"AuthEvent did not contain a session ID");const N=yield function Tv(v){return qf.apply(this,arguments)}(p.sessionId),q={};return qn()?q.ibi=M.packageName:pn()?q.apn=M.packageName:J(v,"operation-not-supported-in-this-environment"),M.displayName&&(q.appDisplayName=M.displayName),q.sessionId=N,Zu(v,m,p.type,void 0,null!==(E=p.eventId)&&void 0!==E?E:void 0,q)}),Zd.apply(this,arguments)}function zf(){return(zf=(0,f.Z)(function*(v){const{BuildInfo:p}=fs(),m={};qn()?m.iosBundleId=p.packageName:pn()?m.androidPackageName=p.packageName:J(v,"operation-not-supported-in-this-environment"),yield ar(v,m)})).apply(this,arguments)}function Qu(){return(Qu=(0,f.Z)(function*(v,p,m){const{cordova:E}=fs();let M=()=>{};try{yield new Promise((N,q)=>{let ge=null;function Be(){var ft;N();const $n=null===(ft=E.plugins.browsertab)||void 0===ft?void 0:ft.close;"function"==typeof $n&&$n(),"function"==typeof m?.close&&m.close()}function Qe(){ge||(ge=window.setTimeout(()=>{q(_e(v,"redirect-cancelled-by-user"))},2e3))}function bt(){"visible"===document?.visibilityState&&Qe()}p.addPassiveListener(Be),document.addEventListener("resume",Qe,!1),pn()&&document.addEventListener("visibilitychange",bt,!1),M=()=>{p.removePassiveListener(Be),document.removeEventListener("resume",Qe,!1),document.removeEventListener("visibilitychange",bt,!1),ge&&window.clearTimeout(ge)}})}finally{M()}})).apply(this,arguments)}function qf(){return(qf=(0,f.Z)(function*(v){const p=function Xu(v){if(Ue(/[0-9a-zA-Z]+/.test(v),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(v);const p=new ArrayBuffer(v.length),m=new Uint8Array(p);for(let E=0;E<v.length;E++)m[E]=v.charCodeAt(E);return m}(v),m=yield crypto.subtle.digest("SHA-256",p);return Array.from(new Uint8Array(m)).map(M=>M.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class Sv extends qi{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(p=>{this.resolveInialized=p})}addPassiveListener(p){this.passiveListeners.add(p)}removePassiveListener(p){this.passiveListeners.delete(p)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(p){return this.resolveInialized(),this.passiveListeners.forEach(m=>m(p)),super.onEvent(p)}initialized(){var p=this;return(0,f.Z)(function*(){yield p.initPromise})()}}function Tm(v){return ia.apply(this,arguments)}function ia(){return(ia=(0,f.Z)(function*(v){const p=yield Yd()._get(Mo(v));return p&&(yield Yd()._remove(Mo(v))),p})).apply(this,arguments)}function Sm(){const v=[];for(let m=0;m<20;m++){const E=Math.floor(62*Math.random());v.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(E))}return v.join("")}function Yd(){return Kt(Jo)}function Mo(v){return Z("authEvent",v.config.apiKey,v.name)}function el(v){if(!v?.includes("?"))return{};const[p,...m]=v.split("?");return(0,F.zd)(m.join("?"))}const Kf=class Am{constructor(){this._redirectPersistence=Gi,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=ot,this._overrideRedirectResult=Fr}_initialize(p){var m=this;return(0,f.Z)(function*(){const E=p._key();let M=m.eventManagers.get(E);return M||(M=new Sv(p),m.eventManagers.set(E,M),m.attachCallbackListeners(p,M)),M})()}_openPopup(p){J(p,"operation-not-supported-in-this-environment")}_openRedirect(p,m,E,M){var N=this;return(0,f.Z)(function*(){!function Dm(v){var p,m,E,M,N,q,ge,Be,Qe,bt;const ft=fs();$("function"==typeof(null===(p=ft?.universalLinks)||void 0===p?void 0:p.subscribe),v,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),$(typeof(null===(m=ft?.BuildInfo)||void 0===m?void 0:m.packageName)<"u",v,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),$("function"==typeof(null===(N=null===(M=null===(E=ft?.cordova)||void 0===E?void 0:E.plugins)||void 0===M?void 0:M.browsertab)||void 0===N?void 0:N.openUrl),v,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),$("function"==typeof(null===(Be=null===(ge=null===(q=ft?.cordova)||void 0===q?void 0:q.plugins)||void 0===ge?void 0:ge.browsertab)||void 0===Be?void 0:Be.isAvailable),v,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),$("function"==typeof(null===(bt=null===(Qe=ft?.cordova)||void 0===Qe?void 0:Qe.InAppBrowser)||void 0===bt?void 0:bt.open),v,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(p);const q=yield N._initialize(p);yield q.initialized(),q.resetRedirect(),function qa(){Os.clear()}(),yield N._originValidation(p);const ge=function Av(v,p,m=null){return{type:p,eventId:m,urlResponse:null,sessionId:Sm(),postBody:null,tenantId:v.tenantId,error:_e(v,"no-auth-event")}}(p,E,M);yield function Wf(v,p){return Yd()._set(Mo(v),p)}(p,ge);const Be=yield function oc(v,p,m){return Zd.apply(this,arguments)}(p,ge,m),Qe=yield function bm(v){const{cordova:p}=fs();return new Promise(m=>{p.plugins.browsertab.isAvailable(E=>{let M=null;E?p.plugins.browsertab.openUrl(v):M=p.InAppBrowser.open(v,function fo(v=(0,F.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(v)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(v)}()?"_blank":"_system","location=yes"),m(M)})})}(Be);return function ac(v,p,m){return Qu.apply(this,arguments)}(p,q,Qe)})()}_isIframeWebStorageSupported(p,m){throw new Error("Method not implemented.")}_originValidation(p){const m=p._key();return this.originValidationPromises[m]||(this.originValidationPromises[m]=function Kd(v){return zf.apply(this,arguments)}(p)),this.originValidationPromises[m]}attachCallbackListeners(p,m){const{universalLinks:E,handleOpenURL:M,BuildInfo:N}=fs(),q=setTimeout((0,f.Z)(function*(){yield Tm(p),m.onEvent(Mm())}),500),ge=function(){var bt=(0,f.Z)(function*(ft){clearTimeout(q);const $n=yield Tm(p);let Qi=null;$n&&ft?.url&&(Qi=function Mv(v,p){var m,E;const M=function Zf(v){const p=el(v),m=p.link?decodeURIComponent(p.link):void 0,E=el(m).link,M=p.deep_link_id?decodeURIComponent(p.deep_link_id):void 0;return el(M).link||M||E||m||v}(p);if(M.includes("/__/auth/callback")){const N=el(M),q=N.firebaseError?function Ju(v){try{return JSON.parse(v)}catch{return null}}(decodeURIComponent(N.firebaseError)):null,ge=null===(E=null===(m=q?.code)||void 0===m?void 0:m.split("auth/"))||void 0===E?void 0:E[1],Be=ge?_e(ge):null;return Be?{type:v.type,eventId:v.eventId,tenantId:v.tenantId,error:Be,urlResponse:null,sessionId:null,postBody:null}:{type:v.type,eventId:v.eventId,tenantId:v.tenantId,sessionId:v.sessionId,urlResponse:M,postBody:null}}return null}($n,ft.url)),m.onEvent(Qi||Mm())});return function($n){return bt.apply(this,arguments)}}();typeof E<"u"&&"function"==typeof E.subscribe&&E.subscribe(null,ge);const Be=M,Qe=`${N.packageName.toLowerCase()}://`;fs().handleOpenURL=function(){var bt=(0,f.Z)(function*(ft){if(ft.toLowerCase().startsWith(Qe)&&ge({url:ft}),"function"==typeof Be)try{Be(ft)}catch($n){console.error($n)}});return function(ft){return bt.apply(this,arguments)}}()}};function Mm(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:_e("no-auth-event")}}function Ka(){var v;return(null===(v=self?.location)||void 0===v?void 0:v.protocol)||null}function Ov(v=(0,F.z$)()){return!("file:"!==Ka()&&"ionic:"!==Ka()&&"capacitor:"!==Ka()||!v.toLowerCase().match(/iphone|ipad|ipod|android/))}function Ya(){try{const v=self.localStorage,p=It();if(v)return v.setItem(p,"1"),v.removeItem(p),!function no(v=(0,F.z$)()){return function kv(){return(0,F.w1)()&&11===document?.documentMode}()||function Xd(v=(0,F.z$)()){return/Edge\/\d+/.test(v)}(v)}()||(0,F.hl)()}catch{return ps()&&(0,F.hl)()}return!1}function ps(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Qa(){return(function xm(){return"http:"===Ka()||"https:"===Ka()}()||(0,F.ru)()||Ov())&&!function Pv(){return(0,F.b$)()||(0,F.UG)()}()&&Ya()&&!ps()}function Xa(){return Ov()&&typeof document<"u"}function sa(){return(sa=(0,f.Z)(function*(){return!!Xa()&&new Promise(v=>{const p=setTimeout(()=>{v(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(p),v(!0)})})})).apply(this,arguments)}const Si={LOCAL:"local",NONE:"none",SESSION:"session"},oa=$,lc="persistence";function Qf(v){return Xf.apply(this,arguments)}function Xf(){return(Xf=(0,f.Z)(function*(v){yield v._initializationPromise;const p=Jf(),m=Z(lc,v.config.apiKey,v.name);p&&p.setItem(m,v._getPersistence())})).apply(this,arguments)}function Jf(){var v;try{return(null===(v=function Rm(){return typeof window<"u"?window:null}())||void 0===v?void 0:v.sessionStorage)||null}catch{return null}}const ep=$;class xo{constructor(){this.browserResolver=Kt(Za),this.cordovaResolver=Kt(Kf),this.underlyingResolver=null,this._redirectPersistence=Gi,this._completeRedirectFn=ot,this._overrideRedirectResult=Fr}_initialize(p){var m=this;return(0,f.Z)(function*(){return yield m.selectUnderlyingResolver(),m.assertedUnderlyingResolver._initialize(p)})()}_openPopup(p,m,E,M){var N=this;return(0,f.Z)(function*(){return yield N.selectUnderlyingResolver(),N.assertedUnderlyingResolver._openPopup(p,m,E,M)})()}_openRedirect(p,m,E,M){var N=this;return(0,f.Z)(function*(){return yield N.selectUnderlyingResolver(),N.assertedUnderlyingResolver._openRedirect(p,m,E,M)})()}_isIframeWebStorageSupported(p,m){this.assertedUnderlyingResolver._isIframeWebStorageSupported(p,m)}_originValidation(p){return this.assertedUnderlyingResolver._originValidation(p)}get _shouldInitProactively(){return Xa()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return ep(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var p=this;return(0,f.Z)(function*(){if(p.underlyingResolver)return;const m=yield function Jd(){return sa.apply(this,arguments)}();p.underlyingResolver=m?p.cordovaResolver:p.browserResolver})()}}function Lv(v){return v.unwrap()}function tl(v){return th(v)}function th(v){const{_tokenResponse:p}=v instanceof F.ZR?v.customData:v;if(!p)return null;if(!(v instanceof F.ZR)&&"temporaryProof"in p&&"phoneNumber"in p)return Vu.credentialFromResult(v);const m=p.providerId;if(!m||m===ae.PASSWORD)return null;let E;switch(m){case ae.GOOGLE:E=bn;break;case ae.FACEBOOK:E=os;break;case ae.GITHUB:E=xa;break;case ae.TWITTER:E=Ts;break;default:const{oauthIdToken:M,oauthAccessToken:N,oauthTokenSecret:q,pendingToken:ge,nonce:Be}=p;return N||q||M||ge?ge?m.startsWith("saml.")?jr._create(m,ge):ci._fromParams({providerId:m,signInMethod:m,pendingToken:ge,idToken:M,accessToken:N}):new mo(m).credential({idToken:M,accessToken:N,rawNonce:Be}):null}return v instanceof F.ZR?E.credentialFromError(v):E.credentialFromResult(v)}function mn(v,p){return p.catch(m=>{throw m instanceof F.ZR&&function Nm(v,p){var m;const E=null===(m=p.customData)||void 0===m?void 0:m._tokenResponse;if("auth/multi-factor-auth-required"===p?.code)p.resolver=new nh(v,function Ut(v,p){var m;const E=(0,F.m9)(v),M=p;return $(p.customData.operationType,E,"argument-error"),$(null===(m=M.customData._serverResponse)||void 0===m?void 0:m.mfaPendingCredential,E,"argument-error"),Au._fromError(E,M)}(v,p));else if(E){const M=th(p),N=p;M&&(N.credential=M,N.tenantId=E.tenantId||void 0,N.email=E.email||void 0,N.phoneNumber=E.phoneNumber||void 0)}}(v,m),m}).then(m=>{const M=m.user;return{operationType:m.operationType,credential:tl(m),additionalUserInfo:xd(m),user:Nn.getOrCreate(M)}})}function Yi(v,p){return Ro.apply(this,arguments)}function Ro(){return(Ro=(0,f.Z)(function*(v,p){const m=yield p;return{verificationId:m.verificationId,confirm:E=>mn(v,m.confirm(E))}})).apply(this,arguments)}class nh{constructor(p,m){this.resolver=m,this.auth=function Vv(v){return v.wrapped()}(p)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(p){return mn(Lv(this.auth),this.resolver.resolveSignIn(p))}}class Nn{constructor(p){this._delegate=p,this.multiFactor=function Ss(v){const p=(0,F.m9)(v);return Xo.has(p)||Xo.set(p,Eo._fromUser(p)),Xo.get(p)}(p)}static getOrCreate(p){return Nn.USER_MAP.has(p)||Nn.USER_MAP.set(p,new Nn(p)),Nn.USER_MAP.get(p)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(p){return this._delegate.getIdTokenResult(p)}getIdToken(p){return this._delegate.getIdToken(p)}linkAndRetrieveDataWithCredential(p){return this.linkWithCredential(p)}linkWithCredential(p){var m=this;return(0,f.Z)(function*(){return mn(m.auth,Cu(m._delegate,p))})()}linkWithPhoneNumber(p,m){var E=this;return(0,f.Z)(function*(){return Yi(E.auth,function pm(v,p,m){return Bd.apply(this,arguments)}(E._delegate,p,m))})()}linkWithPopup(p){var m=this;return(0,f.Z)(function*(){return mn(m.auth,function Iv(v,p,m){return nc.apply(this,arguments)}(m._delegate,p,xo))})()}linkWithRedirect(p){var m=this;return(0,f.Z)(function*(){return yield Qf(tr(m.auth)),K(m._delegate,p,xo)})()}reauthenticateAndRetrieveDataWithCredential(p){return this.reauthenticateWithCredential(p)}reauthenticateWithCredential(p){var m=this;return(0,f.Z)(function*(){return mn(m.auth,Bl(m._delegate,p))})()}reauthenticateWithPhoneNumber(p,m){return Yi(this.auth,function gm(v,p,m){return jd.apply(this,arguments)}(this._delegate,p,m))}reauthenticateWithPopup(p){return mn(this.auth,function Ev(v,p,m){return ju.apply(this,arguments)}(this._delegate,p,xo))}reauthenticateWithRedirect(p){var m=this;return(0,f.Z)(function*(){return yield Qf(tr(m.auth)),T(m._delegate,p,xo)})()}sendEmailVerification(p){return function Vn(v,p){return Js.apply(this,arguments)}(this._delegate,p)}unlink(p){var m=this;return(0,f.Z)(function*(){return yield function Qs(v,p){return Xs.apply(this,arguments)}(m._delegate,p),m})()}updateEmail(p){return function Ad(v,p){return Md((0,F.m9)(v),p,null)}(this._delegate,p)}updatePassword(p){return function Yo(v,p){return Md((0,F.m9)(v),null,p)}(this._delegate,p)}updatePhoneNumber(p){return function Hd(v,p){return Ns.apply(this,arguments)}(this._delegate,p)}updateProfile(p){return function Sd(v,p){return Rf.apply(this,arguments)}(this._delegate,p)}verifyBeforeUpdateEmail(p,m){return function xf(v,p,m){return Fa.apply(this,arguments)}(this._delegate,p,m)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Nn.USER_MAP=new WeakMap;const No=$;let Oo=(()=>{class v{constructor(m,E){if(this.app=m,E.isInitialized())return this._delegate=E.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:M}=m.options;No(M,"invalid-api-key",{appName:m.name}),No(M,"invalid-api-key",{appName:m.name});const N=typeof window<"u"?xo:void 0;this._delegate=E.initialize({options:{persistence:Uv(M,m.name),popupRedirectResolver:N}}),this._delegate._updateErrorMap($e),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Nn.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(m){this._delegate.languageCode=m}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(m){this._delegate.tenantId=m}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(m,E){!function Ws(v,p,m){const E=tr(v);$(E._canInitEmulator,E,"emulator-config-failed"),$(/^https?:\/\//.test(p),E,"invalid-emulator-scheme");const M=!!m?.disableWarnings,N=$o(p),{host:q,port:ge}=function kl(v){const p=$o(v),m=/(\/\/)?([^?#/]+)/.exec(v.substr(p.length));if(!m)return{host:"",port:null};const E=m[2].split("@").pop()||"",M=/^(\[[^\]]+\])(:|$)/.exec(E);if(M){const N=M[1];return{host:N,port:If(E.substr(N.length+1))}}{const[N,q]=E.split(":");return{host:N,port:If(q)}}}(p);E.config.emulator={url:`${N}//${q}${null===ge?"":`:${ge}`}/`},E.settings.appVerificationDisabledForTesting=!0,E.emulatorConfig=Object.freeze({host:q,port:ge,protocol:N.replace(":",""),options:Object.freeze({disableWarnings:M})}),M||function Fl(){function v(){const p=document.createElement("p"),m=p.style;p.innerText="Running in emulator mode. Do not use with production credentials.",m.position="fixed",m.width="100%",m.backgroundColor="#ffffff",m.border=".1em solid #000000",m.color="#b50000",m.bottom="0px",m.left="0px",m.margin="0px",m.zIndex="10000",m.textAlign="center",p.classList.add("firebase-emulator-warning"),document.body.appendChild(p)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",v):v())}()}(this._delegate,m,E)}applyActionCode(m){return function bd(v,p){return Pa.apply(this,arguments)}(this._delegate,m)}checkActionCode(m){return Du(this._delegate,m)}confirmPasswordReset(m,E){return function Sf(v,p,m){return Cd.apply(this,arguments)}(this._delegate,m,E)}createUserWithEmailAndPassword(m,E){var M=this;return(0,f.Z)(function*(){return mn(M._delegate,function yo(v,p,m){return zl.apply(this,arguments)}(M._delegate,m,E))})()}fetchProvidersForEmail(m){return this.fetchSignInMethodsForEmail(m)}fetchSignInMethodsForEmail(m){return function Di(v,p){return Zo.apply(this,arguments)}(this._delegate,m)}isSignInWithEmailLink(m){return function Td(v,p){const m=vn.parseLink(p);return"EMAIL_SIGNIN"===m?.operation}(0,m)}getRedirectResult(){var m=this;return(0,f.Z)(function*(){No(Qa(),m._delegate,"operation-not-supported-in-this-environment");const E=yield function et(v,p){return st.apply(this,arguments)}(m._delegate,xo);return E?mn(m._delegate,Promise.resolve(E)):{credential:null,user:null}})()}addFrameworkForLogging(m){!function Rv(v,p){tr(v)._logFramework(p)}(this._delegate,m)}onAuthStateChanged(m,E,M){const{next:N,error:q,complete:ge}=rh(m,E,M);return this._delegate.onAuthStateChanged(N,q,ge)}onIdTokenChanged(m,E,M){const{next:N,error:q,complete:ge}=rh(m,E,M);return this._delegate.onIdTokenChanged(N,q,ge)}sendSignInLinkToEmail(m,E){return function Dd(v,p,m){return ql.apply(this,arguments)}(this._delegate,m,E)}sendPasswordResetEmail(m,E){return function Ed(v,p,m){return Id.apply(this,arguments)}(this._delegate,m,E||void 0)}setPersistence(m){var E=this;return(0,f.Z)(function*(){let M;switch(function eh(v,p){oa(Object.values(Si).includes(p),v,"invalid-persistence-type"),(0,F.b$)()?oa(p!==Si.SESSION,v,"unsupported-persistence-type"):(0,F.UG)()?oa(p===Si.NONE,v,"unsupported-persistence-type"):ps()?oa(p===Si.NONE||p===Si.LOCAL&&(0,F.hl)(),v,"unsupported-persistence-type"):oa(p===Si.NONE||Ya(),v,"unsupported-persistence-type")}(E._delegate,m),m){case Si.SESSION:M=Gi;break;case Si.LOCAL:M=(yield Kt(Do)._isAvailable())?Do:Jo;break;case Si.NONE:M=B;break;default:return J("argument-error",{appName:E._delegate.name})}return E._delegate.setPersistence(M)})()}signInAndRetrieveDataWithCredential(m){return this.signInWithCredential(m)}signInAnonymously(){return mn(this._delegate,function Tf(v){return Eu.apply(this,arguments)}(this._delegate))}signInWithCredential(m){return mn(this._delegate,Fn(this._delegate,m))}signInWithCustomToken(m){return mn(this._delegate,function vd(v,p){return Hl.apply(this,arguments)}(this._delegate,m))}signInWithEmailAndPassword(m,E){return mn(this._delegate,function mv(v,p,m){return Fn((0,F.m9)(v),ss.credential(p,m))}(this._delegate,m,E))}signInWithEmailLink(m,E){return mn(this._delegate,function rm(v,p,m){return Tu.apply(this,arguments)}(this._delegate,m,E))}signInWithPhoneNumber(m,E){return Yi(this._delegate,function So(v,p,m){return wn.apply(this,arguments)}(this._delegate,m,E))}signInWithPopup(m){var E=this;return(0,f.Z)(function*(){return No(Qa(),E._delegate,"operation-not-supported-in-this-environment"),mn(E._delegate,function ct(v,p,m){return $r.apply(this,arguments)}(E._delegate,m,xo))})()}signInWithRedirect(m){var E=this;return(0,f.Z)(function*(){return No(Qa(),E._delegate,"operation-not-supported-in-this-environment"),yield Qf(E._delegate),Uf(E._delegate,m,xo)})()}updateCurrentUser(m){return this._delegate.updateCurrentUser(m)}verifyPasswordResetCode(m){return function Ln(v,p){return Mf.apply(this,arguments)}(this._delegate,m)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return v.Persistence=Si,v})();function rh(v,p,m){let E=v;"function"!=typeof v&&({next:E,error:p,complete:m}=v);const M=E;return{next:q=>M(q&&Nn.getOrCreate(q)),error:p,complete:m}}function Uv(v,p){const m=function Fv(v,p){const m=Jf();if(!m)return[];const E=Z(lc,v,p);switch(m.getItem(E)){case Si.NONE:return[B];case Si.LOCAL:return[Do,Gi];case Si.SESSION:return[Gi];default:return[]}}(v,p);if(typeof self<"u"&&!m.includes(Do)&&m.push(Do),typeof window<"u")for(const E of[Jo,Gi])m.includes(E)||m.push(E);return m.includes(B)||m.push(B),m}class Ja{constructor(){this.providerId="phone",this._delegate=new Vu(Lv(Q.Z.auth()))}static credential(p,m){return Vu.credential(p,m)}verifyPhoneNumber(p,m){return this._delegate.verifyPhoneNumber(p,m)}unwrap(){return this._delegate}}Ja.PHONE_SIGN_IN_METHOD=Vu.PHONE_SIGN_IN_METHOD,Ja.PROVIDER_ID=Vu.PROVIDER_ID;const Om=$;class ih{constructor(p,m,E=Q.Z.app()){var M;Om(null===(M=E.options)||void 0===M?void 0:M.apiKey,"invalid-api-key",{appName:E.name}),this._delegate=new hm(p,m,E.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function sh(v){v.INTERNAL.registerComponent(new fe.wA("auth-compat",p=>{const m=p.getProvider("app-compat").getImmediate(),E=p.getProvider("auth");return new Oo(m,E)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:ss,FacebookAuthProvider:os,GithubAuthProvider:xa,GoogleAuthProvider:bn,OAuthProvider:mo,SAMLAuthProvider:hi,PhoneAuthProvider:Ja,PhoneMultiFactorGenerator:Hf,RecaptchaVerifier:ih,TwitterAuthProvider:Ts,Auth:Oo,AuthCredential:Zs,Error:F.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),v.registerVersion("@firebase/auth-compat","0.3.1")}(Q.Z)},1878:(lt,Ee,k)=>{k.d(Ee,{Lj:()=>J,X3:()=>ut});var f=k(5861);const Q=($,be)=>be.some(Ue=>$ instanceof Ue);let F,ee;const fe=new WeakMap,Ce=new WeakMap,ae=new WeakMap,U=new WeakMap,G=new WeakMap;let Se={get($,be,Ue){if($ instanceof IDBTransaction){if("done"===be)return Ce.get($);if("objectStoreNames"===be)return $.objectStoreNames||ae.get($);if("store"===be)return Ue.objectStoreNames[1]?void 0:Ue.objectStore(Ue.objectStoreNames[0])}return xe($[be])},set:($,be,Ue)=>($[be]=Ue,!0),has:($,be)=>$ instanceof IDBTransaction&&("done"===be||"store"===be)||be in $};function He($){return"function"==typeof $?function Ne($){return $!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function he(){return ee||(ee=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes($)?function(...be){return $.apply(tt(this),be),xe(fe.get(this))}:function(...be){return xe($.apply(tt(this),be))}:function(be,...Ue){const At=$.call(tt(this),be,...Ue);return ae.set(At,be.sort?be.sort():[be]),xe(At)}}($):($ instanceof IDBTransaction&&function Fe($){if(Ce.has($))return;const be=new Promise((Ue,At)=>{const Kt=()=>{$.removeEventListener("complete",On),$.removeEventListener("error",Mn),$.removeEventListener("abort",Mn)},On=()=>{Ue(),Kt()},Mn=()=>{At($.error||new DOMException("AbortError","AbortError")),Kt()};$.addEventListener("complete",On),$.addEventListener("error",Mn),$.addEventListener("abort",Mn)});Ce.set($,be)}($),Q($,function te(){return F||(F=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy($,Se):$)}function xe($){if($ instanceof IDBRequest)return function X($){const be=new Promise((Ue,At)=>{const Kt=()=>{$.removeEventListener("success",On),$.removeEventListener("error",Mn)},On=()=>{Ue(xe($.result)),Kt()},Mn=()=>{At($.error),Kt()};$.addEventListener("success",On),$.addEventListener("error",Mn)});return be.then(Ue=>{Ue instanceof IDBCursor&&fe.set(Ue,$)}).catch(()=>{}),G.set(be,$),be}($);if(U.has($))return U.get($);const be=He($);return be!==$&&(U.set($,be),G.set(be,$)),be}const tt=$=>G.get($);function ut($,be,{blocked:Ue,upgrade:At,blocking:Kt,terminated:On}={}){const Mn=indexedDB.open($,be),In=xe(Mn);return At&&Mn.addEventListener("upgradeneeded",fr=>{At(xe(Mn.result),fr.oldVersion,fr.newVersion,xe(Mn.transaction))}),Ue&&Mn.addEventListener("blocked",()=>Ue()),In.then(fr=>{On&&fr.addEventListener("close",()=>On()),Kt&&fr.addEventListener("versionchange",()=>Kt())}).catch(()=>{}),In}function J($,{blocked:be}={}){const Ue=indexedDB.deleteDatabase($);return be&&Ue.addEventListener("blocked",()=>be()),xe(Ue).then(()=>{})}const _e=["get","getKey","getAll","getAllKeys","count"],re=["put","add","delete","clear"],ye=new Map;function Le($,be){if(!($ instanceof IDBDatabase)||be in $||"string"!=typeof be)return;if(ye.get(be))return ye.get(be);const Ue=be.replace(/FromIndex$/,""),At=be!==Ue,Kt=re.includes(Ue);if(!(Ue in(At?IDBIndex:IDBObjectStore).prototype)||!Kt&&!_e.includes(Ue))return;const On=function(){var Mn=(0,f.Z)(function*(In,...fr){const zs=this.transaction(In,Kt?"readwrite":"readonly");let ie=zs.store;return At&&(ie=ie.index(fr.shift())),(yield Promise.all([ie[Ue](...fr),Kt&&zs.done]))[0]});return function(fr){return Mn.apply(this,arguments)}}();return ye.set(be,On),On}!function $e($){Se=$(Se)}($=>({...$,get:(be,Ue,At)=>Le(be,Ue)||$.get(be,Ue,At),has:(be,Ue)=>!!Le(be,Ue)||$.has(be,Ue)}))},5861:(lt,Ee,k)=>{function f(F,ee,te,he,fe,Ce,ae){try{var U=F[Ce](ae),G=U.value}catch(X){return void te(X)}U.done?ee(G):Promise.resolve(G).then(he,fe)}function Q(F){return function(){var ee=this,te=arguments;return new Promise(function(he,fe){var Ce=F.apply(ee,te);function ae(G){f(Ce,he,fe,ae,U,"next",G)}function U(G){f(Ce,he,fe,ae,U,"throw",G)}ae(void 0)})}}k.d(Ee,{Z:()=>Q})},7582:(lt,Ee,k)=>{function ee(ie,le){var pe={};for(var de in ie)Object.prototype.hasOwnProperty.call(ie,de)&&le.indexOf(de)<0&&(pe[de]=ie[de]);if(null!=ie&&"function"==typeof Object.getOwnPropertySymbols){var Oe=0;for(de=Object.getOwnPropertySymbols(ie);Oe<de.length;Oe++)le.indexOf(de[Oe])<0&&Object.prototype.propertyIsEnumerable.call(ie,de[Oe])&&(pe[de[Oe]]=ie[de[Oe]])}return pe}function X(ie,le,pe,de){return new(pe||(pe=Promise))(function(Ve,rt){function je(on){try{wt(de.next(on))}catch(Ct){rt(Ct)}}function Xt(on){try{wt(de.throw(on))}catch(Ct){rt(Ct)}}function wt(on){on.done?Ve(on.value):function Oe(Ve){return Ve instanceof pe?Ve:new pe(function(rt){rt(Ve)})}(on.value).then(je,Xt)}wt((de=de.apply(ie,le||[])).next())})}function J(ie){return this instanceof J?(this.v=ie,this):new J(ie)}function _e(ie,le,pe){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Oe,de=pe.apply(ie,le||[]),Ve=[];return Oe={},rt("next"),rt("throw"),rt("return"),Oe[Symbol.asyncIterator]=function(){return this},Oe;function rt(Jt){de[Jt]&&(Oe[Jt]=function(Bn){return new Promise(function(pr,ln){Ve.push([Jt,Bn,pr,ln])>1||je(Jt,Bn)})})}function je(Jt,Bn){try{!function Xt(Jt){Jt.value instanceof J?Promise.resolve(Jt.value.v).then(wt,on):Ct(Ve[0][2],Jt)}(de[Jt](Bn))}catch(pr){Ct(Ve[0][3],pr)}}function wt(Jt){je("next",Jt)}function on(Jt){je("throw",Jt)}function Ct(Jt,Bn){Jt(Bn),Ve.shift(),Ve.length&&je(Ve[0][0],Ve[0][1])}}function ye(ie){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var pe,le=ie[Symbol.asyncIterator];return le?le.call(ie):(ie=function Ne(ie){var le="function"==typeof Symbol&&Symbol.iterator,pe=le&&ie[le],de=0;if(pe)return pe.call(ie);if(ie&&"number"==typeof ie.length)return{next:function(){return ie&&de>=ie.length&&(ie=void 0),{value:ie&&ie[de++],done:!ie}}};throw new TypeError(le?"Object is not iterable.":"Symbol.iterator is not defined.")}(ie),pe={},de("next"),de("throw"),de("return"),pe[Symbol.asyncIterator]=function(){return this},pe);function de(Ve){pe[Ve]=ie[Ve]&&function(rt){return new Promise(function(je,Xt){!function Oe(Ve,rt,je,Xt){Promise.resolve(Xt).then(function(wt){Ve({value:wt,done:je})},rt)}(je,Xt,(rt=ie[Ve](rt)).done,rt.value)})}}}k.d(Ee,{FC:()=>_e,KL:()=>ye,_T:()=>ee,mG:()=>X,qq:()=>J}),"function"==typeof SuppressedError&&SuppressedError}},lt=>{lt(lt.s=9390)}]);